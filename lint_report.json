[{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\coverage\\lcov-report\\block-navigation.js","messages":[],"suppressedMessages":[{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":1,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":86,"endColumn":6,"fix":{"range":[21,24],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":4,"column":5,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":4,"endColumn":76,"fix":{"range":[128,131],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":7,"column":5,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":7,"endColumn":46,"fix":{"range":[259,262],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":10,"column":5,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":10,"endColumn":80,"fix":{"range":[391,394],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":13,"column":5,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":17,"endColumn":57,"fix":{"range":[572,575],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":20,"column":5,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":20,"endColumn":71,"fix":{"range":[820,823],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":22,"column":5,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":22,"endColumn":22,"fix":{"range":[892,895],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":42,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":42,"endColumn":27,"fix":{"range":[1436,1439],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":53,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":53,"endColumn":27,"fix":{"range":[1768,1771],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\coverage\\lcov-report\\prettify.js","messages":[],"suppressedMessages":[{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":52,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":105,"fix":{"range":[72,75],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":105,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":272,"fix":{"range":[125,128],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":272,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":381,"fix":{"range":[292,295],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":381,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":646,"fix":{"range":[401,404],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":646,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":796,"fix":{"range":[666,669],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":796,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":1071,"fix":{"range":[816,819],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":1071,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":1236,"fix":{"range":[1091,1094],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":1236,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":1323,"fix":{"range":[1256,1259],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":1323,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":1506,"fix":{"range":[1343,1346],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":1506,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":1667,"fix":{"range":[1526,1529],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":1667,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":1846,"fix":{"range":[1687,1690],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":1846,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":1919,"fix":{"range":[1866,1869],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":1919,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":1941,"fix":{"range":[1939,1942],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":1941,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":2060,"fix":{"range":[1961,1964],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":2060,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":2072,"fix":{"range":[2080,2083],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":2072,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":2084,"fix":{"range":[2092,2095],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":2084,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":2096,"fix":{"range":[2104,2107],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":2096,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":2108,"fix":{"range":[2116,2119],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":2108,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":2120,"fix":{"range":[2128,2131],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":2120,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":2132,"fix":{"range":[2140,2143],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":2132,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":2144,"fix":{"range":[2152,2155],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":2144,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":2156,"fix":{"range":[2164,2167],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":2156,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":2168,"fix":{"range":[2176,2179],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":2168,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":2180,"fix":{"range":[2188,2191],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":2180,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":2192,"fix":{"range":[2200,2203],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":2192,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":2204,"fix":{"range":[2212,2215],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":2204,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":2219,"fix":{"range":[2224,2227],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":2219,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":2525,"fix":{"range":[2239,2242],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":2539,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":2548,"fix":{"range":[2559,2562],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":2548,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":2560,"fix":{"range":[2568,2571],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":2560,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":2573,"fix":{"range":[2580,2583],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":2577,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":2595,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":2605,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":2617,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":2755,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":2791,"fix":{"range":[2775,2778],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":2807,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":2831,"fix":{"range":[2827,2830],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":2853,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":2873,"fix":{"range":[2873,2876],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":3124,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":3155,"fix":{"range":[3144,3147],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":3235,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":3394,"fix":{"range":[3255,3258],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":3394,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":3404,"fix":{"range":[3414,3417],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":3404,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":3414,"fix":{"range":[3424,3427],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":3414,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":3433,"fix":{"range":[3434,3437],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":3437,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":3463,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":3476,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":3490,"fix":{"range":[3496,3499],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":3532,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":3546,"fix":{"range":[3552,3555],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":3546,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":3553,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":3858,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":3868,"fix":{"range":[3878,3881],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":3868,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":3885,"fix":{"range":[3888,3891],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":3889,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":3897,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":3917,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":3931,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":3999,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":4012,"fix":{"range":[4019,4022],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":4057,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":4065,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":4085,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":4099,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":4230,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":4426,"fix":{"range":[4250,4253],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":4426,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":4443,"fix":{"range":[4446,4449],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":4443,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":4453,"fix":{"range":[4463,4466],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":4457,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":4470,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":4483,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":4497,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":4544,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":4568,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":4600,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":4608,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":4661,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":4674,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":4687,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":4701,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":4785,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":4809,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":4850,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":4863,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":4945,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":4953,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":4966,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":4980,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":4980,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":5000,"fix":{"range":[5000,5003],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":5102,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":5126,"fix":{"range":[5122,5125],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":5198,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":5208,"fix":{"range":[5218,5221],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":5212,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":5230,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":5240,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":5252,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":5386,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":5417,"fix":{"range":[5406,5409],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":5417,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":5426,"fix":{"range":[5437,5440],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":5426,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":5434,"fix":{"range":[5446,5449],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":5434,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":5443,"fix":{"range":[5454,5457],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":5443,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":5451,"fix":{"range":[5463,5466],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":5451,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":5457,"fix":{"range":[5471,5474],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":5618,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":5652,"fix":{"range":[5638,5641],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":5731,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":5751,"fix":{"range":[5751,5754],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":5781,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":5800,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":5884,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":5904,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6143,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6174,"fix":{"range":[6163,6166],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6209,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6220,"fix":{"range":[6229,6232],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6234,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6250,"fix":{"range":[6254,6257],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6254,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6272,"fix":{"range":[6274,6277],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6292,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6309,"fix":{"range":[6312,6315],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6404,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6413,"fix":{"range":[6424,6427],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6413,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6419,"fix":{"range":[6433,6436],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6431,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6450,"fix":{"range":[6451,6454],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6450,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6460,"fix":{"range":[6470,6473],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6460,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6470,"fix":{"range":[6480,6483],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6474,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6494,"fix":{"range":[6494,6497],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6506,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6519,"fix":{"range":[6526,6529],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6519,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6531,"fix":{"range":[6539,6542],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6542,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6558,"fix":{"range":[6562,6565],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6589,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6601,"fix":{"range":[6609,6612],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6601,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6614,"fix":{"range":[6621,6624],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6701,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6716,"fix":{"range":[6721,6724],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6716,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":7512,"fix":{"range":[6736,6739],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6735,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6768,"fix":{"range":[6755,6758],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6768,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6781,"fix":{"range":[6788,6791],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6781,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6790,"fix":{"range":[6801,6804],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6790,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6812,"fix":{"range":[6810,6813],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6812,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6822,"fix":{"range":[6832,6835],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6826,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6847,"fix":{"range":[6846,6849],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6860,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6874,"fix":{"range":[6880,6883],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6874,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6888,"fix":{"range":[6894,6897],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6888,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6902,"fix":{"range":[6908,6911],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6902,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6909,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":6948,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":6971,"fix":{"range":[6968,6971],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":7015,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":7023,"fix":{"range":[7035,7038],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":7217,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":7227,"fix":{"range":[7237,7240],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":7271,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":7284,"fix":{"range":[7291,7294],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":7284,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":7306,"fix":{"range":[7304,7307],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":7306,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":7326,"fix":{"range":[7326,7329],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":7378,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":7401,"fix":{"range":[7398,7401],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":7535,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":7549,"fix":{"range":[7555,7558],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":8105,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":8126,"fix":{"range":[8125,8128],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":8592,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":8696,"fix":{"range":[8612,8615],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":8747,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":8761,"fix":{"range":[8767,8770],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":8781,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":8824,"fix":{"range":[8801,8804],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":9272,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":9373,"fix":{"range":[9292,9295],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":9390,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":9421,"fix":{"range":[9410,9413],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":9421,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":9439,"fix":{"range":[9441,9444],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":9439,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":9462,"fix":{"range":[9459,9462],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":9462,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":9468,"fix":{"range":[9482,9485],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":9623,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":9657,"fix":{"range":[9643,9646],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":9657,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":9687,"fix":{"range":[9677,9680],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":9736,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":9747,"fix":{"range":[9756,9759],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":9909,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":9929,"fix":{"range":[9929,9932],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":9986,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":10006,"fix":{"range":[10006,10009],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":10006,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":10026,"fix":{"range":[10026,10029],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":10033,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":10065,"fix":{"range":[10053,10056],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":10081,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":10124,"fix":{"range":[10101,10104],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":10131,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":10152,"fix":{"range":[10151,10154],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":10351,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":10384,"fix":{"range":[10371,10374],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":10384,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":10405,"fix":{"range":[10404,10407],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":10412,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":10428,"fix":{"range":[10432,10435],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":10428,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":10450,"fix":{"range":[10448,10451],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":10473,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":10482,"fix":{"range":[10493,10496],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":10541,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":10569,"fix":{"range":[10561,10564],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":10573,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":10579,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":10639,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":10646,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":10718,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":10748,"fix":{"range":[10738,10741],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":10772,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":10804,"fix":{"range":[10792,10795],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":10808,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":10826,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":10985,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11029,"fix":{"range":[11005,11008],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11029,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11042,"fix":{"range":[11049,11052],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11042,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11063,"fix":{"range":[11062,11065],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11063,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11080,"fix":{"range":[11083,11086],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11080,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11088,"fix":{"range":[11100,11103],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11088,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11104,"fix":{"range":[11108,11111],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11104,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11120,"fix":{"range":[11124,11127],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11120,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11129,"fix":{"range":[11140,11143],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11129,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11150,"fix":{"range":[11149,11152],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11150,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11165,"fix":{"range":[11170,11173],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11165,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11173,"fix":{"range":[11185,11188],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11181,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11191,"fix":{"range":[11201,11204],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11298,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11311,"fix":{"range":[11318,11321],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11311,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11326,"fix":{"range":[11331,11334],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11326,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11337,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11410,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11422,"fix":{"range":[11430,11433],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ae' is assigned a value but never used.","line":2,"column":11414,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":11416,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11434,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11448,"fix":{"range":[11454,11457],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'af' is assigned a value but never used.","line":2,"column":11438,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":11440,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11448,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11467,"fix":{"range":[11468,11471],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11467,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11479,"fix":{"range":[11487,11490],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ag' is assigned a value but never used.","line":2,"column":11471,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":11473,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11479,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11497,"fix":{"range":[11499,11502],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11497,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11518,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11518,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11534,"fix":{"range":[11538,11541],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11534,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11540,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11626,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11650,"fix":{"range":[11646,11649],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11650,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11682,"fix":{"range":[11670,11673],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11702,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11723,"fix":{"range":[11722,11725],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11894,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11903,"fix":{"range":[11914,11917],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11923,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11937,"fix":{"range":[11943,11946],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":11947,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":11958,"fix":{"range":[11967,11970],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":14075,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":14097,"fix":{"range":[14095,14098],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":14101,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":14123,"fix":{"range":[14121,14124],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":14123,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":14142,"fix":{"range":[14143,14146],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":14287,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":14323,"fix":{"range":[14307,14310],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":14350,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":14401,"fix":{"range":[14370,14373],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":14496,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":14533,"fix":{"range":[14516,14519],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":14533,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":14542,"fix":{"range":[14553,14556],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":14546,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":14554,"fix":{"range":[14566,14569],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":14578,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":14601,"fix":{"range":[14598,14601],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":14638,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":14649,"fix":{"range":[14658,14661],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":14699,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":14707,"fix":{"range":[14719,14722],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":14707,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":14713,"fix":{"range":[14727,14730],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":14713,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":14753,"fix":{"range":[14733,14736],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":14753,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":14778,"fix":{"range":[14773,14776],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ae' is assigned a value but never used.","line":2,"column":14757,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":14759,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":14791,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":14855,"fix":{"range":[14811,14814],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":14888,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":14900,"fix":{"range":[14908,14911],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":14900,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":14920,"fix":{"range":[14920,14923],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":14953,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":14973,"fix":{"range":[14973,14976],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":14973,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":14980,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":15063,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":15076,"fix":{"range":[15083,15086],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":15080,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":15100,"fix":{"range":[15100,15103],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":15265,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":2,"endColumn":15318,"fix":{"range":[15285,15288],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\coverage\\lcov-report\\sorter.js","messages":[],"suppressedMessages":[{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":2,"column":1,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":208,"endColumn":6,"fix":{"range":[21,24],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":4,"column":5,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":8,"endColumn":11,"fix":{"range":[74,77],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":36,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":36,"endColumn":23,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":60,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":60,"endColumn":66,"fix":{"range":[1893,1896],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":61,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":61,"endColumn":62,"fix":{"range":[1959,1962],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":68,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":72,"endColumn":15,"fix":{"range":[2217,2220],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":93,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":98,"endColumn":17,"fix":{"range":[3094,3097],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":112,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":113,"endColumn":15,"fix":{"range":[3625,3628],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":121,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":131,"endColumn":15,"fix":{"range":[3908,3911],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":152,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":153,"endColumn":33,"fix":{"range":[4836,4839],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":166,"column":9,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":183,"endColumn":15,"fix":{"range":[5330,5333],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":169,"column":17,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":169,"endColumn":35,"fix":{"range":[5417,5420],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"no-var","severity":2,"message":"Unexpected var, use let or const instead.","line":172,"column":21,"nodeType":"VariableDeclaration","messageId":"unexpectedVar","endLine":172,"endColumn":52,"fix":{"range":[5493,5496],"text":"let"},"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\infrastructure\\app.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\infrastructure\\game-leaderboard-stack.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'iam' is defined but never used.","line":5,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":16}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as cdk from 'aws-cdk-lib';\r\nimport * as lambda from 'aws-cdk-lib/aws-lambda';\r\nimport * as apigateway from 'aws-cdk-lib/aws-apigateway';\r\nimport * as dynamodb from 'aws-cdk-lib/aws-dynamodb';\r\nimport * as iam from 'aws-cdk-lib/aws-iam';\r\nimport { Construct } from 'constructs';\r\n\r\nexport class GameLeaderboardStack extends cdk.Stack {\r\n  constructor(scope: Construct, id: string, props?: cdk.StackProps) {\r\n    super(scope, id, props);\r\n\r\n    // DynamoDB table for storing scores\r\n    const scoresTable = new dynamodb.Table(this, 'ScoresTable', {\r\n      tableName: 'caminho-assombrado-scores',\r\n      partitionKey: {\r\n        name: 'scoreId',\r\n        type: dynamodb.AttributeType.STRING,\r\n      },\r\n      sortKey: {\r\n        name: 'createdAt',\r\n        type: dynamodb.AttributeType.STRING,\r\n      },\r\n      billingMode: dynamodb.BillingMode.PAY_PER_REQUEST,\r\n      removalPolicy: cdk.RemovalPolicy.RETAIN, // Keep data on stack deletion\r\n      pointInTimeRecoverySpecification: {\r\n        pointInTimeRecoveryEnabled: true,\r\n      },\r\n    });\r\n\r\n    // Global Secondary Index for querying by score (for leaderboard)\r\n    scoresTable.addGlobalSecondaryIndex({\r\n      indexName: 'ScoreIndex',\r\n      partitionKey: {\r\n        name: 'gameType',\r\n        type: dynamodb.AttributeType.STRING,\r\n      },\r\n      sortKey: {\r\n        name: 'score',\r\n        type: dynamodb.AttributeType.NUMBER,\r\n      },\r\n      projectionType: dynamodb.ProjectionType.ALL,\r\n    });\r\n\r\n    // Lambda function for getting top 10 scores\r\n    const getTop10Function = new lambda.Function(this, 'GetTop10ScoresFunction', {\r\n      runtime: lambda.Runtime.NODEJS_18_X,\r\n      handler: 'index.handler',\r\n      code: lambda.Code.fromInline(`\r\n        const { DynamoDBClient } = require('@aws-sdk/client-dynamodb');\r\n        const { DynamoDBDocumentClient, QueryCommand } = require('@aws-sdk/lib-dynamodb');\r\n\r\n        const client = new DynamoDBClient({});\r\n        const docClient = DynamoDBDocumentClient.from(client);\r\n\r\n        exports.handler = async (event) => {\r\n          console.log('GetTop10Scores event:', JSON.stringify(event, null, 2));\r\n          \r\n          try {\r\n            const params = {\r\n              TableName: process.env.SCORES_TABLE_NAME,\r\n              IndexName: 'ScoreIndex',\r\n              KeyConditionExpression: 'gameType = :gameType',\r\n              ExpressionAttributeValues: {\r\n                ':gameType': 'caminho-assombrado'\r\n              },\r\n              ScanIndexForward: false, // Sort in descending order (highest scores first)\r\n              Limit: 10\r\n            };\r\n\r\n            const result = await docClient.send(new QueryCommand(params));\r\n            \r\n            const response = {\r\n              scores: result.Items || [],\r\n              total: result.Count || 0\r\n            };\r\n\r\n            return {\r\n              statusCode: 200,\r\n              headers: {\r\n                'Content-Type': 'application/json',\r\n                'Access-Control-Allow-Origin': '*',\r\n                'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',\r\n                'Access-Control-Allow-Headers': 'Content-Type, Authorization',\r\n              },\r\n              body: JSON.stringify(response),\r\n            };\r\n          } catch (error) {\r\n            console.error('Error fetching top 10 scores:', error);\r\n            return {\r\n              statusCode: 500,\r\n              headers: {\r\n                'Content-Type': 'application/json',\r\n                'Access-Control-Allow-Origin': '*',\r\n              },\r\n              body: JSON.stringify({ error: 'Internal server error' }),\r\n            };\r\n          }\r\n        };\r\n      `),\r\n      environment: {\r\n        SCORES_TABLE_NAME: scoresTable.tableName,\r\n      },\r\n      timeout: cdk.Duration.seconds(10),\r\n    });\r\n\r\n    // Lambda function for getting all scores with pagination\r\n    const getAllScoresFunction = new lambda.Function(this, 'GetAllScoresFunction', {\r\n      runtime: lambda.Runtime.NODEJS_18_X,\r\n      handler: 'index.handler',\r\n      code: lambda.Code.fromInline(`\r\n        const { DynamoDBClient } = require('@aws-sdk/client-dynamodb');\r\n        const { DynamoDBDocumentClient, QueryCommand } = require('@aws-sdk/lib-dynamodb');\r\n\r\n        const client = new DynamoDBClient({});\r\n        const docClient = DynamoDBDocumentClient.from(client);\r\n\r\n        exports.handler = async (event) => {\r\n          console.log('GetAllScores event:', JSON.stringify(event, null, 2));\r\n          \r\n          try {\r\n            const queryParams = event.queryStringParameters || {};\r\n            const limit = parseInt(queryParams.limit) || 50;\r\n            const nextToken = queryParams.nextToken;\r\n\r\n            const params = {\r\n              TableName: process.env.SCORES_TABLE_NAME,\r\n              IndexName: 'ScoreIndex',\r\n              KeyConditionExpression: 'gameType = :gameType',\r\n              ExpressionAttributeValues: {\r\n                ':gameType': 'caminho-assombrado'\r\n              },\r\n              ScanIndexForward: false, // Sort in descending order (highest scores first)\r\n              Limit: limit\r\n            };\r\n\r\n            if (nextToken) {\r\n              params.ExclusiveStartKey = JSON.parse(Buffer.from(nextToken, 'base64').toString());\r\n            }\r\n\r\n            const result = await docClient.send(new QueryCommand(params));\r\n            \r\n            const response = {\r\n              scores: result.Items || [],\r\n              hasMore: !!result.LastEvaluatedKey\r\n            };\r\n\r\n            if (result.LastEvaluatedKey) {\r\n              response.nextToken = Buffer.from(JSON.stringify(result.LastEvaluatedKey)).toString('base64');\r\n            }\r\n\r\n            return {\r\n              statusCode: 200,\r\n              headers: {\r\n                'Content-Type': 'application/json',\r\n                'Access-Control-Allow-Origin': '*',\r\n                'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',\r\n                'Access-Control-Allow-Headers': 'Content-Type, Authorization',\r\n              },\r\n              body: JSON.stringify(response),\r\n            };\r\n          } catch (error) {\r\n            console.error('Error fetching all scores:', error);\r\n            return {\r\n              statusCode: 500,\r\n              headers: {\r\n                'Content-Type': 'application/json',\r\n                'Access-Control-Allow-Origin': '*',\r\n              },\r\n              body: JSON.stringify({ error: 'Internal server error' }),\r\n            };\r\n          }\r\n        };\r\n      `),\r\n      environment: {\r\n        SCORES_TABLE_NAME: scoresTable.tableName,\r\n      },\r\n      timeout: cdk.Duration.seconds(15),\r\n    });\r\n\r\n    // Lambda function for submitting scores\r\n    const submitScoreFunction = new lambda.Function(this, 'SubmitScoreFunction', {\r\n      runtime: lambda.Runtime.NODEJS_18_X,\r\n      handler: 'index.handler',\r\n      code: lambda.Code.fromInline(`\r\n        const { DynamoDBClient } = require('@aws-sdk/client-dynamodb');\r\n        const { DynamoDBDocumentClient, PutCommand } = require('@aws-sdk/lib-dynamodb');\r\n        const { randomUUID } = require('crypto');\r\n\r\n        const client = new DynamoDBClient({});\r\n        const docClient = DynamoDBDocumentClient.from(client);\r\n\r\n        exports.handler = async (event) => {\r\n          console.log('SubmitScore event:', JSON.stringify(event, null, 2));\r\n          \r\n          try {\r\n            const body = JSON.parse(event.body || '{}');\r\n            \r\n            // Validate required fields\r\n            const { firstName, lastName, score, character, weapon, difficulty } = body;\r\n            \r\n            if (!firstName || !lastName || typeof score !== 'number') {\r\n              return {\r\n                statusCode: 400,\r\n                headers: {\r\n                  'Content-Type': 'application/json',\r\n                  'Access-Control-Allow-Origin': '*',\r\n                },\r\n                body: JSON.stringify({ error: 'Missing required fields: firstName, lastName, score' }),\r\n              };\r\n            }\r\n\r\n            // Validate character\r\n            if (!['boy', 'girl'].includes(character)) {\r\n              return {\r\n                statusCode: 400,\r\n                headers: {\r\n                  'Content-Type': 'application/json',\r\n                  'Access-Control-Allow-Origin': '*',\r\n                },\r\n                body: JSON.stringify({ error: 'Invalid character. Must be \"boy\" or \"girl\"' }),\r\n              };\r\n            }\r\n\r\n            // Validate weapon\r\n            if (!['katana', 'laser', 'baseball', 'bazooka'].includes(weapon)) {\r\n              return {\r\n                statusCode: 400,\r\n                headers: {\r\n                  'Content-Type': 'application/json',\r\n                  'Access-Control-Allow-Origin': '*',\r\n                },\r\n                body: JSON.stringify({ error: 'Invalid weapon' }),\r\n              };\r\n            }\r\n\r\n            // Validate difficulty\r\n            if (!['easy', 'medium', 'impossible'].includes(difficulty)) {\r\n              return {\r\n                statusCode: 400,\r\n                headers: {\r\n                  'Content-Type': 'application/json',\r\n                  'Access-Control-Allow-Origin': '*',\r\n                },\r\n                body: JSON.stringify({ error: 'Invalid difficulty' }),\r\n              };\r\n            }\r\n\r\n            // Validate score range\r\n            if (score < 0 || score > 999999) {\r\n              return {\r\n                statusCode: 400,\r\n                headers: {\r\n                  'Content-Type': 'application/json',\r\n                  'Access-Control-Allow-Origin': '*',\r\n                },\r\n                body: JSON.stringify({ error: 'Score must be between 0 and 999999' }),\r\n              };\r\n            }\r\n\r\n            const scoreId = randomUUID();\r\n            const createdAt = new Date().toISOString();\r\n            \r\n            const scoreItem = {\r\n              scoreId,\r\n              gameType: 'caminho-assombrado',\r\n              firstName: firstName.trim(),\r\n              lastName: lastName.trim(),\r\n              score,\r\n              character,\r\n              weapon,\r\n              difficulty,\r\n              createdAt\r\n            };\r\n\r\n            const params = {\r\n              TableName: process.env.SCORES_TABLE_NAME,\r\n              Item: scoreItem\r\n            };\r\n\r\n            await docClient.send(new PutCommand(params));\r\n\r\n            return {\r\n              statusCode: 201,\r\n              headers: {\r\n                'Content-Type': 'application/json',\r\n                'Access-Control-Allow-Origin': '*',\r\n                'Access-Control-Allow-Methods': 'GET, POST, OPTIONS',\r\n                'Access-Control-Allow-Headers': 'Content-Type, Authorization',\r\n              },\r\n              body: JSON.stringify(scoreItem),\r\n            };\r\n          } catch (error) {\r\n            console.error('Error submitting score:', error);\r\n            return {\r\n              statusCode: 500,\r\n              headers: {\r\n                'Content-Type': 'application/json',\r\n                'Access-Control-Allow-Origin': '*',\r\n              },\r\n              body: JSON.stringify({ error: 'Internal server error' }),\r\n            };\r\n          }\r\n        };\r\n      `),\r\n      environment: {\r\n        SCORES_TABLE_NAME: scoresTable.tableName,\r\n      },\r\n      timeout: cdk.Duration.seconds(15),\r\n    });\r\n\r\n    // Grant DynamoDB permissions to Lambda functions\r\n    scoresTable.grantReadData(getTop10Function);\r\n    scoresTable.grantReadData(getAllScoresFunction);\r\n    scoresTable.grantWriteData(submitScoreFunction);\r\n\r\n    // API Gateway\r\n    const api = new apigateway.RestApi(this, 'GameLeaderboardApi', {\r\n      restApiName: 'Caminho Assombrado Leaderboard API',\r\n      description: 'API for managing game scores and leaderboard',\r\n      defaultCorsPreflightOptions: {\r\n        allowOrigins: apigateway.Cors.ALL_ORIGINS,\r\n        allowMethods: apigateway.Cors.ALL_METHODS,\r\n        allowHeaders: ['Content-Type', 'Authorization'],\r\n      },\r\n    });\r\n\r\n    // API Gateway integrations\r\n    const getTop10Integration = new apigateway.LambdaIntegration(getTop10Function);\r\n    const getAllScoresIntegration = new apigateway.LambdaIntegration(getAllScoresFunction);\r\n    const submitScoreIntegration = new apigateway.LambdaIntegration(submitScoreFunction);\r\n\r\n    // API routes\r\n    const scoresResource = api.root.addResource('scores');\r\n    \r\n    // GET /scores - Get all scores with pagination\r\n    scoresResource.addMethod('GET', getAllScoresIntegration);\r\n    \r\n    // POST /scores - Submit new score\r\n    scoresResource.addMethod('POST', submitScoreIntegration);\r\n    \r\n    // GET /scores/top10 - Get top 10 scores\r\n    const top10Resource = scoresResource.addResource('top10');\r\n    top10Resource.addMethod('GET', getTop10Integration);\r\n\r\n    // Output the API Gateway URL\r\n    new cdk.CfnOutput(this, 'ApiGatewayUrl', {\r\n      value: api.url,\r\n      description: 'API Gateway URL for the leaderboard system',\r\n      exportName: 'CaminhoAssombradoApiUrl',\r\n    });\r\n\r\n    // Output the DynamoDB table name\r\n    new cdk.CfnOutput(this, 'ScoresTableName', {\r\n      value: scoresTable.tableName,\r\n      description: 'DynamoDB table name for scores',\r\n      exportName: 'CaminhoAssombradoScoresTable',\r\n    });\r\n  }\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\next.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\parse_lint.js","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":2,"column":12,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":2,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'path' is assigned a value but never used.","line":3,"column":7,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":11},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":3,"column":14,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":3,"endColumn":29}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nconst fs = require('fs');\r\nconst path = require('path');\r\n\r\ntry {\r\n  const content = fs.readFileSync('components_lint.json', 'utf16le'); // Try utf16le first\r\n  const results = JSON.parse(content);\r\n  \r\n  results.forEach(result => {\r\n    if (result.errorCount > 0 || result.warningCount > 0) {\r\n      console.log(`File: ${result.filePath}`);\r\n      result.messages.forEach(msg => {\r\n        console.log(`  [${msg.ruleId}] Line ${msg.line}: ${msg.message}`);\r\n      });\r\n    }\r\n  });\r\n} catch (e) {\r\n  console.error(\"Error parsing JSON:\", e);\r\n  // Try reading as utf8 if utf16le fails or if it was actually utf8\r\n  try {\r\n      const content = fs.readFileSync('components_lint.json', 'utf8');\r\n      const results = JSON.parse(content);\r\n      results.forEach(result => {\r\n        if (result.errorCount > 0 || result.warningCount > 0) {\r\n          console.log(`File: ${result.filePath}`);\r\n          result.messages.forEach(msg => {\r\n            console.log(`  [${msg.ruleId}] Line ${msg.line}: ${msg.message}`);\r\n          });\r\n        }\r\n      });\r\n  } catch (e2) {\r\n      console.error(\"Error parsing JSON as utf8:\", e2);\r\n  }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\postcss.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\__tests__\\analytics.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\app\\api\\analytics\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\app\\api\\health\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\app\\api\\scores\\[scoreId]\\share\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\app\\api\\scores\\leaderboard\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\app\\api\\scores\\player-stats\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\app\\api\\scores\\route.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":70,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":70,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextRequest, NextResponse } from 'next/server';\r\nimport { AllScoresResponse, SubmitScoreRequest, Score } from '@/types';\r\nimport { fetchWithRetry, validateAwsConfig, handleAwsError } from '@/lib/aws-api';\r\n\r\n// GET /api/scores - Get all scores with pagination\r\nexport async function GET(request: NextRequest) {\r\n  try {\r\n    const baseUrl = validateAwsConfig();\r\n    const { searchParams } = new URL(request.url);\r\n    const nextToken = searchParams.get('nextToken');\r\n    \r\n    // Build AWS API URL with query parameters\r\n    const awsUrl = new URL(`${baseUrl}/scores`);\r\n    if (nextToken) {\r\n      awsUrl.searchParams.set('nextToken', nextToken);\r\n    }\r\n\r\n    // Make request to AWS Lambda function via API Gateway with retry logic\r\n    const response = await fetchWithRetry(\r\n      awsUrl.toString(),\r\n      {\r\n        method: 'GET',\r\n        signal: AbortSignal.timeout(15000), // 15 second timeout for pagination\r\n      },\r\n      {\r\n        maxRetries: 3, // More retries for pagination as it's less time-sensitive\r\n        baseDelay: 1000,\r\n      }\r\n    );\r\n\r\n    if (!response.ok) {\r\n      console.error(`AWS API returned ${response.status}: ${response.statusText}`);\r\n      return handleAwsError({ status: response.status, statusText: response.statusText });\r\n    }\r\n\r\n    const data: AllScoresResponse = await response.json();\r\n    \r\n    // Validate response structure\r\n    if (!data.scores || !Array.isArray(data.scores)) {\r\n      console.error('Invalid response structure from AWS API');\r\n      return NextResponse.json(\r\n        { error: 'Invalid response from server' },\r\n        { status: 500 }\r\n      );\r\n    }\r\n\r\n    // Validate pagination fields\r\n    if (typeof data.hasMore !== 'boolean') {\r\n      console.error('Invalid hasMore field in AWS API response');\r\n      return NextResponse.json(\r\n        { error: 'Invalid response from server' },\r\n        { status: 500 }\r\n      );\r\n    }\r\n\r\n    return NextResponse.json(data);\r\n  } catch (error) {\r\n    return handleAwsError(error);\r\n  }\r\n}\r\n\r\n// POST /api/scores - Submit a new score\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const baseUrl = validateAwsConfig();\r\n\r\n    let body: SubmitScoreRequest;\r\n    try {\r\n      body = await request.json();\r\n    } catch (error) {\r\n      return NextResponse.json(\r\n        { error: 'Invalid JSON in request body' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n    \r\n    // Client-side validation before sending to AWS\r\n    if (!body.firstName || !body.lastName || typeof body.score !== 'number') {\r\n      return NextResponse.json(\r\n        { error: 'Missing required fields: firstName, lastName, score' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n    \r\n    if (!body.character || !['boy', 'girl'].includes(body.character)) {\r\n      return NextResponse.json(\r\n        { error: 'Invalid character. Must be \"boy\" or \"girl\"' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n    \r\n    if (!body.weapon || !['katana', 'laser', 'baseball', 'bazooka'].includes(body.weapon)) {\r\n      return NextResponse.json(\r\n        { error: 'Invalid weapon. Must be one of: katana, laser, baseball, bazooka' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n    \r\n    if (!body.difficulty || !['easy', 'medium', 'impossible'].includes(body.difficulty)) {\r\n      return NextResponse.json(\r\n        { error: 'Invalid difficulty. Must be one of: easy, medium, impossible' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n    \r\n    if (body.score < 0 || body.score > 999999) {\r\n      return NextResponse.json(\r\n        { error: 'Score must be between 0 and 999999' },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    // Sanitize input data\r\n    const sanitizedBody: SubmitScoreRequest = {\r\n      firstName: body.firstName.trim(),\r\n      lastName: body.lastName.trim(),\r\n      score: body.score,\r\n      character: body.character,\r\n      weapon: body.weapon,\r\n      difficulty: body.difficulty\r\n    };\r\n\r\n    // Make request to AWS Lambda function via API Gateway with retry logic\r\n    const response = await fetchWithRetry(\r\n      `${baseUrl}/scores`,\r\n      {\r\n        method: 'POST',\r\n        body: JSON.stringify(sanitizedBody),\r\n        signal: AbortSignal.timeout(15000), // 15 second timeout for POST\r\n      },\r\n      {\r\n        maxRetries: 2, // Fewer retries for POST to avoid duplicate submissions\r\n        baseDelay: 1000,\r\n      }\r\n    );\r\n\r\n    if (!response.ok) {\r\n      console.error(`AWS API returned ${response.status}: ${response.statusText}`);\r\n      \r\n      // Handle specific AWS error responses\r\n      if (response.status === 400) {\r\n        try {\r\n          const errorData = await response.json();\r\n          return NextResponse.json(\r\n            { error: errorData.error || 'Invalid request data' },\r\n            { status: 400 }\r\n          );\r\n        } catch {\r\n          return NextResponse.json(\r\n            { error: 'Invalid request data' },\r\n            { status: 400 }\r\n          );\r\n        }\r\n      }\r\n      \r\n      return handleAwsError({ status: response.status, statusText: response.statusText });\r\n    }\r\n\r\n    const newScore: Score = await response.json();\r\n    \r\n    // Validate response structure\r\n    if (!newScore.scoreId || !newScore.firstName || !newScore.lastName || typeof newScore.score !== 'number') {\r\n      console.error('Invalid response structure from AWS API');\r\n      return NextResponse.json(\r\n        { error: 'Invalid response from server' },\r\n        { status: 500 }\r\n      );\r\n    }\r\n\r\n    return NextResponse.json(newScore, { status: 201 });\r\n  } catch (error) {\r\n    return handleAwsError(error);\r\n  }\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\app\\api\\scores\\top10\\route.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\app\\arma\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\app\\configuracoes\\page.tsx","messages":[{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":63,"column":29,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[2707,2830],"text":"\r\n              Ative a opo &quot;Mostrar Prvia da Dificuldade\" nas configuraes de jogo para ver os detalhes.\r\n            "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[2707,2830],"text":"\r\n              Ative a opo &ldquo;Mostrar Prvia da Dificuldade\" nas configuraes de jogo para ver os detalhes.\r\n            "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[2707,2830],"text":"\r\n              Ative a opo &#34;Mostrar Prvia da Dificuldade\" nas configuraes de jogo para ver os detalhes.\r\n            "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[2707,2830],"text":"\r\n              Ative a opo &rdquo;Mostrar Prvia da Dificuldade\" nas configuraes de jogo para ver os detalhes.\r\n            "},"desc":"Replace with `&rdquo;`."}]},{"ruleId":"react/no-unescaped-entities","severity":2,"message":"`\"` can be escaped with `&quot;`, `&ldquo;`, `&#34;`, `&rdquo;`.","line":63,"column":59,"nodeType":"JSXText","messageId":"unescapedEntityAlts","suggestions":[{"messageId":"replaceWithAlt","data":{"alt":"&quot;"},"fix":{"range":[2707,2830],"text":"\r\n              Ative a opo \"Mostrar Prvia da Dificuldade&quot; nas configuraes de jogo para ver os detalhes.\r\n            "},"desc":"Replace with `&quot;`."},{"messageId":"replaceWithAlt","data":{"alt":"&ldquo;"},"fix":{"range":[2707,2830],"text":"\r\n              Ative a opo \"Mostrar Prvia da Dificuldade&ldquo; nas configuraes de jogo para ver os detalhes.\r\n            "},"desc":"Replace with `&ldquo;`."},{"messageId":"replaceWithAlt","data":{"alt":"&#34;"},"fix":{"range":[2707,2830],"text":"\r\n              Ative a opo \"Mostrar Prvia da Dificuldade&#34; nas configuraes de jogo para ver os detalhes.\r\n            "},"desc":"Replace with `&#34;`."},{"messageId":"replaceWithAlt","data":{"alt":"&rdquo;"},"fix":{"range":[2707,2830],"text":"\r\n              Ative a opo \"Mostrar Prvia da Dificuldade&rdquo; nas configuraes de jogo para ver os detalhes.\r\n            "},"desc":"Replace with `&rdquo;`."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { AudioControls } from '../../components/ui/AudioControls';\r\nimport { ControlCustomization } from '../../components/ui/ControlCustomization';\r\nimport { DisplaySettings } from '../../components/ui/DisplaySettings';\r\nimport { AccessibilitySettings } from '../../components/ui/AccessibilitySettings';\r\nimport { GameSettings } from '../../components/ui/GameSettings';\r\nimport { DifficultyPreview } from '../../components/ui/DifficultyPreview';\r\nimport { SettingsImportExport } from '../../components/ui/SettingsImportExport';\r\nimport { ArrowLeft, Settings, Volume2, Keyboard, Monitor, Eye, Gamepad2, Target, FileText } from 'lucide-react';\r\nimport { useAudioStore } from '../../store/audioStore';\r\nimport { useSettingsStore } from '../../store/settingsStore';\r\n\r\ntype SettingsTab = 'audio' | 'controls' | 'display' | 'accessibility' | 'game' | 'difficulty' | 'import-export';\r\n\r\nexport default function ConfiguracoesPage() {\r\n  const router = useRouter();\r\n  const { applySettings } = useAudioStore();\r\n  const { game } = useSettingsStore();\r\n  const [activeTab, setActiveTab] = useState<SettingsTab>('audio');\r\n\r\n  // Apply audio settings when component mounts\r\n  useEffect(() => {\r\n    applySettings();\r\n  }, [applySettings]);\r\n\r\n  const handleGoBack = () => {\r\n    router.back();\r\n  };\r\n\r\n  const tabs = [\r\n    { id: 'audio' as const, label: 'udio', icon: Volume2 },\r\n    { id: 'controls' as const, label: 'Controlos', icon: Keyboard },\r\n    { id: 'display' as const, label: 'Exibio', icon: Monitor },\r\n    { id: 'accessibility' as const, label: 'Acessibilidade', icon: Eye },\r\n    { id: 'game' as const, label: 'Jogo', icon: Gamepad2 },\r\n    { id: 'difficulty' as const, label: 'Dificuldade', icon: Target },\r\n    { id: 'import-export' as const, label: 'Gesto', icon: FileText }\r\n  ];\r\n\r\n  const renderTabContent = () => {\r\n    switch (activeTab) {\r\n      case 'audio':\r\n        return <AudioControls />;\r\n      case 'controls':\r\n        return <ControlCustomization />;\r\n      case 'display':\r\n        return <DisplaySettings />;\r\n      case 'accessibility':\r\n        return <AccessibilitySettings />;\r\n      case 'game':\r\n        return <GameSettings />;\r\n      case 'difficulty':\r\n        return game.showDifficultyPreview ? (\r\n          <DifficultyPreview />\r\n        ) : (\r\n          <div className=\"bg-gray-800/50 rounded-lg p-6 text-center\">\r\n            <Target className=\"w-12 h-12 mx-auto mb-4 text-gray-400\" />\r\n            <h3 className=\"text-lg font-medium text-white mb-2\">Prvia da Dificuldade Desativada</h3>\r\n            <p className=\"text-gray-400 text-sm mb-4\">\r\n              Ative a opo \"Mostrar Prvia da Dificuldade\" nas configuraes de jogo para ver os detalhes.\r\n            </p>\r\n            <button\r\n              onClick={() => setActiveTab('game')}\r\n              className=\"px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors\"\r\n            >\r\n              Ir para Configuraes de Jogo\r\n            </button>\r\n          </div>\r\n        );\r\n      case 'import-export':\r\n        return <SettingsImportExport />;\r\n      default:\r\n        return <AudioControls />;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-b from-purple-900 via-blue-900 to-black\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between p-4 md:p-6 border-b border-gray-700/50\">\r\n        <button\r\n          onClick={handleGoBack}\r\n          className=\"flex items-center gap-2 px-4 py-2 bg-gray-800 hover:bg-gray-700 focus:bg-gray-700 text-white rounded-lg transition-colors focus:outline-none focus:ring-4 focus:ring-gray-500/50\"\r\n          aria-label=\"Voltar  pgina anterior\"\r\n        >\r\n          <ArrowLeft className=\"w-5 h-5\" />\r\n          <span className=\"hidden sm:inline\">Voltar</span>\r\n        </button>\r\n        \r\n        <div className=\"flex items-center gap-2\">\r\n          <Settings className=\"w-6 h-6 text-orange-400\" />\r\n          <h1 className=\"text-xl md:text-2xl font-bold text-white\">Configuraes</h1>\r\n        </div>\r\n        \r\n        <div className=\"w-20\"></div> {/* Spacer for centering */}\r\n      </div>\r\n\r\n      <div className=\"flex flex-col lg:flex-row min-h-0 flex-1\">\r\n        {/* Sidebar Navigation */}\r\n        <div className=\"lg:w-64 bg-black/30 border-r border-gray-700/50\">\r\n          <div className=\"p-4\">\r\n            <nav className=\"space-y-2\" role=\"tablist\" aria-label=\"Configuraes\">\r\n              {tabs.map((tab) => {\r\n                const Icon = tab.icon;\r\n                return (\r\n                  <button\r\n                    key={tab.id}\r\n                    onClick={() => setActiveTab(tab.id)}\r\n                    className={`w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-colors text-left focus:outline-none focus:ring-4 focus:ring-orange-500/50 ${\r\n                      activeTab === tab.id\r\n                        ? 'bg-orange-600 text-white'\r\n                        : 'text-gray-300 hover:bg-gray-800 focus:bg-gray-800 hover:text-white focus:text-white'\r\n                    }`}\r\n                    role=\"tab\"\r\n                    aria-selected={activeTab === tab.id}\r\n                    aria-controls={`${tab.id}-panel`}\r\n                  >\r\n                    <Icon className=\"w-5 h-5\" />\r\n                    <span className=\"font-medium\">{tab.label}</span>\r\n                  </button>\r\n                );\r\n              })}\r\n            </nav>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Main Content */}\r\n        <div className=\"flex-1 overflow-auto\">\r\n          <div className=\"p-4 md:p-6\">\r\n            <div className=\"max-w-4xl mx-auto\">\r\n              <div \r\n                className=\"bg-black/50 backdrop-blur-sm rounded-xl p-6 border border-orange-500/20\"\r\n                role=\"tabpanel\"\r\n                id={`${activeTab}-panel`}\r\n                aria-labelledby={`${activeTab}-tab`}\r\n              >\r\n                {renderTabContent()}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Footer */}\r\n      <div className=\"p-4 text-center border-t border-gray-700/50\">\r\n        <p className=\"text-sm text-gray-400\">\r\n          O Caminho Assombrado da Escola - Configuraes Avanadas\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\app\\conquistas\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\app\\dificuldade\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\app\\estatisticas\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\app\\final\\page.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'autoSubmitScore', 'character', 'difficulty', 'scoreSubmitted', and 'weapon'. Either include them or remove the dependency array.","line":41,"column":6,"nodeType":"ArrayExpression","endLine":41,"endColumn":35,"suggestions":[{"desc":"Update the dependencies array to be: [autoSubmitScore, character, difficulty, firstName, lastName, router, scoreSubmitted, weapon]","fix":{"range":[1598,1627],"text":"[autoSubmitScore, character, difficulty, firstName, lastName, router, scoreSubmitted, weapon]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState, Suspense } from 'react';\r\nimport { useRouter, useSearchParams } from 'next/navigation';\r\nimport { useGameStore } from '@/store/gameStore';\r\nimport { apiClient } from '@/lib/api';\r\nimport { Score } from '@/types';\r\nimport ShareButton from '@/components/ui/ShareButton';\r\n\r\nfunction FinalPageContent() {\r\n  const router = useRouter();\r\n  const searchParams = useSearchParams();\r\n  const { firstName, lastName, score, character, weapon, difficulty, resetGame } = useGameStore();\r\n  \r\n  // Get game result from URL parameters\r\n  const victory = searchParams.get('victory') === 'true';\r\n  const finalScore = parseInt(searchParams.get('score') || score.toString());\r\n  \r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [submitError, setSubmitError] = useState<string | null>(null);\r\n  const [scoreSubmitted, setScoreSubmitted] = useState(false);\r\n  const [allScores, setAllScores] = useState<Score[]>([]);\r\n  const [loadingScores, setLoadingScores] = useState(true);\r\n  const [nextToken, setNextToken] = useState<string | undefined>();\r\n  const [hasMoreScores, setHasMoreScores] = useState(false);\r\n\r\n  // Validate that user came from a completed game and auto-submit score\r\n  useEffect(() => {\r\n    if (!firstName || !lastName) {\r\n      router.push('/');\r\n      return;\r\n    }\r\n    \r\n    // Auto-submit score when page loads\r\n    if (!scoreSubmitted && character && weapon && difficulty) {\r\n      autoSubmitScore();\r\n    } else {\r\n      // Load initial leaderboard scores if score already submitted\r\n      loadAllScores();\r\n    }\r\n  }, [firstName, lastName, router]);\r\n\r\n  // Auto-submit score function\r\n  const autoSubmitScore = async () => {\r\n    if (isSubmitting || scoreSubmitted || !character || !weapon || !difficulty) return;\r\n    \r\n    setIsSubmitting(true);\r\n    setSubmitError(null);\r\n    \r\n    try {\r\n      const scoreData = {\r\n        firstName,\r\n        lastName,\r\n        score: finalScore,\r\n        character,\r\n        weapon,\r\n        difficulty\r\n      };\r\n      \r\n      console.log('Auto-submitting score:', scoreData);\r\n      await apiClient.submitScore(scoreData);\r\n      setScoreSubmitted(true);\r\n      \r\n      // Load leaderboard to show the new score\r\n      await loadAllScores();\r\n      \r\n    } catch (error) {\r\n      console.error('Failed to auto-submit score:', error);\r\n      setSubmitError('Falha ao enviar pontuao automaticamente.');\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const loadAllScores = async (token?: string) => {\r\n    try {\r\n      setLoadingScores(true);\r\n      const response = await apiClient.getAllScores(token);\r\n      \r\n      if (token) {\r\n        // Append to existing scores for pagination\r\n        setAllScores(prev => [...prev, ...response.scores]);\r\n      } else {\r\n        // Replace scores for initial load\r\n        setAllScores(response.scores);\r\n      }\r\n      \r\n      setNextToken(response.nextToken);\r\n      setHasMoreScores(response.hasMore);\r\n    } catch (error) {\r\n      console.error('Failed to load scores:', error);\r\n      setSubmitError('Falha ao carregar leaderboard.');\r\n    } finally {\r\n      setLoadingScores(false);\r\n    }\r\n  };\r\n\r\n  const loadMoreScores = () => {\r\n    if (nextToken && hasMoreScores && !loadingScores) {\r\n      loadAllScores(nextToken);\r\n    }\r\n  };\r\n\r\n  const handleReturnHome = () => {\r\n    // Reset game state and return to home page\r\n    resetGame();\r\n    router.push('/');\r\n  };\r\n\r\n  const handleSubmitScore = async () => {\r\n    // This is now just a wrapper for manual retry if auto-submit failed\r\n    await autoSubmitScore();\r\n  };\r\n\r\n  if (!firstName || !lastName) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-b from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center p-2 sm:p-4\">\r\n      <div className=\"bg-black/30 backdrop-blur-sm rounded-2xl p-4 sm:p-6 lg:p-8 max-w-sm sm:max-w-md lg:max-w-lg w-full text-center text-white\">\r\n        {/* Game Result Header */}\r\n        <div className=\"mb-8\">\r\n          {victory ? (\r\n            <>\r\n              <div className=\"text-6xl mb-4\"></div>\r\n              <h1 className=\"text-3xl font-bold text-green-400 mb-2\">Vitria!</h1>\r\n              <p className=\"text-lg text-gray-300\">\r\n                Chegaste  escola em segurana!\r\n              </p>\r\n            </>\r\n          ) : (\r\n            <>\r\n              <div className=\"text-6xl mb-4\"></div>\r\n              <h1 className=\"text-3xl font-bold text-red-400 mb-2\">Game Over</h1>\r\n              <p className=\"text-lg text-gray-300\">\r\n                No conseguiste chegar  escola...\r\n              </p>\r\n            </>\r\n          )}\r\n        </div>\r\n\r\n        {/* Player Info and Score */}\r\n        <div className=\"bg-black/20 rounded-lg p-6 mb-8\">\r\n          <h2 className=\"text-xl font-semibold mb-4\">Resultado Final</h2>\r\n          <div className=\"space-y-2 text-left\">\r\n            <div className=\"flex justify-between\">\r\n              <span className=\"text-gray-300\">Jogador:</span>\r\n              <span className=\"font-semibold\">{firstName} {lastName}</span>\r\n            </div>\r\n            <div className=\"flex justify-between\">\r\n              <span className=\"text-gray-300\">Pontuao:</span>\r\n              <span className=\"font-bold text-yellow-400 text-xl\">{finalScore}</span>\r\n            </div>\r\n            {victory && (\r\n              <div className=\"flex justify-between text-green-400\">\r\n                <span>Bnus de Vitria:</span>\r\n                <span className=\"font-semibold\">+500</span>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Score Submission Status */}\r\n        <div className=\"space-y-4\">\r\n          {isSubmitting && (\r\n            <div className=\"bg-blue-600/20 border border-blue-600/30 rounded-lg p-3 text-blue-400 text-center\">\r\n              <div className=\"flex items-center justify-center\">\r\n                <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-400 mr-2\"></div>\r\n                Enviando pontuao automaticamente...\r\n              </div>\r\n            </div>\r\n          )}\r\n          \r\n          {scoreSubmitted && (\r\n            <div className=\"bg-green-600/20 border border-green-600/30 rounded-lg p-3 text-green-400 text-center\">\r\n               Pontuao enviada com sucesso!\r\n            </div>\r\n          )}\r\n          \r\n          {submitError && (\r\n            <div className=\"space-y-3\">\r\n              <div className=\"bg-red-600/20 border border-red-600/30 rounded-lg p-3 text-red-400 text-center\">\r\n                 {submitError}\r\n              </div>\r\n              <button\r\n                onClick={handleSubmitScore}\r\n                disabled={isSubmitting}\r\n                className=\"w-full bg-red-600 hover:bg-red-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white font-semibold py-3 px-6 rounded-lg transition-colors\"\r\n              >\r\n                {isSubmitting ? (\r\n                  <div className=\"flex items-center justify-center\">\r\n                    <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2\"></div>\r\n                    Tentando novamente...\r\n                  </div>\r\n                ) : (\r\n                  'Tentar Enviar Novamente'\r\n                )}\r\n              </button>\r\n            </div>\r\n          )}\r\n          \r\n          <button\r\n            onClick={handleReturnHome}\r\n            className=\"w-full bg-gray-600 hover:bg-gray-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors\"\r\n          >\r\n            Voltar ao Incio\r\n          </button>\r\n        </div>\r\n\r\n        {/* Leaderboard Display */}\r\n        <div className=\"mt-6 sm:mt-8\">\r\n          <h3 className=\"text-lg sm:text-xl font-semibold mb-4 text-center\">Leaderboard</h3>\r\n          \r\n          {loadingScores && allScores.length === 0 ? (\r\n            <div className=\"text-center text-gray-400\">\r\n              <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-white mx-auto mb-2\"></div>\r\n              Carregando pontuaes...\r\n            </div>\r\n          ) : allScores.length === 0 ? (\r\n            <div className=\"text-center text-gray-400\">\r\n              <p>Nenhuma pontuao encontrada.</p>\r\n            </div>\r\n          ) : (\r\n            <div className=\"bg-black/20 rounded-lg max-h-48 sm:max-h-64 lg:max-h-80 overflow-y-auto\">\r\n              <div className=\"space-y-2 p-2 sm:p-4\">\r\n                {allScores.map((scoreEntry, index) => (\r\n                  <div\r\n                    key={scoreEntry.scoreId}\r\n                    className={`flex justify-between items-center p-3 rounded-lg ${\r\n                      scoreEntry.firstName === firstName && \r\n                      scoreEntry.lastName === lastName && \r\n                      scoreEntry.score === finalScore\r\n                        ? 'bg-blue-600/30 border border-blue-600/50'\r\n                        : 'bg-black/20'\r\n                    }`}\r\n                  >\r\n                    <div className=\"flex items-center space-x-3\">\r\n                      <span className=\"text-gray-400 font-mono text-sm w-8\">\r\n                        #{index + 1}\r\n                      </span>\r\n                      <div>\r\n                        <p className=\"font-semibold\">\r\n                          {scoreEntry.firstName} {scoreEntry.lastName}\r\n                        </p>\r\n                        <p className=\"text-xs text-gray-400\">\r\n                          {scoreEntry.character === 'boy' ? '' : ''}  {scoreEntry.weapon}  {scoreEntry.difficulty}\r\n                        </p>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-3\">\r\n                      <div className=\"text-right\">\r\n                        <p className=\"font-bold text-yellow-400\">\r\n                          {scoreEntry.score.toLocaleString()}\r\n                        </p>\r\n                        <p className=\"text-xs text-gray-400\">\r\n                          {new Date(scoreEntry.createdAt).toLocaleDateString('pt-PT')}\r\n                        </p>\r\n                      </div>\r\n                      \r\n                      {scoreEntry.firstName === firstName && \r\n                       scoreEntry.lastName === lastName && \r\n                       scoreEntry.score === finalScore && (\r\n                        <ShareButton \r\n                          scoreId={scoreEntry.scoreId} \r\n                          size=\"sm\" \r\n                          variant=\"ghost\"\r\n                        />\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n              \r\n              {/* Load More Button */}\r\n              {hasMoreScores && (\r\n                <div className=\"p-4 border-t border-gray-600\">\r\n                  <button\r\n                    onClick={loadMoreScores}\r\n                    disabled={loadingScores}\r\n                    className=\"w-full bg-gray-700 hover:bg-gray-600 disabled:bg-gray-800 text-white py-2 px-4 rounded-lg transition-colors text-sm\"\r\n                  >\r\n                    {loadingScores ? (\r\n                      <div className=\"flex items-center justify-center\">\r\n                        <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\r\n                        Carregando...\r\n                      </div>\r\n                    ) : (\r\n                      'Carregar Mais'\r\n                    )}\r\n                  </button>\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n      \r\n      {/* Footer */}\r\n      <footer className=\"absolute bottom-4 left-0 right-0 text-center text-gray-400\">\r\n        <p> 2025 - O Caminho Assombrado da Escola - Feito com  pela Sofia para o Halloween</p>\r\n      </footer>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function FinalPage() {\r\n  return (\r\n    <Suspense fallback={\r\n      <div className=\"min-h-screen bg-gradient-to-b from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center\">\r\n        <div className=\"text-white text-center\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4\"></div>\r\n          <p>Carregando resultados...</p>\r\n        </div>\r\n      </div>\r\n    }>\r\n      <FinalPageContent />\r\n    </Suspense>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\app\\jogar\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'shouldOptimize' is assigned a value but never used.","line":14,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isInitialized' is assigned a value but never used.","line":14,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":40}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { useGameStore } from '@/store/gameStore';\r\nimport { ClientOnlyPhaserGame } from '@/components/game/ClientOnlyPhaserGame';\r\nimport { ResponsiveGameCanvas } from '@/components/game/ResponsiveGameCanvas';\r\nimport { PerformanceIndicator } from '@/components/game/PerformanceMonitor';\r\nimport { useMobileOptimization } from '@/hooks/useMobileOptimization';\r\n\r\nexport default function JogarPage() {\r\n  const router = useRouter();\r\n  const { firstName, lastName, character, weapon, difficulty, gameMode } = useGameStore();\r\n  const { shouldOptimize, isInitialized } = useMobileOptimization();\r\n\r\n  // Validate that user has completed all previous steps before accessing this page\r\n  useEffect(() => {\r\n    if (!firstName || !lastName) {\r\n      router.push('/nome');\r\n      return;\r\n    }\r\n    if (!character) {\r\n      router.push('/personagem');\r\n      return;\r\n    }\r\n    if (!weapon) {\r\n      router.push('/arma');\r\n      return;\r\n    }\r\n    if (!difficulty) {\r\n      router.push('/dificuldade');\r\n      return;\r\n    }\r\n    if (!gameMode) {\r\n      router.push('/modo');\r\n      return;\r\n    }\r\n  }, [firstName, lastName, character, weapon, difficulty, gameMode, router]);\r\n\r\n  // Don't render if validation fails\r\n  if (!firstName || !lastName || !character || !weapon || !difficulty || !gameMode) {\r\n    return null;\r\n  }\r\n\r\n  const handleGameEnd = (score: number, victory: boolean) => {\r\n    // Navigate to results page with final score and victory status\r\n    console.log('Game ended:', { score, victory });\r\n    router.push(`/final?score=${score}&victory=${victory}`);\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-b from-purple-900 via-blue-900 to-indigo-900\">\r\n      {/* Game Container */}\r\n      <div className=\"w-full h-screen\">\r\n        <ResponsiveGameCanvas>\r\n          <ClientOnlyPhaserGame \r\n            difficulty={difficulty}\r\n            gameMode={gameMode}\r\n            onGameEnd={handleGameEnd}\r\n            className=\"w-full h-full\"\r\n          />\r\n        </ResponsiveGameCanvas>\r\n      </div>\r\n      \r\n      {/* Performance Indicator */}\r\n      <PerformanceIndicator />\r\n      \r\n      {/* Debug Info - Remove in production */}\r\n      {process.env.NODE_ENV === 'development' && (\r\n        <div className=\"absolute top-4 left-4 bg-black/50 backdrop-blur-sm rounded-lg p-4 text-white text-sm\">\r\n          <h3 className=\"font-bold mb-2\">Player Config:</h3>\r\n          <div className=\"space-y-1\">\r\n            <p>Nome: {firstName} {lastName}</p>\r\n            <p>Personagem: {character === 'boy' ? 'Menino' : 'Menina'}</p>\r\n            <p>Arma: {weapon}</p>\r\n            <p>Dificuldade: {difficulty}</p>\r\n            <p>Modo: {gameMode}</p>\r\n          </div>\r\n          <button\r\n            onClick={() => router.push('/modo')}\r\n            className=\"mt-2 text-gray-400 hover:text-white transition-colors text-xs\"\r\n          >\r\n             Voltar\r\n          </button>\r\n        </div>\r\n      )}\r\n      \r\n      {/* Footer */}\r\n      <footer className=\"absolute bottom-2 left-0 right-0 text-center text-gray-400 text-xs z-10\">\r\n        <p> 2025 - O Caminho Assombrado da Escola - Feito com  pela Sofia para o Halloween</p>\r\n      </footer>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\app\\layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\app\\leaderboard\\page.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Score' is defined but never used.","line":6,"column":39,"nodeType":null,"messageId":"unusedVar","endLine":6,"endColumn":44},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchLeaderboard'. Either include it or remove the dependency array.","line":45,"column":6,"nodeType":"ArrayExpression","endLine":45,"endColumn":38,"suggestions":[{"desc":"Update the dependencies array to be: [difficultyFilter, fetchLeaderboard, periodFilter]","fix":{"range":[1516,1548],"text":"[difficultyFilter, fetchLeaderboard, periodFilter]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport Link from 'next/link';\r\nimport { apiClient } from '@/lib/api';\r\nimport { FilteredLeaderboardResponse, Score } from '@/types';\r\nimport ShareButton from '@/components/ui/ShareButton';\r\n\r\ntype DifficultyFilter = 'all' | 'easy' | 'medium' | 'impossible';\r\ntype PeriodFilter = 'all' | 'weekly' | 'monthly';\r\n\r\nexport default function LeaderboardPage() {\r\n  const [leaderboard, setLeaderboard] = useState<FilteredLeaderboardResponse>({\r\n    scores: [],\r\n    total: 0,\r\n    filters: {}\r\n  });\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  \r\n  // Filter states\r\n  const [difficultyFilter, setDifficultyFilter] = useState<DifficultyFilter>('all');\r\n  const [periodFilter, setPeriodFilter] = useState<PeriodFilter>('all');\r\n\r\n  const fetchLeaderboard = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      \r\n      const difficulty = difficultyFilter === 'all' ? undefined : difficultyFilter;\r\n      const period = periodFilter === 'all' ? undefined : periodFilter;\r\n      \r\n      const response = await apiClient.getFilteredLeaderboard(difficulty, period, 50);\r\n      setLeaderboard(response);\r\n    } catch (err) {\r\n      setError('Erro ao carregar o leaderboard. Tente novamente mais tarde.');\r\n      console.error('Failed to load leaderboard:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchLeaderboard();\r\n  }, [difficultyFilter, periodFilter]);\r\n\r\n  const getDifficultyEmoji = (difficulty: string) => {\r\n    switch (difficulty) {\r\n      case 'easy': return '';\r\n      case 'medium': return '';\r\n      case 'impossible': return '';\r\n      default: return '';\r\n    }\r\n  };\r\n\r\n  const getWeaponEmoji = (weapon: string) => {\r\n    switch (weapon) {\r\n      case 'katana': return '';\r\n      case 'laser': return '';\r\n      case 'baseball': return '';\r\n      case 'bazooka': return '';\r\n      default: return '';\r\n    }\r\n  };\r\n\r\n  const getPeriodLabel = (period: PeriodFilter) => {\r\n    switch (period) {\r\n      case 'weekly': return 'Esta Semana';\r\n      case 'monthly': return 'Este Ms';\r\n      default: return 'Todos os Tempos';\r\n    }\r\n  };\r\n\r\n\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-b from-purple-900 via-blue-900 to-indigo-900\">\r\n      <div className=\"absolute inset-0 bg-black/20\"></div>\r\n\r\n      <main className=\"relative z-10 container mx-auto px-4 py-8\">\r\n        {/* Header */}\r\n        <header className=\"text-center mb-8\">\r\n          <h1 className=\"text-4xl md:text-5xl font-bold text-orange-400 mb-4 drop-shadow-lg\">\r\n             Leaderboard Completo\r\n          </h1>\r\n          <p className=\"text-lg text-gray-200 max-w-2xl mx-auto mb-6\">\r\n            V todas as pontuaes e filtra por dificuldade e perodo\r\n          </p>\r\n          \r\n          <Link\r\n            href=\"/\"\r\n            className=\"inline-block px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white font-medium rounded-lg transition-all transform hover:scale-105\"\r\n          >\r\n             Voltar ao Incio\r\n          </Link>\r\n        </header>\r\n\r\n        {/* Filters */}\r\n        <div className=\"max-w-4xl mx-auto mb-8\">\r\n          <div className=\"bg-black/40 backdrop-blur-sm rounded-lg p-6 border border-orange-500/30\">\r\n            <h2 className=\"text-xl font-bold text-orange-400 mb-4\">Filtros</h2>\r\n            \r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n              {/* Difficulty Filter */}\r\n              <div>\r\n                <label className=\"block text-white font-medium mb-3\">Dificuldade</label>\r\n                <div className=\"grid grid-cols-2 gap-2\">\r\n                  {(['all', 'easy', 'medium', 'impossible'] as DifficultyFilter[]).map((difficulty) => (\r\n                    <button\r\n                      key={difficulty}\r\n                      onClick={() => setDifficultyFilter(difficulty)}\r\n                      className={`px-4 py-2 rounded-lg font-medium transition-all ${\r\n                        difficultyFilter === difficulty\r\n                          ? 'bg-orange-600 text-white'\r\n                          : 'bg-gray-700 hover:bg-gray-600 text-gray-300'\r\n                      }`}\r\n                    >\r\n                      {difficulty === 'all' ? ' Todas' : \r\n                       difficulty === 'easy' ? ' Fcil' :\r\n                       difficulty === 'medium' ? ' Mdio' : ' Impossvel'}\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Period Filter */}\r\n              <div>\r\n                <label className=\"block text-white font-medium mb-3\">Perodo</label>\r\n                <div className=\"grid grid-cols-1 gap-2\">\r\n                  {(['all', 'weekly', 'monthly'] as PeriodFilter[]).map((period) => (\r\n                    <button\r\n                      key={period}\r\n                      onClick={() => setPeriodFilter(period)}\r\n                      className={`px-4 py-2 rounded-lg font-medium transition-all ${\r\n                        periodFilter === period\r\n                          ? 'bg-orange-600 text-white'\r\n                          : 'bg-gray-700 hover:bg-gray-600 text-gray-300'\r\n                      }`}\r\n                    >\r\n                      {period === 'all' ? ' Todos os Tempos' :\r\n                       period === 'weekly' ? ' Esta Semana' : ' Este Ms'}\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Results Summary */}\r\n        <div className=\"max-w-4xl mx-auto mb-6\">\r\n          <div className=\"bg-black/30 backdrop-blur-sm rounded-lg p-4 border border-orange-500/20\">\r\n            <p className=\"text-center text-gray-300\">\r\n              Mostrando <span className=\"font-bold text-orange-400\">{leaderboard.scores.length}</span> de{' '}\r\n              <span className=\"font-bold text-orange-400\">{leaderboard.total}</span> pontuaes\r\n              {difficultyFilter !== 'all' && (\r\n                <span>  Dificuldade: <span className=\"font-bold\">{difficultyFilter}</span></span>\r\n              )}\r\n              {periodFilter !== 'all' && (\r\n                <span>  Perodo: <span className=\"font-bold\">{getPeriodLabel(periodFilter)}</span></span>\r\n              )}\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Leaderboard */}\r\n        <div className=\"max-w-4xl mx-auto\">\r\n          <div className=\"bg-black/40 backdrop-blur-sm rounded-lg border border-orange-500/30\">\r\n            {loading ? (\r\n              <div className=\"flex justify-center items-center py-12\">\r\n                <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-400\"></div>\r\n              </div>\r\n            ) : error ? (\r\n              <div className=\"text-center py-12\">\r\n                <p className=\"text-red-400 mb-4\">{error}</p>\r\n                <button\r\n                  onClick={fetchLeaderboard}\r\n                  className=\"px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-lg transition-colors\"\r\n                >\r\n                  Tentar Novamente\r\n                </button>\r\n              </div>\r\n            ) : leaderboard.scores.length === 0 ? (\r\n              <div className=\"text-center py-12\">\r\n                <p className=\"text-gray-300 text-lg mb-2\">\r\n                  Nenhuma pontuao encontrada para os filtros selecionados.\r\n                </p>\r\n                <p className=\"text-gray-400\">\r\n                  Tenta ajustar os filtros ou ser o primeiro a jogar!\r\n                </p>\r\n              </div>\r\n            ) : (\r\n              <div className=\"p-6\">\r\n                <div className=\"space-y-3\">\r\n                  {leaderboard.scores.map((score, index) => (\r\n                    <div\r\n                      key={score.scoreId}\r\n                      className={`flex items-center justify-between p-4 rounded-lg border transition-all hover:scale-105 ${\r\n                        index === 0\r\n                          ? 'bg-gradient-to-r from-yellow-600/20 to-orange-600/20 border-yellow-500/50'\r\n                          : index === 1\r\n                            ? 'bg-gradient-to-r from-gray-400/20 to-gray-600/20 border-gray-400/50'\r\n                            : index === 2\r\n                              ? 'bg-gradient-to-r from-orange-700/20 to-yellow-700/20 border-orange-700/50'\r\n                              : 'bg-gray-800/50 border-gray-600/30'\r\n                      }`}\r\n                    >\r\n                      <div className=\"flex items-center gap-4\">\r\n                        <span className={`text-2xl font-bold min-w-[3rem] text-center ${\r\n                          index === 0 ? 'text-yellow-400' :\r\n                          index === 1 ? 'text-gray-300' :\r\n                          index === 2 ? 'text-orange-600' :\r\n                          'text-gray-400'\r\n                        }`}>\r\n                          #{index + 1}\r\n                        </span>\r\n                        <div>\r\n                          <p className=\"text-white font-semibold text-lg\">\r\n                            {score.firstName} {score.lastName}\r\n                          </p>\r\n                          <div className=\"flex gap-3 text-sm text-gray-300\">\r\n                            <span>{score.character === 'boy' ? '' : ''}</span>\r\n                            <span>{getWeaponEmoji(score.weapon)} {score.weapon}</span>\r\n                            <span>{getDifficultyEmoji(score.difficulty)} {score.difficulty}</span>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                      \r\n                      <div className=\"flex items-center gap-4\">\r\n                        <div className=\"text-right\">\r\n                          <p className=\"text-2xl font-bold text-orange-400\">\r\n                            {score.score.toLocaleString()}\r\n                          </p>\r\n                          <p className=\"text-xs text-gray-400\">\r\n                            {new Date(score.createdAt).toLocaleDateString('pt-PT')}\r\n                          </p>\r\n                        </div>\r\n                        \r\n                        <ShareButton \r\n                          scoreId={score.scoreId} \r\n                          size=\"sm\" \r\n                          variant=\"primary\"\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Footer */}\r\n        <footer className=\"text-center mt-8 text-gray-400\">\r\n          <p> 2025 - O Caminho Assombrado da Escola - Feito com  pela Sofia para o Halloween</p>\r\n        </footer>\r\n      </main>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\app\\modo\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\app\\nome\\__tests__\\page.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\app\\nome\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\app\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\app\\personagem\\page.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\AccessibilityProvider.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'useEffect' is defined but never used.","line":3,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":26}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useEffect } from 'react';\r\nimport { useAccessibility } from '../hooks/useAccessibility';\r\n\r\ninterface AccessibilityProviderProps {\r\n  children: React.ReactNode;\r\n}\r\n\r\nexport const AccessibilityProvider: React.FC<AccessibilityProviderProps> = ({ children }) => {\r\n  useAccessibility();\r\n\r\n  return <>{children}</>;\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ClientOnlyZustandHydration.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\achievements\\AchievementDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\achievements\\AchievementNotification.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\achievements\\AchievementNotification.tsx:134:7\n  132 |     const newNotifications = notifications.filter(n => !n.shown);\n  133 |     if (newNotifications.length > 0) {\n> 134 |       setVisibleNotifications(prev => [...prev, ...newNotifications]);\n      |       ^^^^^^^^^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  135 |       \n  136 |       // Mark as shown\n  137 |       newNotifications.forEach(notification => {","line":134,"column":7,"nodeType":null,"endLine":134,"endColumn":30}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { useAchievementStore } from '../../store/achievementStore';\r\nimport { Achievement } from '../../types/achievements';\r\n\r\ninterface AchievementNotificationProps {\r\n  achievement: Achievement;\r\n  onClose: () => void;\r\n}\r\n\r\nconst AchievementNotification: React.FC<AchievementNotificationProps> = ({ \r\n  achievement, \r\n  onClose \r\n}) => {\r\n  const [isVisible, setIsVisible] = useState(false);\r\n  const [isLeaving, setIsLeaving] = useState(false);\r\n\r\n  useEffect(() => {\r\n    // Trigger entrance animation\r\n    const timer = setTimeout(() => setIsVisible(true), 100);\r\n    \r\n    // Auto-hide after 5 seconds\r\n    const hideTimer = setTimeout(() => {\r\n      setIsLeaving(true);\r\n      setTimeout(onClose, 300); // Wait for exit animation\r\n    }, 5000);\r\n\r\n    return () => {\r\n      clearTimeout(timer);\r\n      clearTimeout(hideTimer);\r\n    };\r\n  }, [onClose]);\r\n\r\n  const handleClose = () => {\r\n    setIsLeaving(true);\r\n    setTimeout(onClose, 300);\r\n  };\r\n\r\n  const getRarityColor = (rarity: string) => {\r\n    switch (rarity) {\r\n      case 'common': return 'from-gray-500 to-gray-600';\r\n      case 'rare': return 'from-blue-500 to-blue-600';\r\n      case 'epic': return 'from-purple-500 to-purple-600';\r\n      case 'legendary': return 'from-yellow-500 to-yellow-600';\r\n      default: return 'from-gray-500 to-gray-600';\r\n    }\r\n  };\r\n\r\n  const getRarityBorder = (rarity: string) => {\r\n    switch (rarity) {\r\n      case 'common': return 'border-gray-400';\r\n      case 'rare': return 'border-blue-400';\r\n      case 'epic': return 'border-purple-400';\r\n      case 'legendary': return 'border-yellow-400';\r\n      default: return 'border-gray-400';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={`\r\n        fixed top-4 right-4 z-50 max-w-sm w-full\r\n        transform transition-all duration-300 ease-out\r\n        ${isVisible && !isLeaving ? 'translate-x-0 opacity-100' : 'translate-x-full opacity-0'}\r\n      `}\r\n      role=\"alert\"\r\n      aria-live=\"assertive\"\r\n    >\r\n      <div className={`\r\n        bg-gradient-to-r ${getRarityColor(achievement.rarity)}\r\n        border-2 ${getRarityBorder(achievement.rarity)}\r\n        rounded-lg shadow-lg p-4 text-white\r\n        animate-pulse-glow\r\n      `}>\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between mb-2\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <span className=\"text-2xl\" role=\"img\" aria-label=\"Achievement icon\">\r\n              {achievement.icon}\r\n            </span>\r\n            <span className=\"text-xs font-semibold uppercase tracking-wide opacity-90\">\r\n              Conquista Desbloqueada\r\n            </span>\r\n          </div>\r\n          <button\r\n            onClick={handleClose}\r\n            className=\"text-white hover:text-gray-200 transition-colors\"\r\n            aria-label=\"Fechar notificao\"\r\n          >\r\n            <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n              <path fillRule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clipRule=\"evenodd\" />\r\n            </svg>\r\n          </button>\r\n        </div>\r\n\r\n        {/* Achievement Details */}\r\n        <div className=\"space-y-1\">\r\n          <h3 className=\"font-bold text-lg\">{achievement.name}</h3>\r\n          <p className=\"text-sm opacity-90\">{achievement.description}</p>\r\n          \r\n          {/* Points and Rarity */}\r\n          <div className=\"flex items-center justify-between pt-2\">\r\n            <span className=\"text-xs font-medium\">\r\n              +{achievement.points} pontos\r\n            </span>\r\n            <span className={`\r\n              text-xs px-2 py-1 rounded-full font-medium\r\n              ${achievement.rarity === 'legendary' ? 'bg-yellow-200 text-yellow-800' :\r\n                achievement.rarity === 'epic' ? 'bg-purple-200 text-purple-800' :\r\n                achievement.rarity === 'rare' ? 'bg-blue-200 text-blue-800' :\r\n                'bg-gray-200 text-gray-800'}\r\n            `}>\r\n              {achievement.rarity === 'legendary' ? 'Lendrio' :\r\n               achievement.rarity === 'epic' ? 'pico' :\r\n               achievement.rarity === 'rare' ? 'Raro' : 'Comum'}\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Container component to manage multiple notifications\r\nexport const AchievementNotificationContainer: React.FC = () => {\r\n  const { notifications, markNotificationShown } = useAchievementStore();\r\n  const [visibleNotifications, setVisibleNotifications] = useState<typeof notifications>([]);\r\n\r\n  useEffect(() => {\r\n    // Show new notifications\r\n    const newNotifications = notifications.filter(n => !n.shown);\r\n    if (newNotifications.length > 0) {\r\n      setVisibleNotifications(prev => [...prev, ...newNotifications]);\r\n      \r\n      // Mark as shown\r\n      newNotifications.forEach(notification => {\r\n        markNotificationShown(notification.achievement.id);\r\n      });\r\n    }\r\n  }, [notifications, markNotificationShown]);\r\n\r\n  const handleCloseNotification = (achievementId: string) => {\r\n    setVisibleNotifications(prev => \r\n      prev.filter(n => n.achievement.id !== achievementId)\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed top-0 right-0 z-50 p-4 space-y-2\">\r\n      {visibleNotifications.map((notification, index) => (\r\n        <div\r\n          key={notification.achievement.id}\r\n          style={{ \r\n            transform: `translateY(${index * 10}px)`,\r\n            zIndex: 50 - index \r\n          }}\r\n        >\r\n          <AchievementNotification\r\n            achievement={notification.achievement}\r\n            onClose={() => handleCloseNotification(notification.achievement.id)}\r\n          />\r\n        </div>\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AchievementNotification;","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\achievements\\AchievementRewards.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'useGameStore' is defined but never used.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":22},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\achievements\\AchievementRewards.tsx:89:5\n  87 |   useEffect(() => {\n  88 |     const unlockedRewards = JSON.parse(localStorage.getItem('unlockedRewards') || '[]');\n> 89 |     setRewards(prev => prev.map(reward => ({\n     |     ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  90 |       ...reward,\n  91 |       unlocked: unlockedRewards.includes(reward.id)\n  92 |     })));","line":89,"column":5,"nodeType":null,"endLine":89,"endColumn":15}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useAchievementStore } from '../../store/achievementStore';\r\nimport { useGameStore } from '../../store/gameStore';\r\n\r\ninterface RewardItem {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  icon: string;\r\n  cost: number; // Achievement points required\r\n  type: 'cosmetic' | 'gameplay' | 'special';\r\n  unlocked: boolean;\r\n}\r\n\r\n// Special rewards that can be unlocked with achievement points\r\nconst ACHIEVEMENT_REWARDS: RewardItem[] = [\r\n  {\r\n    id: 'golden_character',\r\n    name: 'Personagem Dourada',\r\n    description: 'Desbloqueie uma verso dourada especial da sua personagem',\r\n    icon: '',\r\n    cost: 500,\r\n    type: 'cosmetic',\r\n    unlocked: false\r\n  },\r\n  {\r\n    id: 'extra_life_start',\r\n    name: 'Vida Extra',\r\n    description: 'Comece cada jogo com +2 vidas extras (12 vidas totais)',\r\n    icon: '',\r\n    cost: 300,\r\n    type: 'gameplay',\r\n    unlocked: false\r\n  },\r\n  {\r\n    id: 'score_multiplier',\r\n    name: 'Multiplicador de Pontos',\r\n    description: 'Ganhe 1.5x mais pontos em todos os jogos',\r\n    icon: '',\r\n    cost: 750,\r\n    type: 'gameplay',\r\n    unlocked: false\r\n  },\r\n  {\r\n    id: 'rainbow_weapon_effects',\r\n    name: 'Efeitos Arco-ris',\r\n    description: 'Todas as armas ganham efeitos visuais coloridos especiais',\r\n    icon: '',\r\n    cost: 400,\r\n    type: 'cosmetic',\r\n    unlocked: false\r\n  },\r\n  {\r\n    id: 'achievement_hunter_title',\r\n    name: 'Ttulo: Caador de Conquistas',\r\n    description: 'Exiba um ttulo especial no leaderboard',\r\n    icon: '',\r\n    cost: 1000,\r\n    type: 'special',\r\n    unlocked: false\r\n  },\r\n  {\r\n    id: 'invincibility_potion',\r\n    name: 'Poo de Invencibilidade',\r\n    description: 'Use uma vez por jogo para ficar invencvel por 10 segundos',\r\n    icon: '',\r\n    cost: 600,\r\n    type: 'gameplay',\r\n    unlocked: false\r\n  }\r\n];\r\n\r\ninterface AchievementRewardsProps {\r\n  showOnlyAvailable?: boolean;\r\n}\r\n\r\nexport const AchievementRewards: React.FC<AchievementRewardsProps> = ({\r\n  showOnlyAvailable = false\r\n}) => {\r\n  const { stats } = useAchievementStore();\r\n  const [rewards, setRewards] = useState<RewardItem[]>(ACHIEVEMENT_REWARDS);\r\n  const [selectedReward, setSelectedReward] = useState<RewardItem | null>(null);\r\n\r\n  // Load unlocked rewards from localStorage\r\n  useEffect(() => {\r\n    const unlockedRewards = JSON.parse(localStorage.getItem('unlockedRewards') || '[]');\r\n    setRewards(prev => prev.map(reward => ({\r\n      ...reward,\r\n      unlocked: unlockedRewards.includes(reward.id)\r\n    })));\r\n  }, []);\r\n\r\n  const canAfford = (cost: number) => stats.totalPoints >= cost;\r\n\r\n  const unlockReward = (rewardId: string) => {\r\n    const reward = rewards.find(r => r.id === rewardId);\r\n    if (!reward || reward.unlocked || !canAfford(reward.cost)) return;\r\n\r\n    // Update local state\r\n    setRewards(prev => prev.map(r => \r\n      r.id === rewardId ? { ...r, unlocked: true } : r\r\n    ));\r\n\r\n    // Save to localStorage\r\n    const unlockedRewards = JSON.parse(localStorage.getItem('unlockedRewards') || '[]');\r\n    unlockedRewards.push(rewardId);\r\n    localStorage.setItem('unlockedRewards', JSON.stringify(unlockedRewards));\r\n\r\n    // Show success message\r\n    if (typeof window !== 'undefined') {\r\n      window.dispatchEvent(new CustomEvent('screenReaderAnnounce', {\r\n        detail: { \r\n          message: `Recompensa desbloqueada: ${reward.name}`,\r\n          priority: 'assertive'\r\n        }\r\n      }));\r\n    }\r\n\r\n    setSelectedReward(null);\r\n  };\r\n\r\n  const filteredRewards = showOnlyAvailable \r\n    ? rewards.filter(reward => canAfford(reward.cost) && !reward.unlocked)\r\n    : rewards;\r\n\r\n  const getTypeColor = (type: string) => {\r\n    switch (type) {\r\n      case 'cosmetic': return 'text-pink-600 bg-pink-100';\r\n      case 'gameplay': return 'text-green-600 bg-green-100';\r\n      case 'special': return 'text-purple-600 bg-purple-100';\r\n      default: return 'text-gray-600 bg-gray-100';\r\n    }\r\n  };\r\n\r\n  const getTypeName = (type: string) => {\r\n    switch (type) {\r\n      case 'cosmetic': return 'Cosmtico';\r\n      case 'gameplay': return 'Jogabilidade';\r\n      case 'special': return 'Especial';\r\n      default: return 'Outro';\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Points Display */}\r\n      <div className=\"bg-gradient-to-r from-yellow-400 to-orange-500 text-white p-6 rounded-lg shadow-lg\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div>\r\n            <h2 className=\"text-2xl font-bold mb-2\">Pontos de Conquista</h2>\r\n            <p className=\"text-yellow-100\">\r\n              Use seus pontos para desbloquear recompensas especiais!\r\n            </p>\r\n          </div>\r\n          <div className=\"text-right\">\r\n            <div className=\"text-4xl font-bold\">{stats.totalPoints}</div>\r\n            <div className=\"text-sm text-yellow-100\">pontos disponveis</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Rewards Grid */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n        {filteredRewards.map(reward => (\r\n          <div\r\n            key={reward.id}\r\n            className={`\r\n              relative p-6 rounded-lg border-2 transition-all duration-200 cursor-pointer\r\n              ${reward.unlocked \r\n                ? 'border-green-300 bg-green-50 shadow-md' \r\n                : canAfford(reward.cost)\r\n                  ? 'border-blue-300 bg-blue-50 hover:shadow-lg hover:scale-105'\r\n                  : 'border-gray-200 bg-gray-100 opacity-60'\r\n              }\r\n            `}\r\n            onClick={() => !reward.unlocked && setSelectedReward(reward)}\r\n          >\r\n            {/* Unlocked indicator */}\r\n            {reward.unlocked && (\r\n              <div className=\"absolute -top-2 -right-2 bg-green-500 text-white rounded-full p-2\">\r\n                <svg className=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n                  <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\r\n                </svg>\r\n              </div>\r\n            )}\r\n\r\n            {/* Header */}\r\n            <div className=\"flex items-start justify-between mb-4\">\r\n              <div className=\"flex items-center space-x-3\">\r\n                <span className=\"text-4xl\" role=\"img\" aria-label=\"Reward icon\">\r\n                  {reward.icon}\r\n                </span>\r\n                <div>\r\n                  <h3 className={`font-bold text-lg ${reward.unlocked ? 'text-green-800' : 'text-gray-900'}`}>\r\n                    {reward.name}\r\n                  </h3>\r\n                  <span className={`text-xs px-2 py-1 rounded-full font-medium ${getTypeColor(reward.type)}`}>\r\n                    {getTypeName(reward.type)}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Description */}\r\n            <p className={`text-sm mb-4 ${reward.unlocked ? 'text-green-700' : 'text-gray-700'}`}>\r\n              {reward.description}\r\n            </p>\r\n\r\n            {/* Cost and Status */}\r\n            <div className=\"flex items-center justify-between\">\r\n              <div className=\"flex items-center space-x-2\">\r\n                <span className=\"text-yellow-600 font-bold\">\r\n                  {reward.cost} pontos\r\n                </span>\r\n                {canAfford(reward.cost) && !reward.unlocked && (\r\n                  <span className=\"text-green-600 text-sm\"> Disponvel</span>\r\n                )}\r\n              </div>\r\n              \r\n              {reward.unlocked ? (\r\n                <span className=\"text-green-600 font-medium\">Desbloqueado</span>\r\n              ) : canAfford(reward.cost) ? (\r\n                <button\r\n                  onClick={(e) => {\r\n                    e.stopPropagation();\r\n                    unlockReward(reward.id);\r\n                  }}\r\n                  className=\"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-lg transition-colors\"\r\n                >\r\n                  Desbloquear\r\n                </button>\r\n              ) : (\r\n                <span className=\"text-gray-500 text-sm\">\r\n                  Faltam {reward.cost - stats.totalPoints} pontos\r\n                </span>\r\n              )}\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      {filteredRewards.length === 0 && (\r\n        <div className=\"text-center py-12\">\r\n          <div className=\"text-gray-400 text-6xl mb-4\"></div>\r\n          <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\r\n            {showOnlyAvailable ? 'Nenhuma recompensa disponvel' : 'Nenhuma recompensa encontrada'}\r\n          </h3>\r\n          <p className=\"text-gray-600\">\r\n            {showOnlyAvailable \r\n              ? 'Continue desbloqueando conquistas para ganhar mais pontos!'\r\n              : 'Complete conquistas para desbloquear recompensas especiais!'\r\n            }\r\n          </p>\r\n        </div>\r\n      )}\r\n\r\n      {/* Reward Details Modal */}\r\n      {selectedReward && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\r\n          <div className=\"bg-white rounded-lg p-6 max-w-md w-full\">\r\n            <div className=\"flex items-center space-x-3 mb-4\">\r\n              <span className=\"text-5xl\">{selectedReward.icon}</span>\r\n              <div>\r\n                <h3 className=\"text-xl font-bold text-gray-900\">{selectedReward.name}</h3>\r\n                <span className={`text-sm px-2 py-1 rounded-full font-medium ${getTypeColor(selectedReward.type)}`}>\r\n                  {getTypeName(selectedReward.type)}\r\n                </span>\r\n              </div>\r\n            </div>\r\n            \r\n            <p className=\"text-gray-700 mb-6\">{selectedReward.description}</p>\r\n            \r\n            <div className=\"flex items-center justify-between mb-6\">\r\n              <div className=\"text-lg\">\r\n                <span className=\"text-yellow-600 font-bold\">{selectedReward.cost} pontos</span>\r\n                <div className=\"text-sm text-gray-600\">\r\n                  Voc tem: {stats.totalPoints} pontos\r\n                </div>\r\n              </div>\r\n            </div>\r\n            \r\n            <div className=\"flex space-x-3\">\r\n              <button\r\n                onClick={() => setSelectedReward(null)}\r\n                className=\"flex-1 px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-800 font-medium rounded-lg transition-colors\"\r\n              >\r\n                Cancelar\r\n              </button>\r\n              {canAfford(selectedReward.cost) && (\r\n                <button\r\n                  onClick={() => unlockReward(selectedReward.id)}\r\n                  className=\"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition-colors\"\r\n                >\r\n                  Desbloquear\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AchievementRewards;","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\analytics\\AnalyticsDashboard.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`loadAnalytics` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\analytics\\AnalyticsDashboard.tsx:47:5\n  45 |\n  46 |   useEffect(() => {\n> 47 |     loadAnalytics();\n     |     ^^^^^^^^^^^^^ `loadAnalytics` accessed before it is declared\n  48 |     \n  49 |     // Refresh analytics every 5 seconds when visible\n  50 |     const interval = setInterval(() => {\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\analytics\\AnalyticsDashboard.tsx:59:3\n  57 |   }, [isVisible]);\n  58 |\n> 59 |   const loadAnalytics = () => {\n     |   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 60 |     const summary = analyticsService.getAnalyticsSummary();\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 61 |     setAnalytics(summary);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 62 |   };\n     | ^^^^^ `loadAnalytics` is declared here\n  63 |\n  64 |   const clearAnalytics = () => {\n  65 |     analyticsService.clearData();","line":47,"column":5,"nodeType":null,"endLine":47,"endColumn":18},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Date.now` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\analytics\\AnalyticsDashboard.tsx:160:35\n  158 |                 <span className=\"text-gray-400\">Duration:</span>\n  159 |                 <div className=\"text-white\">\n> 160 |                   {formatDuration(Date.now() - analytics.session.startTime)}\n      |                                   ^^^^^^^^^^ Cannot call impure function\n  161 |                 </div>\n  162 |               </div>\n  163 |               <div>","line":160,"column":35,"nodeType":null,"endLine":160,"endColumn":45}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { analyticsService } from '@/lib/analytics';\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { Button } from '@/components/ui/button';\r\nimport { Badge } from '@/components/ui/badge';\r\nimport { Progress } from '@/components/ui/progress';\r\n\r\ninterface AnalyticsSummary {\r\n  session: {\r\n    sessionId: string;\r\n    startTime: number;\r\n    character: string | null;\r\n    weapon: string | null;\r\n    difficulty: string | null;\r\n  };\r\n  completionRates: {\r\n    easy: number;\r\n    medium: number;\r\n    impossible: number;\r\n  };\r\n  averageScores: {\r\n    easy: number;\r\n    medium: number;\r\n    impossible: number;\r\n  };\r\n  weaponUsage: Array<{\r\n    weapon: string;\r\n    count: number;\r\n    percentage: number;\r\n  }>;\r\n  performance: {\r\n    averageFPS: number;\r\n    averageLoadTime: number;\r\n    currentFPS: number;\r\n  };\r\n  totalGames: number;\r\n  totalProgressionEvents: number;\r\n}\r\n\r\nexport default function AnalyticsDashboard() {\r\n  const [analytics, setAnalytics] = useState<AnalyticsSummary | null>(null);\r\n  const [isVisible, setIsVisible] = useState(false);\r\n\r\n  useEffect(() => {\r\n    loadAnalytics();\r\n    \r\n    // Refresh analytics every 5 seconds when visible\r\n    const interval = setInterval(() => {\r\n      if (isVisible) {\r\n        loadAnalytics();\r\n      }\r\n    }, 5000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, [isVisible]);\r\n\r\n  const loadAnalytics = () => {\r\n    const summary = analyticsService.getAnalyticsSummary();\r\n    setAnalytics(summary);\r\n  };\r\n\r\n  const clearAnalytics = () => {\r\n    analyticsService.clearData();\r\n    loadAnalytics();\r\n  };\r\n\r\n  const exportAnalytics = () => {\r\n    const data = analyticsService.exportData();\r\n    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });\r\n    const url = URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = `game-analytics-${new Date().toISOString().split('T')[0]}.json`;\r\n    document.body.appendChild(a);\r\n    a.click();\r\n    document.body.removeChild(a);\r\n    URL.revokeObjectURL(url);\r\n  };\r\n\r\n  const formatDuration = (ms: number) => {\r\n    const seconds = Math.floor(ms / 1000);\r\n    const minutes = Math.floor(seconds / 60);\r\n    const hours = Math.floor(minutes / 60);\r\n    \r\n    if (hours > 0) {\r\n      return `${hours}h ${minutes % 60}m`;\r\n    } else if (minutes > 0) {\r\n      return `${minutes}m ${seconds % 60}s`;\r\n    } else {\r\n      return `${seconds}s`;\r\n    }\r\n  };\r\n\r\n  const getPerformanceColor = (fps: number) => {\r\n    if (fps >= 50) return 'text-green-600';\r\n    if (fps >= 30) return 'text-yellow-600';\r\n    return 'text-red-600';\r\n  };\r\n\r\n  const getCompletionRateColor = (rate: number) => {\r\n    if (rate >= 70) return 'bg-green-500';\r\n    if (rate >= 40) return 'bg-yellow-500';\r\n    return 'bg-red-500';\r\n  };\r\n\r\n  if (!isVisible) {\r\n    return (\r\n      <div className=\"fixed bottom-4 right-4 z-50\">\r\n        <Button\r\n          onClick={() => setIsVisible(true)}\r\n          variant=\"outline\"\r\n          size=\"sm\"\r\n          className=\"bg-purple-900/80 text-white border-purple-600 hover:bg-purple-800\"\r\n        >\r\n           Analytics\r\n        </Button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!analytics) {\r\n    return (\r\n      <div className=\"fixed bottom-4 right-4 z-50\">\r\n        <Card className=\"w-80 bg-gray-900/95 text-white border-purple-600\">\r\n          <CardContent className=\"p-4\">\r\n            <div className=\"text-center\">Loading analytics...</div>\r\n          </CardContent>\r\n        </Card>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"fixed bottom-4 right-4 z-50 max-h-[80vh] overflow-y-auto\">\r\n      <Card className=\"w-96 bg-gray-900/95 text-white border-purple-600\">\r\n        <CardHeader className=\"pb-3\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <CardTitle className=\"text-lg text-purple-300\">Game Analytics</CardTitle>\r\n            <Button\r\n              onClick={() => setIsVisible(false)}\r\n              variant=\"ghost\"\r\n              size=\"sm\"\r\n              className=\"text-gray-400 hover:text-white\"\r\n            >\r\n              \r\n            </Button>\r\n          </div>\r\n        </CardHeader>\r\n        \r\n        <CardContent className=\"space-y-4\">\r\n          {/* Session Info */}\r\n          <div className=\"space-y-2\">\r\n            <h3 className=\"text-sm font-semibold text-purple-300\">Current Session</h3>\r\n            <div className=\"grid grid-cols-2 gap-2 text-xs\">\r\n              <div>\r\n                <span className=\"text-gray-400\">Duration:</span>\r\n                <div className=\"text-white\">\r\n                  {formatDuration(Date.now() - analytics.session.startTime)}\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <span className=\"text-gray-400\">Games:</span>\r\n                <div className=\"text-white\">{analytics.totalGames}</div>\r\n              </div>\r\n              {analytics.session.character && (\r\n                <div>\r\n                  <span className=\"text-gray-400\">Character:</span>\r\n                  <div className=\"text-white capitalize\">{analytics.session.character}</div>\r\n                </div>\r\n              )}\r\n              {analytics.session.weapon && (\r\n                <div>\r\n                  <span className=\"text-gray-400\">Weapon:</span>\r\n                  <div className=\"text-white capitalize\">{analytics.session.weapon}</div>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Performance Metrics */}\r\n          <div className=\"space-y-2\">\r\n            <h3 className=\"text-sm font-semibold text-purple-300\">Performance</h3>\r\n            <div className=\"grid grid-cols-2 gap-2 text-xs\">\r\n              <div>\r\n                <span className=\"text-gray-400\">Current FPS:</span>\r\n                <div className={`font-mono ${getPerformanceColor(analytics.performance.currentFPS)}`}>\r\n                  {analytics.performance.currentFPS}\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <span className=\"text-gray-400\">Avg FPS:</span>\r\n                <div className={`font-mono ${getPerformanceColor(analytics.performance.averageFPS)}`}>\r\n                  {analytics.performance.averageFPS}\r\n                </div>\r\n              </div>\r\n              <div className=\"col-span-2\">\r\n                <span className=\"text-gray-400\">Avg Load Time:</span>\r\n                <div className=\"text-white font-mono\">\r\n                  {analytics.performance.averageLoadTime}ms\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Completion Rates */}\r\n          <div className=\"space-y-2\">\r\n            <h3 className=\"text-sm font-semibold text-purple-300\">Completion Rates</h3>\r\n            <div className=\"space-y-2\">\r\n              {Object.entries(analytics.completionRates).map(([difficulty, rate]) => (\r\n                <div key={difficulty} className=\"space-y-1\">\r\n                  <div className=\"flex justify-between text-xs\">\r\n                    <span className=\"capitalize text-gray-300\">{difficulty}</span>\r\n                    <span className=\"text-white\">{rate.toFixed(1)}%</span>\r\n                  </div>\r\n                  <Progress \r\n                    value={rate} \r\n                    className=\"h-2\"\r\n                    style={{\r\n                      '--progress-background': getCompletionRateColor(rate)\r\n                    } as React.CSSProperties}\r\n                  />\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Average Scores */}\r\n          <div className=\"space-y-2\">\r\n            <h3 className=\"text-sm font-semibold text-purple-300\">Average Scores</h3>\r\n            <div className=\"grid grid-cols-3 gap-2 text-xs\">\r\n              {Object.entries(analytics.averageScores).map(([difficulty, score]) => (\r\n                <div key={difficulty} className=\"text-center\">\r\n                  <div className=\"text-gray-400 capitalize\">{difficulty}</div>\r\n                  <div className=\"text-white font-mono\">{Math.round(score)}</div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Weapon Usage */}\r\n          {analytics.weaponUsage.length > 0 && (\r\n            <div className=\"space-y-2\">\r\n              <h3 className=\"text-sm font-semibold text-purple-300\">Weapon Usage</h3>\r\n              <div className=\"space-y-1\">\r\n                {analytics.weaponUsage.map(({ weapon, count, percentage }) => (\r\n                  <div key={weapon} className=\"flex items-center justify-between text-xs\">\r\n                    <span className=\"capitalize text-gray-300\">{weapon}</span>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <Badge variant=\"secondary\" className=\"text-xs px-1 py-0\">\r\n                        {count}\r\n                      </Badge>\r\n                      <span className=\"text-white w-10 text-right\">\r\n                        {percentage.toFixed(1)}%\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Actions */}\r\n          <div className=\"flex gap-2 pt-2 border-t border-gray-700\">\r\n            <Button\r\n              onClick={exportAnalytics}\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              className=\"flex-1 text-xs border-purple-600 text-purple-300 hover:bg-purple-900\"\r\n            >\r\n              Export\r\n            </Button>\r\n            <Button\r\n              onClick={clearAnalytics}\r\n              variant=\"outline\"\r\n              size=\"sm\"\r\n              className=\"flex-1 text-xs border-red-600 text-red-300 hover:bg-red-900\"\r\n            >\r\n              Clear\r\n            </Button>\r\n          </div>\r\n        </CardContent>\r\n      </Card>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\debug\\PerformanceMonitor.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'NetworkPerformanceMonitor' is defined but never used.","line":4,"column":38,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":63},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'PerformanceMetrics' is defined but never used.","line":4,"column":106,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":124},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":17,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[569,572],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[569,572],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":112,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":112,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3893,3896],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3893,3896],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":177,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":177,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6373,6376],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6373,6376],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":223,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":223,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8240,8243],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8240,8243],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":263,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":263,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9823,9826],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9823,9826],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":284,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":284,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10551,10554],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10551,10554],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":301,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":301,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11240,11243],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11240,11243],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport { AdvancedPerformanceMonitor, NetworkPerformanceMonitor, MemoryManager, PerformanceDebugger, type PerformanceMetrics } from '../../utils/performance';\r\n\r\ninterface PerformanceMonitorProps {\r\n  isVisible: boolean;\r\n  onToggle: () => void;\r\n  position?: 'top-left' | 'top-right' | 'bottom-left' | 'bottom-right';\r\n}\r\n\r\nexport function PerformanceMonitor({ \r\n  isVisible, \r\n  onToggle, \r\n  position = 'top-right' \r\n}: PerformanceMonitorProps) {\r\n  const [metrics, setMetrics] = useState<any>(null);\r\n  const [activeTab, setActiveTab] = useState<'overview' | 'memory' | 'network' | 'debug'>('overview');\r\n  const performanceMonitorRef = useRef<AdvancedPerformanceMonitor | null>(null);\r\n  const intervalRef = useRef<NodeJS.Timeout | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (!performanceMonitorRef.current) {\r\n      performanceMonitorRef.current = new AdvancedPerformanceMonitor();\r\n    }\r\n\r\n    if (isVisible) {\r\n      // Update metrics every 100ms when visible\r\n      intervalRef.current = setInterval(() => {\r\n        if (performanceMonitorRef.current) {\r\n          const basicMetrics = performanceMonitorRef.current.update();\r\n          const detailedMetrics = performanceMonitorRef.current.getDetailedMetrics();\r\n          const networkMetrics = performanceMonitorRef.current.getNetworkMetrics();\r\n          const memoryMetrics = performanceMonitorRef.current.getMemoryMetrics();\r\n          \r\n          setMetrics({\r\n            basic: basicMetrics,\r\n            detailed: detailedMetrics,\r\n            network: networkMetrics,\r\n            memory: memoryMetrics,\r\n          });\r\n        }\r\n      }, 100);\r\n    } else {\r\n      if (intervalRef.current) {\r\n        clearInterval(intervalRef.current);\r\n        intervalRef.current = null;\r\n      }\r\n    }\r\n\r\n    return () => {\r\n      if (intervalRef.current) {\r\n        clearInterval(intervalRef.current);\r\n      }\r\n    };\r\n  }, [isVisible]);\r\n\r\n  if (!isVisible) {\r\n    return (\r\n      <button\r\n        onClick={onToggle}\r\n        className={`fixed ${getPositionClasses(position)} z-50 bg-black/80 text-white px-2 py-1 rounded text-xs font-mono hover:bg-black/90 transition-colors`}\r\n        title=\"Show Performance Monitor\"\r\n      >\r\n         FPS: {metrics?.basic?.fps?.toFixed(0) || '--'}\r\n      </button>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={`fixed ${getPositionClasses(position)} z-50 bg-black/90 text-white rounded-lg shadow-lg max-w-md w-80`}>\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between p-2 border-b border-gray-600\">\r\n        <h3 className=\"text-sm font-bold\">Performance Monitor</h3>\r\n        <button\r\n          onClick={onToggle}\r\n          className=\"text-gray-400 hover:text-white transition-colors\"\r\n          title=\"Hide Performance Monitor\"\r\n        >\r\n          \r\n        </button>\r\n      </div>\r\n\r\n      {/* Tabs */}\r\n      <div className=\"flex border-b border-gray-600\">\r\n        {(['overview', 'memory', 'network', 'debug'] as const).map((tab) => (\r\n          <button\r\n            key={tab}\r\n            onClick={() => setActiveTab(tab)}\r\n            className={`flex-1 px-2 py-1 text-xs capitalize transition-colors ${\r\n              activeTab === tab\r\n                ? 'bg-blue-600 text-white'\r\n                : 'text-gray-400 hover:text-white hover:bg-gray-700'\r\n            }`}\r\n          >\r\n            {tab}\r\n          </button>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Content */}\r\n      <div className=\"p-2 max-h-80 overflow-y-auto\">\r\n        {activeTab === 'overview' && <OverviewTab metrics={metrics} />}\r\n        {activeTab === 'memory' && <MemoryTab metrics={metrics} />}\r\n        {activeTab === 'network' && <NetworkTab metrics={metrics} />}\r\n        {activeTab === 'debug' && <DebugTab />}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction OverviewTab({ metrics }: { metrics: any }) {\r\n  if (!metrics) return <div className=\"text-gray-400\">Loading...</div>;\r\n\r\n  const { basic, detailed } = metrics;\r\n\r\n  return (\r\n    <div className=\"space-y-2 text-xs font-mono\">\r\n      {/* FPS Display */}\r\n      <div className=\"grid grid-cols-2 gap-2\">\r\n        <div className=\"bg-gray-800 p-2 rounded\">\r\n          <div className=\"text-gray-400\">FPS</div>\r\n          <div className={`text-lg font-bold ${getFPSColor(basic.fps)}`}>\r\n            {basic.fps?.toFixed(0) || '--'}\r\n          </div>\r\n          <div className=\"text-gray-500 text-xs\">\r\n            Avg: {detailed.fps?.average?.toFixed(0) || '--'}\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"bg-gray-800 p-2 rounded\">\r\n          <div className=\"text-gray-400\">Frame Time</div>\r\n          <div className=\"text-lg font-bold text-blue-400\">\r\n            {basic.frameTime?.toFixed(1) || '--'}ms\r\n          </div>\r\n          <div className=\"text-gray-500 text-xs\">\r\n            Target: 16.7ms\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Performance Metrics */}\r\n      <div className=\"space-y-1\">\r\n        <MetricRow label=\"Render Time\" value={`${basic.renderTime?.toFixed(2) || '--'}ms`} />\r\n        <MetricRow label=\"Update Time\" value={`${basic.updateTime?.toFixed(2) || '--'}ms`} />\r\n        <MetricRow label=\"Draw Calls\" value={basic.drawCalls?.toFixed(0) || '--'} />\r\n        <MetricRow label=\"Active Objects\" value={basic.activeObjects?.toString() || '--'} />\r\n        {basic.cpuUsage && (\r\n          <MetricRow \r\n            label=\"CPU Usage\" \r\n            value={`${basic.cpuUsage.toFixed(1)}%`}\r\n            color={basic.cpuUsage > 80 ? 'text-red-400' : basic.cpuUsage > 60 ? 'text-yellow-400' : 'text-green-400'}\r\n          />\r\n        )}\r\n      </div>\r\n\r\n      {/* FPS Chart (simplified) */}\r\n      {detailed.fps?.history && (\r\n        <div className=\"bg-gray-800 p-2 rounded\">\r\n          <div className=\"text-gray-400 mb-1\">FPS History</div>\r\n          <div className=\"flex items-end h-8 gap-px\">\r\n            {detailed.fps.history.slice(-30).map((fps: number, i: number) => (\r\n              <div\r\n                key={i}\r\n                className={`flex-1 ${getFPSColor(fps)} opacity-70`}\r\n                style={{ height: `${Math.min(100, (fps / 60) * 100)}%` }}\r\n                title={`${fps.toFixed(0)} FPS`}\r\n              />\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction MemoryTab({ metrics }: { metrics: any }) {\r\n  if (!metrics?.memory) return <div className=\"text-gray-400\">Memory data unavailable</div>;\r\n\r\n  const { memory } = metrics;\r\n\r\n  return (\r\n    <div className=\"space-y-2 text-xs font-mono\">\r\n      {/* Memory Overview */}\r\n      <div className=\"bg-gray-800 p-2 rounded\">\r\n        <div className=\"text-gray-400 mb-2\">JavaScript Heap</div>\r\n        <MetricRow \r\n          label=\"Used\" \r\n          value={`${memory.usedJSHeapSize?.toFixed(1) || '--'} MB`}\r\n          color={getMemoryColor(memory.usedJSHeapSize, memory.jsHeapSizeLimit)}\r\n        />\r\n        <MetricRow label=\"Total\" value={`${memory.totalJSHeapSize?.toFixed(1) || '--'} MB`} />\r\n        <MetricRow label=\"Limit\" value={`${memory.jsHeapSizeLimit?.toFixed(1) || '--'} MB`} />\r\n      </div>\r\n\r\n      {/* Asset Memory */}\r\n      <div className=\"bg-gray-800 p-2 rounded\">\r\n        <div className=\"text-gray-400 mb-2\">Asset Memory</div>\r\n        <MetricRow label=\"Textures\" value={`${memory.textureMemory?.toFixed(1) || '--'} MB`} />\r\n        <MetricRow label=\"Audio\" value={`${memory.audioMemory?.toFixed(1) || '--'} MB`} />\r\n        <MetricRow label=\"Objects\" value={memory.objectCount?.toString() || '--'} />\r\n      </div>\r\n\r\n      {/* Memory Actions */}\r\n      <div className=\"space-y-1\">\r\n        <button\r\n          onClick={() => MemoryManager.getInstance().forceGarbageCollection()}\r\n          className=\"w-full bg-red-600 hover:bg-red-700 text-white px-2 py-1 rounded text-xs transition-colors\"\r\n        >\r\n          Force Cleanup\r\n        </button>\r\n        <button\r\n          onClick={() => MemoryManager.getInstance().clearAll()}\r\n          className=\"w-full bg-orange-600 hover:bg-orange-700 text-white px-2 py-1 rounded text-xs transition-colors\"\r\n        >\r\n          Clear All Cache\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction NetworkTab({ metrics }: { metrics: any }) {\r\n  if (!metrics?.network) return <div className=\"text-gray-400\">Network data unavailable</div>;\r\n\r\n  const { network } = metrics;\r\n\r\n  return (\r\n    <div className=\"space-y-2 text-xs font-mono\">\r\n      {/* Connection Status */}\r\n      <div className=\"bg-gray-800 p-2 rounded\">\r\n        <div className=\"text-gray-400 mb-2\">Connection</div>\r\n        <MetricRow \r\n          label=\"Status\" \r\n          value={network.isOnline ? 'Online' : 'Offline'}\r\n          color={network.isOnline ? 'text-green-400' : 'text-red-400'}\r\n        />\r\n        <MetricRow label=\"Type\" value={network.connectionType || 'Unknown'} />\r\n        <MetricRow label=\"Download\" value={`${network.downloadSpeed?.toFixed(1) || '--'} Mbps`} />\r\n      </div>\r\n\r\n      {/* Performance Metrics */}\r\n      <div className=\"bg-gray-800 p-2 rounded\">\r\n        <div className=\"text-gray-400 mb-2\">Performance</div>\r\n        <MetricRow \r\n          label=\"Latency\" \r\n          value={network.latency > 0 ? `${network.latency.toFixed(0)}ms` : '--'}\r\n          color={getLatencyColor(network.latency)}\r\n        />\r\n        <MetricRow label=\"Avg Response\" value={`${network.averageResponseTime?.toFixed(0) || '--'}ms`} />\r\n        <MetricRow label=\"Requests\" value={network.requestCount?.toString() || '--'} />\r\n        <MetricRow \r\n          label=\"Failed\" \r\n          value={network.failedRequests?.toString() || '--'}\r\n          color={network.failedRequests > 0 ? 'text-red-400' : 'text-green-400'}\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction DebugTab() {\r\n  const [debugData, setDebugData] = useState<any>(null);\r\n  const perfDebugger = PerformanceDebugger.getInstance();\r\n\r\n  useEffect(() => {\r\n    const interval = setInterval(() => {\r\n      setDebugData({\r\n        profiles: perfDebugger.getAllProfiles(),\r\n        logs: perfDebugger.getLogs(undefined, 10),\r\n      });\r\n    }, 1000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, [perfDebugger]);\r\n\r\n  return (\r\n    <div className=\"space-y-2 text-xs font-mono\">\r\n      {/* Profiles */}\r\n      <div className=\"bg-gray-800 p-2 rounded\">\r\n        <div className=\"text-gray-400 mb-2\">Active Profiles</div>\r\n        {debugData?.profiles?.length > 0 ? (\r\n          <div className=\"space-y-1 max-h-20 overflow-y-auto\">\r\n            {debugData.profiles.slice(0, 5).map((profile: any) => (\r\n              <div key={profile.name} className=\"flex justify-between\">\r\n                <span className=\"truncate\">{profile.name}</span>\r\n                <span className=\"text-yellow-400\">{profile.average.toFixed(2)}ms</span>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        ) : (\r\n          <div className=\"text-gray-500\">No active profiles</div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Recent Logs */}\r\n      <div className=\"bg-gray-800 p-2 rounded\">\r\n        <div className=\"text-gray-400 mb-2\">Recent Logs</div>\r\n        {debugData?.logs?.length > 0 ? (\r\n          <div className=\"space-y-1 max-h-32 overflow-y-auto\">\r\n            {debugData.logs.map((log: any, i: number) => (\r\n              <div key={i} className={`text-xs ${getLogColor(log.level)}`}>\r\n                <span className=\"text-gray-500\">[{log.timestamp.toFixed(0)}]</span> {log.message}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        ) : (\r\n          <div className=\"text-gray-500\">No recent logs</div>\r\n        )}\r\n      </div>\r\n\r\n      {/* Debug Actions */}\r\n      <div className=\"space-y-1\">\r\n        <button\r\n          onClick={() => {\r\n            const data = perfDebugger.exportPerformanceData();\r\n            console.log('Performance Data:', data);\r\n            // Could also download as JSON file\r\n          }}\r\n          className=\"w-full bg-blue-600 hover:bg-blue-700 text-white px-2 py-1 rounded text-xs transition-colors\"\r\n        >\r\n          Export Debug Data\r\n        </button>\r\n        <button\r\n          onClick={() => perfDebugger.clear()}\r\n          className=\"w-full bg-gray-600 hover:bg-gray-700 text-white px-2 py-1 rounded text-xs transition-colors\"\r\n        >\r\n          Clear Debug Data\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction MetricRow({ label, value, color = 'text-white' }: { label: string; value: string; color?: string }) {\r\n  return (\r\n    <div className=\"flex justify-between\">\r\n      <span className=\"text-gray-400\">{label}:</span>\r\n      <span className={color}>{value}</span>\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction getPositionClasses(position: string): string {\r\n  switch (position) {\r\n    case 'top-left': return 'top-4 left-4';\r\n    case 'top-right': return 'top-4 right-4';\r\n    case 'bottom-left': return 'bottom-4 left-4';\r\n    case 'bottom-right': return 'bottom-4 right-4';\r\n    default: return 'top-4 right-4';\r\n  }\r\n}\r\n\r\nfunction getFPSColor(fps: number): string {\r\n  if (fps >= 55) return 'text-green-400';\r\n  if (fps >= 30) return 'text-yellow-400';\r\n  return 'text-red-400';\r\n}\r\n\r\nfunction getMemoryColor(used: number, limit: number): string {\r\n  if (!used || !limit) return 'text-white';\r\n  const percentage = (used / limit) * 100;\r\n  if (percentage >= 80) return 'text-red-400';\r\n  if (percentage >= 60) return 'text-yellow-400';\r\n  return 'text-green-400';\r\n}\r\n\r\nfunction getLatencyColor(latency: number): string {\r\n  if (latency < 0) return 'text-gray-400';\r\n  if (latency <= 50) return 'text-green-400';\r\n  if (latency <= 150) return 'text-yellow-400';\r\n  return 'text-red-400';\r\n}\r\n\r\nfunction getLogColor(level: string): string {\r\n  switch (level) {\r\n    case 'error': return 'text-red-400';\r\n    case 'warn': return 'text-yellow-400';\r\n    case 'info': return 'text-blue-400';\r\n    default: return 'text-white';\r\n  }\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\game\\ClientOnlyPhaserGame.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\game\\GameHUD.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'timeRemaining' is assigned a value but never used.","line":19,"column":87,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":100},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'performanceSettings' is assigned a value but never used.","line":36,"column":30,"nodeType":null,"messageId":"unusedVar","endLine":36,"endColumn":49},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\game\\GameHUD.tsx:44:5\n  42 |   // Ensure this only renders on the client to prevent hydration issues\n  43 |   useEffect(() => {\n> 44 |     setIsClient(true);\n     |     ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  45 |     \n  46 |     // Listen for game mode specific events from the game scene\n  47 |     const handleTimeUpdate = (event: CustomEvent) => {","line":44,"column":5,"nodeType":null,"endLine":44,"endColumn":16}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { useGameStore } from '../../store/gameStore';\r\nimport { PumpkinIcon, SkullIcon } from '../ui/HalloweenIcons';\r\nimport { MobileSettingsButton } from './MobileSettingsButton';\r\nimport AnalyticsDashboard from '../analytics/AnalyticsDashboard';\r\nimport { PerformanceMonitor } from '../debug/PerformanceMonitor';\r\nimport { usePerformanceMonitor } from '../../hooks/usePerformanceMonitor';\r\nimport { usePerformanceMonitoring } from '../../hooks/usePerformanceMonitoring';\r\nimport { PerformanceSettings } from '../settings/PerformanceSettings';\r\nimport { PerformanceWarning } from './PerformanceWarning';\r\n\r\ninterface GameHUDProps {\r\n  className?: string;\r\n}\r\n\r\nexport function GameHUD({ className = '' }: GameHUDProps) {\r\n  const { firstName, lastName, lives, score, character, weapon, difficulty, gameMode, timeRemaining } = useGameStore();\r\n  const [isClient, setIsClient] = useState(false);\r\n  const [showPerformanceSettings, setShowPerformanceSettings] = useState(false);\r\n  const [gameModeData, setGameModeData] = useState<{\r\n    timeRemaining?: number;\r\n    distance?: number;\r\n    difficultyMultiplier?: number;\r\n  }>({});\r\n  \r\n  // Performance monitoring\r\n  const { isVisible: isPerformanceVisible, toggleVisibility: togglePerformance } = usePerformanceMonitor({\r\n    enabled: process.env.NODE_ENV === 'development', // Only enable in development\r\n    updateInterval: 100,\r\n    autoProfile: true,\r\n  });\r\n\r\n  // Performance optimization monitoring\r\n  const { metrics, settings: performanceSettings } = usePerformanceMonitoring({\r\n    enabled: true,\r\n    updateInterval: 1000,\r\n    autoOptimize: true,\r\n  });\r\n\r\n  // Ensure this only renders on the client to prevent hydration issues\r\n  useEffect(() => {\r\n    setIsClient(true);\r\n    \r\n    // Listen for game mode specific events from the game scene\r\n    const handleTimeUpdate = (event: CustomEvent) => {\r\n      setGameModeData(prev => ({ ...prev, timeRemaining: event.detail.timeRemaining }));\r\n    };\r\n    \r\n    const handleDistanceUpdate = (event: CustomEvent) => {\r\n      setGameModeData(prev => ({ ...prev, distance: event.detail.distance }));\r\n    };\r\n    \r\n    const handleDifficultyUpdate = (event: CustomEvent) => {\r\n      setGameModeData(prev => ({ ...prev, difficultyMultiplier: event.detail.difficultyMultiplier }));\r\n    };\r\n    \r\n    // Add event listeners\r\n    window.addEventListener('timeUpdate', handleTimeUpdate as EventListener);\r\n    window.addEventListener('distanceUpdate', handleDistanceUpdate as EventListener);\r\n    window.addEventListener('difficultyUpdate', handleDifficultyUpdate as EventListener);\r\n    \r\n    // Cleanup\r\n    return () => {\r\n      window.removeEventListener('timeUpdate', handleTimeUpdate as EventListener);\r\n      window.removeEventListener('distanceUpdate', handleDistanceUpdate as EventListener);\r\n      window.removeEventListener('difficultyUpdate', handleDifficultyUpdate as EventListener);\r\n    };\r\n  }, []);\r\n\r\n  // Debug: Log the current store values\r\n  console.log('GameHUD render - store values:', {\r\n    firstName, lastName, lives, score, character, weapon, difficulty, isClient\r\n  });\r\n\r\n  // Don't render on server or if we don't have the basic game data yet\r\n  if (!isClient || !firstName || !character || !weapon || !difficulty || !gameMode) {\r\n    console.log('GameHUD: Not ready to render', { isClient, firstName, character, weapon, difficulty, gameMode });\r\n    return null;\r\n  }\r\n\r\n  // Format player name for display\r\n  const playerName = `${firstName} ${lastName}`.trim() || 'Player';\r\n\r\n  // Get character emoji\r\n  const characterEmoji = character === 'boy' ? '' : '';\r\n\r\n  // Get weapon emoji\r\n  const weaponEmoji = {\r\n    katana: '',\r\n    laser: '',\r\n    baseball: '',\r\n    bazooka: ''\r\n  }[weapon || 'katana'];\r\n\r\n  // Get difficulty color\r\n  const difficultyColor = {\r\n    easy: 'text-green-400',\r\n    medium: 'text-yellow-400',\r\n    impossible: 'text-red-400'\r\n  }[difficulty || 'easy'];\r\n\r\n  // Get game mode display info\r\n  const gameModeInfo = {\r\n    story: { name: 'Histria', emoji: '', color: 'text-blue-400' },\r\n    endless: { name: 'Infinito', emoji: '', color: 'text-purple-400' },\r\n    timeAttack: { name: 'Tempo', emoji: '', color: 'text-yellow-400' },\r\n    survival: { name: 'Sobrevivncia', emoji: '', color: 'text-red-400' },\r\n    practice: { name: 'Treino', emoji: '', color: 'text-green-400' }\r\n  }[gameMode || 'story'];\r\n\r\n  // Format time for display\r\n  const formatTime = (seconds: number): string => {\r\n    const mins = Math.floor(seconds / 60);\r\n    const secs = seconds % 60;\r\n    return `${mins}:${secs.toString().padStart(2, '0')}`;\r\n  };\r\n\r\n  return (\r\n    <div \r\n      className={`absolute top-0 left-0 right-0 z-20 pointer-events-none ${className}`}\r\n      role=\"banner\"\r\n      aria-label=\"Interface do jogo\"\r\n    >\r\n      {/* Main HUD with enhanced Halloween styling */}\r\n      <div className=\"flex justify-between items-start p-2 sm:p-4\">\r\n        {/* Left side - Player info with Halloween theme */}\r\n        <div \r\n          className=\"game-hud halloween-card p-2 sm:p-3 rounded-lg\"\r\n          role=\"region\"\r\n          aria-label=\"Informaes do jogador\"\r\n        >\r\n          <div className=\"text-orange-400 text-xs sm:text-sm font-medium mb-1 flex items-center gap-1\">\r\n            <PumpkinIcon size={16} className=\"text-orange-500\" />\r\n            <span className=\"spooky-text\">Player</span>\r\n          </div>\r\n          <div className=\"text-white text-sm sm:text-lg font-bold truncate max-w-[120px] sm:max-w-none mb-1 glowing-text\">\r\n            {playerName}\r\n          </div>\r\n          <div className=\"flex items-center gap-2 text-xs sm:text-sm text-gray-300\">\r\n            <span>{characterEmoji}</span>\r\n            <span className=\"text-orange-400\"></span>\r\n            <span>{weaponEmoji}</span>\r\n            <span className=\"text-orange-400\"></span>\r\n            <span className={`${difficultyColor} font-bold`}>\r\n              {difficulty?.toUpperCase()}\r\n            </span>\r\n          </div>\r\n          <div className=\"flex items-center gap-1 text-xs text-gray-400 mt-1\">\r\n            <span>{gameModeInfo.emoji}</span>\r\n            <span className={`${gameModeInfo.color} font-medium`}>\r\n              {gameModeInfo.name}\r\n            </span>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Right side - Lives and Score with Halloween styling */}\r\n        <div className=\"flex gap-2 sm:gap-3\">\r\n          {/* Lives display with skull icon */}\r\n          <div \r\n            className=\"game-hud spooky-card p-2 sm:p-3 rounded-lg text-center min-w-[60px] sm:min-w-[80px]\"\r\n            role=\"region\"\r\n            aria-label={`Vidas restantes: ${lives}`}\r\n          >\r\n            <div className=\"life-indicator text-xs sm:text-sm font-medium mb-1 flex items-center justify-center gap-1\">\r\n              <SkullIcon size={16} className=\"text-red-500\" />\r\n              <span className=\"spooky-text\">Lives</span>\r\n            </div>\r\n            <div className={`text-lg sm:text-2xl font-bold life-indicator ${lives <= 3 ? 'flickering-text' : ''}`}>\r\n              {lives}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Score display with enhanced styling */}\r\n          <div \r\n            className=\"game-hud halloween-card p-2 sm:p-3 rounded-lg text-center min-w-[80px] sm:min-w-[100px]\"\r\n            role=\"region\"\r\n            aria-label={`Pontuao atual: ${score.toLocaleString()} pontos`}\r\n          >\r\n            <div className=\"score-indicator text-xs sm:text-sm font-medium mb-1 flex items-center justify-center gap-1\">\r\n              <span className=\"text-yellow-400\"></span>\r\n              <span className=\"spooky-text\">Score</span>\r\n            </div>\r\n            <div className=\"text-lg sm:text-2xl font-bold score-indicator glowing-text\">\r\n              {score.toLocaleString()}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Game Mode Specific Displays */}\r\n      {gameMode === 'timeAttack' && (\r\n        <div className=\"absolute top-2 left-1/2 transform -translate-x-1/2\">\r\n          <div className=\"game-hud spooky-card p-2 sm:p-3 rounded-lg text-center\">\r\n            <div className=\"text-xs sm:text-sm font-medium mb-1 flex items-center justify-center gap-1\">\r\n              <span className=\"text-yellow-400\"></span>\r\n              <span className=\"spooky-text\">Time</span>\r\n            </div>\r\n            <div className={`text-lg sm:text-2xl font-bold ${(gameModeData.timeRemaining || 0) <= 30 ? 'text-red-400 flickering-text' : 'text-yellow-400'}`}>\r\n              {formatTime(gameModeData.timeRemaining || 0)}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {gameMode === 'endless' && (\r\n        <div className=\"absolute top-2 left-1/2 transform -translate-x-1/2\">\r\n          <div className=\"game-hud spooky-card p-2 sm:p-3 rounded-lg text-center\">\r\n            <div className=\"text-xs sm:text-sm font-medium mb-1 flex items-center justify-center gap-1\">\r\n              <span className=\"text-purple-400\"></span>\r\n              <span className=\"spooky-text\">Distance</span>\r\n            </div>\r\n            <div className=\"text-lg sm:text-2xl font-bold text-purple-400\">\r\n              {(gameModeData.distance || 0).toLocaleString()}m\r\n            </div>\r\n            {gameModeData.difficultyMultiplier && gameModeData.difficultyMultiplier > 1 && (\r\n              <div className=\"text-xs text-red-400 mt-1\">\r\n                Difficulty: {gameModeData.difficultyMultiplier.toFixed(1)}x\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {gameMode === 'survival' && (\r\n        <div className=\"absolute top-2 left-1/2 transform -translate-x-1/2\">\r\n          <div className=\"game-hud spooky-card p-2 sm:p-3 rounded-lg text-center\">\r\n            <div className=\"text-xs sm:text-sm font-medium mb-1 flex items-center justify-center gap-1\">\r\n              <span className=\"text-red-400\"></span>\r\n              <span className=\"spooky-text\">Survival</span>\r\n            </div>\r\n            <div className=\"text-sm text-red-400 font-bold\">\r\n              {lives}/3 Lives Only\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {gameMode === 'practice' && (\r\n        <div className=\"absolute top-2 left-1/2 transform -translate-x-1/2\">\r\n          <div className=\"game-hud spooky-card p-2 sm:p-3 rounded-lg text-center\">\r\n            <div className=\"text-xs sm:text-sm font-medium mb-1 flex items-center justify-center gap-1\">\r\n              <span className=\"text-green-400\"></span>\r\n              <span className=\"spooky-text\">Practice</span>\r\n            </div>\r\n            <div className=\"text-sm text-green-400 font-bold\">\r\n              Unlimited Lives\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Enhanced health bar visualization */}\r\n      <div className=\"absolute top-16 sm:top-20 right-2 sm:right-4\">\r\n        <div className=\"spooky-card p-2 rounded-lg\">\r\n          <div className=\"text-xs text-center mb-1 text-red-400 spooky-text\">Health</div>\r\n          <div className=\"flex gap-1\">\r\n            {Array.from({ length: 10 }, (_, i) => (\r\n              <div\r\n                key={i}\r\n                className={`w-2 h-4 sm:w-3 sm:h-5 rounded-sm transition-all duration-300 ${i < lives\r\n                  ? lives > 6\r\n                    ? 'bg-green-500 shadow-green-500/50'\r\n                    : lives > 3\r\n                      ? 'bg-yellow-500 shadow-yellow-500/50'\r\n                      : 'bg-red-500 shadow-red-500/50 pulsing'\r\n                  : 'bg-gray-700'\r\n                  }`}\r\n                style={{\r\n                  boxShadow: i < lives ? '0 0 4px currentColor' : 'none'\r\n                }}\r\n              />\r\n            ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Warning overlay for low health */}\r\n      {lives <= 3 && (\r\n        <div className=\"absolute inset-0 pointer-events-none\">\r\n          <div className=\"absolute inset-0 bg-red-900/20 flickering-text\" />\r\n          <div className=\"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2\">\r\n            <div className=\"text-red-400 text-xl sm:text-2xl font-bold spooky-text glowing-text text-center\">\r\n               LOW HEALTH \r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Mobile Settings Button */}\r\n      <MobileSettingsButton />\r\n\r\n      {/* Analytics Dashboard */}\r\n      <AnalyticsDashboard />\r\n\r\n      {/* Performance Monitor (Development only) */}\r\n      {process.env.NODE_ENV === 'development' && (\r\n        <PerformanceMonitor\r\n          isVisible={isPerformanceVisible}\r\n          onToggle={togglePerformance}\r\n          position=\"bottom-right\"\r\n        />\r\n      )}\r\n\r\n      {/* Performance Settings Access (Desktop only) */}\r\n      {typeof window !== 'undefined' && window.innerWidth >= 1024 && (\r\n        <button\r\n          onClick={() => setShowPerformanceSettings(true)}\r\n          className=\"fixed bottom-4 left-4 z-30 bg-black/60 backdrop-blur-sm border border-white/20 rounded-lg p-2 text-white hover:bg-black/80 transition-all duration-200\"\r\n          aria-label=\"Performance Settings\"\r\n          title=\"Graphics & Performance Settings\"\r\n        >\r\n          <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M13 10V3L4 14h7v7l9-11h-7z\" />\r\n          </svg>\r\n          {metrics.isLowPerformance && (\r\n            <div className=\"absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full animate-pulse\" />\r\n          )}\r\n        </button>\r\n      )}\r\n\r\n      {/* Performance Settings Modal */}\r\n      <PerformanceSettings\r\n        isOpen={showPerformanceSettings}\r\n        onClose={() => setShowPerformanceSettings(false)}\r\n      />\r\n\r\n      {/* Performance Warning */}\r\n      <PerformanceWarning />\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\game\\KeyboardHelp.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\game\\MobileOptimizationTest.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'useEffect' is defined but never used.","line":3,"column":20,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":29},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'fullscreenManager' is defined but never used.","line":7,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":20},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":33,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1097,1100],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1097,1100],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":34,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1153,1156],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1153,1156],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":35,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1205,1208],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1205,1208],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":60,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":60,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2329,2332],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2329,2332],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { \r\n  mobileOptimization, \r\n  orientationManager, \r\n  fullscreenManager, \r\n  mobileUIScaler, \r\n  batteryOptimizer \r\n} from '@/utils/mobileOptimization';\r\n\r\n/**\r\n * Test component for mobile optimization features\r\n * This component can be used to verify all mobile features work correctly\r\n */\r\nexport function MobileOptimizationTest() {\r\n  const [testResults, setTestResults] = useState<Record<string, boolean>>({});\r\n  const [isRunning, setIsRunning] = useState(false);\r\n\r\n  const runTests = async () => {\r\n    setIsRunning(true);\r\n    const results: Record<string, boolean> = {};\r\n\r\n    try {\r\n      // Test 1: Orientation Manager\r\n      console.log('Testing orientation manager...');\r\n      const currentOrientation = orientationManager.getCurrentOrientation();\r\n      results.orientationDetection = typeof currentOrientation === 'string';\r\n\r\n      // Test 2: Fullscreen Manager\r\n      console.log('Testing fullscreen manager...');\r\n      const isFullscreenSupported = document.fullscreenEnabled || \r\n        !!(document as any).webkitFullscreenEnabled ||\r\n        !!(document as any).msFullscreenEnabled ||\r\n        !!(document as any).mozFullScreenEnabled;\r\n      results.fullscreenSupport = isFullscreenSupported;\r\n\r\n      // Test 3: UI Scaler\r\n      console.log('Testing UI scaler...');\r\n      const optimalScale = mobileUIScaler.calculateOptimalScale();\r\n      results.uiScaling = typeof optimalScale === 'number' && optimalScale > 0;\r\n\r\n      // Test 4: Battery Optimizer\r\n      console.log('Testing battery optimizer...');\r\n      await batteryOptimizer.initialize();\r\n      const optimizationLevel = batteryOptimizer.getOptimizationLevel();\r\n      results.batteryOptimization = typeof optimizationLevel === 'string';\r\n\r\n      // Test 5: Mobile Optimization Manager\r\n      console.log('Testing mobile optimization manager...');\r\n      await mobileOptimization.initialize({\r\n        batteryOptimization: true,\r\n        uiScale: 1\r\n      });\r\n      const status = mobileOptimization.getStatus();\r\n      results.mobileOptimizationManager = typeof status === 'object' && status !== null;\r\n\r\n      // Test 6: Device Orientation Lock (if supported)\r\n      console.log('Testing orientation lock...');\r\n      if (screen.orientation && (screen.orientation as any).lock) {\r\n        results.orientationLock = true;\r\n      } else {\r\n        results.orientationLock = false; // Not supported, but not an error\r\n      }\r\n\r\n      console.log('All tests completed:', results);\r\n    } catch (error) {\r\n      console.error('Test failed:', error);\r\n      results.error = false;\r\n    }\r\n\r\n    setTestResults(results);\r\n    setIsRunning(false);\r\n  };\r\n\r\n  const getTestStatusIcon = (result: boolean | undefined) => {\r\n    if (result === undefined) return '';\r\n    return result ? '' : '';\r\n  };\r\n\r\n  const getTestStatusText = (result: boolean | undefined) => {\r\n    if (result === undefined) return 'Pending';\r\n    return result ? 'Passed' : 'Failed';\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-gray-900/95 backdrop-blur-md rounded-xl border border-gray-700 p-6 max-w-md\">\r\n      <h2 className=\"text-xl font-bold text-white mb-4\">Mobile Optimization Test</h2>\r\n      \r\n      <button\r\n        onClick={runTests}\r\n        disabled={isRunning}\r\n        className={`w-full py-2 px-4 rounded-lg font-medium transition-colors mb-4 ${\r\n          isRunning \r\n            ? 'bg-gray-600 text-gray-300 cursor-not-allowed' \r\n            : 'bg-blue-600 hover:bg-blue-700 text-white'\r\n        }`}\r\n      >\r\n        {isRunning ? 'Running Tests...' : 'Run Mobile Tests'}\r\n      </button>\r\n\r\n      <div className=\"space-y-2 text-sm\">\r\n        <div className=\"flex justify-between items-center\">\r\n          <span className=\"text-gray-300\">Orientation Detection:</span>\r\n          <span className=\"flex items-center space-x-2\">\r\n            <span>{getTestStatusIcon(testResults.orientationDetection)}</span>\r\n            <span className=\"text-white\">{getTestStatusText(testResults.orientationDetection)}</span>\r\n          </span>\r\n        </div>\r\n\r\n        <div className=\"flex justify-between items-center\">\r\n          <span className=\"text-gray-300\">Fullscreen Support:</span>\r\n          <span className=\"flex items-center space-x-2\">\r\n            <span>{getTestStatusIcon(testResults.fullscreenSupport)}</span>\r\n            <span className=\"text-white\">{getTestStatusText(testResults.fullscreenSupport)}</span>\r\n          </span>\r\n        </div>\r\n\r\n        <div className=\"flex justify-between items-center\">\r\n          <span className=\"text-gray-300\">UI Scaling:</span>\r\n          <span className=\"flex items-center space-x-2\">\r\n            <span>{getTestStatusIcon(testResults.uiScaling)}</span>\r\n            <span className=\"text-white\">{getTestStatusText(testResults.uiScaling)}</span>\r\n          </span>\r\n        </div>\r\n\r\n        <div className=\"flex justify-between items-center\">\r\n          <span className=\"text-gray-300\">Battery Optimization:</span>\r\n          <span className=\"flex items-center space-x-2\">\r\n            <span>{getTestStatusIcon(testResults.batteryOptimization)}</span>\r\n            <span className=\"text-white\">{getTestStatusText(testResults.batteryOptimization)}</span>\r\n          </span>\r\n        </div>\r\n\r\n        <div className=\"flex justify-between items-center\">\r\n          <span className=\"text-gray-300\">Optimization Manager:</span>\r\n          <span className=\"flex items-center space-x-2\">\r\n            <span>{getTestStatusIcon(testResults.mobileOptimizationManager)}</span>\r\n            <span className=\"text-white\">{getTestStatusText(testResults.mobileOptimizationManager)}</span>\r\n          </span>\r\n        </div>\r\n\r\n        <div className=\"flex justify-between items-center\">\r\n          <span className=\"text-gray-300\">Orientation Lock:</span>\r\n          <span className=\"flex items-center space-x-2\">\r\n            <span>{getTestStatusIcon(testResults.orientationLock)}</span>\r\n            <span className=\"text-white\">\r\n              {testResults.orientationLock === false ? 'Not Supported' : getTestStatusText(testResults.orientationLock)}\r\n            </span>\r\n          </span>\r\n        </div>\r\n      </div>\r\n\r\n      {Object.keys(testResults).length > 0 && (\r\n        <div className=\"mt-4 pt-4 border-t border-gray-700\">\r\n          <div className=\"text-xs text-gray-400\">\r\n            <p>Tests completed. Check console for detailed logs.</p>\r\n            {testResults.orientationLock === false && (\r\n              <p className=\"mt-1 text-yellow-400\">\r\n                Note: Orientation lock requires HTTPS and modern browser support.\r\n              </p>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\game\\MobileSettings.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":55,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":55,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1669,1672],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1669,1672],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { mobileOptimization, type MobileSettings, type BatteryInfo } from '@/utils/mobileOptimization';\r\nimport { PerformanceSettings } from '@/components/settings/PerformanceSettings';\r\n\r\ninterface MobileSettingsProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  className?: string;\r\n}\r\n\r\nexport function MobileSettings({ isOpen, onClose, className = '' }: MobileSettingsProps) {\r\n  const [settings, setSettings] = useState<MobileSettings>({\r\n    orientationLock: false,\r\n    fullscreenMode: false,\r\n    batteryOptimization: true,\r\n    uiScale: 1\r\n  });\r\n  \r\n  const [status, setStatus] = useState({\r\n    orientation: 'unknown',\r\n    isOrientationLocked: false,\r\n    isFullscreen: false,\r\n    uiScale: 1,\r\n    batteryInfo: null as BatteryInfo | null,\r\n    optimizationLevel: 'none'\r\n  });\r\n\r\n  const [isApplying, setIsApplying] = useState(false);\r\n  const [showPerformanceSettings, setShowPerformanceSettings] = useState(false);\r\n\r\n  // Load current settings and status\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      const currentSettings = mobileOptimization.getSettings();\r\n      const currentStatus = mobileOptimization.getStatus();\r\n      setSettings(currentSettings);\r\n      setStatus(currentStatus);\r\n    }\r\n  }, [isOpen]);\r\n\r\n  // Update status periodically\r\n  useEffect(() => {\r\n    if (!isOpen) return;\r\n\r\n    const interval = setInterval(() => {\r\n      const currentStatus = mobileOptimization.getStatus();\r\n      setStatus(currentStatus);\r\n    }, 2000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, [isOpen]);\r\n\r\n  const handleSettingChange = async (key: keyof MobileSettings, value: any) => {\r\n    setIsApplying(true);\r\n    \r\n    try {\r\n      const newSettings = { ...settings, [key]: value };\r\n      setSettings(newSettings);\r\n      \r\n      await mobileOptimization.updateSettings({ [key]: value });\r\n      \r\n      // Update status after applying changes\r\n      setTimeout(() => {\r\n        const updatedStatus = mobileOptimization.getStatus();\r\n        setStatus(updatedStatus);\r\n      }, 500);\r\n    } catch (error) {\r\n      console.error('Failed to apply mobile setting:', error);\r\n    } finally {\r\n      setIsApplying(false);\r\n    }\r\n  };\r\n\r\n  const formatBatteryLevel = (level: number): string => {\r\n    return `${Math.round(level * 100)}%`;\r\n  };\r\n\r\n  const getBatteryColor = (level: number): string => {\r\n    if (level > 0.5) return 'text-green-400';\r\n    if (level > 0.2) return 'text-yellow-400';\r\n    return 'text-red-400';\r\n  };\r\n\r\n  const getOptimizationLevelColor = (level: string): string => {\r\n    switch (level) {\r\n      case 'high': return 'text-red-400';\r\n      case 'medium': return 'text-yellow-400';\r\n      case 'low': return 'text-blue-400';\r\n      default: return 'text-green-400';\r\n    }\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className={`fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4 ${className}`}>\r\n      <div className=\"bg-gray-900/95 backdrop-blur-md rounded-xl border border-gray-700 max-w-md w-full max-h-[90vh] overflow-y-auto\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between p-6 border-b border-gray-700\">\r\n          <h2 className=\"text-xl font-bold text-white\">Mobile Settings</h2>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-gray-400 hover:text-white transition-colors\"\r\n            aria-label=\"Close settings\"\r\n          >\r\n            <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n            </svg>\r\n          </button>\r\n        </div>\r\n\r\n        {/* Settings Content */}\r\n        <div className=\"p-6 space-y-6\">\r\n          {/* Device Status */}\r\n          <div className=\"bg-gray-800/50 rounded-lg p-4\">\r\n            <h3 className=\"text-lg font-semibold text-white mb-3\">Device Status</h3>\r\n            <div className=\"space-y-2 text-sm\">\r\n              <div className=\"flex justify-between\">\r\n                <span className=\"text-gray-300\">Orientation:</span>\r\n                <span className=\"text-white font-medium\">\r\n                  {status.orientation.replace('-', ' ').toUpperCase()}\r\n                  {status.isOrientationLocked && (\r\n                    <span className=\"ml-2 text-blue-400\"></span>\r\n                  )}\r\n                </span>\r\n              </div>\r\n              <div className=\"flex justify-between\">\r\n                <span className=\"text-gray-300\">Fullscreen:</span>\r\n                <span className={`font-medium ${status.isFullscreen ? 'text-green-400' : 'text-gray-400'}`}>\r\n                  {status.isFullscreen ? 'Active' : 'Inactive'}\r\n                </span>\r\n              </div>\r\n              <div className=\"flex justify-between\">\r\n                <span className=\"text-gray-300\">UI Scale:</span>\r\n                <span className=\"text-white font-medium\">{status.uiScale.toFixed(2)}x</span>\r\n              </div>\r\n              {status.batteryInfo && (\r\n                <>\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-300\">Battery:</span>\r\n                    <span className={`font-medium ${getBatteryColor(status.batteryInfo.level)}`}>\r\n                      {formatBatteryLevel(status.batteryInfo.level)}\r\n                      {status.batteryInfo.charging && (\r\n                        <span className=\"ml-1 text-green-400\"></span>\r\n                      )}\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-300\">Optimization:</span>\r\n                    <span className={`font-medium ${getOptimizationLevelColor(status.optimizationLevel)}`}>\r\n                      {status.optimizationLevel.toUpperCase()}\r\n                    </span>\r\n                  </div>\r\n                </>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Orientation Lock */}\r\n          <div className=\"space-y-3\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <h4 className=\"text-white font-medium\">Landscape Lock</h4>\r\n                <p className=\"text-gray-400 text-sm\">Lock device to landscape mode for optimal gaming</p>\r\n              </div>\r\n              <button\r\n                onClick={() => handleSettingChange('orientationLock', !settings.orientationLock)}\r\n                disabled={isApplying}\r\n                className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${\r\n                  settings.orientationLock ? 'bg-blue-600' : 'bg-gray-600'\r\n                } ${isApplying ? 'opacity-50' : ''}`}\r\n              >\r\n                <span\r\n                  className={`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${\r\n                    settings.orientationLock ? 'translate-x-6' : 'translate-x-1'\r\n                  }`}\r\n                />\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Fullscreen Mode */}\r\n          <div className=\"space-y-3\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <h4 className=\"text-white font-medium\">Fullscreen Mode</h4>\r\n                <p className=\"text-gray-400 text-sm\">Hide browser UI for immersive gaming experience</p>\r\n              </div>\r\n              <button\r\n                onClick={() => handleSettingChange('fullscreenMode', !settings.fullscreenMode)}\r\n                disabled={isApplying}\r\n                className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${\r\n                  settings.fullscreenMode ? 'bg-blue-600' : 'bg-gray-600'\r\n                } ${isApplying ? 'opacity-50' : ''}`}\r\n              >\r\n                <span\r\n                  className={`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${\r\n                    settings.fullscreenMode ? 'translate-x-6' : 'translate-x-1'\r\n                  }`}\r\n                />\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* UI Scale */}\r\n          <div className=\"space-y-3\">\r\n            <div>\r\n              <h4 className=\"text-white font-medium\">UI Scale</h4>\r\n              <p className=\"text-gray-400 text-sm\">Adjust interface size for your device</p>\r\n            </div>\r\n            <div className=\"space-y-2\">\r\n              <input\r\n                type=\"range\"\r\n                min=\"0.7\"\r\n                max=\"1.5\"\r\n                step=\"0.1\"\r\n                value={settings.uiScale}\r\n                onChange={(e) => handleSettingChange('uiScale', parseFloat(e.target.value))}\r\n                disabled={isApplying}\r\n                className=\"w-full h-2 bg-gray-600 rounded-lg appearance-none cursor-pointer slider\"\r\n              />\r\n              <div className=\"flex justify-between text-xs text-gray-400\">\r\n                <span>Small (0.7x)</span>\r\n                <span>Normal (1.0x)</span>\r\n                <span>Large (1.5x)</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Battery Optimization */}\r\n          <div className=\"space-y-3\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <h4 className=\"text-white font-medium\">Battery Optimization</h4>\r\n                <p className=\"text-gray-400 text-sm\">Automatically adjust performance based on battery level</p>\r\n              </div>\r\n              <button\r\n                onClick={() => handleSettingChange('batteryOptimization', !settings.batteryOptimization)}\r\n                disabled={isApplying}\r\n                className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${\r\n                  settings.batteryOptimization ? 'bg-blue-600' : 'bg-gray-600'\r\n                } ${isApplying ? 'opacity-50' : ''}`}\r\n              >\r\n                <span\r\n                  className={`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${\r\n                    settings.batteryOptimization ? 'translate-x-6' : 'translate-x-1'\r\n                  }`}\r\n                />\r\n              </button>\r\n            </div>\r\n            \r\n            {settings.batteryOptimization && status.batteryInfo && (\r\n              <div className=\"bg-gray-800/30 rounded-lg p-3 text-sm\">\r\n                <div className=\"flex items-center justify-between mb-2\">\r\n                  <span className=\"text-gray-300\">Current Level:</span>\r\n                  <span className={`font-medium ${getBatteryColor(status.batteryInfo.level)}`}>\r\n                    {formatBatteryLevel(status.batteryInfo.level)}\r\n                  </span>\r\n                </div>\r\n                <div className=\"flex items-center justify-between\">\r\n                  <span className=\"text-gray-300\">Optimization:</span>\r\n                  <span className={`font-medium ${getOptimizationLevelColor(status.optimizationLevel)}`}>\r\n                    {status.optimizationLevel.toUpperCase()}\r\n                  </span>\r\n                </div>\r\n                {status.optimizationLevel !== 'none' && (\r\n                  <p className=\"text-gray-400 text-xs mt-2\">\r\n                    Performance settings are automatically adjusted to preserve battery life.\r\n                  </p>\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Performance Settings Button */}\r\n          <div className=\"space-y-3\">\r\n            <button\r\n              onClick={() => setShowPerformanceSettings(true)}\r\n              className=\"w-full p-4 bg-gray-800/50 hover:bg-gray-700/50 rounded-lg border border-gray-600 transition-colors\"\r\n            >\r\n              <div className=\"flex items-center justify-between\">\r\n                <div className=\"text-left\">\r\n                  <h4 className=\"text-white font-medium\">Graphics & Performance</h4>\r\n                  <p className=\"text-gray-400 text-sm\">Optimize game performance for your device</p>\r\n                </div>\r\n                <svg className=\"w-5 h-5 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\r\n                </svg>\r\n              </div>\r\n            </button>\r\n          </div>\r\n\r\n          {/* Apply Status */}\r\n          {isApplying && (\r\n            <div className=\"flex items-center justify-center py-2\">\r\n              <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-400\"></div>\r\n              <span className=\"ml-2 text-gray-400 text-sm\">Applying changes...</span>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Footer */}\r\n        <div className=\"p-6 border-t border-gray-700\">\r\n          <div className=\"flex justify-between items-center\">\r\n            <p className=\"text-gray-400 text-xs\">\r\n              Settings are applied immediately\r\n            </p>\r\n            <button\r\n              onClick={onClose}\r\n              className=\"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors text-sm font-medium\"\r\n            >\r\n              Done\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Custom slider styles */}\r\n      <style jsx>{`\r\n        .slider::-webkit-slider-thumb {\r\n          appearance: none;\r\n          height: 20px;\r\n          width: 20px;\r\n          border-radius: 50%;\r\n          background: #3b82f6;\r\n          cursor: pointer;\r\n          border: 2px solid #1e40af;\r\n        }\r\n        \r\n        .slider::-moz-range-thumb {\r\n          height: 20px;\r\n          width: 20px;\r\n          border-radius: 50%;\r\n          background: #3b82f6;\r\n          cursor: pointer;\r\n          border: 2px solid #1e40af;\r\n        }\r\n      `}</style>\r\n\r\n      {/* Performance Settings Modal */}\r\n      <PerformanceSettings\r\n        isOpen={showPerformanceSettings}\r\n        onClose={() => setShowPerformanceSettings(false)}\r\n      />\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\game\\MobileSettingsButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\game\\PauseMenu.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`handleSettings` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\game\\PauseMenu.tsx:43:11\n  41 |           break;\n  42 |         case 's':\n> 43 |           handleSettings();\n     |           ^^^^^^^^^^^^^^ `handleSettings` accessed before it is declared\n  44 |           event.preventDefault();\n  45 |           break;\n  46 |         case 'q':\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\game\\PauseMenu.tsx:64:3\n  62 |   };\n  63 |\n> 64 |   const handleSettings = () => {\n     |   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 65 |     router.push('/configuracoes');\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 66 |   };\n     | ^^^^^ `handleSettings` is declared here\n  67 |\n  68 |   return (\n  69 |     <div className=\"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center animate-in fade-in duration-200\">","line":43,"column":11,"nodeType":null,"endLine":43,"endColumn":25},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`handleQuit` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\game\\PauseMenu.tsx:47:11\n  45 |           break;\n  46 |         case 'q':\n> 47 |           handleQuit();\n     |           ^^^^^^^^^^ `handleQuit` accessed before it is declared\n  48 |           event.preventDefault();\n  49 |           break;\n  50 |       }\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\game\\PauseMenu.tsx:59:3\n  57 |   if (!isVisible) return null;\n  58 |\n> 59 |   const handleQuit = () => {\n     |   ^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 60 |     onQuit();\n     | ^^^^^^^^^^^^^\n> 61 |     router.push('/');\n     | ^^^^^^^^^^^^^\n> 62 |   };\n     | ^^^^^ `handleQuit` is declared here\n  63 |\n  64 |   const handleSettings = () => {\n  65 |     router.push('/configuracoes');","line":47,"column":11,"nodeType":null,"endLine":47,"endColumn":21},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook React.useEffect has missing dependencies: 'handleQuit' and 'handleSettings'. Either include them or remove the dependency array.","line":55,"column":6,"nodeType":"ArrayExpression","endLine":55,"endColumn":64,"suggestions":[{"desc":"Update the dependencies array to be: [isVisible, showAudioSettings, showKeyboardHelp, onResume, handleSettings, handleQuit]","fix":{"range":[1574,1632],"text":"[isVisible, showAudioSettings, showKeyboardHelp, onResume, handleSettings, handleQuit]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React from 'react';\r\nimport { Play, Home, Settings, Volume2, Keyboard } from 'lucide-react';\r\nimport { AudioControls } from '../ui/AudioControls';\r\nimport { KeyboardHelp } from './KeyboardHelp';\r\nimport { useRouter } from 'next/navigation';\r\n\r\ninterface PauseMenuProps {\r\n  isVisible: boolean;\r\n  onResume: () => void;\r\n  onQuit: () => void;\r\n}\r\n\r\nexport const PauseMenu: React.FC<PauseMenuProps> = ({\r\n  isVisible,\r\n  onResume,\r\n  onQuit\r\n}) => {\r\n  const router = useRouter();\r\n  const [showAudioSettings, setShowAudioSettings] = React.useState(false);\r\n  const [showKeyboardHelp, setShowKeyboardHelp] = React.useState(false);\r\n\r\n  // Handle keyboard shortcuts for pause menu\r\n  React.useEffect(() => {\r\n    if (!isVisible || showAudioSettings || showKeyboardHelp) return;\r\n\r\n    const handleKeyDown = (event: KeyboardEvent) => {\r\n      switch (event.key.toLowerCase()) {\r\n        case 'escape':\r\n          onResume();\r\n          event.preventDefault();\r\n          break;\r\n        case 'a':\r\n          setShowAudioSettings(true);\r\n          event.preventDefault();\r\n          break;\r\n        case 'k':\r\n          setShowKeyboardHelp(true);\r\n          event.preventDefault();\r\n          break;\r\n        case 's':\r\n          handleSettings();\r\n          event.preventDefault();\r\n          break;\r\n        case 'q':\r\n          handleQuit();\r\n          event.preventDefault();\r\n          break;\r\n      }\r\n    };\r\n\r\n    document.addEventListener('keydown', handleKeyDown);\r\n    return () => document.removeEventListener('keydown', handleKeyDown);\r\n  }, [isVisible, showAudioSettings, showKeyboardHelp, onResume]);\r\n\r\n  if (!isVisible) return null;\r\n\r\n  const handleQuit = () => {\r\n    onQuit();\r\n    router.push('/');\r\n  };\r\n\r\n  const handleSettings = () => {\r\n    router.push('/configuracoes');\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center animate-in fade-in duration-200\">\r\n      <div className=\"bg-gray-900/95 backdrop-blur-sm rounded-xl p-6 border border-orange-500/30 max-w-md w-full mx-4 animate-in slide-in-from-bottom-4 duration-300\">\r\n        <div className=\"text-center mb-6\">\r\n          <div className=\"inline-flex items-center justify-center w-16 h-16 bg-orange-500/20 rounded-full mb-4\">\r\n            <div className=\"w-8 h-8 bg-orange-400 rounded-sm\"></div>\r\n          </div>\r\n          <h2 className=\"text-2xl font-bold text-orange-400 mb-2\">Jogo Pausado</h2>\r\n          <p className=\"text-gray-300 text-sm\">Pressione Esc para continuar ou escolha uma opo</p>\r\n        </div>\r\n\r\n        {!showAudioSettings ? (\r\n          <div className=\"space-y-4\">\r\n            {/* Quick Audio Controls */}\r\n            <div className=\"bg-gray-800/50 rounded-lg p-4\">\r\n              <AudioControls compact={true} showLabels={false} />\r\n            </div>\r\n\r\n            {/* Menu Buttons */}\r\n            <div className=\"space-y-3\">\r\n              <button\r\n                onClick={onResume}\r\n                className=\"w-full flex items-center justify-between px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors font-medium group\"\r\n              >\r\n                <div className=\"flex items-center gap-3\">\r\n                  <Play className=\"w-5 h-5\" />\r\n                  Continuar\r\n                </div>\r\n                <kbd className=\"px-2 py-1 bg-green-700/50 rounded text-xs opacity-70 group-hover:opacity-100\">\r\n                  Esc\r\n                </kbd>\r\n              </button>\r\n\r\n              <button\r\n                onClick={() => setShowAudioSettings(!showAudioSettings)}\r\n                className=\"w-full flex items-center justify-between px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors font-medium group\"\r\n              >\r\n                <div className=\"flex items-center gap-3\">\r\n                  <Volume2 className=\"w-5 h-5\" />\r\n                  Controlos de udio\r\n                </div>\r\n                <kbd className=\"px-2 py-1 bg-blue-700/50 rounded text-xs opacity-70 group-hover:opacity-100\">\r\n                  A\r\n                </kbd>\r\n              </button>\r\n\r\n              <button\r\n                onClick={() => setShowKeyboardHelp(true)}\r\n                className=\"w-full flex items-center justify-between px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors font-medium group\"\r\n              >\r\n                <div className=\"flex items-center gap-3\">\r\n                  <Keyboard className=\"w-5 h-5\" />\r\n                  Controlos do Teclado\r\n                </div>\r\n                <kbd className=\"px-2 py-1 bg-purple-700/50 rounded text-xs opacity-70 group-hover:opacity-100\">\r\n                  K\r\n                </kbd>\r\n              </button>\r\n\r\n              <button\r\n                onClick={handleSettings}\r\n                className=\"w-full flex items-center justify-between px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors font-medium group\"\r\n              >\r\n                <div className=\"flex items-center gap-3\">\r\n                  <Settings className=\"w-5 h-5\" />\r\n                  Configuraes\r\n                </div>\r\n                <kbd className=\"px-2 py-1 bg-gray-700/50 rounded text-xs opacity-70 group-hover:opacity-100\">\r\n                  S\r\n                </kbd>\r\n              </button>\r\n\r\n              <button\r\n                onClick={handleQuit}\r\n                className=\"w-full flex items-center justify-between px-6 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors font-medium group\"\r\n              >\r\n                <div className=\"flex items-center gap-3\">\r\n                  <Home className=\"w-5 h-5\" />\r\n                  Sair para Menu\r\n                </div>\r\n                <kbd className=\"px-2 py-1 bg-red-700/50 rounded text-xs opacity-70 group-hover:opacity-100\">\r\n                  Q\r\n                </kbd>\r\n              </button>\r\n            </div>\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-4\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <h3 className=\"text-lg font-bold text-orange-400\">Controlos de udio</h3>\r\n              <button\r\n                onClick={() => setShowAudioSettings(false)}\r\n                className=\"px-3 py-1 bg-gray-700 hover:bg-gray-600 text-white rounded text-sm transition-colors\"\r\n              >\r\n                Voltar\r\n              </button>\r\n            </div>\r\n            \r\n            <div className=\"max-h-64 overflow-y-auto\">\r\n              <AudioControls showLabels={false} />\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"mt-6 pt-4 border-t border-gray-700 text-center\">\r\n          <p className=\"text-xs text-gray-400\">\r\n            Pressione Esc para fechar este menu\r\n          </p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Keyboard Help Modal */}\r\n      <KeyboardHelp\r\n        isVisible={showKeyboardHelp}\r\n        onClose={() => setShowKeyboardHelp(false)}\r\n      />\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\game\\PerformanceMonitor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\game\\PerformanceWarning.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\game\\PerformanceWarning.tsx:24:5\n  22 |                       !dismissed;\n  23 |     \n> 24 |     setShowWarning(shouldShow);\n     |     ^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  25 |     \n  26 |     if (shouldShow) {\n  27 |       setRecommendations(performanceOptimizer.getOptimizationRecommendations());","line":24,"column":5,"nodeType":null,"endLine":24,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { usePerformanceStore } from '@/store/performanceStore';\r\nimport { performanceOptimizer } from '@/utils/performanceOptimizer';\r\n\r\ninterface PerformanceWarningProps {\r\n  className?: string;\r\n}\r\n\r\nexport function PerformanceWarning({ className = '' }: PerformanceWarningProps) {\r\n  const { metrics, settings } = usePerformanceStore();\r\n  const [showWarning, setShowWarning] = useState(false);\r\n  const [recommendations, setRecommendations] = useState<string[]>([]);\r\n  const [dismissed, setDismissed] = useState(false);\r\n\r\n  useEffect(() => {\r\n    // Show warning if performance is consistently low and auto-adjust is disabled\r\n    const shouldShow = metrics.isLowPerformance && \r\n                      metrics.averageFPS < 25 && \r\n                      !settings.autoAdjustQuality && \r\n                      !dismissed;\r\n    \r\n    setShowWarning(shouldShow);\r\n    \r\n    if (shouldShow) {\r\n      setRecommendations(performanceOptimizer.getOptimizationRecommendations());\r\n    }\r\n  }, [metrics.isLowPerformance, metrics.averageFPS, settings.autoAdjustQuality, dismissed]);\r\n\r\n  const handleApplyRecommended = () => {\r\n    const recommended = performanceOptimizer.getRecommendedSettings();\r\n    const { setGraphicsQuality, setFrameRateLimit, setLightweightMode, setAutoAdjustQuality } = usePerformanceStore.getState();\r\n    \r\n    setGraphicsQuality(recommended.quality);\r\n    setFrameRateLimit(recommended.frameRateLimit);\r\n    setLightweightMode(recommended.lightweightMode);\r\n    setAutoAdjustQuality(true);\r\n    \r\n    setDismissed(true);\r\n    setShowWarning(false);\r\n  };\r\n\r\n  const handleDismiss = () => {\r\n    setDismissed(true);\r\n    setShowWarning(false);\r\n  };\r\n\r\n  if (!showWarning) return null;\r\n\r\n  return (\r\n    <div className={`fixed top-20 left-1/2 transform -translate-x-1/2 z-40 max-w-md w-full mx-4 ${className}`}>\r\n      <div className=\"bg-red-900/90 backdrop-blur-md border border-red-600/50 rounded-lg p-4 shadow-lg\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between mb-3\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <div className=\"w-6 h-6 bg-red-500 rounded-full flex items-center justify-center\">\r\n              <svg className=\"w-4 h-4 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z\" />\r\n              </svg>\r\n            </div>\r\n            <h3 className=\"text-red-200 font-semibold\">Low Performance Detected</h3>\r\n          </div>\r\n          <button\r\n            onClick={handleDismiss}\r\n            className=\"text-red-300 hover:text-red-100 transition-colors\"\r\n            aria-label=\"Dismiss warning\"\r\n          >\r\n            <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n            </svg>\r\n          </button>\r\n        </div>\r\n\r\n        {/* Performance Info */}\r\n        <div className=\"mb-3 text-sm text-red-100\">\r\n          <div className=\"flex justify-between items-center mb-1\">\r\n            <span>Current FPS:</span>\r\n            <span className=\"font-medium\">{metrics.currentFPS.toFixed(1)}</span>\r\n          </div>\r\n          <div className=\"flex justify-between items-center\">\r\n            <span>Average FPS:</span>\r\n            <span className=\"font-medium\">{metrics.averageFPS.toFixed(1)}</span>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Recommendations */}\r\n        {recommendations.length > 0 && (\r\n          <div className=\"mb-4\">\r\n            <h4 className=\"text-red-200 font-medium text-sm mb-2\">Recommendations:</h4>\r\n            <ul className=\"text-xs text-red-100 space-y-1\">\r\n              {recommendations.slice(0, 3).map((rec, index) => (\r\n                <li key={index} className=\"flex items-start space-x-2\">\r\n                  <span className=\"text-red-400 mt-0.5\"></span>\r\n                  <span>{rec}</span>\r\n                </li>\r\n              ))}\r\n            </ul>\r\n          </div>\r\n        )}\r\n\r\n        {/* Actions */}\r\n        <div className=\"flex space-x-2\">\r\n          <button\r\n            onClick={handleApplyRecommended}\r\n            className=\"flex-1 bg-red-600 hover:bg-red-700 text-white text-sm font-medium py-2 px-3 rounded transition-colors\"\r\n          >\r\n            Apply Recommended\r\n          </button>\r\n          <button\r\n            onClick={handleDismiss}\r\n            className=\"px-3 py-2 text-red-200 hover:text-red-100 text-sm transition-colors\"\r\n          >\r\n            Dismiss\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\game\\PhaserGameComponent.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":27,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[916,919],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[916,919],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'applySettings', 'character', 'setGameStatus', 'updateLives', 'updateScore', and 'weapon'. Either include them or remove the dependency array.","line":227,"column":6,"nodeType":"ArrayExpression","endLine":227,"endColumn":39,"suggestions":[{"desc":"Update the dependencies array to be: [applySettings, character, difficulty, gameMode, onGameEnd, setGameStatus, updateLives, updateScore, weapon]","fix":{"range":[7754,7787],"text":"[applySettings, character, difficulty, gameMode, onGameEnd, setGameStatus, updateLives, updateScore, weapon]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useRef, useState } from 'react';\r\nimport type { Difficulty, GameMode } from '../../types';\r\nimport { useGameStore } from '../../store/gameStore';\r\nimport { useAudioStore } from '../../store/audioStore';\r\nimport { GameHUD } from './GameHUD';\r\nimport { TouchControls } from './TouchControls';\r\nimport { PauseMenu } from './PauseMenu';\r\n\r\ninterface PhaserGameComponentProps {\r\n  difficulty?: Difficulty;\r\n  gameMode?: GameMode;\r\n  onGameEnd?: (score: number, victory: boolean) => void;\r\n  className?: string;\r\n}\r\n\r\nexport function PhaserGameComponent({ \r\n  difficulty = 'easy',\r\n  gameMode = 'story',\r\n  onGameEnd,\r\n  className = '' \r\n}: PhaserGameComponentProps) {\r\n  const gameRef = useRef<Phaser.Game | null>(null);\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const destroyGameRef = useRef<((game: Phaser.Game) => void) | null>(null);\r\n  const gameSceneRef = useRef<any>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [isPaused, setIsPaused] = useState(false);\r\n  \r\n  // Keyboard state management (similar to touch controls)\r\n  const [keyboardState, setKeyboardState] = useState({\r\n    moveLeft: false,\r\n    moveRight: false,\r\n    jump: false,\r\n    crouch: false,\r\n    attack: false\r\n  });\r\n  \r\n  // Get game store data and actions for updating HUD\r\n  const { \r\n    character, \r\n    weapon, \r\n    updateLives, \r\n    updateScore, \r\n    setGameStatus \r\n  } = useGameStore();\r\n\r\n  // Get audio store for applying settings\r\n  const { applySettings } = useAudioStore();\r\n\r\n  // Browser-level keyboard event handling\r\n  useEffect(() => {\r\n    const handleKeyDown = (event: KeyboardEvent) => {\r\n      console.log('Browser keydown:', event.code);\r\n      \r\n      switch (event.code) {\r\n        case 'ArrowLeft':\r\n        case 'KeyA':\r\n          setKeyboardState(prev => ({ ...prev, moveLeft: true }));\r\n          event.preventDefault();\r\n          break;\r\n        case 'ArrowRight':\r\n        case 'KeyD':\r\n          setKeyboardState(prev => ({ ...prev, moveRight: true }));\r\n          event.preventDefault();\r\n          break;\r\n        case 'ArrowUp':\r\n        case 'KeyW':\r\n          setKeyboardState(prev => ({ ...prev, jump: true }));\r\n          event.preventDefault();\r\n          break;\r\n        case 'ArrowDown':\r\n        case 'KeyS':\r\n          setKeyboardState(prev => ({ ...prev, crouch: true }));\r\n          event.preventDefault();\r\n          break;\r\n        case 'Space':\r\n          setKeyboardState(prev => ({ ...prev, attack: true }));\r\n          event.preventDefault();\r\n          break;\r\n        case 'Escape':\r\n          // Handle pause toggle\r\n          if (gameSceneRef.current && typeof gameSceneRef.current.handlePause === 'function') {\r\n            gameSceneRef.current.handlePause();\r\n          }\r\n          event.preventDefault();\r\n          break;\r\n      }\r\n    };\r\n\r\n    const handleKeyUp = (event: KeyboardEvent) => {\r\n      console.log('Browser keyup:', event.code);\r\n      \r\n      switch (event.code) {\r\n        case 'ArrowLeft':\r\n        case 'KeyA':\r\n          setKeyboardState(prev => ({ ...prev, moveLeft: false }));\r\n          break;\r\n        case 'ArrowRight':\r\n        case 'KeyD':\r\n          setKeyboardState(prev => ({ ...prev, moveRight: false }));\r\n          break;\r\n        case 'ArrowUp':\r\n        case 'KeyW':\r\n          setKeyboardState(prev => ({ ...prev, jump: false }));\r\n          break;\r\n        case 'ArrowDown':\r\n        case 'KeyS':\r\n          setKeyboardState(prev => ({ ...prev, crouch: false }));\r\n          break;\r\n        case 'Space':\r\n          setKeyboardState(prev => ({ ...prev, attack: false }));\r\n          break;\r\n      }\r\n    };\r\n\r\n    // Add event listeners to document\r\n    document.addEventListener('keydown', handleKeyDown);\r\n    document.addEventListener('keyup', handleKeyUp);\r\n\r\n    // Cleanup\r\n    return () => {\r\n      document.removeEventListener('keydown', handleKeyDown);\r\n      document.removeEventListener('keyup', handleKeyUp);\r\n    };\r\n  }, []);\r\n\r\n  // Send keyboard state to game scene\r\n  useEffect(() => {\r\n    if (gameSceneRef.current && typeof gameSceneRef.current.setKeyboardControls === 'function') {\r\n      console.log('Sending keyboard state to game:', keyboardState);\r\n      gameSceneRef.current.setKeyboardControls(keyboardState);\r\n    }\r\n  }, [keyboardState]);\r\n\r\n  useEffect(() => {\r\n    if (!containerRef.current || typeof window === 'undefined') return;\r\n\r\n    // Dynamically import Phaser game functions only on client side\r\n    const initializeGame = async () => {\r\n      try {\r\n        const { createPhaserGame, destroyPhaserGame } = await import('../../game');\r\n        \r\n        // Create the Phaser game\r\n        gameRef.current = createPhaserGame({\r\n          parent: containerRef.current!\r\n        });\r\n\r\n        // Set game configuration in registry for the scene to access\r\n        gameRef.current.registry.set('difficulty', difficulty);\r\n        gameRef.current.registry.set('gameMode', gameMode);\r\n        gameRef.current.registry.set('character', character);\r\n        gameRef.current.registry.set('weapon', weapon);\r\n\r\n        // Set up game event listeners\r\n        gameRef.current.events.on('ready', () => {\r\n          setIsLoading(false);\r\n          setGameStatus('playing');\r\n          \r\n          // Ensure the game canvas has focus for keyboard input\r\n          if (gameRef.current?.canvas) {\r\n            gameRef.current.canvas.focus();\r\n            gameRef.current.canvas.setAttribute('tabindex', '0');\r\n          }\r\n        });\r\n\r\n        // Listen for player stats changes from the game scene\r\n        // We need to wait for the scene to be created, so we'll set up the listener after a short delay\r\n        setTimeout(() => {\r\n          const gameScene = gameRef.current?.scene.getScene('GameScene');\r\n          if (gameScene) {\r\n            // Store reference to game scene for touch controls\r\n            gameSceneRef.current = gameScene;\r\n            \r\n            gameScene.events.on('playerStatsChanged', (stats: { lives: number; score: number }) => {\r\n              console.log('Player stats changed:', stats);\r\n              updateLives(stats.lives);\r\n              updateScore(stats.score);\r\n            });\r\n\r\n            // Handle game end events\r\n            gameScene.events.on('gameEnd', (gameEndData: { score: number; victory: boolean; reason: string }) => {\r\n              console.log('Game end event received:', gameEndData);\r\n              setGameStatus('finished');\r\n              onGameEnd?.(gameEndData.score, gameEndData.victory);\r\n            });\r\n\r\n            // Handle pause state changes\r\n            gameScene.events.on('gamePauseToggled', (pauseData: { isPaused: boolean }) => {\r\n              console.log('Game pause toggled:', pauseData);\r\n              setIsPaused(pauseData.isPaused);\r\n              if (pauseData.isPaused) {\r\n                setGameStatus('paused');\r\n              } else {\r\n                setGameStatus('playing');\r\n              }\r\n            });\r\n          }\r\n        }, 100);\r\n\r\n        // Store destroyPhaserGame function for cleanup\r\n        destroyGameRef.current = destroyPhaserGame;\r\n\r\n        // Apply audio settings when game is ready\r\n        applySettings();\r\n\r\n      } catch (err) {\r\n        console.error('Failed to create Phaser game:', err);\r\n        setError('Failed to load game');\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    initializeGame();\r\n\r\n    // Cleanup function\r\n    return () => {\r\n      if (gameRef.current && destroyGameRef.current) {\r\n        destroyGameRef.current(gameRef.current);\r\n        gameRef.current = null;\r\n        destroyGameRef.current = null;\r\n        gameSceneRef.current = null;\r\n      }\r\n    };\r\n  }, [difficulty, gameMode, onGameEnd]);\r\n\r\n  // Touch control handlers\r\n  const handleTouchControl = (control: 'moveLeft' | 'moveRight' | 'jump' | 'crouch' | 'attack') => \r\n    (pressed: boolean) => {\r\n      if (gameSceneRef.current && typeof gameSceneRef.current.setTouchControl === 'function') {\r\n        gameSceneRef.current.setTouchControl(control, pressed);\r\n      }\r\n    };\r\n\r\n  // Pause menu handlers\r\n  const handleResume = () => {\r\n    if (gameSceneRef.current && typeof gameSceneRef.current.handlePause === 'function') {\r\n      gameSceneRef.current.handlePause();\r\n    }\r\n  };\r\n\r\n  const handleQuit = () => {\r\n    setGameStatus('menu');\r\n    // The parent component will handle navigation\r\n  };\r\n\r\n  if (error) {\r\n    return (\r\n      <div className={`flex items-center justify-center bg-gray-900 text-white ${className}`}>\r\n        <div className=\"text-center\">\r\n          <h3 className=\"text-xl font-bold mb-2\">Game Error</h3>\r\n          <p>{error}</p>\r\n          <button \r\n            onClick={() => window.location.reload()} \r\n            className=\"mt-4 px-4 py-2 bg-blue-600 hover:bg-blue-700 rounded\"\r\n          >\r\n            Reload Game\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={`relative ${className}`}>\r\n      {isLoading && (\r\n        <div className=\"absolute inset-0 flex items-center justify-center bg-gray-900 text-white z-10\">\r\n          <div className=\"text-center\">\r\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4\"></div>\r\n            <p>Loading game...</p>\r\n          </div>\r\n        </div>\r\n      )}\r\n      <div \r\n        ref={containerRef} \r\n        id=\"game-container\"\r\n        className=\"w-full h-full\"\r\n        onClick={() => {\r\n          // Ensure canvas has focus when clicked\r\n          if (gameRef.current?.canvas) {\r\n            console.log('Focusing canvas on click');\r\n            gameRef.current.canvas.focus();\r\n          }\r\n        }}\r\n        onMouseEnter={() => {\r\n          // Also focus on mouse enter\r\n          if (gameRef.current?.canvas) {\r\n            console.log('Focusing canvas on mouse enter');\r\n            gameRef.current.canvas.focus();\r\n          }\r\n        }}\r\n        tabIndex={0}\r\n      />\r\n      {/* Game HUD overlay */}\r\n      {!isLoading && !error && <GameHUD />}\r\n      \r\n      {/* Touch Controls overlay */}\r\n      {!isLoading && !error && (\r\n        <TouchControls\r\n          onMoveLeft={handleTouchControl('moveLeft')}\r\n          onMoveRight={handleTouchControl('moveRight')}\r\n          onJump={handleTouchControl('jump')}\r\n          onCrouch={handleTouchControl('crouch')}\r\n          onAttack={handleTouchControl('attack')}\r\n        />\r\n      )}\r\n\r\n      {/* Pause overlay - visual feedback when game is paused */}\r\n      {isPaused && (\r\n        <div className=\"absolute inset-0 bg-black/20 backdrop-blur-[1px] z-40 pointer-events-none\">\r\n          <div className=\"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2\">\r\n            <div className=\"bg-black/60 backdrop-blur-sm rounded-lg px-4 py-2 border border-orange-500/30\">\r\n              <p className=\"text-white text-sm font-medium\">PAUSADO</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Pause Menu overlay */}\r\n      <PauseMenu\r\n        isVisible={isPaused}\r\n        onResume={handleResume}\r\n        onQuit={handleQuit}\r\n      />\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\game\\ResponsiveGameCanvas.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\game\\TouchControls.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isPortrait' is assigned a value but never used.","line":31,"column":31,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":41},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'width' is assigned a value but never used.","line":31,"column":43,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":48},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'height' is assigned a value but never used.","line":31,"column":50,"nodeType":null,"messageId":"unusedVar","endLine":31,"endColumn":56},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\game\\TouchControls.tsx:58:5\n  56 |   useEffect(() => {\n  57 |     const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;\n> 58 |     setShowControls(isTouchDevice && (isMobile || isTablet));\n     |     ^^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  59 |     \n  60 |     // Optimize touch performance\n  61 |     if (isTouchDevice) {","line":58,"column":5,"nodeType":null,"endLine":58,"endColumn":20},{"ruleId":"react-hooks/preserve-manual-memoization","severity":2,"message":"Compilation Skipped: Existing memoization could not be preserved\n\nReact Compiler has skipped optimizing this component because the existing manual memoization could not be preserved. The inferred dependencies did not match the manually specified dependencies, which could cause the value to change more or less frequently than expected. The inferred dependency was `triggerActionHaptic`, but the source dependencies were [gestureState, onMoveLeft, onMoveRight, onJump, onCrouch]. Inferred different dependency than source.\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\game\\TouchControls.tsx:82:41\n   80 |   }, []);\n   81 |\n>  82 |   const handleGestureMove = useCallback((e: TouchEvent) => {\n      |                                         ^^^^^^^^^^^^^^^^^^^^\n>  83 |     if (e.touches.length === 1 && gestureState.isGesturing) {\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n>  84 |       const touch = e.touches[0];\n      \n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 139 |     }\n      | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 140 |   }, [gestureState, onMoveLeft, onMoveRight, onJump, onCrouch]);\n      | ^^^^ Could not preserve existing manual memoization\n  141 |\n  142 |   const handleGestureEnd = useCallback(() => {\n  143 |     setGestureState(prev => ({","line":82,"column":41,"nodeType":null,"endLine":140,"endColumn":4},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useCallback has a missing dependency: 'triggerActionHaptic'. Either include it or remove the dependency array.","line":140,"column":6,"nodeType":"ArrayExpression","endLine":140,"endColumn":63,"suggestions":[{"desc":"Update the dependencies array to be: [gestureState, triggerActionHaptic, onMoveLeft, onMoveRight, onJump, onCrouch]","fix":{"range":[4739,4796],"text":"[gestureState, triggerActionHaptic, onMoveLeft, onMoveRight, onJump, onCrouch]"}}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'hapticIntensity' is assigned a value but never used. Allowed unused args must match /^_/u.","line":179,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":179,"endColumn":20}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect, useState, useRef, useCallback } from 'react';\r\nimport { useResponsive } from '@/hooks/useResponsive';\r\nimport { useHapticFeedback } from '@/hooks/useHapticFeedback';\r\nimport { getDeviceInfo, getOptimalTouchControlLayout, optimizeTouchPerformance } from '@/utils/touchControlOptimization';\r\n\r\ninterface TouchControlsProps {\r\n  onMoveLeft: (pressed: boolean) => void;\r\n  onMoveRight: (pressed: boolean) => void;\r\n  onJump: (pressed: boolean) => void;\r\n  onCrouch: (pressed: boolean) => void;\r\n  onAttack: (pressed: boolean) => void;\r\n  className?: string;\r\n}\r\n\r\n// Visual feedback state for buttons\r\ninterface ButtonState {\r\n  isPressed: boolean;\r\n  pressStartTime: number;\r\n}\r\n\r\nexport function TouchControls({\r\n  onMoveLeft,\r\n  onMoveRight,\r\n  onJump,\r\n  onCrouch,\r\n  onAttack,\r\n  className = ''\r\n}: TouchControlsProps) {\r\n  const { isMobile, isTablet, isPortrait, width, height } = useResponsive();\r\n  const { triggerActionHaptic } = useHapticFeedback();\r\n  const [showControls, setShowControls] = useState(false);\r\n  \r\n  // Button state for visual feedback\r\n  const [buttonStates, setButtonStates] = useState<Record<string, ButtonState>>({\r\n    moveLeft: { isPressed: false, pressStartTime: 0 },\r\n    moveRight: { isPressed: false, pressStartTime: 0 },\r\n    jump: { isPressed: false, pressStartTime: 0 },\r\n    crouch: { isPressed: false, pressStartTime: 0 },\r\n    attack: { isPressed: false, pressStartTime: 0 }\r\n  });\r\n\r\n  // Gesture detection state\r\n  const gestureRef = useRef<HTMLDivElement>(null);\r\n  const [gestureState, setGestureState] = useState({\r\n    startX: 0,\r\n    startY: 0,\r\n    currentX: 0,\r\n    currentY: 0,\r\n    isGesturing: false,\r\n    gestureType: null as 'swipe-left' | 'swipe-right' | 'swipe-up' | 'swipe-down' | null\r\n  });\r\n\r\n  // Show controls on mobile/tablet with touch support\r\n  useEffect(() => {\r\n    const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0;\r\n    setShowControls(isTouchDevice && (isMobile || isTablet));\r\n    \r\n    // Optimize touch performance\r\n    if (isTouchDevice) {\r\n      optimizeTouchPerformance();\r\n    }\r\n  }, [isMobile, isTablet]);\r\n\r\n  // Gesture detection handlers\r\n  const handleGestureStart = useCallback((e: TouchEvent) => {\r\n    if (e.touches.length === 1) {\r\n      const touch = e.touches[0];\r\n      setGestureState(prev => ({\r\n        ...prev,\r\n        startX: touch.clientX,\r\n        startY: touch.clientY,\r\n        currentX: touch.clientX,\r\n        currentY: touch.clientY,\r\n        isGesturing: true,\r\n        gestureType: null\r\n      }));\r\n    }\r\n  }, []);\r\n\r\n  const handleGestureMove = useCallback((e: TouchEvent) => {\r\n    if (e.touches.length === 1 && gestureState.isGesturing) {\r\n      const touch = e.touches[0];\r\n      const deltaX = touch.clientX - gestureState.startX;\r\n      const deltaY = touch.clientY - gestureState.startY;\r\n      const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);\r\n      \r\n      // Only trigger gestures if movement is significant (> 50px)\r\n      if (distance > 50) {\r\n        const angle = Math.atan2(deltaY, deltaX) * 180 / Math.PI;\r\n        let gestureType: typeof gestureState.gestureType = null;\r\n        \r\n        // Determine gesture direction based on angle\r\n        if (angle >= -45 && angle <= 45) {\r\n          gestureType = 'swipe-right';\r\n        } else if (angle >= 135 || angle <= -135) {\r\n          gestureType = 'swipe-left';\r\n        } else if (angle >= 45 && angle <= 135) {\r\n          gestureType = 'swipe-down';\r\n        } else if (angle >= -135 && angle <= -45) {\r\n          gestureType = 'swipe-up';\r\n        }\r\n        \r\n        // Only update if gesture type changed\r\n        if (gestureType && gestureType !== gestureState.gestureType) {\r\n          setGestureState(prev => ({ ...prev, gestureType }));\r\n          \r\n          // Trigger haptic feedback for gesture\r\n          triggerActionHaptic('gesture');\r\n          \r\n          // Execute gesture action\r\n          switch (gestureType) {\r\n            case 'swipe-left':\r\n              onMoveLeft(true);\r\n              setTimeout(() => onMoveLeft(false), 200);\r\n              break;\r\n            case 'swipe-right':\r\n              onMoveRight(true);\r\n              setTimeout(() => onMoveRight(false), 200);\r\n              break;\r\n            case 'swipe-up':\r\n              onJump(true);\r\n              setTimeout(() => onJump(false), 100);\r\n              break;\r\n            case 'swipe-down':\r\n              onCrouch(true);\r\n              setTimeout(() => onCrouch(false), 200);\r\n              break;\r\n          }\r\n        }\r\n      }\r\n      \r\n      setGestureState(prev => ({\r\n        ...prev,\r\n        currentX: touch.clientX,\r\n        currentY: touch.clientY\r\n      }));\r\n    }\r\n  }, [gestureState, onMoveLeft, onMoveRight, onJump, onCrouch]);\r\n\r\n  const handleGestureEnd = useCallback(() => {\r\n    setGestureState(prev => ({\r\n      ...prev,\r\n      isGesturing: false,\r\n      gestureType: null\r\n    }));\r\n  }, []);\r\n\r\n  // Set up gesture detection\r\n  useEffect(() => {\r\n    const element = gestureRef.current;\r\n    if (!element || !showControls) return;\r\n\r\n    element.addEventListener('touchstart', handleGestureStart, { passive: false });\r\n    element.addEventListener('touchmove', handleGestureMove, { passive: false });\r\n    element.addEventListener('touchend', handleGestureEnd, { passive: false });\r\n\r\n    return () => {\r\n      element.removeEventListener('touchstart', handleGestureStart);\r\n      element.removeEventListener('touchmove', handleGestureMove);\r\n      element.removeEventListener('touchend', handleGestureEnd);\r\n    };\r\n  }, [showControls, handleGestureStart, handleGestureMove, handleGestureEnd]);\r\n\r\n  // Don't render touch controls on desktop\r\n  if (!showControls) {\r\n    return null;\r\n  }\r\n\r\n  // Get optimal layout using device optimization\r\n  const deviceInfo = getDeviceInfo();\r\n  const layout = getOptimalTouchControlLayout(deviceInfo);\r\n\r\n  // Enhanced touch event handlers with haptic and visual feedback\r\n  const createTouchHandlers = (\r\n    buttonKey: string, \r\n    callback: (pressed: boolean) => void,\r\n    hapticIntensity: 'light' | 'medium' | 'heavy' = 'light'\r\n  ) => {\r\n    const handleTouchStart = (e: React.TouchEvent) => {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      \r\n      // Trigger haptic feedback\r\n      triggerActionHaptic('button-press');\r\n      \r\n      // Update visual state\r\n      setButtonStates(prev => ({\r\n        ...prev,\r\n        [buttonKey]: { isPressed: true, pressStartTime: Date.now() }\r\n      }));\r\n      \r\n      callback(true);\r\n    };\r\n\r\n    const handleTouchEnd = (e: React.TouchEvent) => {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      \r\n      // Update visual state\r\n      setButtonStates(prev => ({\r\n        ...prev,\r\n        [buttonKey]: { isPressed: false, pressStartTime: 0 }\r\n      }));\r\n      \r\n      callback(false);\r\n    };\r\n\r\n    // Handle mouse events for testing on desktop\r\n    const handleMouseDown = (e: React.MouseEvent) => {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      \r\n      setButtonStates(prev => ({\r\n        ...prev,\r\n        [buttonKey]: { isPressed: true, pressStartTime: Date.now() }\r\n      }));\r\n      \r\n      callback(true);\r\n    };\r\n\r\n    const handleMouseUp = (e: React.MouseEvent) => {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      \r\n      setButtonStates(prev => ({\r\n        ...prev,\r\n        [buttonKey]: { isPressed: false, pressStartTime: 0 }\r\n      }));\r\n      \r\n      callback(false);\r\n    };\r\n\r\n    const handleMouseLeave = (e: React.MouseEvent) => {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      \r\n      setButtonStates(prev => ({\r\n        ...prev,\r\n        [buttonKey]: { isPressed: false, pressStartTime: 0 }\r\n      }));\r\n      \r\n      callback(false);\r\n    };\r\n\r\n    return {\r\n      onTouchStart: handleTouchStart,\r\n      onTouchEnd: handleTouchEnd,\r\n      onMouseDown: handleMouseDown,\r\n      onMouseUp: handleMouseUp,\r\n      onMouseLeave: handleMouseLeave\r\n    };\r\n  };\r\n\r\n  // Helper function to get button styling with visual feedback\r\n  const getButtonStyle = (buttonKey: string, baseColor: string = 'black', accentColor?: string) => {\r\n    const isPressed = buttonStates[buttonKey]?.isPressed;\r\n    const pressedScale = isPressed ? 'scale-95' : 'scale-100';\r\n    const pressedOpacity = isPressed ? 'opacity-90' : `opacity-${Math.round(layout.opacity * 100)}`;\r\n    const pressedShadow = isPressed ? 'shadow-inner' : 'shadow-lg';\r\n    const glowEffect = isPressed ? 'ring-2 ring-white/50' : '';\r\n    \r\n    if (accentColor) {\r\n      return `${layout.buttonSize} bg-${accentColor}-600/70 backdrop-blur-sm border-2 border-${accentColor}-400/50 ${layout.borderRadius} flex items-center justify-center text-white ${layout.fontSize.labels} font-bold hover:bg-${accentColor}-600/90 active:bg-${accentColor}-700/90 transition-all duration-150 select-none ${pressedScale} ${pressedOpacity} ${pressedShadow} ${glowEffect}`;\r\n    }\r\n    \r\n    return `${layout.buttonSize} bg-${baseColor}/50 backdrop-blur-sm border-2 border-white/30 ${layout.borderRadius} flex items-center justify-center text-white ${layout.fontSize.arrows} font-bold hover:bg-${baseColor}/70 active:bg-${baseColor}/80 transition-all duration-150 select-none ${pressedScale} ${pressedOpacity} ${pressedShadow} ${glowEffect}`;\r\n  };\r\n\r\n  return (\r\n    <div className={`fixed inset-0 pointer-events-none z-20 ${className}`} ref={gestureRef}>\r\n      {/* Gesture detection overlay */}\r\n      {gestureState.isGesturing && (\r\n        <div className=\"absolute inset-0 pointer-events-none\">\r\n          <div \r\n            className=\"absolute w-2 h-2 bg-white/60 rounded-full animate-pulse\"\r\n            style={{\r\n              left: gestureState.currentX - 4,\r\n              top: gestureState.currentY - 4,\r\n              transition: 'all 0.1s ease-out'\r\n            }}\r\n          />\r\n          {gestureState.gestureType && (\r\n            <div \r\n              className=\"absolute bg-black/60 backdrop-blur-sm rounded-lg px-3 py-1 text-white text-sm font-medium\"\r\n              style={{\r\n                left: gestureState.currentX + 10,\r\n                top: gestureState.currentY - 20\r\n              }}\r\n            >\r\n              {gestureState.gestureType.replace('-', ' ').toUpperCase()}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* Left side controls - Movement */}\r\n      <div className={`absolute ${layout.positioning.left} ${layout.positioning.bottom} flex flex-col ${layout.spacing} pointer-events-auto`} data-touch-control=\"movement\">\r\n        {/* Movement controls container */}\r\n        <div className={`flex ${layout.spacing}`}>\r\n          {/* Move Left Button */}\r\n          <button\r\n            className={getButtonStyle('moveLeft')}\r\n            {...createTouchHandlers('moveLeft', onMoveLeft, 'light')}\r\n            aria-label=\"Mover para a esquerda\"\r\n            data-touch-control\r\n            tabIndex={0}\r\n          >\r\n            \r\n          </button>\r\n\r\n          {/* Move Right Button */}\r\n          <button\r\n            className={getButtonStyle('moveRight')}\r\n            {...createTouchHandlers('moveRight', onMoveRight, 'light')}\r\n            aria-label=\"Mover para a direita\"\r\n            data-touch-control\r\n            tabIndex={0}\r\n          >\r\n            \r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Right side controls - Actions */}\r\n      <div className={`absolute ${layout.positioning.right} ${layout.positioning.bottom} flex flex-col ${layout.spacing} pointer-events-auto`} data-touch-control=\"actions\">\r\n        {/* Top row - Jump */}\r\n        <div className=\"flex justify-center\">\r\n          <button\r\n            className={getButtonStyle('jump').replace(layout.fontSize.arrows, layout.fontSize.labels)}\r\n            {...createTouchHandlers('jump', onJump, 'medium')}\r\n            aria-label=\"Saltar\"\r\n            data-touch-control\r\n            tabIndex={0}\r\n          >\r\n            <br/>SALTAR\r\n          </button>\r\n        </div>\r\n\r\n        {/* Bottom row - Crouch and Attack */}\r\n        <div className={`flex ${layout.spacing}`}>\r\n          {/* Crouch Button */}\r\n          <button\r\n            className={getButtonStyle('crouch').replace(layout.fontSize.arrows, layout.fontSize.labels)}\r\n            {...createTouchHandlers('crouch', onCrouch, 'light')}\r\n            aria-label=\"Agachar\"\r\n            data-touch-control\r\n            tabIndex={0}\r\n          >\r\n            <br/>AGACHAR\r\n          </button>\r\n\r\n          {/* Attack Button */}\r\n          <button\r\n            className={getButtonStyle('attack', 'red', 'red').replace(layout.fontSize.arrows, layout.fontSize.labels)}\r\n            {...createTouchHandlers('attack', onAttack, 'heavy')}\r\n            aria-label=\"Atacar\"\r\n            data-touch-control\r\n            tabIndex={0}\r\n          >\r\n            <br/>ATACAR\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Gesture help indicator (shows briefly on first load) */}\r\n      {showControls && (\r\n        <div className=\"absolute top-4 left-1/2 transform -translate-x-1/2 pointer-events-none\">\r\n          <div className=\"bg-black/60 backdrop-blur-sm rounded-lg px-3 py-2 text-white text-xs text-center animate-fade-in-out\">\r\n            <p>Swipe gestures:    </p>\r\n            <p className=\"text-gray-300\">Or use touch controls</p>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\game\\TouchControlsDemo.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\game\\__tests__\\GameHUD.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\game\\__tests__\\TouchControls.test.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":40,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[983,986],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[983,986],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { render, screen, fireEvent } from '@testing-library/react';\r\nimport { TouchControls } from '../TouchControls';\r\n\r\n// Mock window properties for mobile detection\r\nconst mockWindow = (isMobile: boolean) => {\r\n  Object.defineProperty(window, 'innerWidth', {\r\n    writable: true,\r\n    configurable: true,\r\n    value: isMobile ? 768 : 1200,\r\n  });\r\n  \r\n  Object.defineProperty(window, 'ontouchstart', {\r\n    writable: true,\r\n    configurable: true,\r\n    value: isMobile ? {} : undefined,\r\n  });\r\n  \r\n  Object.defineProperty(navigator, 'maxTouchPoints', {\r\n    writable: true,\r\n    configurable: true,\r\n    value: isMobile ? 5 : 0,\r\n  });\r\n};\r\n\r\ndescribe('TouchControls', () => {\r\n  const mockHandlers = {\r\n    onMoveLeft: jest.fn(),\r\n    onMoveRight: jest.fn(),\r\n    onJump: jest.fn(),\r\n    onCrouch: jest.fn(),\r\n    onAttack: jest.fn(),\r\n  };\r\n\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n  });\r\n\r\n  afterEach(() => {\r\n    // Reset window properties\r\n    delete (window as any).ontouchstart;\r\n    Object.defineProperty(navigator, 'maxTouchPoints', {\r\n      writable: true,\r\n      configurable: true,\r\n      value: 0,\r\n    });\r\n  });\r\n\r\n  it('should not render on desktop devices', () => {\r\n    mockWindow(false);\r\n    \r\n    const { container } = render(<TouchControls {...mockHandlers} />);\r\n    \r\n    expect(container.firstChild).toBeNull();\r\n  });\r\n\r\n  it('should render on mobile devices', () => {\r\n    mockWindow(true);\r\n    \r\n    render(<TouchControls {...mockHandlers} />);\r\n    \r\n    expect(screen.getByLabelText('Move Left')).toBeInTheDocument();\r\n    expect(screen.getByLabelText('Move Right')).toBeInTheDocument();\r\n    expect(screen.getByLabelText('Jump')).toBeInTheDocument();\r\n    expect(screen.getByLabelText('Crouch')).toBeInTheDocument();\r\n    expect(screen.getByLabelText('Attack')).toBeInTheDocument();\r\n  });\r\n\r\n  it('should handle touch events correctly', () => {\r\n    mockWindow(true);\r\n    \r\n    render(<TouchControls {...mockHandlers} />);\r\n    \r\n    const moveLeftButton = screen.getByLabelText('Move Left');\r\n    \r\n    // Test touch start\r\n    fireEvent.touchStart(moveLeftButton);\r\n    expect(mockHandlers.onMoveLeft).toHaveBeenCalledWith(true);\r\n    \r\n    // Test touch end\r\n    fireEvent.touchEnd(moveLeftButton);\r\n    expect(mockHandlers.onMoveLeft).toHaveBeenCalledWith(false);\r\n  });\r\n\r\n  it('should handle mouse events for testing', () => {\r\n    mockWindow(true);\r\n    \r\n    render(<TouchControls {...mockHandlers} />);\r\n    \r\n    const jumpButton = screen.getByLabelText('Jump');\r\n    \r\n    // Test mouse down\r\n    fireEvent.mouseDown(jumpButton);\r\n    expect(mockHandlers.onJump).toHaveBeenCalledWith(true);\r\n    \r\n    // Test mouse up\r\n    fireEvent.mouseUp(jumpButton);\r\n    expect(mockHandlers.onJump).toHaveBeenCalledWith(false);\r\n    \r\n    // Test mouse leave\r\n    fireEvent.mouseLeave(jumpButton);\r\n    expect(mockHandlers.onJump).toHaveBeenCalledWith(false);\r\n  });\r\n\r\n  it('should handle all control buttons', () => {\r\n    mockWindow(true);\r\n    \r\n    render(<TouchControls {...mockHandlers} />);\r\n    \r\n    // Test all buttons\r\n    fireEvent.touchStart(screen.getByLabelText('Move Left'));\r\n    expect(mockHandlers.onMoveLeft).toHaveBeenCalledWith(true);\r\n    \r\n    fireEvent.touchStart(screen.getByLabelText('Move Right'));\r\n    expect(mockHandlers.onMoveRight).toHaveBeenCalledWith(true);\r\n    \r\n    fireEvent.touchStart(screen.getByLabelText('Jump'));\r\n    expect(mockHandlers.onJump).toHaveBeenCalledWith(true);\r\n    \r\n    fireEvent.touchStart(screen.getByLabelText('Crouch'));\r\n    expect(mockHandlers.onCrouch).toHaveBeenCalledWith(true);\r\n    \r\n    fireEvent.touchStart(screen.getByLabelText('Attack'));\r\n    expect(mockHandlers.onAttack).toHaveBeenCalledWith(true);\r\n  });\r\n\r\n  it('should prevent default on touch events', () => {\r\n    mockWindow(true);\r\n    \r\n    render(<TouchControls {...mockHandlers} />);\r\n    \r\n    const moveLeftButton = screen.getByLabelText('Move Left');\r\n    \r\n    const touchStartEvent = new TouchEvent('touchstart', { bubbles: true });\r\n    const preventDefaultSpy = jest.spyOn(touchStartEvent, 'preventDefault');\r\n    \r\n    fireEvent(moveLeftButton, touchStartEvent);\r\n    \r\n    expect(preventDefaultSpy).toHaveBeenCalled();\r\n  });\r\n});","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\game\\__tests__\\TouchControlsEnhanced.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\game\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\layout\\ResponsiveContainer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\settings\\PerformanceSettings.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":29,"column":64,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":67,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[793,796],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[793,796],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { usePerformanceStore, type GraphicsQuality } from '@/store/performanceStore';\r\nimport { getDeviceCapabilities } from '@/utils/performance';\r\n\r\ninterface PerformanceSettingsProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  className?: string;\r\n}\r\n\r\nexport function PerformanceSettings({ isOpen, onClose, className = '' }: PerformanceSettingsProps) {\r\n  const {\r\n    settings,\r\n    metrics,\r\n    setGraphicsQuality,\r\n    setAutoAdjustQuality,\r\n    setParticleEffects,\r\n    setAnimations,\r\n    setShadows,\r\n    setAntialiasing,\r\n    setLightweightMode,\r\n    setFrameRateLimit,\r\n    applyQualityPreset,\r\n    resetToDefaults,\r\n  } = usePerformanceStore();\r\n\r\n  const [deviceCapabilities, setDeviceCapabilities] = useState<any>(null);\r\n  const [isApplying, setIsApplying] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      setDeviceCapabilities(getDeviceCapabilities());\r\n    }\r\n  }, [isOpen]);\r\n\r\n  const handleQualityChange = async (quality: GraphicsQuality) => {\r\n    setIsApplying(true);\r\n    try {\r\n      setGraphicsQuality(quality);\r\n      // Small delay to show the applying state\r\n      await new Promise(resolve => setTimeout(resolve, 300));\r\n    } finally {\r\n      setIsApplying(false);\r\n    }\r\n  };\r\n\r\n  const handlePresetApply = async (quality: GraphicsQuality) => {\r\n    setIsApplying(true);\r\n    try {\r\n      applyQualityPreset(quality);\r\n      await new Promise(resolve => setTimeout(resolve, 300));\r\n    } finally {\r\n      setIsApplying(false);\r\n    }\r\n  };\r\n\r\n  const getPerformanceColor = (fps: number): string => {\r\n    if (fps >= 50) return 'text-green-400';\r\n    if (fps >= 30) return 'text-yellow-400';\r\n    return 'text-red-400';\r\n  };\r\n\r\n  const getQualityColor = (quality: GraphicsQuality): string => {\r\n    switch (quality) {\r\n      case 'high': return 'text-green-400';\r\n      case 'medium': return 'text-yellow-400';\r\n      case 'low': return 'text-red-400';\r\n    }\r\n  };\r\n\r\n  const getDeviceRating = (): { rating: string; color: string; recommendation: GraphicsQuality } => {\r\n    if (!deviceCapabilities) return { rating: 'Unknown', color: 'text-gray-400', recommendation: 'medium' };\r\n    \r\n    const { deviceMemory, hardwareConcurrency, webGL2, maxTextureSize } = deviceCapabilities;\r\n    \r\n    // Calculate device score\r\n    let score = 0;\r\n    if (deviceMemory >= 8) score += 3;\r\n    else if (deviceMemory >= 4) score += 2;\r\n    else score += 1;\r\n    \r\n    if (hardwareConcurrency >= 8) score += 3;\r\n    else if (hardwareConcurrency >= 4) score += 2;\r\n    else score += 1;\r\n    \r\n    if (webGL2) score += 2;\r\n    else score += 1;\r\n    \r\n    if (maxTextureSize >= 4096) score += 2;\r\n    else if (maxTextureSize >= 2048) score += 1;\r\n    \r\n    if (score >= 8) {\r\n      return { rating: 'High-End', color: 'text-green-400', recommendation: 'high' };\r\n    } else if (score >= 6) {\r\n      return { rating: 'Mid-Range', color: 'text-yellow-400', recommendation: 'medium' };\r\n    } else {\r\n      return { rating: 'Low-End', color: 'text-red-400', recommendation: 'low' };\r\n    }\r\n  };\r\n\r\n  if (!isOpen) return null;\r\n\r\n  const deviceRating = getDeviceRating();\r\n\r\n  return (\r\n    <div className={`fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4 ${className}`}>\r\n      <div className=\"bg-gray-900/95 backdrop-blur-md rounded-xl border border-gray-700 max-w-2xl w-full max-h-[90vh] overflow-y-auto\">\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between p-6 border-b border-gray-700\">\r\n          <h2 className=\"text-xl font-bold text-white\">Performance Settings</h2>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"text-gray-400 hover:text-white transition-colors\"\r\n            aria-label=\"Close settings\"\r\n          >\r\n            <svg className=\"w-6 h-6\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n            </svg>\r\n          </button>\r\n        </div>\r\n\r\n        {/* Settings Content */}\r\n        <div className=\"p-6 space-y-6\">\r\n          {/* Performance Status */}\r\n          <div className=\"bg-gray-800/50 rounded-lg p-4\">\r\n            <h3 className=\"text-lg font-semibold text-white mb-3\">Performance Status</h3>\r\n            <div className=\"grid grid-cols-2 gap-4 text-sm\">\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex justify-between\">\r\n                  <span className=\"text-gray-300\">Current FPS:</span>\r\n                  <span className={`font-medium ${getPerformanceColor(metrics.currentFPS)}`}>\r\n                    {metrics.currentFPS.toFixed(1)}\r\n                  </span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span className=\"text-gray-300\">Average FPS:</span>\r\n                  <span className={`font-medium ${getPerformanceColor(metrics.averageFPS)}`}>\r\n                    {metrics.averageFPS.toFixed(1)}\r\n                  </span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span className=\"text-gray-300\">Frame Time:</span>\r\n                  <span className=\"text-white font-medium\">{metrics.frameTime.toFixed(2)}ms</span>\r\n                </div>\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex justify-between\">\r\n                  <span className=\"text-gray-300\">Quality:</span>\r\n                  <span className={`font-medium ${getQualityColor(settings.graphicsQuality)}`}>\r\n                    {settings.graphicsQuality.toUpperCase()}\r\n                  </span>\r\n                </div>\r\n                <div className=\"flex justify-between\">\r\n                  <span className=\"text-gray-300\">Auto Adjust:</span>\r\n                  <span className={`font-medium ${settings.autoAdjustQuality ? 'text-green-400' : 'text-gray-400'}`}>\r\n                    {settings.autoAdjustQuality ? 'ON' : 'OFF'}\r\n                  </span>\r\n                </div>\r\n                {metrics.memoryUsage && (\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-300\">Memory:</span>\r\n                    <span className=\"text-white font-medium\">{metrics.memoryUsage.toFixed(1)}MB</span>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Device Information */}\r\n          {deviceCapabilities && (\r\n            <div className=\"bg-gray-800/50 rounded-lg p-4\">\r\n              <h3 className=\"text-lg font-semibold text-white mb-3\">Device Information</h3>\r\n              <div className=\"grid grid-cols-2 gap-4 text-sm\">\r\n                <div className=\"space-y-2\">\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-300\">Device Rating:</span>\r\n                    <span className={`font-medium ${deviceRating.color}`}>\r\n                      {deviceRating.rating}\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-300\">Memory:</span>\r\n                    <span className=\"text-white font-medium\">{deviceCapabilities.deviceMemory}GB</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-300\">CPU Cores:</span>\r\n                    <span className=\"text-white font-medium\">{deviceCapabilities.hardwareConcurrency}</span>\r\n                  </div>\r\n                </div>\r\n                <div className=\"space-y-2\">\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-300\">WebGL 2:</span>\r\n                    <span className={`font-medium ${deviceCapabilities.webGL2 ? 'text-green-400' : 'text-red-400'}`}>\r\n                      {deviceCapabilities.webGL2 ? 'Supported' : 'Not Supported'}\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-300\">Max Texture:</span>\r\n                    <span className=\"text-white font-medium\">{deviceCapabilities.maxTextureSize}px</span>\r\n                  </div>\r\n                  <div className=\"flex justify-between\">\r\n                    <span className=\"text-gray-300\">Recommended:</span>\r\n                    <span className={`font-medium ${getQualityColor(deviceRating.recommendation)}`}>\r\n                      {deviceRating.recommendation.toUpperCase()}\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Graphics Quality Presets */}\r\n          <div className=\"space-y-3\">\r\n            <h3 className=\"text-lg font-semibold text-white\">Graphics Quality</h3>\r\n            <div className=\"grid grid-cols-3 gap-3\">\r\n              {(['low', 'medium', 'high'] as GraphicsQuality[]).map((quality) => (\r\n                <button\r\n                  key={quality}\r\n                  onClick={() => handleQualityChange(quality)}\r\n                  disabled={isApplying}\r\n                  className={`p-3 rounded-lg border-2 transition-all ${\r\n                    settings.graphicsQuality === quality\r\n                      ? 'border-blue-500 bg-blue-500/20'\r\n                      : 'border-gray-600 bg-gray-800/50 hover:border-gray-500'\r\n                  } ${isApplying ? 'opacity-50' : ''}`}\r\n                >\r\n                  <div className=\"text-center\">\r\n                    <div className={`font-medium ${getQualityColor(quality)}`}>\r\n                      {quality.toUpperCase()}\r\n                    </div>\r\n                    <div className=\"text-xs text-gray-400 mt-1\">\r\n                      {quality === 'low' && 'Best Performance'}\r\n                      {quality === 'medium' && 'Balanced'}\r\n                      {quality === 'high' && 'Best Quality'}\r\n                    </div>\r\n                  </div>\r\n                </button>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Auto Quality Adjustment */}\r\n          <div className=\"space-y-3\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <h4 className=\"text-white font-medium\">Auto Quality Adjustment</h4>\r\n                <p className=\"text-gray-400 text-sm\">Automatically adjust quality based on performance</p>\r\n              </div>\r\n              <button\r\n                onClick={() => setAutoAdjustQuality(!settings.autoAdjustQuality)}\r\n                disabled={isApplying}\r\n                className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${\r\n                  settings.autoAdjustQuality ? 'bg-blue-600' : 'bg-gray-600'\r\n                } ${isApplying ? 'opacity-50' : ''}`}\r\n              >\r\n                <span\r\n                  className={`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${\r\n                    settings.autoAdjustQuality ? 'translate-x-6' : 'translate-x-1'\r\n                  }`}\r\n                />\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Individual Settings */}\r\n          <div className=\"space-y-4\">\r\n            <h3 className=\"text-lg font-semibold text-white\">Individual Settings</h3>\r\n            \r\n            {/* Particle Effects */}\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <h4 className=\"text-white font-medium\">Particle Effects</h4>\r\n                <p className=\"text-gray-400 text-sm\">Visual effects like explosions and sparks</p>\r\n              </div>\r\n              <button\r\n                onClick={() => setParticleEffects(!settings.particleEffects)}\r\n                disabled={isApplying || settings.lightweightMode}\r\n                className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${\r\n                  settings.particleEffects && !settings.lightweightMode ? 'bg-blue-600' : 'bg-gray-600'\r\n                } ${(isApplying || settings.lightweightMode) ? 'opacity-50' : ''}`}\r\n              >\r\n                <span\r\n                  className={`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${\r\n                    settings.particleEffects && !settings.lightweightMode ? 'translate-x-6' : 'translate-x-1'\r\n                  }`}\r\n                />\r\n              </button>\r\n            </div>\r\n\r\n            {/* Animations */}\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <h4 className=\"text-white font-medium\">Animations</h4>\r\n                <p className=\"text-gray-400 text-sm\">Character and enemy animations</p>\r\n              </div>\r\n              <button\r\n                onClick={() => setAnimations(!settings.animations)}\r\n                disabled={isApplying || settings.lightweightMode}\r\n                className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${\r\n                  settings.animations && !settings.lightweightMode ? 'bg-blue-600' : 'bg-gray-600'\r\n                } ${(isApplying || settings.lightweightMode) ? 'opacity-50' : ''}`}\r\n              >\r\n                <span\r\n                  className={`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${\r\n                    settings.animations && !settings.lightweightMode ? 'translate-x-6' : 'translate-x-1'\r\n                  }`}\r\n                />\r\n              </button>\r\n            </div>\r\n\r\n            {/* Shadows */}\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <h4 className=\"text-white font-medium\">Shadows</h4>\r\n                <p className=\"text-gray-400 text-sm\">Character and object shadows</p>\r\n              </div>\r\n              <button\r\n                onClick={() => setShadows(!settings.shadows)}\r\n                disabled={isApplying || settings.lightweightMode}\r\n                className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${\r\n                  settings.shadows && !settings.lightweightMode ? 'bg-blue-600' : 'bg-gray-600'\r\n                } ${(isApplying || settings.lightweightMode) ? 'opacity-50' : ''}`}\r\n              >\r\n                <span\r\n                  className={`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${\r\n                    settings.shadows && !settings.lightweightMode ? 'translate-x-6' : 'translate-x-1'\r\n                  }`}\r\n                />\r\n              </button>\r\n            </div>\r\n\r\n            {/* Antialiasing */}\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <h4 className=\"text-white font-medium\">Antialiasing</h4>\r\n                <p className=\"text-gray-400 text-sm\">Smooth edges (requires restart)</p>\r\n              </div>\r\n              <button\r\n                onClick={() => setAntialiasing(!settings.antialiasing)}\r\n                disabled={isApplying || settings.lightweightMode}\r\n                className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${\r\n                  settings.antialiasing && !settings.lightweightMode ? 'bg-blue-600' : 'bg-gray-600'\r\n                } ${(isApplying || settings.lightweightMode) ? 'opacity-50' : ''}`}\r\n              >\r\n                <span\r\n                  className={`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${\r\n                    settings.antialiasing && !settings.lightweightMode ? 'translate-x-6' : 'translate-x-1'\r\n                  }`}\r\n                />\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Frame Rate Limit */}\r\n          <div className=\"space-y-3\">\r\n            <div>\r\n              <h4 className=\"text-white font-medium\">Frame Rate Limit</h4>\r\n              <p className=\"text-gray-400 text-sm\">Limit FPS to save battery (0 = no limit)</p>\r\n            </div>\r\n            <div className=\"space-y-2\">\r\n              <input\r\n                type=\"range\"\r\n                min=\"0\"\r\n                max=\"60\"\r\n                step=\"15\"\r\n                value={settings.frameRateLimit}\r\n                onChange={(e) => setFrameRateLimit(parseInt(e.target.value))}\r\n                disabled={isApplying}\r\n                className=\"w-full h-2 bg-gray-600 rounded-lg appearance-none cursor-pointer slider\"\r\n              />\r\n              <div className=\"flex justify-between text-xs text-gray-400\">\r\n                <span>No Limit</span>\r\n                <span>15 FPS</span>\r\n                <span>30 FPS</span>\r\n                <span>45 FPS</span>\r\n                <span>60 FPS</span>\r\n              </div>\r\n              <div className=\"text-center text-white font-medium\">\r\n                {settings.frameRateLimit === 0 ? 'No Limit' : `${settings.frameRateLimit} FPS`}\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Lightweight Mode */}\r\n          <div className=\"space-y-3\">\r\n            <div className=\"bg-yellow-900/20 border border-yellow-600/30 rounded-lg p-4\">\r\n              <div className=\"flex items-center justify-between mb-2\">\r\n                <div>\r\n                  <h4 className=\"text-yellow-400 font-medium\">Lightweight Mode</h4>\r\n                  <p className=\"text-gray-400 text-sm\">Optimized for older devices (overrides other settings)</p>\r\n                </div>\r\n                <button\r\n                  onClick={() => setLightweightMode(!settings.lightweightMode)}\r\n                  disabled={isApplying}\r\n                  className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${\r\n                    settings.lightweightMode ? 'bg-yellow-600' : 'bg-gray-600'\r\n                  } ${isApplying ? 'opacity-50' : ''}`}\r\n                >\r\n                  <span\r\n                    className={`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${\r\n                      settings.lightweightMode ? 'translate-x-6' : 'translate-x-1'\r\n                    }`}\r\n                  />\r\n                </button>\r\n              </div>\r\n              {settings.lightweightMode && (\r\n                <div className=\"text-xs text-yellow-300\">\r\n                   Lightweight mode disables particles, animations, shadows, and antialiasing for maximum performance.\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Apply Status */}\r\n          {isApplying && (\r\n            <div className=\"flex items-center justify-center py-2\">\r\n              <div className=\"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-400\"></div>\r\n              <span className=\"ml-2 text-gray-400 text-sm\">Applying changes...</span>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Footer */}\r\n        <div className=\"p-6 border-t border-gray-700\">\r\n          <div className=\"flex justify-between items-center\">\r\n            <button\r\n              onClick={resetToDefaults}\r\n              disabled={isApplying}\r\n              className=\"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors text-sm font-medium disabled:opacity-50\"\r\n            >\r\n              Reset to Defaults\r\n            </button>\r\n            <div className=\"flex space-x-3\">\r\n              {deviceRating.recommendation !== settings.graphicsQuality && (\r\n                <button\r\n                  onClick={() => handlePresetApply(deviceRating.recommendation)}\r\n                  disabled={isApplying}\r\n                  className=\"px-4 py-2 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg transition-colors text-sm font-medium disabled:opacity-50\"\r\n                >\r\n                  Use Recommended\r\n                </button>\r\n              )}\r\n              <button\r\n                onClick={onClose}\r\n                className=\"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors text-sm font-medium\"\r\n              >\r\n                Done\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Custom slider styles */}\r\n      <style jsx>{`\r\n        .slider::-webkit-slider-thumb {\r\n          appearance: none;\r\n          height: 20px;\r\n          width: 20px;\r\n          border-radius: 50%;\r\n          background: #3b82f6;\r\n          cursor: pointer;\r\n          border: 2px solid #1e40af;\r\n        }\r\n        \r\n        .slider::-moz-range-thumb {\r\n          height: 20px;\r\n          width: 20px;\r\n          border-radius: 50%;\r\n          background: #3b82f6;\r\n          cursor: pointer;\r\n          border: 2px solid #1e40af;\r\n        }\r\n      `}</style>\r\n    </div>\r\n  );\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\AccessibilitySettings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\AudioControls.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\AudioSubtitles.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'display' is assigned a value but never used.","line":20,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":20,"endColumn":18},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\AudioSubtitles.tsx:26:5\n  24 |\n  25 |   useEffect(() => {\n> 26 |     setIsClient(true);\n     |     ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  27 |   }, []);\n  28 |\n  29 |   useEffect(() => {","line":26,"column":5,"nodeType":null,"endLine":26,"endColumn":16},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'isClient'. Either include it or remove the dependency array.","line":115,"column":6,"nodeType":"ArrayExpression","endLine":115,"endColumn":21,"suggestions":[{"desc":"Update the dependencies array to be: [isClient, showSubtitles]","fix":{"range":[3487,3502],"text":"[isClient, showSubtitles]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { useSettingsStore } from '@/store/settingsStore';\r\n\r\ninterface AudioEvent {\r\n  id: string;\r\n  type: 'jump' | 'damage' | 'item_collect' | 'weapon_attack' | 'background_music';\r\n  message: string;\r\n  timestamp: number;\r\n  duration: number;\r\n  priority: 'low' | 'medium' | 'high';\r\n}\r\n\r\ninterface AudioSubtitlesProps {\r\n  className?: string;\r\n}\r\n\r\nexport const AudioSubtitles: React.FC<AudioSubtitlesProps> = ({ className = '' }) => {\r\n  const { display } = useSettingsStore();\r\n  const [activeEvents, setActiveEvents] = useState<AudioEvent[]>([]);\r\n  const [showSubtitles, setShowSubtitles] = useState(false);\r\n  const [isClient, setIsClient] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setIsClient(true);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!isClient) return;\r\n    // Listen for audio events from the game\r\n    const handleAudioEvent = (event: CustomEvent<{\r\n      type: AudioEvent['type'];\r\n      weaponType?: string;\r\n    }>) => {\r\n      if (!showSubtitles) return;\r\n\r\n      const { type, weaponType } = event.detail;\r\n      const timestamp = Date.now();\r\n      const id = `${type}-${timestamp}`;\r\n\r\n      let message = '';\r\n      let duration = 2000;\r\n      let priority: AudioEvent['priority'] = 'medium';\r\n\r\n      switch (type) {\r\n        case 'jump':\r\n          message = ' Salto';\r\n          duration = 1000;\r\n          priority = 'low';\r\n          break;\r\n        case 'damage':\r\n          message = ' Dano recebido';\r\n          duration = 2000;\r\n          priority = 'high';\r\n          break;\r\n        case 'item_collect':\r\n          message = ' Item coletado';\r\n          duration = 1500;\r\n          priority = 'medium';\r\n          break;\r\n        case 'weapon_attack':\r\n          const weaponMessages = {\r\n            katana: ' Katana - Corte',\r\n            laser: ' Laser - Disparo',\r\n            baseball: ' Taco - Pancada',\r\n            bazooka: ' Bazuca - Exploso'\r\n          };\r\n          message = weaponMessages[weaponType as keyof typeof weaponMessages] || ' Ataque';\r\n          duration = 1500;\r\n          priority = 'medium';\r\n          break;\r\n        case 'background_music':\r\n          message = ' Msica ambiente';\r\n          duration = 3000;\r\n          priority = 'low';\r\n          break;\r\n        default:\r\n          return;\r\n      }\r\n\r\n      const audioEvent: AudioEvent = {\r\n        id,\r\n        type,\r\n        message,\r\n        timestamp,\r\n        duration,\r\n        priority\r\n      };\r\n\r\n      setActiveEvents(prev => {\r\n        // Remove old events of the same type to prevent spam\r\n        const filtered = prev.filter(e => e.type !== type);\r\n        return [...filtered, audioEvent].slice(-3); // Keep max 3 events\r\n      });\r\n\r\n      // Remove event after duration\r\n      setTimeout(() => {\r\n        setActiveEvents(prev => prev.filter(e => e.id !== id));\r\n      }, duration);\r\n    };\r\n\r\n    // Listen for subtitle toggle events\r\n    const handleSubtitleToggle = (event: CustomEvent<{ enabled: boolean }>) => {\r\n      setShowSubtitles(event.detail.enabled);\r\n    };\r\n\r\n    window.addEventListener('audioEvent', handleAudioEvent as EventListener);\r\n    window.addEventListener('toggleSubtitles', handleSubtitleToggle as EventListener);\r\n\r\n    return () => {\r\n      window.removeEventListener('audioEvent', handleAudioEvent as EventListener);\r\n      window.removeEventListener('toggleSubtitles', handleSubtitleToggle as EventListener);\r\n    };\r\n  }, [showSubtitles]);\r\n\r\n  if (!isClient || !showSubtitles || activeEvents.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div \r\n      className={`fixed bottom-20 left-4 right-4 z-30 pointer-events-none ${className}`}\r\n      role=\"log\"\r\n      aria-live=\"polite\"\r\n      aria-label=\"Legendas de udio\"\r\n    >\r\n      <div className=\"space-y-2\">\r\n        {activeEvents\r\n          .sort((a, b) => {\r\n            // Sort by priority (high first) then by timestamp (newest first)\r\n            const priorityOrder = { high: 3, medium: 2, low: 1 };\r\n            const priorityDiff = priorityOrder[b.priority] - priorityOrder[a.priority];\r\n            return priorityDiff !== 0 ? priorityDiff : b.timestamp - a.timestamp;\r\n          })\r\n          .map((event) => (\r\n            <div\r\n              key={event.id}\r\n              className={`\r\n                inline-block px-3 py-2 rounded-lg text-sm font-medium\r\n                backdrop-blur-sm border transition-all duration-300\r\n                ${event.priority === 'high' \r\n                  ? 'bg-red-900/80 border-red-500/50 text-red-100' \r\n                  : event.priority === 'medium'\r\n                  ? 'bg-orange-900/80 border-orange-500/50 text-orange-100'\r\n                  : 'bg-gray-900/80 border-gray-500/50 text-gray-100'\r\n                }\r\n                animate-in slide-in-from-bottom-2 fade-in duration-300\r\n              `}\r\n              style={{\r\n                animation: `fadeInUp 0.3s ease-out, fadeOut 0.3s ease-in ${event.duration - 300}ms forwards`\r\n              }}\r\n            >\r\n              {event.message}\r\n            </div>\r\n          ))}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Hook for managing audio subtitles\r\nexport const useAudioSubtitles = () => {\r\n  const triggerAudioEvent = (\r\n    type: AudioEvent['type'], \r\n    weaponType?: string\r\n  ) => {\r\n    window.dispatchEvent(new CustomEvent('audioEvent', {\r\n      detail: { type, weaponType }\r\n    }));\r\n  };\r\n\r\n  const toggleSubtitles = (enabled: boolean) => {\r\n    window.dispatchEvent(new CustomEvent('toggleSubtitles', {\r\n      detail: { enabled }\r\n    }));\r\n  };\r\n\r\n  return {\r\n    triggerAudioEvent,\r\n    toggleSubtitles\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\ColorblindFilters.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\ColorblindFilters.tsx:9:5\n   7 |\n   8 |   useEffect(() => {\n>  9 |     setIsClient(true);\n     |     ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  10 |   }, []);\n  11 |\n  12 |   if (!isClient) {","line":9,"column":5,"nodeType":null,"endLine":9,"endColumn":16}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\n\r\nexport const ColorblindFilters: React.FC = () => {\r\n  const [isClient, setIsClient] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setIsClient(true);\r\n  }, []);\r\n\r\n  if (!isClient) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <svg style={{ position: 'absolute', width: 0, height: 0 }} aria-hidden=\"true\">\r\n      <defs>\r\n        {/* Protanopia Filter (Red-blind) */}\r\n        <filter id=\"protanopia-filter\">\r\n          <feColorMatrix\r\n            type=\"matrix\"\r\n            values=\"0.567 0.433 0.000 0.000 0.000 0.558 0.442 0.000 0.000 0.000 0.000 0.242 0.758 0.000 0.000 0.000 0.000 0.000 1.000 0.000\"\r\n          />\r\n        </filter>\r\n\r\n        {/* Deuteranopia Filter (Green-blind) */}\r\n        <filter id=\"deuteranopia-filter\">\r\n          <feColorMatrix\r\n            type=\"matrix\"\r\n            values=\"0.625 0.375 0.000 0.000 0.000 0.700 0.300 0.000 0.000 0.000 0.000 0.300 0.700 0.000 0.000 0.000 0.000 0.000 1.000 0.000\"\r\n          />\r\n        </filter>\r\n\r\n        {/* Tritanopia Filter (Blue-blind) */}\r\n        <filter id=\"tritanopia-filter\">\r\n          <feColorMatrix\r\n            type=\"matrix\"\r\n            values=\"0.950 0.050 0.000 0.000 0.000 0.000 0.433 0.567 0.000 0.000 0.000 0.475 0.525 0.000 0.000 0.000 0.000 0.000 1.000 0.000\"\r\n          />\r\n        </filter>\r\n      </defs>\r\n    </svg>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\ColorblindFriendlyUI.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\ComprehensiveAccessibilitySettings.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Palette' is defined but never used.","line":15,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":10},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Settings' is defined but never used.","line":16,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":11}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useState } from 'react';\r\nimport { AccessibilitySettings } from './AccessibilitySettings';\r\nimport { SimplifiedControls } from './SimplifiedControls';\r\nimport { AudioSubtitles, useAudioSubtitles } from './AudioSubtitles';\r\nimport { VisualAudioIndicators, useVisualAudioIndicators } from './VisualAudioIndicators';\r\nimport { ColorblindFriendlyUI, useColorblindFriendly } from './ColorblindFriendlyUI';\r\nimport { useSettingsStore } from '@/store/settingsStore';\r\nimport { \r\n  Accessibility, \r\n  Eye, \r\n  Hand, \r\n  Volume2, \r\n  Palette, \r\n  Settings,\r\n  TestTube,\r\n  Info\r\n} from 'lucide-react';\r\n\r\ninterface ComprehensiveAccessibilitySettingsProps {\r\n  className?: string;\r\n}\r\n\r\nexport const ComprehensiveAccessibilitySettings: React.FC<ComprehensiveAccessibilitySettingsProps> = ({\r\n  className = ''\r\n}) => {\r\n  const { display } = useSettingsStore();\r\n  const [activeTab, setActiveTab] = useState<'visual' | 'motor' | 'audio' | 'test'>('visual');\r\n  const { toggleSubtitles } = useAudioSubtitles();\r\n  const { toggleVisualIndicators } = useVisualAudioIndicators();\r\n  const { isEnabled: colorblindUIEnabled } = useColorblindFriendly();\r\n\r\n  // Test functions for accessibility features\r\n  const testAudioSubtitles = () => {\r\n    const events = ['jump', 'damage', 'item_collect', 'weapon_attack'];\r\n    const weapons = ['katana', 'laser', 'baseball', 'bazooka'];\r\n    \r\n    events.forEach((event, index) => {\r\n      setTimeout(() => {\r\n        window.dispatchEvent(new CustomEvent('audioEvent', {\r\n          detail: { \r\n            type: event, \r\n            weaponType: event === 'weapon_attack' ? weapons[index % weapons.length] : undefined \r\n          }\r\n        }));\r\n      }, index * 1000);\r\n    });\r\n  };\r\n\r\n  const testVisualIndicators = () => {\r\n    const indicators = [\r\n      { type: 'jump', intensity: 'low' },\r\n      { type: 'damage', intensity: 'high' },\r\n      { type: 'item_collect', intensity: 'medium' },\r\n      { type: 'weapon_attack', intensity: 'medium', weaponType: 'bazooka' },\r\n      { type: 'low_health', intensity: 'high' }\r\n    ];\r\n\r\n    indicators.forEach((indicator, index) => {\r\n      setTimeout(() => {\r\n        window.dispatchEvent(new CustomEvent('visualIndicator', {\r\n          detail: {\r\n            ...indicator,\r\n            position: { \r\n              x: 20 + (index * 15), \r\n              y: 30 + (index * 10) \r\n            }\r\n          }\r\n        }));\r\n      }, index * 800);\r\n    });\r\n  };\r\n\r\n  const tabs = [\r\n    {\r\n      id: 'visual' as const,\r\n      name: 'Visual',\r\n      icon: <Eye className=\"w-4 h-4\" />,\r\n      description: 'Configuraes visuais e de contraste'\r\n    },\r\n    {\r\n      id: 'motor' as const,\r\n      name: 'Motor',\r\n      icon: <Hand className=\"w-4 h-4\" />,\r\n      description: 'Controlos simplificados e adaptados'\r\n    },\r\n    {\r\n      id: 'audio' as const,\r\n      name: 'udio',\r\n      icon: <Volume2 className=\"w-4 h-4\" />,\r\n      description: 'Legendas e indicadores visuais de udio'\r\n    },\r\n    {\r\n      id: 'test' as const,\r\n      name: 'Teste',\r\n      icon: <TestTube className=\"w-4 h-4\" />,\r\n      description: 'Testar funcionalidades de acessibilidade'\r\n    }\r\n  ];\r\n\r\n  return (\r\n    <ColorblindFriendlyUI className={className}>\r\n      <div className=\"space-y-6\">\r\n        {/* Header */}\r\n        <div className=\"text-center\">\r\n          <h2 className=\"text-2xl font-bold text-orange-400 mb-2 flex items-center justify-center gap-2\">\r\n            <Accessibility className=\"w-6 h-6\" />\r\n            Configuraes de Acessibilidade\r\n          </h2>\r\n          <p className=\"text-gray-300\">\r\n            Personalize o jogo para uma experincia mais acessvel e confortvel\r\n          </p>\r\n        </div>\r\n\r\n        {/* Tab Navigation */}\r\n        <div className=\"flex flex-wrap gap-2 p-1 bg-gray-800/50 rounded-lg\">\r\n          {tabs.map((tab) => (\r\n            <button\r\n              key={tab.id}\r\n              onClick={() => setActiveTab(tab.id)}\r\n              className={`\r\n                flex-1 min-w-[120px] px-4 py-3 rounded-lg transition-all\r\n                flex items-center justify-center gap-2 text-sm font-medium\r\n                ${activeTab === tab.id\r\n                  ? 'bg-orange-600 text-white shadow-lg'\r\n                  : 'text-gray-300 hover:text-white hover:bg-gray-700/50'\r\n                }\r\n              `}\r\n              aria-selected={activeTab === tab.id}\r\n              role=\"tab\"\r\n              title={tab.description}\r\n            >\r\n              {tab.icon}\r\n              <span className=\"hidden sm:inline\">{tab.name}</span>\r\n            </button>\r\n          ))}\r\n        </div>\r\n\r\n        {/* Tab Content */}\r\n        <div className=\"min-h-[400px]\">\r\n          {activeTab === 'visual' && (\r\n            <div className=\"space-y-6\">\r\n              <AccessibilitySettings showLabels={false} />\r\n              \r\n              {/* Visual accessibility info */}\r\n              <div className=\"bg-blue-900/30 rounded-lg p-4 border border-blue-500/30\">\r\n                <h4 className=\"text-blue-300 font-medium mb-2 flex items-center gap-2\">\r\n                  <Info className=\"w-4 h-4\" />\r\n                  Sobre as Configuraes Visuais\r\n                </h4>\r\n                <ul className=\"text-sm text-blue-200 space-y-1\">\r\n                  <li> <strong>Alto Contraste:</strong> Melhora a visibilidade de texto e elementos</li>\r\n                  <li> <strong>Reduzir Movimento:</strong> Reduz animaes que podem causar desconforto</li>\r\n                  <li> <strong>Filtros de Daltonismo:</strong> Ajusta cores para diferentes tipos de daltonismo</li>\r\n                  <li> <strong>Interface Amigvel:</strong> Adiciona smbolos e padres alm de cores</li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {activeTab === 'motor' && (\r\n            <div className=\"space-y-6\">\r\n              <SimplifiedControls />\r\n              \r\n              {/* Motor accessibility info */}\r\n              <div className=\"bg-green-900/30 rounded-lg p-4 border border-green-500/30\">\r\n                <h4 className=\"text-green-300 font-medium mb-2 flex items-center gap-2\">\r\n                  <Info className=\"w-4 h-4\" />\r\n                  Sobre os Controlos Adaptados\r\n                </h4>\r\n                <ul className=\"text-sm text-green-200 space-y-1\">\r\n                  <li> <strong>Uma Mo:</strong> Todos os controlos numa rea pequena do teclado</li>\r\n                  <li> <strong>Controlos Mnimos:</strong> Apenas 3-4 teclas essenciais</li>\r\n                  <li> <strong>Teclas Grandes:</strong> Usa teclas maiores e mais fceis de encontrar</li>\r\n                  <li> Todos os esquemas mantm a funcionalidade completa do jogo</li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {activeTab === 'audio' && (\r\n            <div className=\"space-y-6\">\r\n              {/* Audio accessibility controls */}\r\n              <div className=\"bg-gray-800/50 rounded-lg p-4\">\r\n                <h3 className=\"text-lg font-semibold text-orange-400 mb-4 flex items-center gap-2\">\r\n                  <Volume2 className=\"w-5 h-5\" />\r\n                  Acessibilidade de udio\r\n                </h3>\r\n\r\n                <div className=\"space-y-4\">\r\n                  {/* Audio Subtitles Control */}\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <label className=\"text-white font-medium\">\r\n                        Legendas de udio\r\n                      </label>\r\n                      <p className=\"text-sm text-gray-400\">\r\n                        Mostra texto descritivo para eventos sonoros do jogo\r\n                      </p>\r\n                    </div>\r\n                    <button\r\n                      onClick={() => toggleSubtitles(!display.audioSubtitles)}\r\n                      className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-4 focus:ring-orange-500/50 ${\r\n                        display.audioSubtitles ? 'bg-orange-600' : 'bg-gray-600'\r\n                      }`}\r\n                      role=\"switch\"\r\n                      aria-checked={display.audioSubtitles}\r\n                    >\r\n                      <span\r\n                        className={`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${\r\n                          display.audioSubtitles ? 'translate-x-6' : 'translate-x-1'\r\n                        }`}\r\n                      />\r\n                    </button>\r\n                  </div>\r\n\r\n                  {/* Visual Indicators Control */}\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div>\r\n                      <label className=\"text-white font-medium\">\r\n                        Indicadores Visuais\r\n                      </label>\r\n                      <p className=\"text-sm text-gray-400\">\r\n                        Efeitos visuais que representam sons importantes\r\n                      </p>\r\n                    </div>\r\n                    <button\r\n                      onClick={() => toggleVisualIndicators(!display.visualAudioIndicators)}\r\n                      className={`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-4 focus:ring-orange-500/50 ${\r\n                        display.visualAudioIndicators ? 'bg-orange-600' : 'bg-gray-600'\r\n                      }`}\r\n                      role=\"switch\"\r\n                      aria-checked={display.visualAudioIndicators}\r\n                    >\r\n                      <span\r\n                        className={`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${\r\n                          display.visualAudioIndicators ? 'translate-x-6' : 'translate-x-1'\r\n                        }`}\r\n                      />\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Audio accessibility info */}\r\n              <div className=\"bg-purple-900/30 rounded-lg p-4 border border-purple-500/30\">\r\n                <h4 className=\"text-purple-300 font-medium mb-2 flex items-center gap-2\">\r\n                  <Info className=\"w-4 h-4\" />\r\n                  Sobre a Acessibilidade de udio\r\n                </h4>\r\n                <ul className=\"text-sm text-purple-200 space-y-1\">\r\n                  <li> <strong>Legendas:</strong> Texto que aparece quando h eventos sonoros</li>\r\n                  <li> <strong>Indicadores Visuais:</strong> Efeitos de luz e cor para sons importantes</li>\r\n                  <li> <strong>Prioridade:</strong> Eventos importantes (dano) tm indicadores mais visveis</li>\r\n                  <li> Ideal para utilizadores com deficincia auditiva</li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {activeTab === 'test' && (\r\n            <div className=\"space-y-6\">\r\n              <div className=\"bg-gray-800/50 rounded-lg p-4\">\r\n                <h3 className=\"text-lg font-semibold text-orange-400 mb-4 flex items-center gap-2\">\r\n                  <TestTube className=\"w-5 h-5\" />\r\n                  Testar Funcionalidades\r\n                </h3>\r\n\r\n                <div className=\"grid gap-4 md:grid-cols-2\">\r\n                  {/* Test Audio Subtitles */}\r\n                  <div className=\"bg-gray-700/50 rounded-lg p-4\">\r\n                    <h4 className=\"text-white font-medium mb-2\">Legendas de udio</h4>\r\n                    <p className=\"text-sm text-gray-300 mb-3\">\r\n                      Testa a exibio de legendas para diferentes eventos sonoros\r\n                    </p>\r\n                    <button\r\n                      onClick={testAudioSubtitles}\r\n                      className=\"w-full px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors\"\r\n                      disabled={!display.audioSubtitles}\r\n                    >\r\n                      {display.audioSubtitles ? 'Testar Legendas' : 'Ative as Legendas Primeiro'}\r\n                    </button>\r\n                  </div>\r\n\r\n                  {/* Test Visual Indicators */}\r\n                  <div className=\"bg-gray-700/50 rounded-lg p-4\">\r\n                    <h4 className=\"text-white font-medium mb-2\">Indicadores Visuais</h4>\r\n                    <p className=\"text-sm text-gray-300 mb-3\">\r\n                      Testa os efeitos visuais para eventos de udio\r\n                    </p>\r\n                    <button\r\n                      onClick={testVisualIndicators}\r\n                      className=\"w-full px-4 py-2 bg-green-600 hover:bg-green-500 text-white rounded-lg transition-colors\"\r\n                      disabled={!display.visualAudioIndicators}\r\n                    >\r\n                      {display.visualAudioIndicators ? 'Testar Indicadores' : 'Ative os Indicadores Primeiro'}\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Current Settings Summary */}\r\n                <div className=\"mt-6 bg-gray-700/30 rounded-lg p-4\">\r\n                  <h4 className=\"text-white font-medium mb-3\">Configuraes Atuais</h4>\r\n                  <div className=\"grid gap-2 text-sm\">\r\n                    <div className=\"flex justify-between\">\r\n                      <span className=\"text-gray-300\">Alto Contraste:</span>\r\n                      <span className={display.highContrast ? 'text-green-400' : 'text-red-400'}>\r\n                        {display.highContrast ? 'Ativo' : 'Inativo'}\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"flex justify-between\">\r\n                      <span className=\"text-gray-300\">Reduzir Movimento:</span>\r\n                      <span className={display.reducedMotion ? 'text-green-400' : 'text-red-400'}>\r\n                        {display.reducedMotion ? 'Ativo' : 'Inativo'}\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"flex justify-between\">\r\n                      <span className=\"text-gray-300\">Filtro de Daltonismo:</span>\r\n                      <span className=\"text-blue-400\">\r\n                        {display.colorBlindMode === 'none' ? 'Nenhum' : display.colorBlindMode}\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"flex justify-between\">\r\n                      <span className=\"text-gray-300\">Legendas de udio:</span>\r\n                      <span className={display.audioSubtitles ? 'text-green-400' : 'text-red-400'}>\r\n                        {display.audioSubtitles ? 'Ativo' : 'Inativo'}\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"flex justify-between\">\r\n                      <span className=\"text-gray-300\">Indicadores Visuais:</span>\r\n                      <span className={display.visualAudioIndicators ? 'text-green-400' : 'text-red-400'}>\r\n                        {display.visualAudioIndicators ? 'Ativo' : 'Inativo'}\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"flex justify-between\">\r\n                      <span className=\"text-gray-300\">Interface Amigvel:</span>\r\n                      <span className={colorblindUIEnabled ? 'text-green-400' : 'text-red-400'}>\r\n                        {colorblindUIEnabled ? 'Ativo' : 'Inativo'}\r\n                      </span>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Audio Subtitles Component */}\r\n        {display.audioSubtitles && <AudioSubtitles />}\r\n        \r\n        {/* Visual Audio Indicators Component */}\r\n        {display.visualAudioIndicators && <VisualAudioIndicators />}\r\n      </div>\r\n    </ColorblindFriendlyUI>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\ControlCustomization.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\DifficultyPreview.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\DisplaySettings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\Footer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\GameButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\GameSettings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\GlobalScreenReaderAnnouncer.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\GlobalScreenReaderAnnouncer.tsx:14:5\n  12 |\n  13 |   useEffect(() => {\n> 14 |     setIsClient(true);\n     |     ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  15 |   }, []);\n  16 |\n  17 |   useEffect(() => {","line":14,"column":5,"nodeType":null,"endLine":14,"endColumn":16}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { ScreenReaderAnnouncer } from './ScreenReaderAnnouncer';\r\n\r\nexport const GlobalScreenReaderAnnouncer: React.FC = () => {\r\n  const [announcement, setAnnouncement] = useState<{\r\n    message: string;\r\n    priority: 'polite' | 'assertive';\r\n  } | null>(null);\r\n  const [isClient, setIsClient] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setIsClient(true);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!isClient) return;\r\n    \r\n    const handleAnnouncement = (event: CustomEvent) => {\r\n      const { message, priority = 'polite' } = event.detail;\r\n      setAnnouncement({ message, priority });\r\n    };\r\n\r\n    // Listen for screen reader announcement events\r\n    window.addEventListener('screenReaderAnnounce', handleAnnouncement as EventListener);\r\n\r\n    return () => {\r\n      window.removeEventListener('screenReaderAnnounce', handleAnnouncement as EventListener);\r\n    };\r\n  }, [isClient]);\r\n\r\n  return isClient && announcement ? (\r\n    <ScreenReaderAnnouncer \r\n      message={announcement.message} \r\n      priority={announcement.priority}\r\n      clearAfter={3000}\r\n    />\r\n  ) : null;\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\HalloweenBackground.tsx","messages":[{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\HalloweenBackground.tsx:34:28\n  32 |                 className=\"absolute w-2 h-2 bg-orange-400 rounded-full opacity-30 floating\"\n  33 |                 style={{\n> 34 |                   left: `${Math.random() * 100}%`,\n     |                            ^^^^^^^^^^^^^ Cannot call impure function\n  35 |                   top: `${Math.random() * 100}%`,\n  36 |                   animationDelay: `${Math.random() * 3}s`,\n  37 |                   animationDuration: `${3 + Math.random() * 2}s`","line":34,"column":28,"nodeType":null,"endLine":34,"endColumn":41},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\HalloweenBackground.tsx:35:27\n  33 |                 style={{\n  34 |                   left: `${Math.random() * 100}%`,\n> 35 |                   top: `${Math.random() * 100}%`,\n     |                           ^^^^^^^^^^^^^ Cannot call impure function\n  36 |                   animationDelay: `${Math.random() * 3}s`,\n  37 |                   animationDuration: `${3 + Math.random() * 2}s`\n  38 |                 }}","line":35,"column":27,"nodeType":null,"endLine":35,"endColumn":40},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\HalloweenBackground.tsx:36:38\n  34 |                   left: `${Math.random() * 100}%`,\n  35 |                   top: `${Math.random() * 100}%`,\n> 36 |                   animationDelay: `${Math.random() * 3}s`,\n     |                                      ^^^^^^^^^^^^^ Cannot call impure function\n  37 |                   animationDuration: `${3 + Math.random() * 2}s`\n  38 |                 }}\n  39 |               />","line":36,"column":38,"nodeType":null,"endLine":36,"endColumn":51},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\HalloweenBackground.tsx:37:45\n  35 |                   top: `${Math.random() * 100}%`,\n  36 |                   animationDelay: `${Math.random() * 3}s`,\n> 37 |                   animationDuration: `${3 + Math.random() * 2}s`\n     |                                             ^^^^^^^^^^^^^ Cannot call impure function\n  38 |                 }}\n  39 |               />\n  40 |             ))}","line":37,"column":45,"nodeType":null,"endLine":37,"endColumn":58},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\HalloweenBackground.tsx:59:28\n  57 |                 className=\"absolute w-1 h-1 bg-yellow-200 rounded-full pulsing\"\n  58 |                 style={{\n> 59 |                   left: `${Math.random() * 100}%`,\n     |                            ^^^^^^^^^^^^^ Cannot call impure function\n  60 |                   top: `${Math.random() * 50}%`,\n  61 |                   animationDelay: `${Math.random() * 2}s`\n  62 |                 }}","line":59,"column":28,"nodeType":null,"endLine":59,"endColumn":41},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\HalloweenBackground.tsx:60:27\n  58 |                 style={{\n  59 |                   left: `${Math.random() * 100}%`,\n> 60 |                   top: `${Math.random() * 50}%`,\n     |                           ^^^^^^^^^^^^^ Cannot call impure function\n  61 |                   animationDelay: `${Math.random() * 2}s`\n  62 |                 }}\n  63 |               />","line":60,"column":27,"nodeType":null,"endLine":60,"endColumn":40},{"ruleId":"react-hooks/purity","severity":2,"message":"Error: Cannot call impure function during render\n\n`Math.random` is an impure function. Calling an impure function can produce unstable results that update unpredictably when the component happens to re-render. (https://react.dev/reference/rules/components-and-hooks-must-be-pure#components-and-hooks-must-be-idempotent).\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\HalloweenBackground.tsx:61:38\n  59 |                   left: `${Math.random() * 100}%`,\n  60 |                   top: `${Math.random() * 50}%`,\n> 61 |                   animationDelay: `${Math.random() * 2}s`\n     |                                      ^^^^^^^^^^^^^ Cannot call impure function\n  62 |                 }}\n  63 |               />\n  64 |             ))}","line":61,"column":38,"nodeType":null,"endLine":61,"endColumn":51}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React from 'react';\r\n\r\ninterface HalloweenBackgroundProps {\r\n  children: React.ReactNode;\r\n  variant?: 'default' | 'game' | 'menu';\r\n  showParticles?: boolean;\r\n}\r\n\r\nexport const HalloweenBackground: React.FC<HalloweenBackgroundProps> = ({\r\n  children,\r\n  variant = 'default',\r\n  showParticles = true\r\n}) => {\r\n  const backgroundClasses = {\r\n    default: 'halloween-bg halloween-bg-pattern',\r\n    game: 'bg-gradient-to-b from-purple-900 via-black to-purple-900',\r\n    menu: 'halloween-bg-orange halloween-bg-pattern'\r\n  };\r\n\r\n  return (\r\n    <div className={`min-h-screen relative overflow-hidden ${backgroundClasses[variant]}`}>\r\n      {/* Animated background elements */}\r\n      {showParticles && (\r\n        <>\r\n          {/* Floating particles */}\r\n          <div className=\"absolute inset-0 pointer-events-none\">\r\n            {Array.from({ length: 20 }).map((_, i) => (\r\n              <div\r\n                key={i}\r\n                className=\"absolute w-2 h-2 bg-orange-400 rounded-full opacity-30 floating\"\r\n                style={{\r\n                  left: `${Math.random() * 100}%`,\r\n                  top: `${Math.random() * 100}%`,\r\n                  animationDelay: `${Math.random() * 3}s`,\r\n                  animationDuration: `${3 + Math.random() * 2}s`\r\n                }}\r\n              />\r\n            ))}\r\n          </div>\r\n\r\n          {/* Spooky shadows */}\r\n          <div className=\"absolute inset-0 pointer-events-none\">\r\n            <div className=\"absolute top-10 left-10 w-32 h-32 bg-black opacity-20 rounded-full blur-xl floating\" />\r\n            <div className=\"absolute top-32 right-20 w-24 h-24 bg-purple-900 opacity-30 rounded-full blur-lg floating\" \r\n                 style={{ animationDelay: '1s' }} />\r\n            <div className=\"absolute bottom-20 left-1/3 w-40 h-20 bg-orange-900 opacity-25 rounded-full blur-2xl floating\" \r\n                 style={{ animationDelay: '2s' }} />\r\n          </div>\r\n\r\n          {/* Twinkling stars */}\r\n          <div className=\"absolute inset-0 pointer-events-none\">\r\n            {Array.from({ length: 15 }).map((_, i) => (\r\n              <div\r\n                key={`star-${i}`}\r\n                className=\"absolute w-1 h-1 bg-yellow-200 rounded-full pulsing\"\r\n                style={{\r\n                  left: `${Math.random() * 100}%`,\r\n                  top: `${Math.random() * 50}%`,\r\n                  animationDelay: `${Math.random() * 2}s`\r\n                }}\r\n              />\r\n            ))}\r\n          </div>\r\n        </>\r\n      )}\r\n\r\n      {/* Content */}\r\n      <div className=\"relative z-10\">\r\n        {children}\r\n      </div>\r\n    </div>\r\n  );\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\HalloweenCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\HalloweenIcons.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\KeyboardNavigationHelper.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\KeyboardNavigationHelper.tsx:21:5\n  19 |   // Ensure we're on the client side before accessing localStorage\n  20 |   useEffect(() => {\n> 21 |     setIsClient(true);\n     |     ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  22 |   }, []);\n  23 |\n  24 |   useEffect(() => {","line":21,"column":5,"nodeType":null,"endLine":21,"endColumn":16}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { Keyboard, X } from 'lucide-react';\r\n\r\ninterface KeyboardNavigationHelperProps {\r\n  showOnFirstVisit?: boolean;\r\n  className?: string;\r\n}\r\n\r\nexport const KeyboardNavigationHelper: React.FC<KeyboardNavigationHelperProps> = ({\r\n  showOnFirstVisit = true,\r\n  className = ''\r\n}) => {\r\n  const [isVisible, setIsVisible] = useState(false);\r\n  const [hasBeenShown, setHasBeenShown] = useState(false);\r\n  const [isClient, setIsClient] = useState(false);\r\n\r\n  // Ensure we're on the client side before accessing localStorage\r\n  useEffect(() => {\r\n    setIsClient(true);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!isClient) return;\r\n    \r\n    // Check if user has seen the helper before\r\n    const hasSeenHelper = localStorage.getItem('keyboard-navigation-helper-seen');\r\n    \r\n    if (showOnFirstVisit && !hasSeenHelper) {\r\n      // Show after a short delay\r\n      const timer = setTimeout(() => {\r\n        setIsVisible(true);\r\n        setHasBeenShown(true);\r\n      }, 2000);\r\n\r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [showOnFirstVisit, isClient]);\r\n\r\n  useEffect(() => {\r\n    if (!isClient) return;\r\n    \r\n    // Listen for keyboard events to show helper\r\n    const handleKeyDown = (event: KeyboardEvent) => {\r\n      // Show helper when Tab is pressed (keyboard navigation)\r\n      if (event.key === 'Tab' && !hasBeenShown) {\r\n        setIsVisible(true);\r\n        setHasBeenShown(true);\r\n      }\r\n    };\r\n\r\n    document.addEventListener('keydown', handleKeyDown);\r\n    return () => document.removeEventListener('keydown', handleKeyDown);\r\n  }, [hasBeenShown, isClient]);\r\n\r\n  const handleClose = () => {\r\n    setIsVisible(false);\r\n    if (isClient) {\r\n      localStorage.setItem('keyboard-navigation-helper-seen', 'true');\r\n    }\r\n  };\r\n\r\n  const handleDontShowAgain = () => {\r\n    handleClose();\r\n    if (isClient) {\r\n      localStorage.setItem('keyboard-navigation-helper-dismissed', 'true');\r\n    }\r\n  };\r\n\r\n  if (!isClient || !isVisible) return null;\r\n\r\n  return (\r\n    <div className={`fixed bottom-4 right-4 z-50 max-w-sm ${className}`}>\r\n      <div className=\"bg-gray-900/95 backdrop-blur-sm border border-orange-500/30 rounded-lg p-4 shadow-xl animate-in slide-in-from-bottom-4 duration-300\">\r\n        <div className=\"flex items-start gap-3\">\r\n          <div className=\"flex-shrink-0\">\r\n            <div className=\"w-8 h-8 bg-orange-500/20 rounded-full flex items-center justify-center\">\r\n              <Keyboard className=\"w-4 h-4 text-orange-400\" />\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"flex-1 min-w-0\">\r\n            <h3 className=\"text-sm font-semibold text-orange-400 mb-1\">\r\n              Navegao por Teclado\r\n            </h3>\r\n            <div className=\"text-xs text-gray-300 space-y-1\">\r\n              <p> Use <kbd className=\"px-1 py-0.5 bg-gray-700 rounded text-xs\">Tab</kbd> para navegar</p>\r\n              <p> <kbd className=\"px-1 py-0.5 bg-gray-700 rounded text-xs\">Enter</kbd>/<kbd className=\"px-1 py-0.5 bg-gray-700 rounded text-xs\">Espao</kbd> para ativar</p>\r\n              <p> <kbd className=\"px-1 py-0.5 bg-gray-700 rounded text-xs\">Esc</kbd> para pausar no jogo</p>\r\n            </div>\r\n          </div>\r\n          \r\n          <button\r\n            onClick={handleClose}\r\n            className=\"flex-shrink-0 p-1 text-gray-400 hover:text-white transition-colors focus:outline-none focus:ring-2 focus:ring-orange-500/50 rounded\"\r\n            aria-label=\"Fechar ajuda de navegao\"\r\n          >\r\n            <X className=\"w-4 h-4\" />\r\n          </button>\r\n        </div>\r\n        \r\n        <div className=\"mt-3 flex gap-2\">\r\n          <button\r\n            onClick={handleClose}\r\n            className=\"flex-1 px-3 py-1.5 bg-orange-600 hover:bg-orange-700 focus:bg-orange-700 text-white text-xs rounded transition-colors focus:outline-none focus:ring-2 focus:ring-orange-500/50\"\r\n          >\r\n            Entendi\r\n          </button>\r\n          <button\r\n            onClick={handleDontShowAgain}\r\n            className=\"px-3 py-1.5 bg-gray-700 hover:bg-gray-600 focus:bg-gray-600 text-white text-xs rounded transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500/50\"\r\n          >\r\n            No mostrar novamente\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Hook to manually trigger the keyboard navigation helper\r\nexport const useKeyboardNavigationHelper = () => {\r\n  const [isVisible, setIsVisible] = useState(false);\r\n\r\n  const show = () => setIsVisible(true);\r\n  const hide = () => setIsVisible(false);\r\n\r\n  return {\r\n    isVisible,\r\n    show,\r\n    hide,\r\n    KeyboardNavigationHelper: () => (\r\n      <KeyboardNavigationHelper \r\n        showOnFirstVisit={false} \r\n        className={isVisible ? '' : 'hidden'} \r\n      />\r\n    )\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\LoadingSpinner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\ScreenReaderAnnouncer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\SettingsImportExport.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\ShareButton.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'shareErr' is defined but never used.","line":53,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":53,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":89,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":89,"endColumn":21}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState } from 'react';\r\nimport { apiClient } from '@/lib/api';\r\nimport { ShareableScore } from '@/types';\r\n\r\ninterface ShareButtonProps {\r\n  scoreId: string;\r\n  className?: string;\r\n  size?: 'sm' | 'md' | 'lg';\r\n  variant?: 'primary' | 'secondary' | 'ghost';\r\n}\r\n\r\nexport default function ShareButton({ \r\n  scoreId, \r\n  className = '', \r\n  size = 'md',\r\n  variant = 'primary'\r\n}: ShareButtonProps) {\r\n  const [isSharing, setIsSharing] = useState(false);\r\n  const [shareError, setShareError] = useState<string | null>(null);\r\n\r\n  const sizeClasses = {\r\n    sm: 'p-1 text-sm',\r\n    md: 'p-2 text-base',\r\n    lg: 'p-3 text-lg'\r\n  };\r\n\r\n  const variantClasses = {\r\n    primary: 'bg-blue-600 hover:bg-blue-700 text-white',\r\n    secondary: 'bg-gray-600 hover:bg-gray-700 text-white',\r\n    ghost: 'bg-transparent hover:bg-gray-700/50 text-gray-300 hover:text-white border border-gray-600'\r\n  };\r\n\r\n  const handleShare = async () => {\r\n    if (isSharing) return;\r\n\r\n    try {\r\n      setIsSharing(true);\r\n      setShareError(null);\r\n\r\n      const shareData = await apiClient.generateShareableScore(scoreId);\r\n      \r\n      // Try native sharing first (mobile devices)\r\n      if (navigator.share) {\r\n        try {\r\n          await navigator.share({\r\n            title: 'O Caminho Assombrado da Escola',\r\n            text: shareData.shareText,\r\n            url: shareData.shareUrl,\r\n          });\r\n          return;\r\n        } catch (shareErr) {\r\n          // User cancelled or sharing failed, fall back to clipboard\r\n          console.log('Native sharing cancelled or failed, falling back to clipboard');\r\n        }\r\n      }\r\n\r\n      // Fallback to clipboard\r\n      if (navigator.clipboard && navigator.clipboard.writeText) {\r\n        const shareContent = `${shareData.shareText}\\n\\n Joga tambm: ${shareData.shareUrl}`;\r\n        await navigator.clipboard.writeText(shareContent);\r\n        \r\n        // Show success feedback\r\n        const button = document.activeElement as HTMLButtonElement;\r\n        if (button) {\r\n          const originalText = button.innerHTML;\r\n          button.innerHTML = ' Copiado!';\r\n          button.disabled = true;\r\n          \r\n          setTimeout(() => {\r\n            button.innerHTML = originalText;\r\n            button.disabled = false;\r\n          }, 2000);\r\n        }\r\n      } else {\r\n        // Final fallback - show share data in a modal or alert\r\n        const shareContent = `${shareData.shareText}\\n\\nLink: ${shareData.shareUrl}`;\r\n        \r\n        // Create a temporary textarea to select and copy\r\n        const textarea = document.createElement('textarea');\r\n        textarea.value = shareContent;\r\n        document.body.appendChild(textarea);\r\n        textarea.select();\r\n        \r\n        try {\r\n          document.execCommand('copy');\r\n          alert('Pontuao copiada para a rea de transferncia!');\r\n        } catch (err) {\r\n          // Show the content in an alert as last resort\r\n          alert(`Partilha a tua pontuao:\\n\\n${shareContent}`);\r\n        } finally {\r\n          document.body.removeChild(textarea);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to share score:', error);\r\n      setShareError('Erro ao partilhar pontuao. Tenta novamente.');\r\n      \r\n      setTimeout(() => {\r\n        setShareError(null);\r\n      }, 3000);\r\n    } finally {\r\n      setIsSharing(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"relative\">\r\n      <button\r\n        onClick={handleShare}\r\n        disabled={isSharing}\r\n        className={`\r\n          ${sizeClasses[size]} \r\n          ${variantClasses[variant]}\r\n          ${className}\r\n          rounded-lg font-medium transition-all transform hover:scale-105 \r\n          disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none\r\n          flex items-center justify-center gap-2\r\n        `}\r\n        title=\"Partilhar pontuao\"\r\n      >\r\n        {isSharing ? (\r\n          <>\r\n            <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-current\"></div>\r\n            <span className=\"hidden sm:inline\">Partilhando...</span>\r\n          </>\r\n        ) : (\r\n          <>\r\n            <span></span>\r\n            <span className=\"hidden sm:inline\">Partilhar</span>\r\n          </>\r\n        )}\r\n      </button>\r\n      \r\n      {shareError && (\r\n        <div className=\"absolute top-full left-1/2 transform -translate-x-1/2 mt-2 px-3 py-2 bg-red-600 text-white text-sm rounded-lg whitespace-nowrap z-10\">\r\n          {shareError}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n// Utility function to generate share text for different platforms\r\nexport function generateShareText(shareData: ShareableScore): {\r\n  twitter: string;\r\n  facebook: string;\r\n  whatsapp: string;\r\n  generic: string;\r\n} {\r\n  const baseText = shareData.shareText;\r\n  const url = shareData.shareUrl;\r\n  \r\n  return {\r\n    twitter: `${baseText}  #OCaminhoAssombradoDaEscola ${url}`,\r\n    facebook: `${baseText}\\n\\nJoga tambm: ${url}`,\r\n    whatsapp: ` ${baseText}\\n\\n Joga tambm: ${url}`,\r\n    generic: `${baseText}\\n\\nJoga tambm: ${url}`\r\n  };\r\n}\r\n\r\n// Social media specific share functions\r\nexport const socialShare = {\r\n  twitter: (shareData: ShareableScore) => {\r\n    const text = generateShareText(shareData).twitter;\r\n    const url = `https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}`;\r\n    window.open(url, '_blank', 'width=550,height=420');\r\n  },\r\n  \r\n  facebook: (shareData: ShareableScore) => {\r\n    const url = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareData.shareUrl)}`;\r\n    window.open(url, '_blank', 'width=580,height=296');\r\n  },\r\n  \r\n  whatsapp: (shareData: ShareableScore) => {\r\n    const text = generateShareText(shareData).whatsapp;\r\n    const url = `https://wa.me/?text=${encodeURIComponent(text)}`;\r\n    window.open(url, '_blank');\r\n  },\r\n  \r\n  telegram: (shareData: ShareableScore) => {\r\n    const text = generateShareText(shareData).generic;\r\n    const url = `https://t.me/share/url?url=${encodeURIComponent(shareData.shareUrl)}&text=${encodeURIComponent(text)}`;\r\n    window.open(url, '_blank');\r\n  }\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\SimplifiedControls.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\TouchControls.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\VisualAudioIndicators.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'display' is assigned a value but never used.","line":22,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":18},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\VisualAudioIndicators.tsx:28:5\n  26 |\n  27 |   useEffect(() => {\n> 28 |     setIsClient(true);\n     |     ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  29 |   }, []);\n  30 |\n  31 |   useEffect(() => {","line":28,"column":5,"nodeType":null,"endLine":28,"endColumn":16},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'isClient'. Either include it or remove the dependency array.","line":116,"column":6,"nodeType":"ArrayExpression","endLine":116,"endColumn":22,"suggestions":[{"desc":"Update the dependencies array to be: [isClient, showIndicators]","fix":{"range":[3685,3701],"text":"[isClient, showIndicators]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useEffect, useState } from 'react';\r\nimport { useSettingsStore } from '@/store/settingsStore';\r\n\r\ninterface VisualIndicator {\r\n  id: string;\r\n  type: 'jump' | 'damage' | 'item_collect' | 'weapon_attack' | 'enemy_nearby' | 'low_health';\r\n  position: { x: number; y: number };\r\n  intensity: 'low' | 'medium' | 'high';\r\n  duration: number;\r\n  timestamp: number;\r\n}\r\n\r\ninterface VisualAudioIndicatorsProps {\r\n  className?: string;\r\n}\r\n\r\nexport const VisualAudioIndicators: React.FC<VisualAudioIndicatorsProps> = ({ \r\n  className = '' \r\n}) => {\r\n  const { display } = useSettingsStore();\r\n  const [indicators, setIndicators] = useState<VisualIndicator[]>([]);\r\n  const [showIndicators, setShowIndicators] = useState(true);\r\n  const [isClient, setIsClient] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setIsClient(true);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!isClient) return;\r\n    const handleVisualIndicator = (event: CustomEvent<{\r\n      type: VisualIndicator['type'];\r\n      position?: { x: number; y: number };\r\n      intensity?: VisualIndicator['intensity'];\r\n      weaponType?: string;\r\n    }>) => {\r\n      if (!showIndicators) return;\r\n\r\n      const { type, position, intensity = 'medium', weaponType } = event.detail;\r\n      const timestamp = Date.now();\r\n      const randomId = Math.random().toString(36).substr(2, 9);\r\n      const id = `${type}-${timestamp}-${randomId}`;\r\n\r\n      // Default position (center of screen)\r\n      const defaultPosition = { x: 50, y: 50 };\r\n\r\n      let duration = 1000;\r\n      let finalIntensity = intensity;\r\n\r\n      // Adjust duration and intensity based on type\r\n      switch (type) {\r\n        case 'jump':\r\n          duration = 500;\r\n          finalIntensity = 'low';\r\n          break;\r\n        case 'damage':\r\n          duration = 1500;\r\n          finalIntensity = 'high';\r\n          break;\r\n        case 'item_collect':\r\n          duration = 800;\r\n          finalIntensity = 'medium';\r\n          break;\r\n        case 'weapon_attack':\r\n          duration = 600;\r\n          finalIntensity = weaponType === 'bazooka' ? 'high' : 'medium';\r\n          break;\r\n        case 'enemy_nearby':\r\n          duration = 2000;\r\n          finalIntensity = 'medium';\r\n          break;\r\n        case 'low_health':\r\n          duration = 3000;\r\n          finalIntensity = 'high';\r\n          break;\r\n      }\r\n\r\n      const indicator: VisualIndicator = {\r\n        id,\r\n        type,\r\n        position: position || defaultPosition,\r\n        intensity: finalIntensity,\r\n        duration,\r\n        timestamp\r\n      };\r\n\r\n      setIndicators(prev => {\r\n        // Remove old indicators of the same type to prevent spam\r\n        const filtered = prev.filter(i => \r\n          i.type !== type || (timestamp - i.timestamp) > 100\r\n        );\r\n        // Keep maximum of 10 indicators to prevent performance issues\r\n        const limited = [...filtered, indicator].slice(-10);\r\n        return limited;\r\n      });\r\n\r\n      // Remove indicator after duration\r\n      setTimeout(() => {\r\n        setIndicators(prev => prev.filter(i => i.id !== id));\r\n      }, duration);\r\n    };\r\n\r\n    const handleToggleIndicators = (event: CustomEvent<{ enabled: boolean }>) => {\r\n      setShowIndicators(event.detail.enabled);\r\n    };\r\n\r\n    window.addEventListener('visualIndicator', handleVisualIndicator as EventListener);\r\n    window.addEventListener('toggleVisualIndicators', handleToggleIndicators as EventListener);\r\n\r\n    return () => {\r\n      window.removeEventListener('visualIndicator', handleVisualIndicator as EventListener);\r\n      window.removeEventListener('toggleVisualIndicators', handleToggleIndicators as EventListener);\r\n    };\r\n  }, [showIndicators]);\r\n\r\n  if (!isClient || !showIndicators) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div \r\n      className={`fixed inset-0 pointer-events-none z-20 ${className}`}\r\n      aria-hidden=\"true\"\r\n    >\r\n      {indicators.map((indicator) => {\r\n        const getIndicatorStyles = () => {\r\n          const baseClasses = \"absolute transform -translate-x-1/2 -translate-y-1/2 rounded-full\";\r\n          \r\n          switch (indicator.type) {\r\n            case 'jump':\r\n              return {\r\n                className: `${baseClasses} bg-blue-400/60 animate-ping`,\r\n                size: indicator.intensity === 'high' ? 'w-16 h-16' : 'w-12 h-12'\r\n              };\r\n            case 'damage':\r\n              return {\r\n                className: `${baseClasses} bg-red-500/80 animate-pulse`,\r\n                size: indicator.intensity === 'high' ? 'w-24 h-24' : 'w-16 h-16'\r\n              };\r\n            case 'item_collect':\r\n              return {\r\n                className: `${baseClasses} bg-yellow-400/70 animate-bounce`,\r\n                size: 'w-14 h-14'\r\n              };\r\n            case 'weapon_attack':\r\n              return {\r\n                className: `${baseClasses} bg-orange-500/70 animate-pulse`,\r\n                size: indicator.intensity === 'high' ? 'w-20 h-20' : 'w-12 h-12'\r\n              };\r\n            case 'enemy_nearby':\r\n              return {\r\n                className: `${baseClasses} bg-purple-500/60 animate-ping`,\r\n                size: 'w-18 h-18'\r\n              };\r\n            case 'low_health':\r\n              return {\r\n                className: `${baseClasses} bg-red-600/90 animate-pulse`,\r\n                size: 'w-32 h-32'\r\n              };\r\n            default:\r\n              return {\r\n                className: `${baseClasses} bg-gray-400/50 animate-ping`,\r\n                size: 'w-12 h-12'\r\n              };\r\n          }\r\n        };\r\n\r\n        const { className: indicatorClassName, size } = getIndicatorStyles();\r\n\r\n        return (\r\n          <div\r\n            key={indicator.id}\r\n            className={`${indicatorClassName} ${size}`}\r\n            style={{\r\n              left: `${indicator.position.x}%`,\r\n              top: `${indicator.position.y}%`,\r\n              animationDuration: `${indicator.duration}ms`\r\n            }}\r\n          >\r\n            {/* Inner glow effect */}\r\n            <div \r\n              className={`absolute inset-0 rounded-full ${\r\n                indicator.type === 'damage' ? 'bg-red-300/40' :\r\n                indicator.type === 'item_collect' ? 'bg-yellow-300/40' :\r\n                indicator.type === 'jump' ? 'bg-blue-300/40' :\r\n                indicator.type === 'weapon_attack' ? 'bg-orange-300/40' :\r\n                indicator.type === 'enemy_nearby' ? 'bg-purple-300/40' :\r\n                indicator.type === 'low_health' ? 'bg-red-400/60' :\r\n                'bg-gray-300/40'\r\n              }`}\r\n              style={{\r\n                animation: `pulse ${indicator.duration / 2}ms ease-in-out infinite`\r\n              }}\r\n            />\r\n          </div>\r\n        );\r\n      })}\r\n\r\n      {/* Screen flash for high-intensity events */}\r\n      {indicators.some(i => i.intensity === 'high' && i.type === 'damage') && (\r\n        <div \r\n          className=\"absolute inset-0 bg-red-500/20 animate-pulse\"\r\n          style={{ animationDuration: '200ms', animationIterationCount: '3' }}\r\n        />\r\n      )}\r\n\r\n      {/* Health warning overlay */}\r\n      {indicators.some(i => i.type === 'low_health') && (\r\n        <div className=\"absolute inset-0 border-4 border-red-500/60 animate-pulse\" />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\n// Hook for managing visual audio indicators\r\nexport const useVisualAudioIndicators = () => {\r\n  const triggerVisualIndicator = (\r\n    type: VisualIndicator['type'],\r\n    options?: {\r\n      position?: { x: number; y: number };\r\n      intensity?: VisualIndicator['intensity'];\r\n      weaponType?: string;\r\n    }\r\n  ) => {\r\n    window.dispatchEvent(new CustomEvent('visualIndicator', {\r\n      detail: { type, ...options }\r\n    }));\r\n  };\r\n\r\n  const toggleVisualIndicators = (enabled: boolean) => {\r\n    window.dispatchEvent(new CustomEvent('toggleVisualIndicators', {\r\n      detail: { enabled }\r\n    }));\r\n  };\r\n\r\n  return {\r\n    triggerVisualIndicator,\r\n    toggleVisualIndicators\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\__tests__\\AccessibilityFeatures.test.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":38,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1399,1402],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1399,1402],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":64,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2162,2165],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2162,2165],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":130,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":130,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4156,4159],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4156,4159],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":164,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":164,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5443,5446],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5443,5446],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":181,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":181,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6031,6034],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6031,6034],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\r\nimport { render, screen, fireEvent, waitFor } from '@testing-library/react';\r\nimport { AudioSubtitles } from '../AudioSubtitles';\r\nimport { VisualAudioIndicators } from '../VisualAudioIndicators';\r\nimport { SimplifiedControls } from '../SimplifiedControls';\r\nimport { ColorblindFriendlyUI } from '../ColorblindFriendlyUI';\r\nimport { useSettingsStore } from '../../../store/settingsStore';\r\n\r\n// Mock the settings store\r\njest.mock('../../../store/settingsStore');\r\nconst mockUseSettingsStore = useSettingsStore as jest.MockedFunction<typeof useSettingsStore>;\r\n\r\ndescribe('Accessibility Features', () => {\r\n  beforeEach(() => {\r\n    mockUseSettingsStore.mockReturnValue({\r\n      display: {\r\n        reducedMotion: false,\r\n        highContrast: false,\r\n        colorBlindMode: 'none',\r\n        showFPS: false,\r\n        particleEffects: true,\r\n        screenShake: true,\r\n        audioSubtitles: true,\r\n        visualAudioIndicators: true,\r\n        colorBlindFriendlyUI: true\r\n      },\r\n      controls: {\r\n        moveLeft: ['KeyA', 'ArrowLeft'],\r\n        moveRight: ['KeyD', 'ArrowRight'],\r\n        jump: ['KeyW', 'ArrowUp', 'Space'],\r\n        crouch: ['KeyS', 'ArrowDown'],\r\n        attack: ['Space'],\r\n        pause: ['Escape', 'KeyP']\r\n      },\r\n      setDisplaySetting: jest.fn(),\r\n      setControlMapping: jest.fn(),\r\n      resetControlsToDefault: jest.fn()\r\n    } as any);\r\n  });\r\n\r\n  describe('AudioSubtitles', () => {\r\n    it('should render when audioSubtitles is enabled', async () => {\r\n      render(<AudioSubtitles />);\r\n      \r\n      // Enable subtitles first\r\n      fireEvent(window, new CustomEvent('toggleSubtitles', {\r\n        detail: { enabled: true }\r\n      }));\r\n\r\n      // Trigger an audio event\r\n      fireEvent(window, new CustomEvent('audioEvent', {\r\n        detail: { type: 'jump' }\r\n      }));\r\n\r\n      // Should show subtitle\r\n      await waitFor(() => {\r\n        expect(screen.getByRole('log')).toBeInTheDocument();\r\n      });\r\n    });\r\n\r\n    it('should not render when audioSubtitles is disabled', () => {\r\n      mockUseSettingsStore.mockReturnValue({\r\n        display: { audioSubtitles: false }\r\n      } as any);\r\n\r\n      render(<AudioSubtitles />);\r\n      \r\n      // Should not render anything\r\n      expect(screen.queryByRole('log')).not.toBeInTheDocument();\r\n    });\r\n\r\n    it('should display correct messages for different audio events', async () => {\r\n      render(<AudioSubtitles />);\r\n      \r\n      // Enable subtitles first\r\n      fireEvent(window, new CustomEvent('toggleSubtitles', {\r\n        detail: { enabled: true }\r\n      }));\r\n\r\n      // Test jump event\r\n      fireEvent(window, new CustomEvent('audioEvent', {\r\n        detail: { type: 'jump' }\r\n      }));\r\n\r\n      await waitFor(() => {\r\n        expect(screen.getByText(' Salto')).toBeInTheDocument();\r\n      });\r\n\r\n      // Test damage event\r\n      fireEvent(window, new CustomEvent('audioEvent', {\r\n        detail: { type: 'damage' }\r\n      }));\r\n\r\n      await waitFor(() => {\r\n        expect(screen.getByText(' Dano recebido')).toBeInTheDocument();\r\n      });\r\n\r\n      // Test weapon attack event\r\n      fireEvent(window, new CustomEvent('audioEvent', {\r\n        detail: { type: 'weapon_attack', weaponType: 'katana' }\r\n      }));\r\n\r\n      await waitFor(() => {\r\n        expect(screen.getByText(' Katana - Corte')).toBeInTheDocument();\r\n      });\r\n    });\r\n  });\r\n\r\n  describe('VisualAudioIndicators', () => {\r\n    it('should render visual indicators when enabled', () => {\r\n      render(<VisualAudioIndicators />);\r\n      \r\n      // Trigger a visual indicator event\r\n      fireEvent(window, new CustomEvent('visualIndicator', {\r\n        detail: { \r\n          type: 'damage',\r\n          position: { x: 50, y: 50 },\r\n          intensity: 'high'\r\n        }\r\n      }));\r\n\r\n      // Should render the indicator container\r\n      const container = document.querySelector('.fixed.inset-0');\r\n      expect(container).toBeInTheDocument();\r\n    });\r\n\r\n    it('should not render when visualAudioIndicators is disabled', () => {\r\n      mockUseSettingsStore.mockReturnValue({\r\n        display: { visualAudioIndicators: false }\r\n      } as any);\r\n\r\n      render(<VisualAudioIndicators />);\r\n      \r\n      // Should return null and not render anything\r\n      expect(screen.queryByText('visual-indicator')).not.toBeInTheDocument();\r\n    });\r\n  });\r\n\r\n  describe('SimplifiedControls', () => {\r\n    it('should render control schemes', () => {\r\n      render(<SimplifiedControls />);\r\n      \r\n      expect(screen.getByText('Esquemas de Controlo Simplificados')).toBeInTheDocument();\r\n      expect(screen.getByText('Controlos Padro')).toBeInTheDocument();\r\n      expect(screen.getByText('Uma Mo (Esquerda)')).toBeInTheDocument();\r\n      expect(screen.getByText('Uma Mo (Direita)')).toBeInTheDocument();\r\n      expect(screen.getByText('Controlos Mnimos')).toBeInTheDocument();\r\n      expect(screen.getByText('Teclas Grandes')).toBeInTheDocument();\r\n    });\r\n\r\n    it('should apply control scheme when clicked', () => {\r\n      const mockSetControlMapping = jest.fn();\r\n      mockUseSettingsStore.mockReturnValue({\r\n        controls: {\r\n          moveLeft: ['KeyA'],\r\n          moveRight: ['KeyD'],\r\n          jump: ['Space'],\r\n          crouch: ['KeyS'],\r\n          attack: ['Space'],\r\n          pause: ['Escape']\r\n        },\r\n        setControlMapping: mockSetControlMapping,\r\n        resetControlsToDefault: jest.fn()\r\n      } as any);\r\n\r\n      render(<SimplifiedControls />);\r\n      \r\n      // Click on one-handed left scheme\r\n      const oneHandedScheme = screen.getByText('Uma Mo (Esquerda)').closest('[role=\"button\"]');\r\n      fireEvent.click(oneHandedScheme!);\r\n\r\n      // Should call setControlMapping for each control\r\n      expect(mockSetControlMapping).toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe('ColorblindFriendlyUI', () => {\r\n    it('should render children normally when disabled', () => {\r\n      mockUseSettingsStore.mockReturnValue({\r\n        display: { colorBlindFriendlyUI: false }\r\n      } as any);\r\n\r\n      render(\r\n        <ColorblindFriendlyUI>\r\n          <div>Test Content</div>\r\n        </ColorblindFriendlyUI>\r\n      );\r\n      \r\n      expect(screen.getByText('Test Content')).toBeInTheDocument();\r\n    });\r\n\r\n    it('should apply colorblind-friendly class when enabled', () => {\r\n      render(\r\n        <ColorblindFriendlyUI>\r\n          <div>Test Content</div>\r\n        </ColorblindFriendlyUI>\r\n      );\r\n      \r\n      const container = document.querySelector('.colorblind-friendly-ui');\r\n      expect(container).toBeInTheDocument();\r\n      expect(screen.getByText('Test Content')).toBeInTheDocument();\r\n    });\r\n  });\r\n});\r\n\r\n// Integration test for accessibility features\r\ndescribe('Accessibility Integration', () => {\r\n  it('should work together without conflicts', () => {\r\n    render(\r\n      <ColorblindFriendlyUI>\r\n        <AudioSubtitles />\r\n        <VisualAudioIndicators />\r\n        <SimplifiedControls />\r\n      </ColorblindFriendlyUI>\r\n    );\r\n\r\n    // All components should render without errors\r\n    expect(screen.getByText('Esquemas de Controlo Simplificados')).toBeInTheDocument();\r\n    \r\n    // Test that events work together\r\n    fireEvent(window, new CustomEvent('toggleSubtitles', {\r\n      detail: { enabled: true }\r\n    }));\r\n\r\n    fireEvent(window, new CustomEvent('audioEvent', {\r\n      detail: { type: 'jump' }\r\n    }));\r\n\r\n    fireEvent(window, new CustomEvent('visualIndicator', {\r\n      detail: { type: 'jump', intensity: 'low' }\r\n    }));\r\n\r\n    // Should not throw any errors\r\n    expect(document.body).toBeInTheDocument();\r\n  });\r\n});","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\badge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\components\\ui\\progress.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\PhaserGame.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\__tests__\\ScoringSystem.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\entities\\Bat.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\entities\\Enemy.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'time' is defined but never used. Allowed unused args must match /^_/u.","line":60,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":60,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'delta' is defined but never used. Allowed unused args must match /^_/u.","line":60,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":60,"endColumn":30}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as Phaser from 'phaser';\r\n\r\nexport abstract class BaseEnemy extends Phaser.Physics.Arcade.Sprite {\r\n  public type: 'ghost' | 'bat' | 'vampire' | 'mummy';\r\n  public isAlive: boolean;\r\n  public moveSpeed: number;\r\n  public movementType: 'floating' | 'ground';\r\n  \r\n  constructor(\r\n    scene: Phaser.Scene, \r\n    x: number, \r\n    y: number, \r\n    texture: string, \r\n    type: 'ghost' | 'bat' | 'vampire' | 'mummy'\r\n  ) {\r\n    super(scene, x, y, texture);\r\n    \r\n    this.type = type;\r\n    this.isAlive = true;\r\n    this.moveSpeed = 100; // Default speed, will be overridden by subclasses\r\n    this.movementType = 'floating'; // Default, will be overridden by subclasses\r\n    \r\n    // Add to scene and enable physics\r\n    scene.add.existing(this);\r\n    scene.physics.add.existing(this);\r\n    \r\n    // Configure physics body\r\n    if (this.body instanceof Phaser.Physics.Arcade.Body) {\r\n      this.body.setCollideWorldBounds(true);\r\n      this.body.setSize(32, 32); // Default collision box\r\n      \r\n      // Set gravity based on movement type\r\n      if (this.movementType === 'floating') {\r\n        this.body.setGravityY(0); // No gravity for floating enemies\r\n      } else {\r\n        this.body.setGravityY(300); // Apply gravity for ground enemies\r\n      }\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Abstract method for enemy-specific movement behavior\r\n   */\r\n  abstract updateMovement(): void;\r\n  \r\n  /**\r\n   * Handle collision with player - all enemies remove 1 life and disappear\r\n   * Requirements: 4.1, 4.2, 4.3, 4.4, 7.3\r\n   */\r\n  onCollision(): void {\r\n    if (!this.isAlive) return;\r\n    \r\n    // Enemy disappears on collision\r\n    this.destroy();\r\n  }\r\n  \r\n  /**\r\n   * Update method called every frame\r\n   */\r\n  update(time?: number, delta?: number): void {\r\n    if (!this.isAlive) return;\r\n    \r\n    // Update enemy-specific movement\r\n    this.updateMovement();\r\n    \r\n    // Remove enemy if it goes too far off screen (optimization)\r\n    if (this.x < -100 || this.x > this.scene.scale.width + 100) {\r\n      this.destroy();\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Destroy the enemy\r\n   */\r\n  destroy(): void {\r\n    this.isAlive = false;\r\n    super.destroy();\r\n  }\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\entities\\EnemyFactory.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\entities\\Ghost.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\entities\\LifeItem.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\entities\\Mummy.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\entities\\Player.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'WeaponFactory' is defined but never used.","line":4,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'texture' is defined but never used. Allowed unused args must match /^_/u.","line":26,"column":58,"nodeType":null,"messageId":"unusedVar","endLine":26,"endColumn":65},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'scene' is assigned a value but never used.","line":184,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":184,"endColumn":16}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as Phaser from 'phaser';\r\nimport { WeaponEntity } from '../../types';\r\nimport { audioManager } from '../utils/AudioManager';\r\nimport { WeaponFactory } from './WeaponFactory';\r\n\r\nexport class Player extends Phaser.Physics.Arcade.Sprite {\r\n  public lives: number;\r\n  public score: number;\r\n  public weapon: WeaponEntity | null;\r\n  public isInvulnerable: boolean;\r\n  public invulnerabilityTimer: number;\r\n  public isCrouching: boolean;\r\n  public isJumping: boolean;\r\n  \r\n  // Animation properties\r\n  private currentAnimation: string;\r\n  private animationFrame: number;\r\n  private animationTimer: number;\r\n  private readonly ANIMATION_SPEED = 200; // ms per frame\r\n  \r\n  // Movement constants\r\n  private readonly MOVE_SPEED = 200;\r\n  private readonly JUMP_VELOCITY = -360; // Negative for upward movement\r\n  private readonly INVULNERABILITY_DURATION = 800; // 800ms as per requirement 7.4\r\n  \r\n  constructor(scene: Phaser.Scene, x: number, y: number, texture: string) {\r\n    // Get character selection from game registry\r\n    const character = scene.registry.get('character') || 'boy';\r\n    const characterTexture = character === 'boy' ? 'player_boy' : 'player_girl';\r\n    \r\n    super(scene, x, y, characterTexture);\r\n    \r\n    // Initialize properties\r\n    this.lives = 10; // Starting lives as per requirement 7.1\r\n    this.score = 0;\r\n    this.weapon = null;\r\n    this.isInvulnerable = false;\r\n    this.invulnerabilityTimer = 0;\r\n    this.isCrouching = false;\r\n    this.isJumping = false;\r\n    \r\n    // Initialize animation properties\r\n    this.currentAnimation = 'idle';\r\n    this.animationFrame = 0;\r\n    this.animationTimer = 0;\r\n    \r\n    // Add to scene and enable physics\r\n    scene.add.existing(this);\r\n    scene.physics.add.existing(this);\r\n    \r\n    console.log('Player created at:', x, y, 'texture:', characterTexture);\r\n    console.log('Player body after physics:', !!this.body);\r\n    \r\n    // Configure physics body\r\n    if (this.body instanceof Phaser.Physics.Arcade.Body) {\r\n      this.body.setCollideWorldBounds(true);\r\n      this.body.setGravityY(300); // Apply gravity\r\n      this.body.setSize(32, 48); // Set collision box size\r\n      console.log('Player physics body configured successfully');\r\n    } else {\r\n      console.error('Player physics body not created properly!');\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Move player left or right\r\n   * Requirements: 3.1, 3.2\r\n   */\r\n  move(direction: 'left' | 'right'): void {\r\n    if (!this.body || this.isCrouching) {\r\n      console.log('Movement blocked - no body or crouching');\r\n      return;\r\n    }\r\n    \r\n    const body = this.body as Phaser.Physics.Arcade.Body;\r\n    \r\n    if (direction === 'left') {\r\n      body.setVelocityX(-this.MOVE_SPEED);\r\n      this.setFlipX(true); // Face left\r\n      this.setAnimation('walk');\r\n    } else if (direction === 'right') {\r\n      body.setVelocityX(this.MOVE_SPEED);\r\n      this.setFlipX(false); // Face right\r\n      this.setAnimation('walk');\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Stop horizontal movement\r\n   */\r\n  stopMovement(): void {\r\n    if (!this.body) return;\r\n    \r\n    const body = this.body as Phaser.Physics.Arcade.Body;\r\n    body.setVelocityX(0);\r\n    this.setAnimation('idle');\r\n  }\r\n  \r\n  /**\r\n   * Make player jump\r\n   * Requirements: 3.3, 11.2\r\n   */\r\n  jump(): void {\r\n    if (!this.body || this.isCrouching) return;\r\n    \r\n    const body = this.body as Phaser.Physics.Arcade.Body;\r\n    \r\n    // Only jump if on ground\r\n    if (body.touching.down) {\r\n      body.setVelocityY(this.JUMP_VELOCITY);\r\n      this.isJumping = true;\r\n      this.setAnimation('jump');\r\n      \r\n      // Play jump sound effect\r\n      audioManager.playJumpSound();\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Make player crouch\r\n   * Requirements: 3.4\r\n   */\r\n  crouch(): void {\r\n    if (!this.body) return;\r\n    \r\n    const body = this.body as Phaser.Physics.Arcade.Body;\r\n    \r\n    if (!this.isCrouching) {\r\n      this.isCrouching = true;\r\n      // Reduce collision box height when crouching\r\n      body.setSize(32, 24);\r\n      body.setOffset(0, 24);\r\n      // Stop horizontal movement when crouching\r\n      body.setVelocityX(0);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Stop crouching\r\n   */\r\n  stopCrouching(): void {\r\n    if (!this.body) return;\r\n    \r\n    const body = this.body as Phaser.Physics.Arcade.Body;\r\n    \r\n    if (this.isCrouching) {\r\n      this.isCrouching = false;\r\n      // Restore normal collision box\r\n      body.setSize(32, 48);\r\n      body.setOffset(0, 0);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Attack with selected weapon\r\n   * Requirements: 3.5, 11.5\r\n   */\r\n  attack(): void {\r\n    if (!this.weapon || this.isCrouching) return;\r\n    \r\n    // Check if weapon can attack (cooldown)\r\n    if (this.weapon.canAttack()) {\r\n      // Get attack position based on player facing direction\r\n      const attackX = this.flipX ? this.x - this.weapon.range : this.x + this.weapon.range;\r\n      const attackY = this.y;\r\n      \r\n      // Execute weapon attack\r\n      this.weapon.attack(attackX, attackY);\r\n      \r\n      // Show visual weapon attack\r\n      this.showWeaponAttack();\r\n      \r\n      // Play weapon-specific sound effect\r\n      audioManager.playWeaponSound(this.weapon.type);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Show visual weapon attack effect with enhanced animations\r\n   */\r\n  private showWeaponAttack(): void {\r\n    if (!this.weapon) return;\r\n    \r\n    const scene = this.scene;\r\n    const facingLeft = this.flipX;\r\n    \r\n    // Create visual attack effect based on weapon type\r\n    switch (this.weapon.type) {\r\n      case 'katana':\r\n        this.showKatanaAttack(facingLeft);\r\n        break;\r\n      case 'baseball':\r\n        this.showBaseballAttack(facingLeft);\r\n        break;\r\n      case 'laser':\r\n        this.showLaserAttack(facingLeft);\r\n        break;\r\n      case 'bazooka':\r\n        this.showBazookaAttack(facingLeft);\r\n        break;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Show katana attack with slash animation\r\n   */\r\n  private showKatanaAttack(facingLeft: boolean): void {\r\n    if (!this.weapon) return;\r\n    \r\n    const scene = this.scene;\r\n    const attackX = facingLeft ? this.x - this.weapon.range/2 : this.x + this.weapon.range/2;\r\n    const attackY = this.y - 10;\r\n    \r\n    // Create katana slash effect with multiple layers\r\n    const slash1 = scene.add.graphics();\r\n    const slash2 = scene.add.graphics();\r\n    const slash3 = scene.add.graphics();\r\n    \r\n    // Main slash (silver)\r\n    slash1.lineStyle(4, 0xc0c0c0, 0.9);\r\n    // Glow effect (white)\r\n    slash2.lineStyle(8, 0xffffff, 0.5);\r\n    // Sparkle effect (yellow)\r\n    slash3.lineStyle(2, 0xffff00, 0.7);\r\n    \r\n    if (facingLeft) {\r\n      const startX = attackX + 25;\r\n      const startY = attackY - 25;\r\n      const endX = attackX - 25;\r\n      const endY = attackY + 25;\r\n      \r\n      slash1.lineBetween(startX, startY, endX, endY);\r\n      slash2.lineBetween(startX, startY, endX, endY);\r\n      slash3.lineBetween(startX, startY, endX, endY);\r\n    } else {\r\n      const startX = attackX - 25;\r\n      const startY = attackY - 25;\r\n      const endX = attackX + 25;\r\n      const endY = attackY + 25;\r\n      \r\n      slash1.lineBetween(startX, startY, endX, endY);\r\n      slash2.lineBetween(startX, startY, endX, endY);\r\n      slash3.lineBetween(startX, startY, endX, endY);\r\n    }\r\n    \r\n    // Add sparkle particles\r\n    for (let i = 0; i < 5; i++) {\r\n      const sparkle = scene.add.graphics();\r\n      sparkle.fillStyle(0xffff00, 0.8);\r\n      sparkle.fillCircle(\r\n        attackX + (Math.random() - 0.5) * 50,\r\n        attackY + (Math.random() - 0.5) * 30,\r\n        2\r\n      );\r\n      \r\n      scene.tweens.add({\r\n        targets: sparkle,\r\n        alpha: 0,\r\n        scaleX: 0,\r\n        scaleY: 0,\r\n        duration: 200 + Math.random() * 100,\r\n        onComplete: () => sparkle.destroy()\r\n      });\r\n    }\r\n    \r\n    // Animate slashes\r\n    scene.tweens.add({\r\n      targets: [slash1, slash2, slash3],\r\n      alpha: 0,\r\n      duration: 150,\r\n      onComplete: () => {\r\n        slash1.destroy();\r\n        slash2.destroy();\r\n        slash3.destroy();\r\n      }\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * Show baseball bat attack with swing animation\r\n   */\r\n  private showBaseballAttack(facingLeft: boolean): void {\r\n    if (!this.weapon) return;\r\n    \r\n    const scene = this.scene;\r\n    const attackX = facingLeft ? this.x - this.weapon.range/2 : this.x + this.weapon.range/2;\r\n    const attackY = this.y - 5;\r\n    \r\n    // Create baseball bat swing arc\r\n    const swing = scene.add.graphics();\r\n    swing.lineStyle(6, 0x8b4513, 0.8); // Brown bat color\r\n    \r\n    // Draw swing arc\r\n    const centerX = this.x;\r\n    const centerY = this.y - 10;\r\n    const radius = this.weapon.range / 2;\r\n    const startAngle = facingLeft ? Math.PI * 0.3 : Math.PI * 0.7;\r\n    const endAngle = facingLeft ? Math.PI * 0.7 : Math.PI * 0.3;\r\n    \r\n    swing.beginPath();\r\n    swing.arc(centerX, centerY, radius, startAngle, endAngle, facingLeft);\r\n    swing.strokePath();\r\n    \r\n    // Add impact effect\r\n    const impact = scene.add.graphics();\r\n    impact.fillStyle(0xffff00, 0.6);\r\n    impact.fillCircle(attackX, attackY, 15);\r\n    \r\n    // Add motion lines\r\n    for (let i = 0; i < 3; i++) {\r\n      const line = scene.add.graphics();\r\n      line.lineStyle(2, 0xffffff, 0.5);\r\n      const lineX = attackX + (i - 1) * 10;\r\n      line.lineBetween(lineX, attackY - 10, lineX, attackY + 10);\r\n      \r\n      scene.tweens.add({\r\n        targets: line,\r\n        alpha: 0,\r\n        duration: 100 + i * 50,\r\n        onComplete: () => line.destroy()\r\n      });\r\n    }\r\n    \r\n    // Animate swing and impact\r\n    scene.tweens.add({\r\n      targets: swing,\r\n      alpha: 0,\r\n      duration: 200,\r\n      onComplete: () => swing.destroy()\r\n    });\r\n    \r\n    scene.tweens.add({\r\n      targets: impact,\r\n      scaleX: 2,\r\n      scaleY: 2,\r\n      alpha: 0,\r\n      duration: 150,\r\n      onComplete: () => impact.destroy()\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * Show laser weapon attack with beam animation\r\n   */\r\n  private showLaserAttack(facingLeft: boolean): void {\r\n    const scene = this.scene;\r\n    const startX = this.x;\r\n    const startY = this.y - 10;\r\n    const endX = facingLeft ? this.x - 200 : this.x + 200;\r\n    \r\n    // Create laser beam with multiple layers\r\n    const laserCore = scene.add.graphics();\r\n    const laserGlow = scene.add.graphics();\r\n    const laserOuter = scene.add.graphics();\r\n    \r\n    // Core beam (bright red)\r\n    laserCore.lineStyle(2, 0xff0000, 1.0);\r\n    laserCore.lineBetween(startX, startY, endX, startY);\r\n    \r\n    // Inner glow (orange)\r\n    laserGlow.lineStyle(6, 0xff6600, 0.6);\r\n    laserGlow.lineBetween(startX, startY, endX, startY);\r\n    \r\n    // Outer glow (yellow)\r\n    laserOuter.lineStyle(12, 0xffff00, 0.3);\r\n    laserOuter.lineBetween(startX, startY, endX, startY);\r\n    \r\n    // Add energy particles along the beam\r\n    for (let i = 0; i < 8; i++) {\r\n      const particle = scene.add.graphics();\r\n      particle.fillStyle(0xff0000, 0.8);\r\n      const particleX = startX + (endX - startX) * (i / 8);\r\n      particle.fillCircle(particleX, startY + (Math.random() - 0.5) * 4, 1);\r\n      \r\n      scene.tweens.add({\r\n        targets: particle,\r\n        alpha: 0,\r\n        y: startY + (Math.random() - 0.5) * 20,\r\n        duration: 200,\r\n        onComplete: () => particle.destroy()\r\n      });\r\n    }\r\n    \r\n    // Animate laser beam\r\n    scene.tweens.add({\r\n      targets: [laserCore, laserGlow, laserOuter],\r\n      alpha: 0,\r\n      duration: 250,\r\n      onComplete: () => {\r\n        laserCore.destroy();\r\n        laserGlow.destroy();\r\n        laserOuter.destroy();\r\n      }\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * Show bazooka weapon attack with explosion animation\r\n   */\r\n  private showBazookaAttack(facingLeft: boolean): void {\r\n    const scene = this.scene;\r\n    const startX = this.x;\r\n    const startY = this.y - 10;\r\n    const targetX = facingLeft ? this.x - 100 : this.x + 100;\r\n    \r\n    // Create projectile trail first\r\n    const projectile = scene.add.graphics();\r\n    projectile.fillStyle(0xff6600, 0.9);\r\n    projectile.fillCircle(startX, startY, 3);\r\n    \r\n    // Animate projectile to target\r\n    scene.tweens.add({\r\n      targets: projectile,\r\n      x: targetX,\r\n      duration: 200,\r\n      onComplete: () => {\r\n        projectile.destroy();\r\n        this.createExplosionEffect(scene, targetX, startY);\r\n      }\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * Create explosion effect for bazooka\r\n   */\r\n  private createExplosionEffect(scene: Phaser.Scene, x: number, y: number): void {\r\n    // Main explosion\r\n    const explosion = scene.add.graphics();\r\n    explosion.fillStyle(0xff6600, 0.8);\r\n    explosion.fillCircle(x, y, 20);\r\n    \r\n    // Explosion rings\r\n    const ring1 = scene.add.graphics();\r\n    ring1.lineStyle(4, 0xffff00, 0.8);\r\n    ring1.strokeCircle(x, y, 25);\r\n    \r\n    const ring2 = scene.add.graphics();\r\n    ring2.lineStyle(6, 0xff0000, 0.6);\r\n    ring2.strokeCircle(x, y, 35);\r\n    \r\n    // Explosion particles\r\n    for (let i = 0; i < 12; i++) {\r\n      const particle = scene.add.graphics();\r\n      particle.fillStyle(0xff6600, 0.7);\r\n      particle.fillCircle(x, y, 2);\r\n      \r\n      const angle = (i / 12) * Math.PI * 2;\r\n      const distance = 40 + Math.random() * 20;\r\n      const targetX = x + Math.cos(angle) * distance;\r\n      const targetY = y + Math.sin(angle) * distance;\r\n      \r\n      scene.tweens.add({\r\n        targets: particle,\r\n        x: targetX,\r\n        y: targetY,\r\n        alpha: 0,\r\n        scaleX: 0.1,\r\n        scaleY: 0.1,\r\n        duration: 300 + Math.random() * 200,\r\n        onComplete: () => particle.destroy()\r\n      });\r\n    }\r\n    \r\n    // Animate explosion\r\n    scene.tweens.add({\r\n      targets: explosion,\r\n      scaleX: 2.5,\r\n      scaleY: 2.5,\r\n      alpha: 0,\r\n      duration: 400,\r\n      onComplete: () => explosion.destroy()\r\n    });\r\n    \r\n    scene.tweens.add({\r\n      targets: ring1,\r\n      scaleX: 3,\r\n      scaleY: 3,\r\n      alpha: 0,\r\n      duration: 500,\r\n      onComplete: () => ring1.destroy()\r\n    });\r\n    \r\n    scene.tweens.add({\r\n      targets: ring2,\r\n      scaleX: 4,\r\n      scaleY: 4,\r\n      alpha: 0,\r\n      duration: 600,\r\n      onComplete: () => ring2.destroy()\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * Check if player is currently attacking (for collision detection)\r\n   */\r\n  isAttacking(): boolean {\r\n    if (!this.weapon) return false;\r\n    \r\n    // Check if attack happened recently (within 100ms window)\r\n    const timeSinceAttack = this.scene.time.now - this.weapon.getLastAttackTime();\r\n    return timeSinceAttack <= 100;\r\n  }\r\n  \r\n  /**\r\n   * Take damage and apply invulnerability\r\n   * Requirements: 7.3, 7.4, 11.3\r\n   */\r\n  takeDamage(): void {\r\n    // Don't take damage if already invulnerable\r\n    if (this.isInvulnerable || this.lives <= 0) return;\r\n    \r\n    // Reduce lives\r\n    this.lives = Math.max(0, this.lives - 1);\r\n    \r\n    // Apply invulnerability\r\n    this.isInvulnerable = true;\r\n    this.invulnerabilityTimer = this.INVULNERABILITY_DURATION;\r\n    \r\n    // Visual feedback - make player flash\r\n    this.setAlpha(0.5);\r\n    \r\n    // Play damage sound effect\r\n    audioManager.playDamageSound();\r\n    \r\n    // Update game store with new lives count\r\n    // This will be handled by the game scene that manages the player\r\n  }\r\n  \r\n  /**\r\n   * Set the player's weapon\r\n   */\r\n  setWeapon(weapon: WeaponEntity): void {\r\n    this.weapon = weapon;\r\n  }\r\n  \r\n  /**\r\n   * Add points to score\r\n   */\r\n  addScore(points: number): void {\r\n    this.score += points;\r\n  }\r\n  \r\n  /**\r\n   * Add lives (up to maximum of 10)\r\n   * Requirements: 6.2\r\n   */\r\n  addLife(): void {\r\n    if (this.lives < 10) {\r\n      this.lives += 1;\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Set player animation\r\n   */\r\n  private setAnimation(animation: string): void {\r\n    if (this.currentAnimation !== animation) {\r\n      this.currentAnimation = animation;\r\n      this.animationFrame = 0;\r\n      this.animationTimer = 0;\r\n      this.updateAnimationFrame();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update animation frame based on current animation\r\n   */\r\n  private updateAnimationFrame(): void {\r\n    const character = this.scene.registry.get('character') || 'boy';\r\n    const characterPrefix = character === 'boy' ? 'player_boy' : 'player_girl';\r\n    \r\n    let frameIndex = 0;\r\n    \r\n    switch (this.currentAnimation) {\r\n      case 'idle':\r\n        frameIndex = 0;\r\n        break;\r\n      case 'walk':\r\n        // Cycle between walk frames (1 and 2)\r\n        frameIndex = (this.animationFrame % 2) + 1;\r\n        break;\r\n      case 'jump':\r\n        frameIndex = 3;\r\n        break;\r\n    }\r\n    \r\n    // Try to use individual frame texture, fallback to main texture\r\n    const frameTexture = `${characterPrefix}_${frameIndex}`;\r\n    if (this.scene.textures.exists(frameTexture)) {\r\n      this.setTexture(frameTexture);\r\n    } else {\r\n      this.setTexture(characterPrefix);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update animation timer and advance frames\r\n   */\r\n  private updateAnimation(delta: number): void {\r\n    this.animationTimer += delta;\r\n    \r\n    if (this.animationTimer >= this.ANIMATION_SPEED) {\r\n      this.animationTimer = 0;\r\n      this.animationFrame++;\r\n      this.updateAnimationFrame();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update method called every frame\r\n   */\r\n  update(time: number, delta: number): void {\r\n    // Update animations\r\n    this.updateAnimation(delta);\r\n    \r\n    // Update invulnerability timer\r\n    if (this.isInvulnerable) {\r\n      this.invulnerabilityTimer -= delta;\r\n      \r\n      if (this.invulnerabilityTimer <= 0) {\r\n        this.isInvulnerable = false;\r\n        this.setAlpha(1); // Restore full opacity\r\n      } else {\r\n        // Flash effect during invulnerability\r\n        const flashRate = 100; // Flash every 100ms\r\n        const shouldShow = Math.floor(this.invulnerabilityTimer / flashRate) % 2 === 0;\r\n        this.setAlpha(shouldShow ? 0.5 : 0.2);\r\n      }\r\n    }\r\n    \r\n    // Update jumping state and animation\r\n    if (this.body instanceof Phaser.Physics.Arcade.Body) {\r\n      if (this.isJumping && this.body.touching.down) {\r\n        this.isJumping = false;\r\n        // Return to idle or walk animation based on movement\r\n        if (Math.abs(this.body.velocity.x) > 10) {\r\n          this.setAnimation('walk');\r\n        } else {\r\n          this.setAnimation('idle');\r\n        }\r\n      }\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Check if player is on ground\r\n   */\r\n  isOnGround(): boolean {\r\n    if (this.body instanceof Phaser.Physics.Arcade.Body) {\r\n      return this.body.touching.down;\r\n    }\r\n    return false;\r\n  }\r\n  \r\n  /**\r\n   * Get player's current state for debugging\r\n   */\r\n  getState(): {\r\n    x: number;\r\n    y: number;\r\n    lives: number;\r\n    score: number;\r\n    isInvulnerable: boolean;\r\n    isCrouching: boolean;\r\n    isJumping: boolean;\r\n  } {\r\n    return {\r\n      x: this.x,\r\n      y: this.y,\r\n      lives: this.lives,\r\n      score: this.score,\r\n      isInvulnerable: this.isInvulnerable,\r\n      isCrouching: this.isCrouching,\r\n      isJumping: this.isJumping,\r\n    };\r\n  }\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\entities\\Vampire.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\entities\\WeaponFactory.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\entities\\__tests__\\EnemyBehavior.test.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":47,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":47,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[994,997],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[994,997],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'texture' is defined but never used. Allowed unused args must match /^_/u.","line":47,"column":55,"nodeType":null,"messageId":"unusedVar","endLine":47,"endColumn":62},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":75,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":75,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1715,1718],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1715,1718],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":83,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":83,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1883,1886],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1883,1886],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":150,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":150,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3978,3981],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3978,3981],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'initialY' is assigned a value but never used.","line":171,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":171,"endColumn":21},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":206,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":206,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5924,5927],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5924,5927],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'initialY' is assigned a value but never used.","line":233,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":233,"endColumn":21},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'initialY' is assigned a value but never used.","line":243,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":243,"endColumn":21},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":263,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":263,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7948,7951],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7948,7951],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":264,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":264,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8012,8015],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8012,8015],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":271,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":271,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8314,8317],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8314,8317],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":272,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":272,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8378,8381],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8378,8381],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":282,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":282,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8783,8786],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8783,8786],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":283,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":283,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8847,8850],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8847,8850],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":295,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":295,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9319,9322],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9319,9322],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":296,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":296,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9383,9386],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9383,9386],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":309,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":309,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9836,9839],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9836,9839],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":14,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Ghost } from '../Ghost';\r\nimport { Vampire } from '../Vampire';\r\nimport { BaseEnemy } from '../Enemy';\r\n\r\n// Mock Phaser classes\r\nclass MockBody {\r\n  public touching = { down: false };\r\n  public velocity = { x: 0, y: 0 };\r\n  \r\n  setGravityY = jest.fn();\r\n  setSize = jest.fn();\r\n  setVelocityX = jest.fn((x: number) => { this.velocity.x = x; });\r\n  setVelocityY = jest.fn((y: number) => { this.velocity.y = y; });\r\n  setCollideWorldBounds = jest.fn();\r\n}\r\n\r\nclass MockScene {\r\n  public time = {\r\n    now: 0\r\n  };\r\n  \r\n  public add = {\r\n    existing: jest.fn()\r\n  };\r\n  \r\n  public physics = {\r\n    add: {\r\n      existing: jest.fn()\r\n    }\r\n  };\r\n  \r\n  public scale = {\r\n    width: 800\r\n  };\r\n}\r\n\r\n// Mock Phaser.Physics.Arcade.Sprite\r\njest.mock('phaser', () => ({\r\n  Physics: {\r\n    Arcade: {\r\n      Sprite: class MockSprite {\r\n        public x: number;\r\n        public y: number;\r\n        public body: MockBody;\r\n        public alpha: number = 1;\r\n        \r\n        constructor(scene: any, x: number, y: number, texture: string) {\r\n          this.x = x;\r\n          this.y = y;\r\n          this.body = new MockBody();\r\n        }\r\n        \r\n        setAlpha = jest.fn((alpha: number) => { this.alpha = alpha; });\r\n        setFlipX = jest.fn();\r\n        destroy = jest.fn();\r\n      }\r\n    }\r\n  }\r\n}));\r\n\r\ndescribe('Enemy Behavior', () => {\r\n  let mockScene: MockScene;\r\n  \r\n  beforeEach(() => {\r\n    mockScene = new MockScene();\r\n    jest.clearAllMocks();\r\n  });\r\n  \r\n  describe('BaseEnemy', () => {\r\n    // Create a concrete implementation for testing\r\n    class TestEnemy extends BaseEnemy {\r\n      updateMovement(): void {\r\n        // Simple test movement\r\n        if (this.body) {\r\n          (this.body as any).setVelocityX(-this.moveSpeed);\r\n        }\r\n      }\r\n    }\r\n    \r\n    let enemy: TestEnemy;\r\n    \r\n    beforeEach(() => {\r\n      enemy = new TestEnemy(mockScene as any, 100, 100, 'test', 'ghost');\r\n    });\r\n    \r\n    it('should initialize with correct properties', () => {\r\n      expect(enemy.type).toBe('ghost');\r\n      expect(enemy.isAlive).toBe(true);\r\n      expect(enemy.moveSpeed).toBe(100);\r\n      expect(enemy.movementType).toBe('floating');\r\n    });\r\n    \r\n    it('should configure physics body on creation', () => {\r\n      expect(mockScene.add.existing).toHaveBeenCalledWith(enemy);\r\n      expect(mockScene.physics.add.existing).toHaveBeenCalledWith(enemy);\r\n      expect(enemy.body.setCollideWorldBounds).toHaveBeenCalledWith(true);\r\n      expect(enemy.body.setSize).toHaveBeenCalledWith(32, 32);\r\n    });\r\n    \r\n    it('should set gravity based on movement type', () => {\r\n      // Floating enemy should have no gravity\r\n      expect(enemy.body.setGravityY).toHaveBeenCalledWith(0);\r\n    });\r\n    \r\n    it('should handle collision correctly', () => {\r\n      const destroySpy = jest.spyOn(enemy, 'destroy');\r\n      \r\n      enemy.onCollision();\r\n      \r\n      expect(destroySpy).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should update movement when alive', () => {\r\n      const updateMovementSpy = jest.spyOn(enemy, 'updateMovement');\r\n      \r\n      enemy.update();\r\n      \r\n      expect(updateMovementSpy).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should not update movement when dead', () => {\r\n      enemy.isAlive = false;\r\n      const updateMovementSpy = jest.spyOn(enemy, 'updateMovement');\r\n      \r\n      enemy.update();\r\n      \r\n      expect(updateMovementSpy).not.toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should destroy when going off screen', () => {\r\n      const destroySpy = jest.spyOn(enemy, 'destroy');\r\n      \r\n      // Move enemy far off screen\r\n      enemy.x = -200;\r\n      enemy.update();\r\n      \r\n      expect(destroySpy).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should set isAlive to false when destroyed', () => {\r\n      enemy.destroy();\r\n      expect(enemy.isAlive).toBe(false);\r\n    });\r\n  });\r\n  \r\n  describe('Ghost', () => {\r\n    let ghost: Ghost;\r\n    \r\n    beforeEach(() => {\r\n      ghost = new Ghost(mockScene as any, 200, 150, 'ghost');\r\n    });\r\n    \r\n    it('should have correct ghost specifications per requirement 4.1', () => {\r\n      expect(ghost.type).toBe('ghost');\r\n      expect(ghost.moveSpeed).toBe(80); // Moderate floating speed\r\n      expect(ghost.movementType).toBe('floating');\r\n    });\r\n    \r\n    it('should configure physics for floating movement', () => {\r\n      expect(ghost.body.setGravityY).toHaveBeenCalledWith(0); // No gravity\r\n      expect(ghost.body.setSize).toHaveBeenCalledWith(28, 32); // Smaller collision box\r\n    });\r\n    \r\n    it('should move left with constant horizontal velocity', () => {\r\n      ghost.updateMovement();\r\n      \r\n      expect(ghost.body.setVelocityX).toHaveBeenCalledWith(-80); // Move left\r\n    });\r\n    \r\n    it('should have floating motion with sine wave pattern', () => {\r\n      const initialY = ghost.y;\r\n      mockScene.time.now = 1000;\r\n      \r\n      ghost.updateMovement();\r\n      \r\n      // Y position should change due to floating motion\r\n      // The exact value depends on the sine calculation\r\n      expect(typeof ghost.y).toBe('number');\r\n    });\r\n    \r\n    it('should have transparency effect for ghostly appearance', () => {\r\n      mockScene.time.now = 1000;\r\n      \r\n      ghost.updateMovement();\r\n      \r\n      expect(ghost.setAlpha).toHaveBeenCalled();\r\n      // Alpha should be between 0.6 and 1.0 (0.8  0.2)\r\n      const alphaCall = (ghost.setAlpha as jest.Mock).mock.calls[0][0];\r\n      expect(alphaCall).toBeGreaterThanOrEqual(0.6);\r\n      expect(alphaCall).toBeLessThanOrEqual(1.0);\r\n    });\r\n    \r\n    it('should remove 1 life and disappear on collision per requirement 4.1', () => {\r\n      const destroySpy = jest.spyOn(ghost, 'destroy');\r\n      \r\n      ghost.onCollision();\r\n      \r\n      expect(destroySpy).toHaveBeenCalled();\r\n    });\r\n  });\r\n  \r\n  describe('Vampire', () => {\r\n    let vampire: Vampire;\r\n    \r\n    beforeEach(() => {\r\n      vampire = new Vampire(mockScene as any, 200, 150, 'vampire');\r\n    });\r\n    \r\n    it('should have correct vampire specifications per requirement 4.3', () => {\r\n      expect(vampire.type).toBe('vampire');\r\n      expect(vampire.moveSpeed).toBe(100); // Ground walking speed\r\n      expect(vampire.movementType).toBe('ground');\r\n    });\r\n    \r\n    it('should configure physics for ground movement', () => {\r\n      expect(vampire.body.setGravityY).toHaveBeenCalledWith(300); // Apply gravity\r\n      expect(vampire.body.setSize).toHaveBeenCalledWith(32, 48); // Taller collision box\r\n    });\r\n    \r\n    it('should move left with constant horizontal velocity', () => {\r\n      vampire.updateMovement();\r\n      \r\n      expect(vampire.body.setVelocityX).toHaveBeenCalledWith(-100); // Move left\r\n    });\r\n    \r\n    it('should face left when moving left', () => {\r\n      vampire.updateMovement();\r\n      \r\n      expect(vampire.setFlipX).toHaveBeenCalledWith(true); // Face left\r\n    });\r\n    \r\n    it('should have walking animation with bobbing motion', () => {\r\n      const initialY = vampire.y;\r\n      \r\n      vampire.updateMovement();\r\n      \r\n      // Y position might change due to walking bob effect\r\n      expect(typeof vampire.y).toBe('number');\r\n    });\r\n    \r\n    it('should apply walking bob only when on ground', () => {\r\n      vampire.body.touching.down = true;\r\n      const initialY = vampire.y;\r\n      \r\n      vampire.updateMovement();\r\n      \r\n      // When on ground, bobbing effect should be applied\r\n      // The exact change depends on the animation timer\r\n      expect(typeof vampire.y).toBe('number');\r\n    });\r\n    \r\n    it('should remove 1 life and disappear on collision per requirement 4.3', () => {\r\n      const destroySpy = jest.spyOn(vampire, 'destroy');\r\n      \r\n      vampire.onCollision();\r\n      \r\n      expect(destroySpy).toHaveBeenCalled();\r\n    });\r\n  });\r\n  \r\n  describe('Enemy Movement Patterns', () => {\r\n    it('should have different movement speeds for different enemy types', () => {\r\n      const ghost = new Ghost(mockScene as any, 100, 100);\r\n      const vampire = new Vampire(mockScene as any, 100, 100);\r\n      \r\n      expect(ghost.moveSpeed).toBe(80); // Moderate floating\r\n      expect(vampire.moveSpeed).toBe(100); // Ground walking\r\n    });\r\n    \r\n    it('should have different physics configurations for floating vs ground enemies', () => {\r\n      const ghost = new Ghost(mockScene as any, 100, 100);\r\n      const vampire = new Vampire(mockScene as any, 100, 100);\r\n      \r\n      // Ghost should have no gravity (floating)\r\n      expect(ghost.body.setGravityY).toHaveBeenCalledWith(0);\r\n      \r\n      // Vampire should have gravity (ground)\r\n      expect(vampire.body.setGravityY).toHaveBeenCalledWith(300);\r\n    });\r\n    \r\n    it('should have different collision box sizes for different enemy types', () => {\r\n      const ghost = new Ghost(mockScene as any, 100, 100);\r\n      const vampire = new Vampire(mockScene as any, 100, 100);\r\n      \r\n      // Ghost has smaller collision box\r\n      expect(ghost.body.setSize).toHaveBeenCalledWith(28, 32);\r\n      \r\n      // Vampire has taller collision box (humanoid)\r\n      expect(vampire.body.setSize).toHaveBeenCalledWith(32, 48);\r\n    });\r\n  });\r\n  \r\n  describe('Enemy Collision Behavior', () => {\r\n    it('should all enemies remove 1 life and disappear on contact per requirements 4.1-4.4', () => {\r\n      const ghost = new Ghost(mockScene as any, 100, 100);\r\n      const vampire = new Vampire(mockScene as any, 100, 100);\r\n      \r\n      const ghostDestroySpy = jest.spyOn(ghost, 'destroy');\r\n      const vampireDestroySpy = jest.spyOn(vampire, 'destroy');\r\n      \r\n      ghost.onCollision();\r\n      vampire.onCollision();\r\n      \r\n      expect(ghostDestroySpy).toHaveBeenCalled();\r\n      expect(vampireDestroySpy).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should not process collision when already dead', () => {\r\n      const ghost = new Ghost(mockScene as any, 100, 100);\r\n      ghost.isAlive = false;\r\n      \r\n      const destroySpy = jest.spyOn(ghost, 'destroy');\r\n      \r\n      ghost.onCollision();\r\n      \r\n      expect(destroySpy).not.toHaveBeenCalled();\r\n    });\r\n  });\r\n});","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\entities\\__tests__\\Player.test.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":69,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1480,1483],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1480,1483],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":88,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":88,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1910,1913],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1910,1913],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'texture' is defined but never used. Allowed unused args must match /^_/u.","line":88,"column":55,"nodeType":null,"messageId":"unusedVar","endLine":88,"endColumn":62},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":108,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":108,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2444,2447],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2444,2447],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'femalePlayer' is assigned a value but never used.","line":133,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":133,"endColumn":25},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":133,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":133,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3600,3603],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3600,3603],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":198,"column":32,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":198,"endColumn":67},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":228,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":228,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6659,6662],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6659,6662],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":289,"column":32,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":289,"endColumn":67},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":326,"column":32,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":326,"endColumn":67}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Player } from '../Player';\r\n\r\n// Mock AudioManager\r\njest.mock('../../utils/AudioManager', () => ({\r\n  audioManager: {\r\n    playJumpSound: jest.fn(),\r\n    playDamageSound: jest.fn(),\r\n    playWeaponSound: jest.fn()\r\n  }\r\n}));\r\n\r\n// Mock WeaponFactory\r\njest.mock('../WeaponFactory', () => ({\r\n  WeaponFactory: {\r\n    createWeapon: jest.fn()\r\n  }\r\n}));\r\n\r\n// Mock Phaser classes\r\nclass MockBody {\r\n  public touching = { down: false };\r\n  public velocity = { x: 0, y: 0 };\r\n  \r\n  setCollideWorldBounds = jest.fn();\r\n  setGravityY = jest.fn();\r\n  setSize = jest.fn();\r\n  setOffset = jest.fn();\r\n  setVelocityX = jest.fn((x: number) => { this.velocity.x = x; });\r\n  setVelocityY = jest.fn((y: number) => { this.velocity.y = y; });\r\n}\r\n\r\nclass MockScene {\r\n  public time = {\r\n    now: 0\r\n  };\r\n  \r\n  public registry = {\r\n    get: jest.fn(() => 'boy')\r\n  };\r\n  \r\n  public add = {\r\n    existing: jest.fn(),\r\n    rectangle: jest.fn(() => ({\r\n      destroy: jest.fn(),\r\n      setAlpha: jest.fn()\r\n    })),\r\n    circle: jest.fn(() => ({\r\n      destroy: jest.fn(),\r\n      setScale: jest.fn(),\r\n      setAlpha: jest.fn()\r\n    })),\r\n    graphics: jest.fn(() => ({\r\n      lineStyle: jest.fn(),\r\n      lineBetween: jest.fn(),\r\n      fillStyle: jest.fn(),\r\n      fillCircle: jest.fn(),\r\n      strokeCircle: jest.fn(),\r\n      destroy: jest.fn()\r\n    }))\r\n  };\r\n  \r\n  public physics = {\r\n    add: {\r\n      existing: jest.fn()\r\n    }\r\n  };\r\n  \r\n  public tweens = {\r\n    add: jest.fn((config: any) => {\r\n      if (config.onComplete) {\r\n        config.onComplete();\r\n      }\r\n    })\r\n  };\r\n}\r\n\r\n// Mock Phaser.Physics.Arcade.Sprite\r\njest.mock('phaser', () => ({\r\n  Physics: {\r\n    Arcade: {\r\n      Sprite: class MockSprite {\r\n        public x: number;\r\n        public y: number;\r\n        public body: MockBody;\r\n        public alpha: number = 1;\r\n        public flipX: boolean = false;\r\n        \r\n        constructor(scene: any, x: number, y: number, texture: string) {\r\n          this.x = x;\r\n          this.y = y;\r\n          this.body = new MockBody();\r\n        }\r\n        \r\n        setAlpha = jest.fn((alpha: number) => { this.alpha = alpha; });\r\n        setFlipX = jest.fn((flip: boolean) => { this.flipX = flip; });\r\n        destroy = jest.fn();\r\n      }\r\n    }\r\n  }\r\n}));\r\n\r\ndescribe('Player', () => {\r\n  let mockScene: MockScene;\r\n  let player: Player;\r\n  \r\n  beforeEach(() => {\r\n    mockScene = new MockScene();\r\n    player = new Player(mockScene as any, 100, 100, 'player');\r\n    jest.clearAllMocks();\r\n  });\r\n  \r\n  describe('constructor', () => {\r\n    it('should initialize with correct starting values per requirement 7.1', () => {\r\n      expect(player.lives).toBe(10); // Starting lives\r\n      expect(player.score).toBe(0); // Starting score\r\n      expect(player.weapon).toBeNull();\r\n      expect(player.isInvulnerable).toBe(false);\r\n      expect(player.invulnerabilityTimer).toBe(0);\r\n      expect(player.isCrouching).toBe(false);\r\n      expect(player.isJumping).toBe(false);\r\n    });\r\n    \r\n    it('should configure physics body correctly', () => {\r\n      expect(mockScene.add.existing).toHaveBeenCalledWith(player);\r\n      expect(mockScene.physics.add.existing).toHaveBeenCalledWith(player);\r\n      expect(player.body.setCollideWorldBounds).toHaveBeenCalledWith(true);\r\n      expect(player.body.setGravityY).toHaveBeenCalledWith(300);\r\n      expect(player.body.setSize).toHaveBeenCalledWith(32, 48);\r\n    });\r\n    \r\n    it('should select correct character texture based on registry', () => {\r\n      mockScene.registry.get = jest.fn(() => 'girl');\r\n      const femalePlayer = new Player(mockScene as any, 100, 100, 'player');\r\n      \r\n      expect(mockScene.registry.get).toHaveBeenCalledWith('character');\r\n    });\r\n  });\r\n  \r\n  describe('movement', () => {\r\n    it('should move left when direction is left per requirement 3.1', () => {\r\n      player.move('left');\r\n      \r\n      expect(player.body.setVelocityX).toHaveBeenCalledWith(-200);\r\n      expect(player.setFlipX).toHaveBeenCalledWith(true); // Face left\r\n    });\r\n    \r\n    it('should move right when direction is right per requirement 3.2', () => {\r\n      player.move('right');\r\n      \r\n      expect(player.body.setVelocityX).toHaveBeenCalledWith(200);\r\n      expect(player.setFlipX).toHaveBeenCalledWith(false); // Face right\r\n    });\r\n    \r\n    it('should not move when crouching', () => {\r\n      player.crouch();\r\n      player.move('right');\r\n      \r\n      // Should not set velocity when crouching\r\n      expect(player.body.setVelocityX).toHaveBeenCalledWith(0); // From crouch, not from move\r\n    });\r\n    \r\n    it('should stop movement correctly', () => {\r\n      player.stopMovement();\r\n      \r\n      expect(player.body.setVelocityX).toHaveBeenCalledWith(0);\r\n    });\r\n  });\r\n  \r\n  describe('jumping', () => {\r\n    it('should jump when on ground per requirement 3.3', () => {\r\n      player.body.touching.down = true;\r\n      \r\n      player.jump();\r\n      \r\n      expect(player.body.setVelocityY).toHaveBeenCalledWith(-360);\r\n      expect(player.isJumping).toBe(true);\r\n    });\r\n    \r\n    it('should not jump when not on ground', () => {\r\n      player.body.touching.down = false;\r\n      \r\n      player.jump();\r\n      \r\n      expect(player.body.setVelocityY).not.toHaveBeenCalled();\r\n      expect(player.isJumping).toBe(false);\r\n    });\r\n    \r\n    it('should not jump when crouching', () => {\r\n      player.body.touching.down = true;\r\n      player.crouch();\r\n      \r\n      player.jump();\r\n      \r\n      expect(player.body.setVelocityY).not.toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should play jump sound when jumping', () => {\r\n      const { audioManager } = require('../../utils/AudioManager');\r\n      player.body.touching.down = true;\r\n      \r\n      player.jump();\r\n      \r\n      expect(audioManager.playJumpSound).toHaveBeenCalled();\r\n    });\r\n  });\r\n  \r\n  describe('crouching', () => {\r\n    it('should crouch and modify collision box per requirement 3.4', () => {\r\n      player.crouch();\r\n      \r\n      expect(player.isCrouching).toBe(true);\r\n      expect(player.body.setSize).toHaveBeenCalledWith(32, 24); // Reduced height\r\n      expect(player.body.setOffset).toHaveBeenCalledWith(0, 24);\r\n      expect(player.body.setVelocityX).toHaveBeenCalledWith(0); // Stop movement\r\n    });\r\n    \r\n    it('should stop crouching and restore collision box', () => {\r\n      player.crouch();\r\n      player.stopCrouching();\r\n      \r\n      expect(player.isCrouching).toBe(false);\r\n      expect(player.body.setSize).toHaveBeenCalledWith(32, 48); // Restored height\r\n      expect(player.body.setOffset).toHaveBeenCalledWith(0, 0);\r\n    });\r\n  });\r\n  \r\n  describe('attacking', () => {\r\n    let mockWeapon: any;\r\n    \r\n    beforeEach(() => {\r\n      mockWeapon = {\r\n        type: 'katana',\r\n        range: 40,\r\n        canAttack: jest.fn(() => true),\r\n        attack: jest.fn(),\r\n        getLastAttackTime: jest.fn(() => mockScene.time.now - 50)\r\n      };\r\n      player.setWeapon(mockWeapon);\r\n    });\r\n    \r\n    it('should attack with weapon when available per requirement 3.5', () => {\r\n      player.attack();\r\n      \r\n      expect(mockWeapon.canAttack).toHaveBeenCalled();\r\n      expect(mockWeapon.attack).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should not attack when no weapon is set', () => {\r\n      player.setWeapon(null);\r\n      \r\n      player.attack();\r\n      \r\n      // No weapon, so no attack should occur\r\n      expect(mockWeapon.attack).not.toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should not attack when crouching', () => {\r\n      player.crouch();\r\n      \r\n      player.attack();\r\n      \r\n      expect(mockWeapon.attack).not.toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should not attack when weapon cooldown is not ready', () => {\r\n      mockWeapon.canAttack = jest.fn(() => false);\r\n      \r\n      player.attack();\r\n      \r\n      expect(mockWeapon.attack).not.toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should calculate attack position based on facing direction', () => {\r\n      player.flipX = false; // Facing right\r\n      player.x = 100;\r\n      player.y = 150;\r\n      \r\n      player.attack();\r\n      \r\n      expect(mockWeapon.attack).toHaveBeenCalledWith(140, 150); // x + range\r\n      \r\n      player.flipX = true; // Facing left\r\n      player.attack();\r\n      \r\n      expect(mockWeapon.attack).toHaveBeenCalledWith(60, 150); // x - range\r\n    });\r\n    \r\n    it('should play weapon-specific sound per requirement 11.5', () => {\r\n      const { audioManager } = require('../../utils/AudioManager');\r\n      \r\n      player.attack();\r\n      \r\n      expect(audioManager.playWeaponSound).toHaveBeenCalledWith('katana');\r\n    });\r\n  });\r\n  \r\n  describe('damage and invulnerability', () => {\r\n    it('should take damage and lose life per requirement 7.3', () => {\r\n      player.takeDamage();\r\n      \r\n      expect(player.lives).toBe(9); // Lost 1 life\r\n      expect(player.isInvulnerable).toBe(true);\r\n      expect(player.invulnerabilityTimer).toBe(800); // 800ms invulnerability\r\n      expect(player.setAlpha).toHaveBeenCalledWith(0.5); // Visual feedback\r\n    });\r\n    \r\n    it('should not take damage when already invulnerable', () => {\r\n      player.takeDamage(); // First damage\r\n      const livesAfterFirst = player.lives;\r\n      \r\n      player.takeDamage(); // Second damage while invulnerable\r\n      \r\n      expect(player.lives).toBe(livesAfterFirst); // No additional damage\r\n    });\r\n    \r\n    it('should not take damage when lives are 0', () => {\r\n      player.lives = 0;\r\n      \r\n      player.takeDamage();\r\n      \r\n      expect(player.lives).toBe(0); // Should not go negative\r\n      expect(player.isInvulnerable).toBe(false); // Should not become invulnerable\r\n    });\r\n    \r\n    it('should play damage sound when taking damage per requirement 11.3', () => {\r\n      const { audioManager } = require('../../utils/AudioManager');\r\n      \r\n      player.takeDamage();\r\n      \r\n      expect(audioManager.playDamageSound).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should have 800ms invulnerability duration per requirement 7.4', () => {\r\n      player.takeDamage();\r\n      \r\n      expect(player.invulnerabilityTimer).toBe(800);\r\n    });\r\n  });\r\n  \r\n  describe('scoring and lives', () => {\r\n    it('should add score correctly', () => {\r\n      player.addScore(100);\r\n      expect(player.score).toBe(100);\r\n      \r\n      player.addScore(50);\r\n      expect(player.score).toBe(150);\r\n    });\r\n    \r\n    it('should add life up to maximum of 10 per requirement 6.2', () => {\r\n      player.lives = 8;\r\n      \r\n      player.addLife();\r\n      expect(player.lives).toBe(9);\r\n      \r\n      player.addLife();\r\n      expect(player.lives).toBe(10);\r\n      \r\n      player.addLife(); // Should not exceed 10\r\n      expect(player.lives).toBe(10);\r\n    });\r\n  });\r\n  \r\n  describe('update method', () => {\r\n    it('should update invulnerability timer', () => {\r\n      player.takeDamage();\r\n      const initialTimer = player.invulnerabilityTimer;\r\n      \r\n      player.update(1000, 100); // 100ms delta\r\n      \r\n      expect(player.invulnerabilityTimer).toBe(initialTimer - 100);\r\n    });\r\n    \r\n    it('should end invulnerability when timer expires', () => {\r\n      player.takeDamage();\r\n      \r\n      player.update(1000, 900); // 900ms delta, more than 800ms timer\r\n      \r\n      expect(player.isInvulnerable).toBe(false);\r\n      expect(player.setAlpha).toHaveBeenCalledWith(1); // Restore full opacity\r\n    });\r\n    \r\n    it('should create flashing effect during invulnerability', () => {\r\n      player.takeDamage();\r\n      \r\n      player.update(1000, 50); // Small delta, still invulnerable\r\n      \r\n      expect(player.setAlpha).toHaveBeenCalled();\r\n      // Should be called with either 0.5 or 0.2 for flashing effect\r\n      const alphaCall = (player.setAlpha as jest.Mock).mock.calls.slice(-1)[0][0];\r\n      expect([0.5, 0.2]).toContain(alphaCall);\r\n    });\r\n    \r\n    it('should update jumping state when landing', () => {\r\n      player.isJumping = true;\r\n      player.body.touching.down = true;\r\n      \r\n      player.update(1000, 16);\r\n      \r\n      expect(player.isJumping).toBe(false);\r\n    });\r\n  });\r\n  \r\n  describe('utility methods', () => {\r\n    it('should check if player is on ground correctly', () => {\r\n      player.body.touching.down = true;\r\n      expect(player.isOnGround()).toBe(true);\r\n      \r\n      player.body.touching.down = false;\r\n      expect(player.isOnGround()).toBe(false);\r\n    });\r\n    \r\n    it('should check if player is attacking correctly', () => {\r\n      const mockWeapon = {\r\n        getLastAttackTime: jest.fn(() => mockScene.time.now - 50) // 50ms ago\r\n      };\r\n      player.setWeapon(mockWeapon);\r\n      \r\n      expect(player.isAttacking()).toBe(true); // Within 100ms window\r\n      \r\n      mockWeapon.getLastAttackTime = jest.fn(() => mockScene.time.now - 150); // 150ms ago\r\n      expect(player.isAttacking()).toBe(false); // Outside 100ms window\r\n    });\r\n    \r\n    it('should return correct state information', () => {\r\n      player.x = 200;\r\n      player.y = 300;\r\n      player.lives = 8;\r\n      player.score = 1500;\r\n      player.isInvulnerable = true;\r\n      player.isCrouching = true;\r\n      player.isJumping = false;\r\n      \r\n      const state = player.getState();\r\n      \r\n      expect(state).toEqual({\r\n        x: 200,\r\n        y: 300,\r\n        lives: 8,\r\n        score: 1500,\r\n        isInvulnerable: true,\r\n        isCrouching: true,\r\n        isJumping: false\r\n      });\r\n    });\r\n  });\r\n});","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\entities\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\scenes\\GameScene.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'y2' is assigned a value but never used.","line":1167,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":1167,"endColumn":15}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as Phaser from 'phaser';\r\nimport { Player } from '../entities/Player';\r\nimport { DifficultyConfig } from '../../types';\r\nimport { EnemyFactory, EnemyType } from '../entities/EnemyFactory';\r\nimport { LifeItemFactory, LifeItem } from '../entities/LifeItem';\r\nimport { WeaponFactory } from '../entities/WeaponFactory';\r\nimport { audioManager } from '../utils/AudioManager';\r\nimport { batteryOptimizer } from '../../utils/mobileOptimization';\r\nimport { analyticsService } from '../../lib/analytics';\r\nimport { AdvancedPerformanceMonitor, PerformanceDebugger } from '../../utils/performance';\r\nimport { performanceOptimizer } from '../../utils/performanceOptimizer';\r\nimport { usePerformanceStore } from '../../store/performanceStore';\r\nimport { useAchievementStore } from '../../store/achievementStore';\r\n\r\nexport class GameScene extends Phaser.Scene {\r\n  private player!: Player;\r\n  private enemies!: Phaser.Physics.Arcade.Group;\r\n  private lifeItems!: Phaser.Physics.Arcade.Group;\r\n  private schoolGate!: Phaser.GameObjects.Image;\r\n\r\n  // Parallax background layers\r\n  private backgroundLayers: {\r\n    moon_clouds?: Phaser.GameObjects.TileSprite;\r\n    houses?: Phaser.GameObjects.TileSprite;\r\n    trees?: Phaser.GameObjects.TileSprite;\r\n    street?: Phaser.GameObjects.TileSprite;\r\n  } = {};\r\n\r\n  // World configuration\r\n  private WORLD_WIDTH = 3500;\r\n  private readonly WORLD_HEIGHT = 720;\r\n  private readonly GRAVITY = 300;\r\n\r\n  // Difficulty configuration\r\n  private difficulty: 'easy' | 'medium' | 'impossible' = 'easy';\r\n\r\n  // Game mode configuration\r\n  private gameMode: 'story' | 'endless' | 'timeAttack' | 'survival' | 'practice' = 'story';\r\n\r\n  // Spawning system\r\n  private lastSpawnX: number = 0;\r\n  private spawnInterval: number = 500; // Distance between spawn checks (px) - reduced for more frequent spawning\r\n  private difficultyConfig!: DifficultyConfig;\r\n\r\n  // Side-scrolling spawning system\r\n  private lastEnemySpawnTime: number = 0;\r\n  private lastLifeItemSpawnTime: number = 0;\r\n  private enemySpawnInterval: number = 2000; // Base spawn interval in ms\r\n  private lifeItemSpawnInterval: number = 5000; // Life item spawn interval in ms\r\n\r\n  // Debug counters\r\n  private inputCallCount: number = 0;\r\n  private updateCallCount: number = 0;\r\n\r\n  // Analytics tracking\r\n  private sceneLoadStartTime: number = 0;\r\n\r\n  // Game mode specific properties\r\n  private timeRemaining: number = 0; // For time attack mode\r\n  private survivalLives: number = 3; // For survival mode\r\n  private endlessDistance: number = 0; // For endless mode\r\n  private difficultyMultiplier: number = 1; // For endless mode increasing difficulty\r\n\r\n  // Performance monitoring\r\n  private performanceMonitor: AdvancedPerformanceMonitor;\r\n  private performanceDebugger: PerformanceDebugger;\r\n\r\n  // Performance optimization\r\n  private frameSkipCounter: number = 0;\r\n  private lastQualityCheck: number = 0;\r\n\r\n  // Touch controls state\r\n  private touchControls = {\r\n    moveLeft: false,\r\n    moveRight: false,\r\n    jump: false,\r\n    crouch: false,\r\n    attack: false\r\n  };\r\n\r\n  // Keyboard controls state (from browser-level events)\r\n  private keyboardControls = {\r\n    moveLeft: false,\r\n    moveRight: false,\r\n    jump: false,\r\n    crouch: false,\r\n    attack: false\r\n  };\r\n\r\n  // Keyboard keys (stored as class properties)\r\n  private keys: {\r\n    left?: Phaser.Input.Keyboard.Key;\r\n    right?: Phaser.Input.Keyboard.Key;\r\n    up?: Phaser.Input.Keyboard.Key;\r\n    down?: Phaser.Input.Keyboard.Key;\r\n    a?: Phaser.Input.Keyboard.Key;\r\n    d?: Phaser.Input.Keyboard.Key;\r\n    w?: Phaser.Input.Keyboard.Key;\r\n    s?: Phaser.Input.Keyboard.Key;\r\n    space?: Phaser.Input.Keyboard.Key;\r\n    esc?: Phaser.Input.Keyboard.Key;\r\n  } = {};\r\n\r\n  constructor() {\r\n    super({ key: 'GameScene' });\r\n\r\n    // Initialize performance monitoring\r\n    this.performanceMonitor = new AdvancedPerformanceMonitor();\r\n    this.performanceDebugger = PerformanceDebugger.getInstance();\r\n  }\r\n\r\n  /**\r\n   * Initialize scene data\r\n   */\r\n  init(): void {\r\n    // Track scene load start time for performance metrics\r\n    this.sceneLoadStartTime = performance.now();\r\n\r\n    // Get difficulty and game mode from game registry (set by React component)\r\n    this.difficulty = this.registry.get('difficulty') || 'easy';\r\n    this.gameMode = this.registry.get('gameMode') || 'story';\r\n\r\n    // Initialize difficulty configuration\r\n    this.difficultyConfig = this.getDifficultyConfig();\r\n\r\n    // Initialize game mode specific settings\r\n    this.initializeGameMode();\r\n\r\n    // Initialize spawning system\r\n    this.lastSpawnX = 0;\r\n\r\n    // Initialize side-scrolling spawning timers\r\n    this.lastEnemySpawnTime = 0;\r\n    this.lastLifeItemSpawnTime = 0;\r\n\r\n    // Debug: Check if scene is paused\r\n    console.log('Scene initialized - isPaused:', this.scene.isPaused());\r\n  }\r\n\r\n  /**\r\n   * Preload assets for the game scene\r\n   */\r\n  preload(): void {\r\n    // Create Halloween-themed sprites using graphics\r\n    this.createPlayerSprites();\r\n    this.createBackgroundSprites();\r\n    this.createEnemySprites();\r\n    this.createLifeItemSprites();\r\n    this.createEnvironmentSprites();\r\n  }\r\n\r\n  /**\r\n   * Create player character sprites with animation frames\r\n   */\r\n  private createPlayerSprites(): void {\r\n    this.createBoyCharacterSprites();\r\n    this.createGirlCharacterSprites();\r\n\r\n    // Create default player texture (will be overridden by character selection)\r\n    const defaultGraphics = this.add.graphics();\r\n    defaultGraphics.fillStyle(0x00ff00);\r\n    defaultGraphics.fillRect(0, 0, 32, 50);\r\n    defaultGraphics.generateTexture('player', 32, 50);\r\n    defaultGraphics.destroy();\r\n  }\r\n\r\n  /**\r\n   * Create boy character sprites with animation frames\r\n   */\r\n  private createBoyCharacterSprites(): void {\r\n    const frameWidth = 32;\r\n    const frameHeight = 50;\r\n    const frames = 4; // idle, walk1, walk2, jump\r\n\r\n    // Create spritesheet canvas\r\n    const canvas = this.add.renderTexture(0, 0, frameWidth * frames, frameHeight);\r\n\r\n    // Frame 0: Idle\r\n    this.drawBoyFrame(canvas, 0, 'idle');\r\n\r\n    // Frame 1: Walk 1\r\n    this.drawBoyFrame(canvas, 1, 'walk1');\r\n\r\n    // Frame 2: Walk 2  \r\n    this.drawBoyFrame(canvas, 2, 'walk2');\r\n\r\n    // Frame 3: Jump\r\n    this.drawBoyFrame(canvas, 3, 'jump');\r\n\r\n    // Generate texture from canvas\r\n    canvas.saveTexture('player_boy_spritesheet');\r\n    canvas.destroy();\r\n\r\n    // Create individual frame textures\r\n    for (let i = 0; i < frames; i++) {\r\n      const frameGraphics = this.add.graphics();\r\n      this.drawBoyFrameGraphics(frameGraphics, i === 1 ? 'walk1' : i === 2 ? 'walk2' : i === 3 ? 'jump' : 'idle');\r\n      frameGraphics.generateTexture(`player_boy_${i}`, frameWidth, frameHeight);\r\n      frameGraphics.destroy();\r\n    }\r\n\r\n    // Create main boy texture (idle frame)\r\n    const boyGraphics = this.add.graphics();\r\n    this.drawBoyFrameGraphics(boyGraphics, 'idle');\r\n    boyGraphics.generateTexture('player_boy', frameWidth, frameHeight);\r\n    boyGraphics.destroy();\r\n  }\r\n\r\n  /**\r\n   * Draw boy character frame on render texture\r\n   */\r\n  private drawBoyFrame(canvas: Phaser.GameObjects.RenderTexture, frameIndex: number, pose: string): void {\r\n    const frameWidth = 32;\r\n    const x = frameIndex * frameWidth;\r\n\r\n    const graphics = this.add.graphics();\r\n    this.drawBoyFrameGraphics(graphics, pose);\r\n\r\n    canvas.draw(graphics, x, 0);\r\n    graphics.destroy();\r\n  }\r\n\r\n  /**\r\n   * Draw boy character graphics for different poses\r\n   */\r\n  private drawBoyFrameGraphics(graphics: Phaser.GameObjects.Graphics, pose: string): void {\r\n    const legOffset = pose === 'walk1' ? 2 : pose === 'walk2' ? -2 : 0;\r\n    const armOffset = pose === 'walk1' ? -1 : pose === 'walk2' ? 1 : 0;\r\n    const jumpOffset = pose === 'jump' ? -3 : 0;\r\n\r\n    // Head (skin tone)\r\n    graphics.fillStyle(0xfdbcb4);\r\n    graphics.fillCircle(16, 12 + jumpOffset, 8);\r\n\r\n    // Hair (brown)\r\n    graphics.fillStyle(0x8b4513);\r\n    graphics.fillCircle(16, 8 + jumpOffset, 6);\r\n\r\n    // Eyes\r\n    graphics.fillStyle(0x000000);\r\n    graphics.fillCircle(13, 11 + jumpOffset, 1);\r\n    graphics.fillCircle(19, 11 + jumpOffset, 1);\r\n\r\n    // Body (shirt - blue)\r\n    graphics.fillStyle(0x4169e1);\r\n    graphics.fillRect(10, 20 + jumpOffset, 12, 16);\r\n\r\n    // Arms (skin tone) - animated\r\n    graphics.fillStyle(0xfdbcb4);\r\n    graphics.fillRect(8, 22 + jumpOffset + armOffset, 3, 12);\r\n    graphics.fillRect(21, 22 + jumpOffset - armOffset, 3, 12);\r\n\r\n    // Legs (pants - dark blue) - animated\r\n    graphics.fillStyle(0x191970);\r\n    graphics.fillRect(12, 36 + jumpOffset, 3, 12 + legOffset);\r\n    graphics.fillRect(17, 36 + jumpOffset, 3, 12 - legOffset);\r\n\r\n    // Shoes (black)\r\n    graphics.fillStyle(0x000000);\r\n    graphics.fillRect(11, 46 + jumpOffset + legOffset, 5, 3);\r\n    graphics.fillRect(16, 46 + jumpOffset - legOffset, 5, 3);\r\n  }\r\n\r\n  /**\r\n   * Create girl character sprites with animation frames\r\n   */\r\n  private createGirlCharacterSprites(): void {\r\n    const frameWidth = 32;\r\n    const frameHeight = 50;\r\n    const frames = 4; // idle, walk1, walk2, jump\r\n\r\n    // Create spritesheet canvas\r\n    const canvas = this.add.renderTexture(0, 0, frameWidth * frames, frameHeight);\r\n\r\n    // Frame 0: Idle\r\n    this.drawGirlFrame(canvas, 0, 'idle');\r\n\r\n    // Frame 1: Walk 1\r\n    this.drawGirlFrame(canvas, 1, 'walk1');\r\n\r\n    // Frame 2: Walk 2  \r\n    this.drawGirlFrame(canvas, 2, 'walk2');\r\n\r\n    // Frame 3: Jump\r\n    this.drawGirlFrame(canvas, 3, 'jump');\r\n\r\n    // Generate texture from canvas\r\n    canvas.saveTexture('player_girl_spritesheet');\r\n    canvas.destroy();\r\n\r\n    // Create individual frame textures\r\n    for (let i = 0; i < frames; i++) {\r\n      const frameGraphics = this.add.graphics();\r\n      this.drawGirlFrameGraphics(frameGraphics, i === 1 ? 'walk1' : i === 2 ? 'walk2' : i === 3 ? 'jump' : 'idle');\r\n      frameGraphics.generateTexture(`player_girl_${i}`, frameWidth, frameHeight);\r\n      frameGraphics.destroy();\r\n    }\r\n\r\n    // Create main girl texture (idle frame)\r\n    const girlGraphics = this.add.graphics();\r\n    this.drawGirlFrameGraphics(girlGraphics, 'idle');\r\n    girlGraphics.generateTexture('player_girl', frameWidth, frameHeight);\r\n    girlGraphics.destroy();\r\n  }\r\n\r\n  /**\r\n   * Draw girl character frame on render texture\r\n   */\r\n  private drawGirlFrame(canvas: Phaser.GameObjects.RenderTexture, frameIndex: number, pose: string): void {\r\n    const frameWidth = 32;\r\n    const x = frameIndex * frameWidth;\r\n\r\n    const graphics = this.add.graphics();\r\n    this.drawGirlFrameGraphics(graphics, pose);\r\n\r\n    canvas.draw(graphics, x, 0);\r\n    graphics.destroy();\r\n  }\r\n\r\n  /**\r\n   * Draw girl character graphics for different poses\r\n   */\r\n  private drawGirlFrameGraphics(graphics: Phaser.GameObjects.Graphics, pose: string): void {\r\n    const legOffset = pose === 'walk1' ? 2 : pose === 'walk2' ? -2 : 0;\r\n    const armOffset = pose === 'walk1' ? -1 : pose === 'walk2' ? 1 : 0;\r\n    const jumpOffset = pose === 'jump' ? -3 : 0;\r\n    const dressSwing = pose === 'walk1' ? 1 : pose === 'walk2' ? -1 : 0;\r\n\r\n    // Head (skin tone)\r\n    graphics.fillStyle(0xfdbcb4);\r\n    graphics.fillCircle(16, 12 + jumpOffset, 8);\r\n\r\n    // Hair (blonde)\r\n    graphics.fillStyle(0xffd700);\r\n    graphics.fillCircle(16, 8 + jumpOffset, 7);\r\n\r\n    // Eyes\r\n    graphics.fillStyle(0x000000);\r\n    graphics.fillCircle(13, 11 + jumpOffset, 1);\r\n    graphics.fillCircle(19, 11 + jumpOffset, 1);\r\n\r\n    // Body (dress - pink) - animated swing\r\n    graphics.fillStyle(0xff69b4);\r\n    graphics.fillRect(9 + dressSwing, 20 + jumpOffset, 14, 18);\r\n\r\n    // Arms (skin tone) - animated\r\n    graphics.fillStyle(0xfdbcb4);\r\n    graphics.fillRect(7, 22 + jumpOffset + armOffset, 3, 12);\r\n    graphics.fillRect(22, 22 + jumpOffset - armOffset, 3, 12);\r\n\r\n    // Legs (skin tone) - animated\r\n    graphics.fillStyle(0xfdbcb4);\r\n    graphics.fillRect(12, 38 + jumpOffset, 3, 8 + legOffset);\r\n    graphics.fillRect(17, 38 + jumpOffset, 3, 8 - legOffset);\r\n\r\n    // Shoes (red)\r\n    graphics.fillStyle(0xff0000);\r\n    graphics.fillRect(11, 46 + jumpOffset + legOffset, 5, 3);\r\n    graphics.fillRect(16, 46 + jumpOffset - legOffset, 5, 3);\r\n  }\r\n\r\n  /**\r\n   * Draw a spooky tree silhouette\r\n   */\r\n  private drawSpookyTree(graphics: Phaser.GameObjects.Graphics, x: number, type: string): void {\r\n    const treeHeight = 180 + Math.random() * 120;\r\n    const baseY = 720 - treeHeight;\r\n\r\n    // Tree trunk\r\n    graphics.fillStyle(0x2d1b0e);\r\n    const trunkWidth = type === 'gnarled' ? 20 : 12;\r\n    graphics.fillRect(x, baseY, trunkWidth, treeHeight);\r\n\r\n    // Trunk texture\r\n    graphics.fillStyle(0x1a0f08);\r\n    for (let i = 0; i < 3; i++) {\r\n      graphics.fillRect(x + 2, baseY + i * 40, 2, 15);\r\n    }\r\n\r\n    switch (type) {\r\n      case 'dead':\r\n        // Completely bare with jagged branches\r\n        graphics.fillStyle(0x2d1b0e);\r\n        // Main branches\r\n        graphics.fillRect(x - 25, baseY + 30, 35, 4);\r\n        graphics.fillRect(x + trunkWidth, baseY + 20, 30, 3);\r\n        graphics.fillRect(x - 15, baseY + 50, 20, 3);\r\n\r\n        // Smaller twigs\r\n        graphics.fillRect(x - 30, baseY + 25, 8, 2);\r\n        graphics.fillRect(x + trunkWidth + 25, baseY + 15, 10, 2);\r\n        break;\r\n\r\n      case 'twisted':\r\n        // Curved trunk and twisted branches\r\n        graphics.fillStyle(0x2d1b0e);\r\n        // Curved sections\r\n        graphics.fillRect(x - 5, baseY + 40, trunkWidth + 10, 8);\r\n        graphics.fillRect(x + 5, baseY + 80, trunkWidth, 8);\r\n\r\n        // Twisted branches\r\n        graphics.fillRect(x - 20, baseY + 25, 25, 5);\r\n        graphics.fillRect(x + trunkWidth - 5, baseY + 35, 28, 4);\r\n        graphics.fillRect(x - 10, baseY + 60, 15, 3);\r\n        break;\r\n\r\n      case 'gnarled':\r\n        // Thick trunk with many branches\r\n        graphics.fillStyle(0x2d1b0e);\r\n        // Multiple branch levels\r\n        for (let level = 0; level < 4; level++) {\r\n          const branchY = baseY + 20 + level * 25;\r\n          const leftBranch = 15 + Math.random() * 10;\r\n          const rightBranch = 15 + Math.random() * 10;\r\n\r\n          graphics.fillRect(x - leftBranch, branchY, leftBranch + 5, 4);\r\n          graphics.fillRect(x + trunkWidth, branchY + 5, rightBranch, 3);\r\n        }\r\n        break;\r\n\r\n      default: // normal\r\n        // Standard spooky tree\r\n        graphics.fillStyle(0x2d1b0e);\r\n        graphics.fillRect(x - 20, baseY + 20, 27, 3);\r\n        graphics.fillRect(x + 7, baseY + 30, 28, 3);\r\n        graphics.fillRect(x - 12, baseY + 45, 18, 2);\r\n    }\r\n\r\n    // Sparse dead leaves\r\n    if (Math.random() > 0.6) {\r\n      graphics.fillStyle(0x8b4513);\r\n      const leafCount = Math.floor(Math.random() * 3) + 1;\r\n      for (let l = 0; l < leafCount; l++) {\r\n        const leafX = x - 20 + Math.random() * 40;\r\n        const leafY = baseY + 20 + Math.random() * 40;\r\n        graphics.fillCircle(leafX, leafY, 3 + Math.random() * 3);\r\n      }\r\n    }\r\n\r\n    // Hanging moss or cobwebs\r\n    if (type === 'twisted' && Math.random() > 0.7) {\r\n      graphics.fillStyle(0x666666, 0.6);\r\n      graphics.fillRect(x - 10, baseY + 30, 1, 15);\r\n      graphics.fillRect(x + 15, baseY + 25, 1, 20);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Draw a Halloween-themed house silhouette\r\n   */\r\n  private drawHalloweenHouse(graphics: Phaser.GameObjects.Graphics, x: number, type: string): void {\r\n    let height: number;\r\n    let width: number;\r\n\r\n    switch (type) {\r\n      case 'tall':\r\n        height = 200 + Math.random() * 80;\r\n        width = 80;\r\n        break;\r\n      case 'wide':\r\n        height = 120 + Math.random() * 60;\r\n        width = 140;\r\n        break;\r\n      case 'spooky':\r\n        height = 180 + Math.random() * 70;\r\n        width = 100;\r\n        break;\r\n      case 'mansion':\r\n        height = 250 + Math.random() * 50;\r\n        width = 160;\r\n        break;\r\n      default: // normal\r\n        height = 150 + Math.random() * 80;\r\n        width = 100;\r\n    }\r\n\r\n    const baseY = 720 - height;\r\n\r\n    // House body\r\n    graphics.fillStyle(0x000000);\r\n    graphics.fillRect(x, baseY, width, height);\r\n\r\n    // Roof variations\r\n    if (type === 'spooky') {\r\n      // Crooked spooky roof\r\n      graphics.fillTriangle(\r\n        x - 15, baseY,\r\n        x + width / 2 - 10, baseY - 50,\r\n        x + width + 15, baseY\r\n      );\r\n      // Add chimney\r\n      graphics.fillRect(x + width - 20, baseY - 30, 12, 25);\r\n    } else if (type === 'mansion') {\r\n      // Multiple roof sections\r\n      graphics.fillTriangle(x - 10, baseY, x + 40, baseY - 40, x + 90, baseY);\r\n      graphics.fillTriangle(x + 70, baseY, x + 110, baseY - 35, x + width + 10, baseY);\r\n    } else {\r\n      // Standard triangular roof\r\n      graphics.fillTriangle(\r\n        x - 10, baseY,\r\n        x + width / 2, baseY - 40,\r\n        x + width + 10, baseY\r\n      );\r\n    }\r\n\r\n    // Windows with Halloween decorations\r\n    const windowCount = Math.floor(width / 40);\r\n    for (let w = 0; w < windowCount; w++) {\r\n      const windowX = x + 15 + w * 40;\r\n      const windowY = baseY + 30;\r\n\r\n      // Window frame\r\n      graphics.fillStyle(0x1a1a1a);\r\n      graphics.fillRect(windowX, windowY, 20, 25);\r\n\r\n      // Lit windows (Halloween colors)\r\n      if (Math.random() > 0.4) {\r\n        const lightColor = Math.random() > 0.7 ? 0xff6600 : 0xffff99; // Orange or yellow\r\n        graphics.fillStyle(lightColor);\r\n        graphics.fillRect(windowX + 2, windowY + 2, 16, 21);\r\n\r\n        // Window cross\r\n        graphics.fillStyle(0x000000);\r\n        graphics.fillRect(windowX + 9, windowY + 2, 2, 21);\r\n        graphics.fillRect(windowX + 2, windowY + 12, 16, 2);\r\n      }\r\n    }\r\n\r\n    // Halloween decorations\r\n    if (Math.random() > 0.6) {\r\n      // Porch light\r\n      graphics.fillStyle(0xff6600);\r\n      graphics.fillCircle(x + width / 2, baseY + height - 10, 3);\r\n    }\r\n\r\n    if (type === 'spooky' && Math.random() > 0.5) {\r\n      // Bats around spooky house\r\n      graphics.fillStyle(0x000000);\r\n      graphics.fillEllipse(x - 20, baseY - 20, 8, 4);\r\n      graphics.fillEllipse(x + width + 15, baseY - 30, 6, 3);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create background layer sprites\r\n   */\r\n  private createBackgroundSprites(): void {\r\n    // Moon and clouds layer - Enhanced Halloween atmosphere\r\n    const moonCloudsGraphics = this.add.graphics();\r\n\r\n    // Night sky gradient - deeper Halloween colors\r\n    moonCloudsGraphics.fillGradientStyle(0x0a0a1a, 0x0a0a1a, 0x1a0a2e, 0x1a0a2e, 1);\r\n    moonCloudsGraphics.fillRect(0, 0, 800, 720);\r\n\r\n    // Full moon with eerie glow\r\n    moonCloudsGraphics.fillStyle(0xfff8dc);\r\n    moonCloudsGraphics.fillCircle(650, 100, 45);\r\n\r\n    // Moon glow effect\r\n    moonCloudsGraphics.fillStyle(0xffff99, 0.3);\r\n    moonCloudsGraphics.fillCircle(650, 100, 60);\r\n    moonCloudsGraphics.fillStyle(0xffff99, 0.1);\r\n    moonCloudsGraphics.fillCircle(650, 100, 80);\r\n\r\n    // Moon craters - more detailed\r\n    moonCloudsGraphics.fillStyle(0xe6e6d3);\r\n    moonCloudsGraphics.fillCircle(645, 95, 8);\r\n    moonCloudsGraphics.fillCircle(655, 105, 5);\r\n    moonCloudsGraphics.fillCircle(640, 110, 3);\r\n    moonCloudsGraphics.fillCircle(660, 90, 4);\r\n\r\n    // More stars with twinkling effect\r\n    moonCloudsGraphics.fillStyle(0xffffff);\r\n    for (let i = 0; i < 40; i++) {\r\n      const x = Math.random() * 800;\r\n      const y = Math.random() * 300;\r\n      const size = Math.random() * 2 + 0.5;\r\n      moonCloudsGraphics.fillCircle(x, y, size);\r\n\r\n      // Add some larger, brighter stars\r\n      if (Math.random() > 0.8) {\r\n        moonCloudsGraphics.fillStyle(0xffffcc);\r\n        moonCloudsGraphics.fillCircle(x, y, size + 1);\r\n        moonCloudsGraphics.fillStyle(0xffffff);\r\n      }\r\n    }\r\n\r\n    // Spooky clouds with more detail\r\n    moonCloudsGraphics.fillStyle(0x2a2a2a);\r\n    moonCloudsGraphics.fillEllipse(200, 150, 140, 50);\r\n    moonCloudsGraphics.fillEllipse(180, 140, 80, 30);\r\n    moonCloudsGraphics.fillEllipse(220, 160, 100, 35);\r\n\r\n    moonCloudsGraphics.fillEllipse(500, 200, 120, 45);\r\n    moonCloudsGraphics.fillEllipse(480, 190, 70, 25);\r\n    moonCloudsGraphics.fillEllipse(520, 210, 90, 30);\r\n\r\n    // Wispy cloud edges\r\n    moonCloudsGraphics.fillStyle(0x404040, 0.5);\r\n    moonCloudsGraphics.fillEllipse(150, 145, 60, 20);\r\n    moonCloudsGraphics.fillEllipse(250, 155, 80, 25);\r\n    moonCloudsGraphics.fillEllipse(450, 195, 70, 20);\r\n    moonCloudsGraphics.fillEllipse(550, 205, 60, 18);\r\n\r\n    moonCloudsGraphics.generateTexture('moon_clouds', 800, 720);\r\n    moonCloudsGraphics.destroy();\r\n\r\n    // Houses layer - Enhanced Halloween neighborhood\r\n    const housesGraphics = this.add.graphics();\r\n\r\n    // Dark sky with purple tint\r\n    housesGraphics.fillGradientStyle(0x1a1a3e, 0x1a1a3e, 0x0f0f2e, 0x0f0f2e, 1);\r\n    housesGraphics.fillRect(0, 0, 800, 720);\r\n\r\n    // Halloween house silhouettes with more variety\r\n    const houseTypes = ['normal', 'tall', 'wide', 'spooky', 'mansion'];\r\n    for (let i = 0; i < 6; i++) {\r\n      const x = i * 130 + 30;\r\n      const houseType = houseTypes[i % houseTypes.length];\r\n\r\n      this.drawHalloweenHouse(housesGraphics, x, houseType);\r\n    }\r\n\r\n    housesGraphics.generateTexture('houses', 800, 720);\r\n    housesGraphics.destroy();\r\n\r\n    // Trees layer - Enhanced spooky forest\r\n    const treesGraphics = this.add.graphics();\r\n\r\n    // Darker sky with fog effect\r\n    treesGraphics.fillGradientStyle(0x1a2460, 0x1a2460, 0x0a1040, 0x0a1040, 1);\r\n    treesGraphics.fillRect(0, 0, 800, 720);\r\n\r\n    // Ground fog\r\n    treesGraphics.fillStyle(0x404040, 0.3);\r\n    treesGraphics.fillEllipse(400, 680, 800, 80);\r\n    treesGraphics.fillStyle(0x505050, 0.2);\r\n    treesGraphics.fillEllipse(200, 690, 400, 60);\r\n    treesGraphics.fillEllipse(600, 685, 350, 70);\r\n\r\n    // Spooky trees with more variety\r\n    const treeTypes = ['dead', 'twisted', 'normal', 'gnarled'];\r\n    for (let i = 0; i < 10; i++) {\r\n      const x = i * 80 + 20;\r\n      const treeType = treeTypes[i % treeTypes.length];\r\n\r\n      this.drawSpookyTree(treesGraphics, x, treeType);\r\n    }\r\n\r\n    treesGraphics.generateTexture('trees', 800, 720);\r\n    treesGraphics.destroy();\r\n\r\n    // Street layer - Enhanced Halloween street\r\n    const streetGraphics = this.add.graphics();\r\n\r\n    // Street/ground with Halloween atmosphere\r\n    streetGraphics.fillGradientStyle(0x4a2c6a, 0x4a2c6a, 0x2d1b49, 0x2d1b49, 1);\r\n    streetGraphics.fillRect(0, 0, 800, 100);\r\n\r\n    // Cracked asphalt texture\r\n    streetGraphics.fillStyle(0x3a1c5a);\r\n    for (let i = 0; i < 15; i++) {\r\n      const crackX = Math.random() * 800;\r\n      const crackY = 20 + Math.random() * 60;\r\n      const crackLength = 20 + Math.random() * 40;\r\n      streetGraphics.fillRect(crackX, crackY, crackLength, 1);\r\n\r\n      // Branching cracks\r\n      if (Math.random() > 0.7) {\r\n        streetGraphics.fillRect(crackX + crackLength / 2, crackY, 1, 10);\r\n      }\r\n    }\r\n\r\n    // Street lines - worn and broken\r\n    streetGraphics.fillStyle(0x666666);\r\n    for (let i = 0; i < 800; i += 60) {\r\n      const lineLength = 25 + Math.random() * 10; // Varying lengths\r\n      const lineY = 49 + (Math.random() - 0.5) * 2; // Slight vertical variation\r\n      streetGraphics.fillRect(i, lineY, lineLength, 2);\r\n\r\n      // Some lines are faded/broken\r\n      if (Math.random() > 0.8) {\r\n        streetGraphics.fillStyle(0x444444);\r\n        streetGraphics.fillRect(i + lineLength / 2, lineY, 5, 2);\r\n        streetGraphics.fillStyle(0x666666);\r\n      }\r\n    }\r\n\r\n    // Sidewalk edge with wear\r\n    streetGraphics.fillStyle(0x696969);\r\n    streetGraphics.fillRect(0, 0, 800, 5);\r\n\r\n    // Sidewalk cracks\r\n    streetGraphics.fillStyle(0x555555);\r\n    for (let i = 0; i < 10; i++) {\r\n      const x = i * 80 + Math.random() * 40;\r\n      streetGraphics.fillRect(x, 0, 1, 5);\r\n    }\r\n\r\n    // Fallen leaves on street\r\n    streetGraphics.fillStyle(0x8b4513);\r\n    for (let i = 0; i < 20; i++) {\r\n      const leafX = Math.random() * 800;\r\n      const leafY = 10 + Math.random() * 80;\r\n      streetGraphics.fillEllipse(leafX, leafY, 4, 2);\r\n    }\r\n\r\n    // Puddles reflecting moonlight\r\n    streetGraphics.fillStyle(0x1a1a3a, 0.7);\r\n    streetGraphics.fillEllipse(150, 60, 30, 8);\r\n    streetGraphics.fillEllipse(400, 45, 25, 6);\r\n    streetGraphics.fillEllipse(650, 70, 35, 10);\r\n\r\n    streetGraphics.generateTexture('street', 800, 100);\r\n    streetGraphics.destroy();\r\n  }\r\n\r\n  /**\r\n   * Create enemy sprites with Halloween theme and animations\r\n   */\r\n  private createEnemySprites(): void {\r\n    this.createGhostSprites();\r\n    this.createBatSprites();\r\n    this.createVampireSprites();\r\n    this.createMummySprites();\r\n  }\r\n\r\n  /**\r\n   * Create ghost sprites with floating animation frames\r\n   */\r\n  private createGhostSprites(): void {\r\n    const frameWidth = 32;\r\n    const frameHeight = 40;\r\n    const frames = 3; // float1, float2, float3\r\n\r\n    // Create individual frame textures\r\n    for (let i = 0; i < frames; i++) {\r\n      const frameGraphics = this.add.graphics();\r\n      this.drawGhostFrameGraphics(frameGraphics, i);\r\n      frameGraphics.generateTexture(`ghost_${i}`, frameWidth, frameHeight);\r\n      frameGraphics.destroy();\r\n    }\r\n\r\n    // Create main ghost texture (frame 0)\r\n    const ghostGraphics = this.add.graphics();\r\n    this.drawGhostFrameGraphics(ghostGraphics, 0);\r\n    ghostGraphics.generateTexture('ghost', frameWidth, frameHeight);\r\n    ghostGraphics.destroy();\r\n  }\r\n\r\n  /**\r\n   * Draw ghost frame graphics with floating animation\r\n   */\r\n  private drawGhostFrameGraphics(graphics: Phaser.GameObjects.Graphics, frame: number): void {\r\n    const floatOffset = frame === 1 ? -1 : frame === 2 ? 1 : 0;\r\n    const tailWave = frame === 1 ? 1 : frame === 2 ? -1 : 0;\r\n\r\n    // Ghost body (white with transparency effect)\r\n    graphics.fillStyle(0xf0f0f0);\r\n    graphics.fillEllipse(16, 20 + floatOffset, 28, 32);\r\n\r\n    // Ghost tail (wavy bottom) - animated\r\n    graphics.fillStyle(0xf0f0f0);\r\n    graphics.fillTriangle(2, 32 + floatOffset, 8 + tailWave, 36 + floatOffset, 12, 32 + floatOffset);\r\n    graphics.fillTriangle(12, 32 + floatOffset, 16, 28 + floatOffset + tailWave, 20, 32 + floatOffset);\r\n    graphics.fillTriangle(20, 32 + floatOffset, 24 - tailWave, 36 + floatOffset, 30, 32 + floatOffset);\r\n\r\n    // Eyes (black) - slight blink animation\r\n    const eyeHeight = frame === 1 ? 4 : 6;\r\n    graphics.fillStyle(0x000000);\r\n    graphics.fillEllipse(10, 16 + floatOffset, 4, eyeHeight);\r\n    graphics.fillEllipse(22, 16 + floatOffset, 4, eyeHeight);\r\n\r\n    // Mouth (surprised)\r\n    graphics.fillEllipse(16, 24 + floatOffset, 3, 4);\r\n  }\r\n\r\n  /**\r\n   * Create bat sprites with wing flapping animation\r\n   */\r\n  private createBatSprites(): void {\r\n    const frameWidth = 24;\r\n    const frameHeight = 20;\r\n    const frames = 3; // wings up, wings middle, wings down\r\n\r\n    // Create individual frame textures\r\n    for (let i = 0; i < frames; i++) {\r\n      const frameGraphics = this.add.graphics();\r\n      this.drawBatFrameGraphics(frameGraphics, i);\r\n      frameGraphics.generateTexture(`bat_${i}`, frameWidth, frameHeight);\r\n      frameGraphics.destroy();\r\n    }\r\n\r\n    // Create main bat texture (frame 1 - middle position)\r\n    const batGraphics = this.add.graphics();\r\n    this.drawBatFrameGraphics(batGraphics, 1);\r\n    batGraphics.generateTexture('bat', frameWidth, frameHeight);\r\n    batGraphics.destroy();\r\n  }\r\n\r\n  /**\r\n   * Draw bat frame graphics with wing flapping animation\r\n   */\r\n  private drawBatFrameGraphics(graphics: Phaser.GameObjects.Graphics, frame: number): void {\r\n    const wingAngle = frame === 0 ? -2 : frame === 2 ? 2 : 0;\r\n\r\n    // Bat body\r\n    graphics.fillStyle(0x2d1b0e);\r\n    graphics.fillEllipse(12, 12, 8, 12);\r\n\r\n    // Bat wings - animated flapping\r\n    graphics.fillStyle(0x2d1b0e);\r\n    // Left wing\r\n    graphics.fillTriangle(4, 10 + wingAngle, 0, 6 + wingAngle, 8, 12);\r\n    graphics.fillTriangle(2, 14 - wingAngle, 6, 18 - wingAngle, 8, 12);\r\n    // Right wing  \r\n    graphics.fillTriangle(20, 10 + wingAngle, 24, 6 + wingAngle, 16, 12);\r\n    graphics.fillTriangle(22, 14 - wingAngle, 18, 18 - wingAngle, 16, 12);\r\n\r\n    // Eyes (red)\r\n    graphics.fillStyle(0xff0000);\r\n    graphics.fillCircle(10, 10, 1);\r\n    graphics.fillCircle(14, 10, 1);\r\n  }\r\n\r\n  /**\r\n   * Create vampire sprites with cape animation\r\n   */\r\n  private createVampireSprites(): void {\r\n    const frameWidth = 32;\r\n    const frameHeight = 48;\r\n    const frames = 3; // cape still, cape left, cape right\r\n\r\n    // Create individual frame textures\r\n    for (let i = 0; i < frames; i++) {\r\n      const frameGraphics = this.add.graphics();\r\n      this.drawVampireFrameGraphics(frameGraphics, i);\r\n      frameGraphics.generateTexture(`vampire_${i}`, frameWidth, frameHeight);\r\n      frameGraphics.destroy();\r\n    }\r\n\r\n    // Create main vampire texture (frame 0)\r\n    const vampireGraphics = this.add.graphics();\r\n    this.drawVampireFrameGraphics(vampireGraphics, 0);\r\n    vampireGraphics.generateTexture('vampire', frameWidth, frameHeight);\r\n    vampireGraphics.destroy();\r\n  }\r\n\r\n  /**\r\n   * Draw vampire frame graphics with cape animation\r\n   */\r\n  private drawVampireFrameGraphics(graphics: Phaser.GameObjects.Graphics, frame: number): void {\r\n    const capeSwing = frame === 1 ? -2 : frame === 2 ? 2 : 0;\r\n\r\n    // Head (pale skin)\r\n    graphics.fillStyle(0xe6e6e6);\r\n    graphics.fillCircle(16, 12, 8);\r\n\r\n    // Hair (black)\r\n    graphics.fillStyle(0x000000);\r\n    graphics.fillCircle(16, 8, 6);\r\n\r\n    // Cape collar\r\n    graphics.fillStyle(0x8b0000);\r\n    graphics.fillRect(8, 18, 16, 4);\r\n\r\n    // Eyes (red) - glowing effect\r\n    graphics.fillStyle(0xff0000);\r\n    graphics.fillCircle(13, 11, 1);\r\n    graphics.fillCircle(19, 11, 1);\r\n    // Eye glow\r\n    graphics.fillStyle(0xff6666);\r\n    graphics.fillCircle(13, 11, 2);\r\n    graphics.fillCircle(19, 11, 2);\r\n\r\n    // Fangs\r\n    graphics.fillStyle(0xffffff);\r\n    graphics.fillTriangle(12, 14, 14, 18, 16, 14);\r\n    graphics.fillTriangle(16, 14, 18, 18, 20, 14);\r\n\r\n    // Body (black cape) - animated\r\n    graphics.fillStyle(0x000000);\r\n    graphics.fillRect(6 + capeSwing, 22, 20, 24);\r\n\r\n    // Cape (red interior) - animated swing\r\n    graphics.fillStyle(0x8b0000);\r\n    graphics.fillTriangle(6 + capeSwing, 22, 2 + capeSwing, 46, 10 + capeSwing, 46);\r\n    graphics.fillTriangle(26 + capeSwing, 22, 30 + capeSwing, 46, 22 + capeSwing, 46);\r\n  }\r\n\r\n  /**\r\n   * Create mummy sprites with bandage animation\r\n   */\r\n  private createMummySprites(): void {\r\n    const frameWidth = 32;\r\n    const frameHeight = 48;\r\n    const frames = 3; // bandages normal, bandages loose, bandages tight\r\n\r\n    // Create individual frame textures\r\n    for (let i = 0; i < frames; i++) {\r\n      const frameGraphics = this.add.graphics();\r\n      this.drawMummyFrameGraphics(frameGraphics, i);\r\n      frameGraphics.generateTexture(`mummy_${i}`, frameWidth, frameHeight);\r\n      frameGraphics.destroy();\r\n    }\r\n\r\n    // Create main mummy texture (frame 0)\r\n    const mummyGraphics = this.add.graphics();\r\n    this.drawMummyFrameGraphics(mummyGraphics, 0);\r\n    mummyGraphics.generateTexture('mummy', frameWidth, frameHeight);\r\n    mummyGraphics.destroy();\r\n  }\r\n\r\n  /**\r\n   * Draw mummy frame graphics with bandage animation\r\n   */\r\n  private drawMummyFrameGraphics(graphics: Phaser.GameObjects.Graphics, frame: number): void {\r\n    const bandageOffset = frame === 1 ? 1 : frame === 2 ? -1 : 0;\r\n\r\n    // Body base (beige)\r\n    graphics.fillStyle(0xf5deb3);\r\n    graphics.fillRect(8, 8, 16, 40);\r\n\r\n    // Bandage wrappings (white) - animated\r\n    graphics.fillStyle(0xffffff);\r\n    for (let y = 10; y < 46; y += 6) {\r\n      const offset = (y % 12 === 0) ? bandageOffset : -bandageOffset;\r\n      graphics.fillRect(6 + offset, y, 20, 3);\r\n    }\r\n\r\n    // Head wrappings\r\n    graphics.fillStyle(0xffffff);\r\n    graphics.fillRect(10 + bandageOffset, 8, 12, 12);\r\n\r\n    // Eyes (glowing) - pulsing effect\r\n    const eyeGlow = frame === 1 ? 0xffff99 : 0xffff00;\r\n    graphics.fillStyle(eyeGlow);\r\n    graphics.fillCircle(13, 14, 2);\r\n    graphics.fillCircle(19, 14, 2);\r\n\r\n    // Eye pupils\r\n    graphics.fillStyle(0x000000);\r\n    graphics.fillCircle(13, 14, 1);\r\n    graphics.fillCircle(19, 14, 1);\r\n\r\n    // Loose bandage strips (for frame 1)\r\n    if (frame === 1) {\r\n      graphics.fillStyle(0xf0f0f0);\r\n      graphics.fillRect(4, 25, 2, 8);\r\n      graphics.fillRect(26, 30, 2, 6);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create life item sprites with Halloween theme\r\n   */\r\n  private createLifeItemSprites(): void {\r\n    // Pumpkin life item\r\n    const pumpkinGraphics = this.add.graphics();\r\n\r\n    // Pumpkin body\r\n    pumpkinGraphics.fillStyle(0xff6600);\r\n    pumpkinGraphics.fillEllipse(12, 14, 20, 16);\r\n\r\n    // Pumpkin ridges - using thin rectangles\r\n    pumpkinGraphics.fillStyle(0xcc5500);\r\n    pumpkinGraphics.fillRect(5, 8, 1, 12);   // Left ridge\r\n    pumpkinGraphics.fillRect(12, 6, 1, 16);  // Center ridge\r\n    pumpkinGraphics.fillRect(19, 8, 1, 12);  // Right ridge\r\n\r\n    // Stem\r\n    pumpkinGraphics.fillStyle(0x228b22);\r\n    pumpkinGraphics.fillRect(11, 2, 2, 6);\r\n\r\n    // Jack-o'-lantern face\r\n    pumpkinGraphics.fillStyle(0xffff00);\r\n    pumpkinGraphics.fillTriangle(8, 12, 10, 16, 6, 16);  // Left eye\r\n    pumpkinGraphics.fillTriangle(16, 12, 18, 16, 14, 16); // Right eye\r\n    pumpkinGraphics.fillRect(11, 18, 2, 1); // Nose\r\n\r\n    // Smile - simplified using rectangle\r\n    pumpkinGraphics.fillRect(8, 20, 8, 2);\r\n\r\n    pumpkinGraphics.generateTexture('life_item_pumpkin', 24, 24);\r\n    pumpkinGraphics.destroy();\r\n\r\n    // Lollipop life item\r\n    const lollipopGraphics = this.add.graphics();\r\n\r\n    // Stick\r\n    lollipopGraphics.fillStyle(0xffffff);\r\n    lollipopGraphics.fillRect(11, 12, 2, 10);\r\n\r\n    // Candy (spiral)\r\n    lollipopGraphics.fillStyle(0xff69b4);\r\n    lollipopGraphics.fillCircle(12, 10, 8);\r\n\r\n    // Spiral pattern - simplified using circles\r\n    lollipopGraphics.fillStyle(0xffffff);\r\n    lollipopGraphics.fillCircle(12, 10, 1);\r\n    lollipopGraphics.fillCircle(15, 8, 1);\r\n    lollipopGraphics.fillCircle(9, 12, 1);\r\n    lollipopGraphics.fillCircle(14, 12, 1);\r\n\r\n    lollipopGraphics.generateTexture('life_item_lollipop', 24, 24);\r\n    lollipopGraphics.destroy();\r\n\r\n    // Apple life item\r\n    const appleGraphics = this.add.graphics();\r\n\r\n    // Apple body\r\n    appleGraphics.fillStyle(0xff0000);\r\n    appleGraphics.fillEllipse(12, 14, 16, 18);\r\n\r\n    // Apple indent (top)\r\n    appleGraphics.fillStyle(0xcc0000);\r\n    appleGraphics.fillEllipse(12, 8, 8, 4);\r\n\r\n    // Stem\r\n    appleGraphics.fillStyle(0x8b4513);\r\n    appleGraphics.fillRect(11, 4, 2, 6);\r\n\r\n    // Leaf\r\n    appleGraphics.fillStyle(0x228b22);\r\n    appleGraphics.fillEllipse(15, 6, 4, 2);\r\n\r\n    // Highlight\r\n    appleGraphics.fillStyle(0xff6666);\r\n    appleGraphics.fillEllipse(9, 11, 4, 6);\r\n\r\n    appleGraphics.generateTexture('life_item_apple', 24, 24);\r\n    appleGraphics.destroy();\r\n  }\r\n\r\n  /**\r\n   * Create environment sprites\r\n   */\r\n  private createEnvironmentSprites(): void {\r\n    // Enhanced Halloween school gate\r\n    const gateGraphics = this.add.graphics();\r\n\r\n    // Stone gate posts with texture\r\n    gateGraphics.fillStyle(0x2d1b0e);\r\n    gateGraphics.fillRect(10, 0, 18, 200);\r\n    gateGraphics.fillRect(72, 0, 18, 200);\r\n\r\n    // Stone texture\r\n    gateGraphics.fillStyle(0x1a0f08);\r\n    for (let i = 0; i < 8; i++) {\r\n      gateGraphics.fillRect(12, i * 25, 14, 2);\r\n      gateGraphics.fillRect(74, i * 25 + 10, 14, 2);\r\n    }\r\n\r\n    // Weathered gate posts caps\r\n    gateGraphics.fillStyle(0x3d2b1e);\r\n    gateGraphics.fillRect(8, 0, 22, 8);\r\n    gateGraphics.fillRect(70, 0, 22, 8);\r\n\r\n    // Ornate iron gate bars\r\n    gateGraphics.fillStyle(0x1a1a1a);\r\n    for (let i = 0; i < 6; i++) {\r\n      const x = 28 + i * 8;\r\n      gateGraphics.fillRect(x, 25, 4, 150);\r\n\r\n      // Decorative spear points\r\n      gateGraphics.fillTriangle(x, 25, x + 2, 15, x + 4, 25);\r\n\r\n      // Rust spots\r\n      if (Math.random() > 0.6) {\r\n        gateGraphics.fillStyle(0x8b4513);\r\n        gateGraphics.fillRect(x + 1, 50 + Math.random() * 100, 2, 3);\r\n        gateGraphics.fillStyle(0x1a1a1a);\r\n      }\r\n    }\r\n\r\n    // Gate top with decorative ironwork\r\n    gateGraphics.fillStyle(0x1a1a1a);\r\n    gateGraphics.fillRect(10, 25, 80, 6);\r\n\r\n    // Decorative scrollwork\r\n    gateGraphics.fillStyle(0x2a2a2a);\r\n    gateGraphics.fillCircle(30, 28, 3);\r\n    gateGraphics.fillCircle(50, 28, 3);\r\n    gateGraphics.fillCircle(70, 28, 3);\r\n\r\n    // Weathered school sign\r\n    gateGraphics.fillStyle(0x6b4423);\r\n    gateGraphics.fillRect(18, 45, 64, 35);\r\n\r\n    // Sign frame\r\n    gateGraphics.fillStyle(0x4a2f16);\r\n    gateGraphics.fillRect(16, 43, 68, 39);\r\n    gateGraphics.fillRect(18, 45, 64, 35);\r\n\r\n    // Aged sign background\r\n    gateGraphics.fillStyle(0xf0f0e0);\r\n    gateGraphics.fillRect(20, 47, 60, 31);\r\n\r\n    // Weather stains on sign\r\n    gateGraphics.fillStyle(0xd0d0c0);\r\n    gateGraphics.fillEllipse(25, 52, 8, 4);\r\n    gateGraphics.fillEllipse(70, 70, 6, 3);\r\n\r\n    // Sign text placeholder (would be \"ESCOLA\" in actual implementation)\r\n    gateGraphics.fillStyle(0x2d1b0e);\r\n    gateGraphics.fillRect(25, 52, 50, 3);\r\n    gateGraphics.fillRect(25, 58, 45, 3);\r\n    gateGraphics.fillRect(25, 64, 40, 3);\r\n\r\n    // Ivy growing on posts\r\n    gateGraphics.fillStyle(0x2d4a2d);\r\n    gateGraphics.fillEllipse(15, 120, 8, 25);\r\n    gateGraphics.fillEllipse(12, 140, 6, 20);\r\n    gateGraphics.fillEllipse(85, 110, 7, 30);\r\n\r\n    // Gate hinges\r\n    gateGraphics.fillStyle(0x3a3a3a);\r\n    gateGraphics.fillRect(25, 40, 6, 4);\r\n    gateGraphics.fillRect(25, 160, 6, 4);\r\n\r\n    // Spooky lanterns (unlit)\r\n    gateGraphics.fillStyle(0x1a1a1a);\r\n    gateGraphics.fillRect(5, 35, 8, 12);\r\n    gateGraphics.fillRect(87, 35, 8, 12);\r\n\r\n    // Lantern glass (dark)\r\n    gateGraphics.fillStyle(0x0a0a0a);\r\n    gateGraphics.fillRect(6, 36, 6, 10);\r\n    gateGraphics.fillRect(88, 36, 6, 10);\r\n\r\n    gateGraphics.generateTexture('school_gate', 100, 200);\r\n    gateGraphics.destroy();\r\n\r\n    // Create weapon attack effects\r\n    this.createWeaponEffects();\r\n\r\n    // Create explosion effects\r\n    this.createExplosionEffects();\r\n  }\r\n\r\n  /**\r\n   * Create visual effects for weapon attacks\r\n   */\r\n  private createWeaponEffects(): void {\r\n    // Katana slash effect\r\n    const katanaSlashGraphics = this.add.graphics();\r\n    katanaSlashGraphics.fillStyle(0xc0c0c0, 0.8);\r\n    katanaSlashGraphics.fillEllipse(20, 10, 35, 8);\r\n    katanaSlashGraphics.fillStyle(0xffffff, 0.6);\r\n    katanaSlashGraphics.fillEllipse(20, 10, 25, 5);\r\n    katanaSlashGraphics.generateTexture('katana_slash', 40, 20);\r\n    katanaSlashGraphics.destroy();\r\n\r\n    // Baseball bat impact effect\r\n    const batImpactGraphics = this.add.graphics();\r\n    batImpactGraphics.fillStyle(0xffff99, 0.7);\r\n    batImpactGraphics.fillCircle(15, 15, 12);\r\n    batImpactGraphics.fillStyle(0xffffff, 0.5);\r\n    batImpactGraphics.fillCircle(15, 15, 8);\r\n    // Impact lines\r\n    batImpactGraphics.fillStyle(0xffff00, 0.8);\r\n    for (let i = 0; i < 6; i++) {\r\n      const angle = (i * 60) * Math.PI / 180;\r\n      const x1 = 15 + Math.cos(angle) * 8;\r\n      const y1 = 15 + Math.sin(angle) * 8;\r\n      const x2 = 15 + Math.cos(angle) * 18;\r\n      const y2 = 15 + Math.sin(angle) * 18;\r\n      batImpactGraphics.fillRect(x1, y1, x2 - x1, 2);\r\n    }\r\n    batImpactGraphics.generateTexture('bat_impact', 30, 30);\r\n    batImpactGraphics.destroy();\r\n\r\n    // Laser beam effect\r\n    const laserBeamGraphics = this.add.graphics();\r\n    laserBeamGraphics.fillStyle(0x00ff00, 0.9);\r\n    laserBeamGraphics.fillRect(0, 8, 40, 4);\r\n    laserBeamGraphics.fillStyle(0x88ff88, 0.7);\r\n    laserBeamGraphics.fillRect(0, 9, 40, 2);\r\n    laserBeamGraphics.fillStyle(0xffffff, 0.5);\r\n    laserBeamGraphics.fillRect(0, 10, 40, 1);\r\n    laserBeamGraphics.generateTexture('laser_beam', 40, 20);\r\n    laserBeamGraphics.destroy();\r\n\r\n    // Laser projectile\r\n    const laserProjectileGraphics = this.add.graphics();\r\n    laserProjectileGraphics.fillStyle(0x00ff00);\r\n    laserProjectileGraphics.fillEllipse(6, 6, 10, 4);\r\n    laserProjectileGraphics.fillStyle(0xffffff, 0.8);\r\n    laserProjectileGraphics.fillEllipse(6, 6, 6, 2);\r\n    laserProjectileGraphics.generateTexture('laser_projectile', 12, 12);\r\n    laserProjectileGraphics.destroy();\r\n  }\r\n\r\n  /**\r\n   * Show weapon attack effect at specified position\r\n   */\r\n  public showWeaponEffect(x: number, y: number, weaponType: string): void {\r\n    let effectKey: string;\r\n    let duration: number = 200;\r\n\r\n    switch (weaponType) {\r\n      case 'katana':\r\n        effectKey = 'katana_slash';\r\n        break;\r\n      case 'baseball':\r\n        effectKey = 'bat_impact';\r\n        duration = 300;\r\n        break;\r\n      case 'laser':\r\n        effectKey = 'laser_beam';\r\n        duration = 150;\r\n        break;\r\n      default:\r\n        return;\r\n    }\r\n\r\n    const effect = this.add.image(x, y, effectKey);\r\n    effect.setAlpha(0.8);\r\n    effect.setScale(1.2);\r\n\r\n    // Animate the effect\r\n    this.tweens.add({\r\n      targets: effect,\r\n      scaleX: 1.5,\r\n      scaleY: 1.5,\r\n      alpha: 0,\r\n      duration: duration,\r\n      ease: 'Power2',\r\n      onComplete: () => {\r\n        effect.destroy();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Show explosion effect at specified position\r\n   */\r\n  public showExplosion(x: number, y: number, size: 'small' | 'medium' | 'large' = 'medium'): void {\r\n    const explosionFrames = ['explosion_0', 'explosion_1', 'explosion_2', 'explosion_3', 'explosion_4'];\r\n    let currentFrame = 0;\r\n\r\n    const explosion = this.add.image(x, y, explosionFrames[0]);\r\n\r\n    // Scale based on size\r\n    const scale = size === 'small' ? 0.5 : size === 'large' ? 1.5 : 1.0;\r\n    explosion.setScale(scale);\r\n\r\n    // Animate through explosion frames\r\n    const frameTimer = this.time.addEvent({\r\n      delay: 80,\r\n      callback: () => {\r\n        currentFrame++;\r\n        if (currentFrame < explosionFrames.length) {\r\n          explosion.setTexture(explosionFrames[currentFrame]);\r\n        } else {\r\n          explosion.destroy();\r\n          frameTimer.destroy();\r\n        }\r\n      },\r\n      repeat: explosionFrames.length - 1\r\n    });\r\n\r\n    // Screen shake effect for larger explosions\r\n    if (size === 'large') {\r\n      this.cameras.main.shake(200, 0.01);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create laser projectile\r\n   */\r\n  public createLaserProjectile(x: number, y: number, direction: number): Phaser.GameObjects.Image {\r\n    const projectile = this.add.image(x, y, 'laser_projectile');\r\n    this.physics.add.existing(projectile);\r\n\r\n    const body = projectile.body as Phaser.Physics.Arcade.Body;\r\n    body.setVelocityX(direction * 500); // 500px/s as per requirements\r\n\r\n    // Add glow effect\r\n    projectile.setTint(0x00ff00);\r\n\r\n    // Destroy projectile after 2 seconds or when it goes off screen\r\n    this.time.delayedCall(2000, () => {\r\n      if (projectile.active) {\r\n        projectile.destroy();\r\n      }\r\n    });\r\n\r\n    return projectile;\r\n  }\r\n\r\n  /**\r\n   * Create bazooka rocket projectile\r\n   */\r\n  public createBazookaRocket(x: number, y: number, direction: number): Phaser.GameObjects.Image {\r\n    const rocket = this.add.image(x, y, 'bazooka_rocket');\r\n    this.physics.add.existing(rocket);\r\n\r\n    const body = rocket.body as Phaser.Physics.Arcade.Body;\r\n    body.setVelocityX(direction * 300); // Slower than laser\r\n\r\n    // Flip rocket if going left\r\n    if (direction < 0) {\r\n      rocket.setFlipX(true);\r\n    }\r\n\r\n    // Add exhaust trail effect\r\n    const exhaustTimer = this.time.addEvent({\r\n      delay: 50,\r\n      callback: () => {\r\n        if (rocket.active) {\r\n          const exhaustX = rocket.x - (direction * 15);\r\n          const exhaustY = rocket.y + (Math.random() - 0.5) * 4;\r\n\r\n          const exhaust = this.add.circle(exhaustX, exhaustY, 2, 0xff4500, 0.7);\r\n          this.tweens.add({\r\n            targets: exhaust,\r\n            alpha: 0,\r\n            scale: 0.5,\r\n            duration: 200,\r\n            onComplete: () => exhaust.destroy()\r\n          });\r\n        }\r\n      },\r\n      repeat: -1\r\n    });\r\n\r\n    // Destroy rocket after 3 seconds\r\n    this.time.delayedCall(3000, () => {\r\n      if (rocket.active) {\r\n        exhaustTimer.destroy();\r\n        rocket.destroy();\r\n      }\r\n    });\r\n\r\n    return rocket;\r\n  }\r\n\r\n  /**\r\n   * Create explosion visual effects\r\n   */\r\n  private createExplosionEffects(): void {\r\n    // Create multiple explosion frames for animation\r\n    for (let frame = 0; frame < 5; frame++) {\r\n      const explosionGraphics = this.add.graphics();\r\n      const size = 20 + frame * 15;\r\n      const alpha = 1 - (frame * 0.15);\r\n\r\n      // Outer explosion (orange/red)\r\n      explosionGraphics.fillStyle(0xff4500, alpha);\r\n      explosionGraphics.fillCircle(30, 30, size);\r\n\r\n      // Middle explosion (yellow)\r\n      explosionGraphics.fillStyle(0xffa500, alpha * 0.8);\r\n      explosionGraphics.fillCircle(30, 30, size * 0.7);\r\n\r\n      // Inner explosion (white/yellow)\r\n      explosionGraphics.fillStyle(0xffff00, alpha * 0.6);\r\n      explosionGraphics.fillCircle(30, 30, size * 0.4);\r\n\r\n      // Core (white)\r\n      if (frame < 3) {\r\n        explosionGraphics.fillStyle(0xffffff, alpha * 0.9);\r\n        explosionGraphics.fillCircle(30, 30, size * 0.2);\r\n      }\r\n\r\n      // Explosion sparks\r\n      explosionGraphics.fillStyle(0xff6600, alpha);\r\n      for (let i = 0; i < 8; i++) {\r\n        const angle = (i * 45) * Math.PI / 180;\r\n        const sparkDistance = size + frame * 5;\r\n        const sparkX = 30 + Math.cos(angle) * sparkDistance;\r\n        const sparkY = 30 + Math.sin(angle) * sparkDistance;\r\n        explosionGraphics.fillCircle(sparkX, sparkY, 2);\r\n      }\r\n\r\n      explosionGraphics.generateTexture(`explosion_${frame}`, 60, 60);\r\n      explosionGraphics.destroy();\r\n    }\r\n\r\n    // Bazooka rocket projectile\r\n    const rocketGraphics = this.add.graphics();\r\n    // Rocket body\r\n    rocketGraphics.fillStyle(0x666666);\r\n    rocketGraphics.fillRect(0, 6, 20, 8);\r\n    // Rocket nose\r\n    rocketGraphics.fillStyle(0x444444);\r\n    rocketGraphics.fillTriangle(20, 6, 25, 10, 20, 14);\r\n    // Rocket fins\r\n    rocketGraphics.fillTriangle(0, 6, 0, 2, 5, 6);\r\n    rocketGraphics.fillTriangle(0, 14, 0, 18, 5, 14);\r\n    // Exhaust flame\r\n    rocketGraphics.fillStyle(0xff4500, 0.8);\r\n    rocketGraphics.fillTriangle(0, 8, -8, 10, 0, 12);\r\n    rocketGraphics.fillStyle(0xffff00, 0.6);\r\n    rocketGraphics.fillTriangle(0, 9, -5, 10, 0, 11);\r\n\r\n    rocketGraphics.generateTexture('bazooka_rocket', 33, 20);\r\n    rocketGraphics.destroy();\r\n  }\r\n\r\n  /**\r\n   * Create game objects and set up the scene\r\n   */\r\n  create(): void {\r\n    // Start scene creation profiling\r\n    this.performanceDebugger.startProfile('scene-creation');\r\n    this.performanceDebugger.setMarker('scene-create-start');\r\n\r\n    // Set world bounds\r\n    this.physics.world.setBounds(0, 0, this.WORLD_WIDTH, this.WORLD_HEIGHT);\r\n\r\n    // Set up Arcade Physics with gravity\r\n    this.physics.world.gravity.y = this.GRAVITY;\r\n\r\n    // Initialize audio system\r\n    this.setupAudio();\r\n\r\n    // Create parallax background layers\r\n    this.createBackgroundLayers();\r\n\r\n    // Create player\r\n    this.createPlayer();\r\n\r\n    // Create groups for enemies and life items\r\n    this.createGroups();\r\n\r\n    // Create school gate at the end of the level\r\n    this.createSchoolGate();\r\n\r\n    // Set up camera to follow player\r\n    this.setupCamera();\r\n\r\n    // Set up input controls\r\n    this.setupControls();\r\n\r\n    // Spawn some initial enemies for testing\r\n    this.spawnInitialEnemies();\r\n\r\n    // Track scene load time for analytics\r\n    const loadTime = performance.now() - this.sceneLoadStartTime;\r\n    analyticsService.trackPerformanceMetrics(loadTime);\r\n\r\n    // Initialize achievements and trigger game start\r\n    this.initializeAchievements();\r\n\r\n    // End scene creation profiling\r\n    this.performanceDebugger.setMarker('scene-create-end');\r\n    const creationTime = this.performanceDebugger.endProfile('scene-creation');\r\n    this.performanceDebugger.log('info', 'Scene creation completed', {\r\n      loadTime,\r\n      creationTime,\r\n      totalObjects: this.enemies.children.size + this.lifeItems.children.size + 1,\r\n    });\r\n\r\n    // Set up render performance monitoring\r\n    this.setupRenderMonitoring();\r\n\r\n    // Debug: Final scene state\r\n    console.log('GameScene created successfully - isPaused:', this.scene.isPaused());\r\n    console.log('Player position:', this.player.x, this.player.y);\r\n    console.log('Player visible:', this.player.visible);\r\n    console.log('Scene load time:', loadTime, 'ms');\r\n    console.log('Scene creation time:', creationTime, 'ms');\r\n  }\r\n\r\n  /**\r\n   * Set up render performance monitoring\r\n   */\r\n  private setupRenderMonitoring(): void {\r\n    // Hook into Phaser's render events\r\n    this.sys.events.on('prerender', () => {\r\n      this.performanceMonitor.startRenderMeasurement();\r\n    });\r\n\r\n    this.sys.events.on('postrender', () => {\r\n      this.performanceMonitor.endRenderMeasurement();\r\n      this.performanceMonitor.recordDrawCall();\r\n    });\r\n\r\n    // Monitor scene events for performance tracking\r\n    this.sys.events.on('pause', () => {\r\n      this.performanceDebugger.log('info', 'Scene paused');\r\n    });\r\n\r\n    this.sys.events.on('resume', () => {\r\n      this.performanceDebugger.log('info', 'Scene resumed');\r\n    });\r\n\r\n    this.sys.events.on('destroy', () => {\r\n      this.performanceDebugger.log('info', 'Scene destroyed');\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Spawn some initial enemies for immediate gameplay\r\n   */\r\n  private spawnInitialEnemies(): void {\r\n    const camera = this.cameras.main;\r\n    const groundY = this.WORLD_HEIGHT - 100;\r\n\r\n    // Spawn a few enemies at different distances from the right side of the screen\r\n    const initialSpawns = [\r\n      { distance: 200, type: 'ghost' as const },\r\n      { distance: 400, type: 'bat' as const },\r\n      { distance: 600, type: 'vampire' as const },\r\n      { distance: 800, type: 'mummy' as const }\r\n    ];\r\n\r\n    initialSpawns.forEach(spawn => {\r\n      const spawnX = camera.width + spawn.distance; // Spawn to the right of the screen\r\n      const spawnY = EnemyFactory.getSpawnHeight(spawn.type, groundY);\r\n      const enemy = EnemyFactory.createEnemy(this, spawnX, spawnY, spawn.type);\r\n      this.enemies.add(enemy);\r\n      console.log(`Initial spawn: ${spawn.type} at (${spawnX}, ${spawnY})`);\r\n    });\r\n\r\n    // Also spawn some life items for testing\r\n    const lifeItemSpawns = [\r\n      { distance: 300, type: 'pumpkin' as const },\r\n      { distance: 500, type: 'lollipop' as const },\r\n      { distance: 700, type: 'apple' as const }\r\n    ];\r\n\r\n    lifeItemSpawns.forEach(spawn => {\r\n      const spawnX = camera.width + spawn.distance; // Spawn to the right of the screen\r\n      const spawnY = LifeItemFactory.getSpawnHeight(groundY);\r\n      const lifeItem = LifeItemFactory.createLifeItem(this, spawnX, spawnY, spawn.type);\r\n      this.lifeItems.add(lifeItem);\r\n      console.log(`Initial life item: ${spawn.type} at (${spawnX}, ${spawnY})`);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Create parallax background layers\r\n   */\r\n  private createBackgroundLayers(): void {\r\n    // Create background layers with different scroll speeds for parallax effect\r\n    // Layers are ordered from back to front\r\n\r\n    // Moon and clouds (slowest parallax)\r\n    this.backgroundLayers.moon_clouds = this.add.tileSprite(\r\n      0, 0,\r\n      this.WORLD_WIDTH,\r\n      this.WORLD_HEIGHT,\r\n      'moon_clouds'\r\n    );\r\n    this.backgroundLayers.moon_clouds.setOrigin(0, 0);\r\n    this.backgroundLayers.moon_clouds.setScrollFactor(0.1);\r\n\r\n    // Houses (medium parallax)\r\n    this.backgroundLayers.houses = this.add.tileSprite(\r\n      0, 0,\r\n      this.WORLD_WIDTH,\r\n      this.WORLD_HEIGHT,\r\n      'houses'\r\n    );\r\n    this.backgroundLayers.houses.setOrigin(0, 0);\r\n    this.backgroundLayers.houses.setScrollFactor(0.3);\r\n\r\n    // Trees (faster parallax)\r\n    this.backgroundLayers.trees = this.add.tileSprite(\r\n      0, 0,\r\n      this.WORLD_WIDTH,\r\n      this.WORLD_HEIGHT,\r\n      'trees'\r\n    );\r\n    this.backgroundLayers.trees.setOrigin(0, 0);\r\n    this.backgroundLayers.trees.setScrollFactor(0.6);\r\n\r\n    // Street (foreground, moves with camera)\r\n    this.backgroundLayers.street = this.add.tileSprite(\r\n      0, this.WORLD_HEIGHT - 100,\r\n      this.WORLD_WIDTH,\r\n      100,\r\n      'street'\r\n    );\r\n    this.backgroundLayers.street.setOrigin(0, 0);\r\n    this.backgroundLayers.street.setScrollFactor(1);\r\n  }\r\n\r\n  /**\r\n   * Create the player character\r\n   */\r\n  private createPlayer(): void {\r\n    // Create player at starting position (left side of the world)\r\n    this.player = new Player(this, 100, this.WORLD_HEIGHT - 150, 'player');\r\n\r\n    // Set player collision with world bounds\r\n    this.player.setCollideWorldBounds(true);\r\n\r\n    // Set lives based on game mode\r\n    this.setPlayerLivesForGameMode();\r\n\r\n    // Initialize weapon based on game registry\r\n    const weaponType = this.registry.get('weapon') || 'katana';\r\n    const weapon = WeaponFactory.createWeapon(this, weaponType);\r\n    this.player.setWeapon(weapon);\r\n\r\n    // Create ground platform for the player to stand on\r\n    this.createGround();\r\n\r\n    // Initialize HUD with player's starting stats (with delay to ensure React listeners are ready)\r\n    setTimeout(() => {\r\n      this.updateGameState();\r\n    }, 200);\r\n  }\r\n\r\n  /**\r\n   * Create ground platform for player physics\r\n   */\r\n  private createGround(): void {\r\n    // Create invisible ground platform at the bottom\r\n    const ground = this.add.rectangle(\r\n      this.WORLD_WIDTH / 2,\r\n      this.WORLD_HEIGHT - 50,\r\n      this.WORLD_WIDTH,\r\n      100,\r\n      0x000000,\r\n      0 // Invisible\r\n    );\r\n\r\n    // Enable physics for ground collision\r\n    this.physics.add.existing(ground, true); // true = static body\r\n\r\n    // Set up collision between player and ground\r\n    this.physics.add.collider(this.player, ground);\r\n  }\r\n\r\n  /**\r\n   * Create groups for game objects\r\n   */\r\n  private createGroups(): void {\r\n    // Create enemy group with physics\r\n    this.enemies = this.physics.add.group({\r\n      runChildUpdate: true // Automatically call update on all group members\r\n    });\r\n\r\n    // Create life items group with physics\r\n    this.lifeItems = this.physics.add.group({\r\n      runChildUpdate: true\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Create the school gate at the end of the level\r\n   */\r\n  private createSchoolGate(): void {\r\n    // Place school gate at the end of the world using the proper sprite\r\n    this.schoolGate = this.add.image(\r\n      this.WORLD_WIDTH - 50,\r\n      this.WORLD_HEIGHT - 100,\r\n      'school_gate'\r\n    );\r\n\r\n    // Enable physics for collision detection\r\n    this.physics.add.existing(this.schoolGate, true); // true = static body\r\n  }\r\n\r\n  /**\r\n   * Set up camera to follow player with smooth scrolling\r\n   */\r\n  private setupCamera(): void {\r\n    // Make camera follow the player\r\n    this.cameras.main.startFollow(this.player);\r\n\r\n    // Set camera bounds to world bounds\r\n    this.cameras.main.setBounds(0, 0, this.WORLD_WIDTH, this.WORLD_HEIGHT);\r\n\r\n    // Configure smooth camera following\r\n    this.cameras.main.setFollowOffset(0, 0);\r\n    this.cameras.main.setLerp(0.1, 0.1); // Smooth camera movement\r\n\r\n    // Set camera deadzone for smoother following\r\n    this.cameras.main.setDeadzone(100, 50);\r\n  }\r\n\r\n  /**\r\n   * Set up audio system\r\n   * Requirements: 11.1\r\n   */\r\n  private setupAudio(): void {\r\n    // Initialize audio manager\r\n    audioManager.initialize();\r\n\r\n    // Start background music (wind and crickets ambient sound)\r\n    audioManager.playBackgroundMusic();\r\n\r\n    console.log('Audio system initialized');\r\n  }\r\n\r\n  /**\r\n   * Set up keyboard controls\r\n   * Requirements: 3.1, 3.2, 3.3, 3.4, 3.5, 3.6\r\n   */\r\n  private setupControls(): void {\r\n    // Ensure keyboard input is available\r\n    if (!this.input.keyboard) {\r\n      console.warn('Keyboard input not available');\r\n      return;\r\n    }\r\n\r\n    console.log('Setting up keyboard controls...');\r\n\r\n    // Create and store keys in class properties\r\n    this.keys.left = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.LEFT);\r\n    this.keys.right = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.RIGHT);\r\n    this.keys.up = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.UP);\r\n    this.keys.down = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.DOWN);\r\n    this.keys.a = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A);\r\n    this.keys.d = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.D);\r\n    this.keys.w = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.W);\r\n    this.keys.s = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.S);\r\n    this.keys.space = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE);\r\n    this.keys.esc = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.ESC);\r\n\r\n    // Debug: Log the created keys\r\n    console.log('Keys created:', {\r\n      left: !!this.keys.left,\r\n      right: !!this.keys.right,\r\n      a: !!this.keys.a,\r\n      d: !!this.keys.d,\r\n      w: !!this.keys.w,\r\n      s: !!this.keys.s,\r\n      space: !!this.keys.space\r\n    });\r\n\r\n    // Add debug logging for key presses\r\n    this.input.keyboard.on('keydown', (event: KeyboardEvent) => {\r\n      console.log('Key pressed:', event.code);\r\n    });\r\n\r\n    // Add specific key listeners for debugging\r\n    this.keys.a?.on('down', () => console.log('A key DOWN detected'));\r\n    this.keys.d?.on('down', () => console.log('D key DOWN detected'));\r\n    this.keys.left?.on('down', () => console.log('LEFT arrow DOWN detected'));\r\n    this.keys.right?.on('down', () => console.log('RIGHT arrow DOWN detected'));\r\n\r\n    console.log('Keyboard controls set up successfully');\r\n\r\n    // Prevent default browser behavior for game keys\r\n    this.input.keyboard.addCapture([\r\n      Phaser.Input.Keyboard.KeyCodes.W,\r\n      Phaser.Input.Keyboard.KeyCodes.A,\r\n      Phaser.Input.Keyboard.KeyCodes.S,\r\n      Phaser.Input.Keyboard.KeyCodes.D,\r\n      Phaser.Input.Keyboard.KeyCodes.SPACE,\r\n      Phaser.Input.Keyboard.KeyCodes.UP,\r\n      Phaser.Input.Keyboard.KeyCodes.DOWN,\r\n      Phaser.Input.Keyboard.KeyCodes.LEFT,\r\n      Phaser.Input.Keyboard.KeyCodes.RIGHT,\r\n      Phaser.Input.Keyboard.KeyCodes.ESC\r\n    ]);\r\n  }\r\n\r\n  /**\r\n   * Get difficulty configuration based on current difficulty setting\r\n   * Requirements: 12.1, 12.2, 12.3\r\n   */\r\n  private getDifficultyConfig(): DifficultyConfig {\r\n    const configs: Record<string, DifficultyConfig> = {\r\n      easy: {\r\n        enemySpawnRate: 2,       // Few enemies (2 per 1000px)\r\n        lifeItemSpawnRate: 8,    // Many life items (8 per 1000px)\r\n        enemyTypes: ['ghost', 'bat'] // Easier enemies only\r\n      },\r\n      medium: {\r\n        enemySpawnRate: 4,       // Some enemies (4 per 1000px)\r\n        lifeItemSpawnRate: 3,    // Few life items (3 per 1000px)\r\n        enemyTypes: ['ghost', 'bat', 'vampire', 'mummy'] // All enemies\r\n      },\r\n      impossible: {\r\n        enemySpawnRate: 8,       // Many enemies (8 per 1000px)\r\n        lifeItemSpawnRate: 0,    // Zero life items\r\n        enemyTypes: ['vampire', 'mummy', 'ghost', 'bat'] // All enemies, prioritize harder ones\r\n      }\r\n    };\r\n\r\n    return configs[this.difficulty];\r\n  }\r\n\r\n  /**\r\n   * Initialize game mode specific settings\r\n   */\r\n  private initializeGameMode(): void {\r\n    switch (this.gameMode) {\r\n      case 'timeAttack':\r\n        this.timeRemaining = 300; // 5 minutes in seconds\r\n        break;\r\n      case 'survival':\r\n        this.survivalLives = 3;\r\n        // Override difficulty config to remove life items\r\n        this.difficultyConfig.lifeItemSpawnRate = 0;\r\n        break;\r\n      case 'practice':\r\n        // Override difficulty to make it easier\r\n        this.difficultyConfig.enemySpawnRate = 1;\r\n        this.difficultyConfig.lifeItemSpawnRate = 10;\r\n        break;\r\n      case 'endless':\r\n        this.endlessDistance = 0;\r\n        this.difficultyMultiplier = 1;\r\n        // Start with easier settings that will increase\r\n        this.difficultyConfig.enemySpawnRate = 1;\r\n        this.difficultyConfig.lifeItemSpawnRate = 5;\r\n        break;\r\n      case 'story':\r\n      default:\r\n        // Use default difficulty settings\r\n        break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update game mode specific logic\r\n   */\r\n  private updateGameMode(time: number, delta: number): void {\r\n    switch (this.gameMode) {\r\n      case 'timeAttack':\r\n        this.updateTimeAttackMode(delta);\r\n        break;\r\n      case 'endless':\r\n        this.updateEndlessMode();\r\n        break;\r\n      case 'survival':\r\n        this.updateSurvivalMode();\r\n        break;\r\n      case 'practice':\r\n        this.updatePracticeMode();\r\n        break;\r\n      case 'story':\r\n      default:\r\n        // No special updates needed for story mode\r\n        break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update time attack mode - countdown timer\r\n   */\r\n  private updateTimeAttackMode(delta: number): void {\r\n    this.timeRemaining -= delta / 1000; // Convert delta to seconds\r\n\r\n    if (this.timeRemaining <= 0) {\r\n      this.timeRemaining = 0;\r\n      // End game due to time running out\r\n      this.endGame(false, 'Time ran out!');\r\n    }\r\n\r\n    // Emit time update for HUD\r\n    this.events.emit('timeUpdate', { timeRemaining: Math.ceil(this.timeRemaining) });\r\n\r\n    // Also emit to window for React components\r\n    if (typeof window !== 'undefined') {\r\n      window.dispatchEvent(new CustomEvent('timeUpdate', {\r\n        detail: { timeRemaining: Math.ceil(this.timeRemaining) }\r\n      }));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update endless mode - increasing difficulty\r\n   */\r\n  private updateEndlessMode(): void {\r\n    // Calculate distance traveled\r\n    this.endlessDistance = this.player.x;\r\n\r\n    // Increase difficulty every 1000px\r\n    const newMultiplier = 1 + Math.floor(this.endlessDistance / 1000) * 0.2;\r\n    if (newMultiplier > this.difficultyMultiplier) {\r\n      this.difficultyMultiplier = newMultiplier;\r\n\r\n      // Update spawn rates based on multiplier\r\n      const baseConfig = this.getDifficultyConfig();\r\n      this.difficultyConfig.enemySpawnRate = Math.floor(baseConfig.enemySpawnRate * this.difficultyMultiplier);\r\n      this.difficultyConfig.lifeItemSpawnRate = Math.max(1, Math.floor(baseConfig.lifeItemSpawnRate / this.difficultyMultiplier));\r\n\r\n      console.log(`Endless mode difficulty increased: ${this.difficultyMultiplier}x`);\r\n    }\r\n\r\n    // Extend world bounds as player progresses\r\n    if (this.endlessDistance > this.WORLD_WIDTH - 1000) {\r\n      this.WORLD_WIDTH += 1000;\r\n      this.physics.world.setBounds(0, 0, this.WORLD_WIDTH, this.WORLD_HEIGHT);\r\n\r\n      // Update background layers\r\n      if (this.backgroundLayers.street) {\r\n        this.backgroundLayers.street.setSize(this.WORLD_WIDTH, 100);\r\n      }\r\n      if (this.backgroundLayers.trees) {\r\n        this.backgroundLayers.trees.setSize(this.WORLD_WIDTH, this.WORLD_HEIGHT);\r\n      }\r\n      if (this.backgroundLayers.houses) {\r\n        this.backgroundLayers.houses.setSize(this.WORLD_WIDTH, this.WORLD_HEIGHT);\r\n      }\r\n      if (this.backgroundLayers.moon_clouds) {\r\n        this.backgroundLayers.moon_clouds.setSize(this.WORLD_WIDTH, this.WORLD_HEIGHT);\r\n      }\r\n    }\r\n\r\n    // Emit distance update for HUD\r\n    this.events.emit('distanceUpdate', { distance: Math.floor(this.endlessDistance) });\r\n\r\n    // Also emit to window for React components\r\n    if (typeof window !== 'undefined') {\r\n      window.dispatchEvent(new CustomEvent('distanceUpdate', {\r\n        detail: {\r\n          distance: Math.floor(this.endlessDistance),\r\n          difficultyMultiplier: this.difficultyMultiplier\r\n        }\r\n      }));\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update survival mode - track limited lives\r\n   */\r\n  private updateSurvivalMode(): void {\r\n    // Lives are already tracked by the player entity\r\n    // Just emit survival stats for HUD\r\n    this.events.emit('survivalUpdate', {\r\n      lives: this.player.lives,\r\n      maxLives: this.survivalLives\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Update practice mode - unlimited lives\r\n   */\r\n  private updatePracticeMode(): void {\r\n    // Ensure player always has lives in practice mode\r\n    if (this.player.lives <= 0) {\r\n      this.player.lives = 999;\r\n      this.updateGameState();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Set player lives based on game mode\r\n   */\r\n  private setPlayerLivesForGameMode(): void {\r\n    switch (this.gameMode) {\r\n      case 'survival':\r\n        this.player.lives = 3;\r\n        break;\r\n      case 'practice':\r\n        this.player.lives = 999;\r\n        break;\r\n      case 'story':\r\n      case 'timeAttack':\r\n      case 'endless':\r\n      default:\r\n        this.player.lives = 10; // Default lives\r\n        break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update method called every frame\r\n   */\r\n  update(time: number, delta: number): void {\r\n    // Start performance measurement\r\n    this.performanceMonitor.startUpdateMeasurement();\r\n\r\n    // Update performance optimizer\r\n    performanceOptimizer.update();\r\n\r\n    // Check if we should skip this frame for performance\r\n    const optimizationSettings = performanceOptimizer.getOptimizationSettings();\r\n    if (optimizationSettings.skipFrames) {\r\n      this.frameSkipCounter++;\r\n      if (this.frameSkipCounter % 2 === 0) {\r\n        this.performanceMonitor.endUpdateMeasurement();\r\n        return; // Skip every other frame\r\n      }\r\n    }\r\n\r\n    // Debug: Count update calls\r\n    this.updateCallCount++;\r\n    if (this.updateCallCount % 60 === 0) { // Log every 60 frames\r\n      console.log('Update called', this.updateCallCount, 'times');\r\n\r\n      // Update performance metrics and log if performance is low\r\n      const metrics = this.performanceMonitor.update();\r\n      if (metrics.isLowPerformance) {\r\n        this.performanceDebugger.log('warn', 'Low performance detected', {\r\n          fps: metrics.fps,\r\n          frameTime: metrics.frameTime,\r\n          activeObjects: metrics.activeObjects,\r\n        });\r\n\r\n        // Apply emergency optimizations if performance is critically low\r\n        if (metrics.fps < 15) {\r\n          performanceOptimizer.applyEmergencyOptimizations();\r\n        }\r\n      }\r\n    }\r\n\r\n    // Apply battery optimization settings\r\n    this.applyBatteryOptimizations();\r\n\r\n    // Apply performance optimizations\r\n    this.applyPerformanceOptimizations();\r\n\r\n    // Update player\r\n    this.player.update(time, delta);\r\n\r\n    // Update game mode specific logic\r\n    this.updateGameMode(time, delta);\r\n\r\n    // Handle input\r\n    this.handleInput();\r\n\r\n    // Update parallax backgrounds (conditionally based on optimizations)\r\n    const shouldUpdateParallax = this.shouldUpdateParallax();\r\n    if (shouldUpdateParallax) {\r\n      this.updateParallax();\r\n    }\r\n\r\n    // Handle spawning system (with reduced frequency if needed)\r\n    const shouldUpdateSpawning = this.shouldUpdateSpawning();\r\n    if (shouldUpdateSpawning) {\r\n      this.updateSpawning();\r\n    }\r\n\r\n    // Handle collisions\r\n    this.handleCollisions();\r\n\r\n    // Update game state and emit events to React\r\n    this.updateGameState();\r\n\r\n    // Check for game end conditions\r\n    this.checkGameEndConditions();\r\n\r\n    // Record object count for performance monitoring\r\n    const totalObjects = this.enemies.children.size + this.lifeItems.children.size + 1; // +1 for player\r\n    this.performanceMonitor.recordObjectCount(totalObjects);\r\n\r\n    // Cull off-screen objects if optimization is enabled\r\n    if (optimizationSettings.cullOffscreenObjects) {\r\n      this.cullOffscreenObjects();\r\n    }\r\n\r\n    // Force garbage collection periodically if enabled\r\n    if (optimizationSettings.aggressiveGarbageCollection && this.updateCallCount % 300 === 0) {\r\n      performanceOptimizer.forceGarbageCollection();\r\n    }\r\n\r\n    // End performance measurement\r\n    this.performanceMonitor.endUpdateMeasurement();\r\n  }\r\n\r\n  /**\r\n   * Handle player input (keyboard and touch controls)\r\n   * Requirements: 3.1, 3.2, 3.3, 3.4, 3.5, 3.6\r\n   */\r\n  private handleInput(): void {\r\n    // Debug: Count how many times this is called\r\n    this.inputCallCount++;\r\n    if (this.inputCallCount % 60 === 0) { // Log every 60 frames (about once per second)\r\n      console.log('handleInput called', this.inputCallCount, 'times');\r\n    }\r\n\r\n    // Skip input handling if game is paused\r\n    if (this.scene.isPaused()) {\r\n      console.log('Game is paused, skipping input');\r\n      return;\r\n    }\r\n\r\n    // Check if keys are available\r\n    if (!this.keys.left || !this.keys.right) {\r\n      console.warn('Keys not initialized yet');\r\n      return;\r\n    }\r\n\r\n    // Ensure canvas has focus (check every 5 seconds)\r\n    if (this.inputCallCount % 300 === 0) {\r\n      const canvas = this.game.canvas;\r\n      if (canvas && document.activeElement !== canvas) {\r\n        console.log('Canvas lost focus, refocusing...');\r\n        canvas.focus();\r\n      }\r\n    }\r\n\r\n    // Handle pause first (Esc key) - Requirement 3.6\r\n    if (this.keys.esc && Phaser.Input.Keyboard.JustDown(this.keys.esc)) {\r\n      this.handlePause();\r\n      return; // Don't process other inputs when pausing\r\n    }\r\n\r\n    // Handle movement (A/D keys and arrow keys) - Requirements 3.1, 3.2\r\n    const moveLeft = (\r\n      this.keyboardControls.moveLeft ||\r\n      this.touchControls.moveLeft\r\n    );\r\n    const moveRight = (\r\n      this.keyboardControls.moveRight ||\r\n      this.touchControls.moveRight\r\n    );\r\n\r\n    // Debug movement input - always log to see what's happening\r\n    if (this.inputCallCount % 60 === 0) { // Log every second\r\n      console.log('Input state check:', {\r\n        keyboardStates: {\r\n          moveLeft: this.keyboardControls.moveLeft,\r\n          moveRight: this.keyboardControls.moveRight,\r\n          jump: this.keyboardControls.jump,\r\n          attack: this.keyboardControls.attack\r\n        },\r\n        touchStates: {\r\n          moveLeft: this.touchControls.moveLeft,\r\n          moveRight: this.touchControls.moveRight,\r\n          jump: this.touchControls.jump,\r\n          attack: this.touchControls.attack\r\n        },\r\n        finalStates: {\r\n          moveLeft,\r\n          moveRight\r\n        }\r\n      });\r\n    }\r\n\r\n    // Debug movement input\r\n    if (moveLeft || moveRight) {\r\n      console.log('Movement detected:', {\r\n        moveLeft,\r\n        moveRight,\r\n        leftArrow: this.keys.left?.isDown,\r\n        rightArrow: this.keys.right?.isDown,\r\n        aKey: this.keys.a?.isDown,\r\n        dKey: this.keys.d?.isDown,\r\n        touchLeft: this.touchControls.moveLeft,\r\n        touchRight: this.touchControls.moveRight\r\n      });\r\n    }\r\n\r\n    if (moveLeft && !moveRight) {\r\n      console.log('Calling player.move(left)');\r\n      this.player.move('left');\r\n    } else if (moveRight && !moveLeft) {\r\n      console.log('Calling player.move(right)');\r\n      this.player.move('right');\r\n    } else {\r\n      this.player.stopMovement();\r\n    }\r\n\r\n    // Handle jumping (W/ keys) - Requirement 3.3\r\n    const shouldJump = (\r\n      this.keyboardControls.jump ||\r\n      this.touchControls.jump\r\n    );\r\n\r\n    if (shouldJump) {\r\n      this.player.jump();\r\n    }\r\n\r\n    // Handle crouching (S/ keys) - Requirement 3.4\r\n    const shouldCrouch = (\r\n      this.keyboardControls.crouch ||\r\n      this.touchControls.crouch\r\n    );\r\n\r\n    if (shouldCrouch) {\r\n      this.player.crouch();\r\n    } else {\r\n      this.player.stopCrouching();\r\n    }\r\n\r\n    // Handle attack (Space key) - Requirement 3.5\r\n    const shouldAttack = (\r\n      this.keyboardControls.attack ||\r\n      this.touchControls.attack\r\n    );\r\n\r\n    if (shouldAttack) {\r\n      this.player.attack();\r\n\r\n      // Track weapon usage for analytics\r\n      const weaponType = this.registry.get('weapon');\r\n      if (weaponType) {\r\n        analyticsService.trackWeaponUsage(weaponType);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update parallax background scrolling\r\n   */\r\n  private updateParallax(): void {\r\n    // Get camera scroll position\r\n    const camera = this.cameras.main;\r\n    const scrollX = camera.scrollX;\r\n\r\n    // Update each background layer with different scroll speeds\r\n    if (this.backgroundLayers.moon_clouds) {\r\n      this.backgroundLayers.moon_clouds.tilePositionX = scrollX * 0.1;\r\n    }\r\n\r\n    if (this.backgroundLayers.houses) {\r\n      this.backgroundLayers.houses.tilePositionX = scrollX * 0.3;\r\n    }\r\n\r\n    if (this.backgroundLayers.trees) {\r\n      this.backgroundLayers.trees.tilePositionX = scrollX * 0.6;\r\n    }\r\n\r\n    if (this.backgroundLayers.street) {\r\n      this.backgroundLayers.street.tilePositionX = scrollX * 1;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update spawning system for side-scrolling gameplay\r\n   * Requirements: 12.1, 12.2, 12.3, 6.1\r\n   */\r\n  private updateSpawning(): void {\r\n    // Spawn enemies from the right side of the screen continuously\r\n    this.updateEnemySpawning();\r\n\r\n    // Spawn life items occasionally\r\n    this.updateLifeItemSpawning();\r\n\r\n    // Clean up enemies that have moved too far off screen\r\n    this.cleanupOffscreenEnemies();\r\n  }\r\n\r\n  /**\r\n   * Spawn entities in a specific region based on difficulty\r\n   * @param startX - Start X position of spawn region\r\n   * @param endX - End X position of spawn region\r\n   */\r\n  private spawnEntitiesInRegion(startX: number, endX: number): void {\r\n    const regionWidth = endX - startX;\r\n    const groundY = this.WORLD_HEIGHT - 100; // Ground level\r\n\r\n    // Spawn enemies based on difficulty\r\n    this.spawnEnemiesInRegion(startX, endX, regionWidth, groundY);\r\n\r\n    // Spawn life items based on difficulty\r\n    this.spawnLifeItemsInRegion(startX, endX, regionWidth, groundY);\r\n  }\r\n\r\n  /**\r\n   * Spawn enemies in a region based on difficulty configuration\r\n   * Requirements: 12.1, 12.2, 12.3\r\n   */\r\n  private spawnEnemiesInRegion(startX: number, endX: number, regionWidth: number, groundY: number): void {\r\n    const enemyCount = Math.floor((regionWidth / 1000) * this.difficultyConfig.enemySpawnRate);\r\n\r\n    console.log(`Spawning ${enemyCount} enemies in region ${startX}-${endX} (difficulty: ${this.difficulty})`);\r\n\r\n    for (let i = 0; i < enemyCount; i++) {\r\n      // Random position within the region\r\n      const spawnX = startX + Math.random() * regionWidth;\r\n\r\n      // Select random enemy type from available types for this difficulty\r\n      const enemyType = this.getRandomEnemyType();\r\n\r\n      // Get appropriate spawn height for enemy type\r\n      const spawnY = EnemyFactory.getSpawnHeight(enemyType, groundY);\r\n\r\n      console.log(`Creating ${enemyType} enemy at (${spawnX}, ${spawnY})`);\r\n\r\n      // Create enemy\r\n      const enemy = EnemyFactory.createEnemy(this, spawnX, spawnY, enemyType);\r\n\r\n      // Add to enemies group\r\n      this.enemies.add(enemy);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Spawn life items in a region based on difficulty configuration\r\n   * Requirements: 6.1\r\n   */\r\n  private spawnLifeItemsInRegion(startX: number, endX: number, regionWidth: number, groundY: number): void {\r\n    const lifeItemCount = Math.floor((regionWidth / 1000) * this.difficultyConfig.lifeItemSpawnRate);\r\n\r\n    for (let i = 0; i < lifeItemCount; i++) {\r\n      // Random position within the region\r\n      const spawnX = startX + Math.random() * regionWidth;\r\n\r\n      // Get spawn height that requires jumping to collect\r\n      const spawnY = LifeItemFactory.getSpawnHeight(groundY);\r\n\r\n      // Create random life item\r\n      const lifeItem = LifeItemFactory.createRandomLifeItem(this, spawnX, spawnY);\r\n\r\n      // Add to life items group\r\n      this.lifeItems.add(lifeItem);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get a random enemy type based on difficulty configuration\r\n   */\r\n  private getRandomEnemyType(): EnemyType {\r\n    const availableTypes = this.difficultyConfig.enemyTypes as EnemyType[];\r\n    return availableTypes[Math.floor(Math.random() * availableTypes.length)];\r\n  }\r\n\r\n  /**\r\n   * Handle collision detection\r\n   * Requirements: 4.5, 4.6, 6.2, 6.3, 7.2, 7.5\r\n   */\r\n  private handleCollisions(): void {\r\n    // Player-enemy collisions with damage and invulnerability\r\n    this.physics.overlap(this.player, this.enemies, (player, enemy) => {\r\n      this.handlePlayerEnemyCollision(player as Player, enemy as Phaser.GameObjects.GameObject);\r\n    });\r\n\r\n    // Player-life item collisions with +1 life and +50 points\r\n    this.physics.overlap(this.player, this.lifeItems, (player, item) => {\r\n      this.handlePlayerLifeItemCollision(player as Player, item as Phaser.GameObjects.GameObject);\r\n    });\r\n\r\n    // Player-school gate collision for game completion (+500 bonus points)\r\n    this.physics.overlap(this.player, this.schoolGate, () => {\r\n      this.handlePlayerSchoolGateCollision();\r\n    });\r\n\r\n    // Weapon-enemy collisions for enemy elimination (+100 points each)\r\n    this.handleWeaponEnemyCollisions();\r\n  }\r\n\r\n  /**\r\n   * Handle player-enemy collision with damage and invulnerability\r\n   * Requirements: 4.5, 7.3, 7.4\r\n   */\r\n  private handlePlayerEnemyCollision(player: Player, enemy: Phaser.GameObjects.GameObject): void {\r\n    // Only process collision if player is not invulnerable\r\n    if (player.isInvulnerable) return;\r\n\r\n    // Check if player can avoid damage based on position and enemy type\r\n    if (this.canPlayerAvoidDamage(player, enemy)) {\r\n      return;\r\n    }\r\n\r\n    // Player takes damage (includes invulnerability timer)\r\n    player.takeDamage();\r\n\r\n    // Trigger damage taken achievement\r\n    this.triggerDamageTakenAchievement();\r\n\r\n    // Enemy disappears on contact (requirement 4.1-4.4)\r\n    enemy.destroy();\r\n\r\n    // Update game state store with new lives count\r\n    this.updateGameState();\r\n\r\n    // Check for game over\r\n    if (player.lives <= 0) {\r\n      this.handleGameOver();\r\n    }\r\n  }\r\n\r\n  /**\r\n      return true;\r\n    }\r\n\r\n    // Player jumping avoids damage from ground enemies (Vampire, Mummy)\r\n    if (player.isJumping && (enemyType === 'vampire' || enemyType === 'mummy')) {\r\n      return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Handle player-life item collision with +1 life and +50 points\r\n   * Requirements: 6.2, 6.3, 11.4\r\n   */\r\n  private handlePlayerLifeItemCollision(player: Player, item: Phaser.GameObjects.GameObject): void {\r\n    if (item instanceof LifeItem) {\r\n      // Player gains life (up to maximum of 10) and points\r\n      player.addLife(); // +1 life (capped at 10 in Player class)\r\n      player.addScore(item.getPointValue()); // +50 points for life item\r\n\r\n      // Trigger life collected achievement\r\n      this.triggerLifeCollectedAchievement();\r\n\r\n      // Trigger score achievement check\r\n      this.triggerScoreAchievement(player.score);\r\n\r\n      // Play item collection sound effect\r\n      audioManager.playItemCollectSound();\r\n\r\n      // Handle collection (includes destruction)\r\n      item.collect();\r\n\r\n      // Update game state store\r\n      this.updateGameState();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle player reaching school gate for game completion\r\n   * Requirements: 7.5\r\n   */\r\n  private handlePlayerSchoolGateCollision(): void {\r\n    // Only trigger if player has lives remaining\r\n    if (this.player.lives <= 0) return;\r\n\r\n    // Player wins the game with bonus points\r\n    this.player.addScore(500); // +500 bonus points for completion\r\n\r\n    // Calculate game time for achievements\r\n    const achievementStore = useAchievementStore.getState();\r\n    const gameTime = achievementStore.sessionStats?.gameStartTime ?\r\n      (Date.now() - achievementStore.sessionStats.gameStartTime) / 1000 : 0;\r\n\r\n    // Trigger game completion achievements\r\n    this.triggerGameCompletionAchievement(true, this.player.score, gameTime);\r\n\r\n    // Trigger score achievement check\r\n    this.triggerScoreAchievement(this.player.score);\r\n\r\n    // Update game state store\r\n    this.updateGameState();\r\n\r\n    // Handle game victory\r\n    this.handleGameWin();\r\n  }\r\n\r\n  /**\r\n   * Handle weapon-enemy collisions for enemy elimination\r\n   * Requirements: 5.5, 7.2\r\n   */\r\n  private handleWeaponEnemyCollisions(): void {\r\n    // Only check weapon collisions if player has a weapon\r\n    if (!this.player.weapon) return;\r\n\r\n    // Check if player just attacked (within the last 150ms)\r\n    const timeSinceLastAttack = this.time.now - this.player.weapon.getLastAttackTime();\r\n    if (timeSinceLastAttack > 150) return;\r\n\r\n    // Get weapon attack area based on weapon type and player position\r\n    const weaponAttackArea = this.getWeaponAttackArea();\r\n    if (!weaponAttackArea) return;\r\n\r\n    // Check each enemy for collision with weapon attack area\r\n    this.enemies.children.entries.forEach((enemy) => {\r\n      if (!enemy.active) return;\r\n\r\n      const enemySprite = enemy as Phaser.Physics.Arcade.Sprite;\r\n\r\n      // Check if enemy is within weapon attack area and hasn't been hit recently\r\n      if (this.isEnemyInWeaponRange(enemySprite, weaponAttackArea) && !enemySprite.getData('justHit')) {\r\n        // Mark enemy as hit to prevent multiple hits from same attack\r\n        enemySprite.setData('justHit', true);\r\n        this.time.delayedCall(200, () => {\r\n          if (enemySprite.active) {\r\n            enemySprite.setData('justHit', false);\r\n          }\r\n        });\r\n\r\n        this.handleWeaponHitEnemy(enemySprite);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get weapon attack area based on current weapon and player state\r\n   */\r\n  private getWeaponAttackArea(): { x: number; y: number; width: number; height: number } | null {\r\n    if (!this.player.weapon) return null;\r\n\r\n    const weapon = this.player.weapon;\r\n    const playerX = this.player.x;\r\n    const playerY = this.player.y;\r\n    const facingLeft = this.player.flipX;\r\n\r\n    // Calculate attack area based on weapon type\r\n    switch (weapon.type) {\r\n      case 'katana':\r\n        return {\r\n          x: facingLeft ? playerX - weapon.range : playerX,\r\n          y: playerY - 30,\r\n          width: weapon.range, // 40px\r\n          height: 60\r\n        };\r\n\r\n      case 'baseball':\r\n        return {\r\n          x: facingLeft ? playerX - weapon.range : playerX,\r\n          y: playerY - 30,\r\n          width: weapon.range, // 55px\r\n          height: 60\r\n        };\r\n\r\n      case 'laser':\r\n        // For projectile weapons, we'll handle this differently\r\n        // For now, return a basic area (projectile collision will be enhanced later)\r\n        return {\r\n          x: facingLeft ? playerX - 200 : playerX,\r\n          y: playerY - 10,\r\n          width: 200,\r\n          height: 20\r\n        };\r\n\r\n      case 'bazooka':\r\n        // Area damage weapon\r\n        return {\r\n          x: facingLeft ? playerX - 100 : playerX,\r\n          y: playerY - 50,\r\n          width: 100,\r\n          height: 100\r\n        };\r\n\r\n      default:\r\n        return null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if enemy is within weapon attack range\r\n   */\r\n  private isEnemyInWeaponRange(\r\n    enemy: Phaser.Physics.Arcade.Sprite,\r\n    attackArea: { x: number; y: number; width: number; height: number }\r\n  ): boolean {\r\n    const enemyBounds = enemy.getBounds();\r\n    const attackBounds = new Phaser.Geom.Rectangle(\r\n      attackArea.x,\r\n      attackArea.y,\r\n      attackArea.width,\r\n      attackArea.height\r\n    );\r\n\r\n    return Phaser.Geom.Rectangle.Overlaps(enemyBounds, attackBounds);\r\n  }\r\n\r\n  /**\r\n   * Handle weapon hitting enemy - eliminate enemy and award points\r\n   * Requirements: 5.5, 7.2\r\n   */\r\n  private handleWeaponHitEnemy(enemy: Phaser.Physics.Arcade.Sprite): void {\r\n    // Award points for enemy elimination\r\n    this.player.addScore(100); // +100 points for each enemy eliminated\r\n\r\n    // Get enemy type for achievement tracking\r\n    const enemyType = (enemy as { type?: string }).type || 'unknown';\r\n    const weaponType = this.player.weapon?.type || 'unknown';\r\n\r\n    // Trigger enemy killed achievement\r\n    this.triggerEnemyKilledAchievement(enemyType, weaponType);\r\n\r\n    // Trigger score achievement check\r\n    this.triggerScoreAchievement(this.player.score);\r\n\r\n    // Apply weapon-specific effects\r\n    if (this.player.weapon?.type === 'baseball') {\r\n      // Baseball bat applies knockback before destruction\r\n      this.applyKnockback(enemy);\r\n    }\r\n\r\n    // Eliminate enemy immediately (all weapons eliminate in one hit)\r\n    enemy.destroy();\r\n\r\n    // Update game state store\r\n    this.updateGameState();\r\n\r\n    // TODO: Play weapon-specific sound effect\r\n    // this.playWeaponHitSound();\r\n  }\r\n\r\n  /**\r\n   * Apply knockback effect for baseball bat\r\n   */\r\n  private applyKnockback(enemy: Phaser.Physics.Arcade.Sprite): void {\r\n    if (enemy.body instanceof Phaser.Physics.Arcade.Body) {\r\n      const knockbackForce = 200;\r\n      const direction = this.player.flipX ? -1 : 1;\r\n      enemy.body.setVelocityX(direction * knockbackForce);\r\n    }\r\n  }\r\n\r\n\r\n\r\n  /**\r\n   * Handle pause functionality\r\n   * Requirement 3.6\r\n   */\r\n  private handlePause(): void {\r\n    if (this.scene.isPaused()) {\r\n      // Resume game\r\n      this.scene.resume();\r\n      console.log('Game resumed');\r\n    } else {\r\n      // Pause game\r\n      this.scene.pause();\r\n      console.log('Game paused - Press ESC to resume');\r\n    }\r\n\r\n    // Emit pause state change for UI components\r\n    this.events.emit('gamePauseToggled', {\r\n      isPaused: this.scene.isPaused()\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Handle game over (player died)\r\n   * Requirements: 7.6\r\n   */\r\n  private handleGameOver(): void {\r\n    // Set game status to finished\r\n    this.updateGameState();\r\n\r\n    // Pause the game\r\n    this.scene.pause();\r\n\r\n    // Emit game end event with defeat status\r\n    this.events.emit('gameEnd', {\r\n      score: this.player.score,\r\n      victory: false,\r\n      reason: 'defeat'\r\n    });\r\n\r\n    console.log('Game Over! Final Score:', this.player.score);\r\n  }\r\n\r\n  /**\r\n   * Handle game win (reached school)\r\n   * Requirements: 7.5\r\n   */\r\n  private handleGameWin(): void {\r\n    // Set game status to finished\r\n    this.updateGameState();\r\n\r\n    // Pause the game\r\n    this.scene.pause();\r\n\r\n    // Emit game end event with victory status\r\n    this.events.emit('gameEnd', {\r\n      score: this.player.score,\r\n      victory: true,\r\n      reason: 'victory'\r\n    });\r\n\r\n    console.log('Victory! Final Score:', this.player.score);\r\n  }\r\n\r\n  /**\r\n   * Get current player for external access\r\n   */\r\n  getPlayer(): Player {\r\n    return this.player;\r\n  }\r\n\r\n  /**\r\n   * Get enemy group for external access\r\n   */\r\n  getEnemies(): Phaser.Physics.Arcade.Group {\r\n    return this.enemies;\r\n  }\r\n\r\n  /**\r\n   * Get life items group for external access\r\n   */\r\n  getLifeItems(): Phaser.Physics.Arcade.Group {\r\n    return this.lifeItems;\r\n  }\r\n\r\n  /**\r\n   * Handle touch control input from React component\r\n   * Requirements: 10.2\r\n   */\r\n  setTouchControl(control: 'moveLeft' | 'moveRight' | 'jump' | 'crouch' | 'attack', pressed: boolean): void {\r\n    this.touchControls[control] = pressed;\r\n  }\r\n\r\n  /**\r\n   * Handle keyboard control input from React component (browser-level)\r\n   */\r\n  setKeyboardControls(keyboardState: {\r\n    moveLeft: boolean;\r\n    moveRight: boolean;\r\n    jump: boolean;\r\n    crouch: boolean;\r\n    attack: boolean;\r\n  }): void {\r\n    // Store keyboard state similar to touch controls\r\n    this.keyboardControls = keyboardState;\r\n  }\r\n\r\n  /**\r\n   * Get current touch controls state for debugging\r\n   */\r\n  getTouchControlsState(): typeof this.touchControls {\r\n    return { ...this.touchControls };\r\n  }\r\n\r\n  /**\r\n   * Get current keyboard input state for debugging\r\n   */\r\n  getKeyboardState(): {\r\n    cursors: {\r\n      left: boolean;\r\n      right: boolean;\r\n      up: boolean;\r\n      down: boolean;\r\n    };\r\n    wasd: {\r\n      W: boolean;\r\n      A: boolean;\r\n      S: boolean;\r\n      D: boolean;\r\n    };\r\n    spaceKey: boolean;\r\n    escKey: boolean;\r\n  } {\r\n    const cursors = this.registry.get('cursors');\r\n    const wasd = this.registry.get('wasd');\r\n    const spaceKey = this.registry.get('spaceKey');\r\n    const escKey = this.registry.get('escKey');\r\n\r\n    return {\r\n      cursors: {\r\n        left: cursors?.left?.isDown || false,\r\n        right: cursors?.right?.isDown || false,\r\n        up: cursors?.up?.isDown || false,\r\n        down: cursors?.down?.isDown || false,\r\n      },\r\n      wasd: {\r\n        W: wasd?.W?.isDown || false,\r\n        A: wasd?.A?.isDown || false,\r\n        S: wasd?.S?.isDown || false,\r\n        D: wasd?.D?.isDown || false,\r\n      },\r\n      spaceKey: spaceKey?.isDown || false,\r\n      escKey: escKey?.isDown || false,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Check if keyboard controls are properly initialized\r\n   */\r\n  areKeyboardControlsReady(): boolean {\r\n    const cursors = this.registry.get('cursors');\r\n    const wasd = this.registry.get('wasd');\r\n    const spaceKey = this.registry.get('spaceKey');\r\n    const escKey = this.registry.get('escKey');\r\n\r\n    return !!(cursors && wasd && spaceKey && escKey);\r\n  }\r\n\r\n  /**\r\n   * Update game state and emit events to React\r\n   */\r\n  private updateGameState(): void {\r\n    console.log('updateGameState called - emitting playerStatsChanged:', {\r\n      lives: this.player.lives,\r\n      score: this.player.score\r\n    });\r\n\r\n    // Emit player stats changes to React\r\n    this.events.emit('playerStatsChanged', {\r\n      lives: this.player.lives,\r\n      score: this.player.score\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Check for game end conditions\r\n   */\r\n  private checkGameEndConditions(): void {\r\n    // Check if player has no lives left (defeat) - except in practice mode\r\n    if (this.player.lives <= 0 && this.gameMode !== 'practice') {\r\n      this.endGame(false, 'No lives remaining');\r\n      return;\r\n    }\r\n\r\n    // Check if player reached the school gate (victory) - not applicable in endless mode\r\n    if (this.gameMode !== 'endless' && this.physics.overlap(this.player, this.schoolGate)) {\r\n      // Add victory bonus\r\n      this.player.addScore(500);\r\n      this.endGame(true, 'Reached school gate');\r\n      return;\r\n    }\r\n\r\n    // Time attack mode - time runs out is handled in updateTimeAttackMode\r\n    // Endless mode - no end condition, continues indefinitely\r\n    // Survival mode - uses standard life check\r\n    // Practice mode - no defeat condition\r\n  }\r\n\r\n  /**\r\n   * End the game and emit event to React\r\n   */\r\n  private endGame(victory: boolean, reason: string): void {\r\n    console.log(`Game ended: ${victory ? 'Victory' : 'Defeat'} - ${reason}`);\r\n\r\n    // Calculate final score based on game mode\r\n    let finalScore = this.player.score;\r\n\r\n    if (this.gameMode === 'timeAttack' && victory) {\r\n      // Bonus points for remaining time\r\n      const timeBonus = Math.floor(this.timeRemaining * 10);\r\n      finalScore += timeBonus;\r\n    } else if (this.gameMode === 'endless') {\r\n      // Score based on distance in endless mode\r\n      finalScore += Math.floor(this.endlessDistance / 10);\r\n    }\r\n\r\n    // Emit game end event to React\r\n    this.events.emit('gameEnd', {\r\n      score: finalScore,\r\n      victory: victory,\r\n      reason: reason,\r\n      gameMode: this.gameMode,\r\n      stats: {\r\n        distance: this.gameMode === 'endless' ? this.endlessDistance : this.player.x,\r\n        timeRemaining: this.gameMode === 'timeAttack' ? this.timeRemaining : undefined,\r\n        difficultyMultiplier: this.gameMode === 'endless' ? this.difficultyMultiplier : undefined\r\n      }\r\n    });\r\n\r\n    // Pause the scene to stop gameplay\r\n    this.scene.pause();\r\n  }\r\n\r\n  /**\r\n   * Update enemy spawning for side-scrolling gameplay\r\n   */\r\n  private updateEnemySpawning(): void {\r\n    const currentTime = this.time.now;\r\n\r\n    // Calculate spawn interval based on difficulty\r\n    const baseInterval = this.enemySpawnInterval;\r\n    const difficultyMultiplier = {\r\n      easy: 1.5,     // Slower spawning\r\n      medium: 1.0,   // Normal spawning\r\n      impossible: 0.5 // Faster spawning\r\n    }[this.difficulty];\r\n\r\n    const actualInterval = baseInterval * difficultyMultiplier;\r\n\r\n    // Check if it's time to spawn a new enemy\r\n    if (currentTime - this.lastEnemySpawnTime > actualInterval) {\r\n      this.spawnEnemyFromRight();\r\n      this.lastEnemySpawnTime = currentTime;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update life item spawning\r\n   */\r\n  private updateLifeItemSpawning(): void {\r\n    const currentTime = this.time.now;\r\n\r\n    // Don't spawn life items on impossible difficulty\r\n    if (this.difficulty === 'impossible') return;\r\n\r\n    // Calculate spawn interval based on difficulty\r\n    const baseInterval = this.lifeItemSpawnInterval;\r\n    const difficultyMultiplier = {\r\n      easy: 0.6,     // More frequent life items\r\n      medium: 1.0,   // Normal frequency\r\n      impossible: 0  // No life items\r\n    }[this.difficulty];\r\n\r\n    const actualInterval = baseInterval * difficultyMultiplier;\r\n\r\n    // Check if it's time to spawn a new life item\r\n    if (actualInterval > 0 && currentTime - this.lastLifeItemSpawnTime > actualInterval) {\r\n      this.spawnLifeItemFromRight();\r\n      this.lastLifeItemSpawnTime = currentTime;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Spawn an enemy from the right side of the screen\r\n   */\r\n  private spawnEnemyFromRight(): void {\r\n    const camera = this.cameras.main;\r\n    const screenRight = camera.scrollX + camera.width + 100; // Spawn off-screen to the right\r\n    const groundY = this.WORLD_HEIGHT - 100;\r\n\r\n    // Select random enemy type based on difficulty\r\n    const enemyType = this.getRandomEnemyType();\r\n\r\n    // Get appropriate spawn height for enemy type\r\n    const spawnY = EnemyFactory.getSpawnHeight(enemyType, groundY);\r\n\r\n    console.log(`Spawning ${enemyType} from right at (${screenRight}, ${spawnY})`);\r\n\r\n    // Create enemy\r\n    const enemy = EnemyFactory.createEnemy(this, screenRight, spawnY, enemyType);\r\n\r\n    // Add to enemies group\r\n    this.enemies.add(enemy);\r\n  }\r\n\r\n  /**\r\n   * Spawn a life item from the right side of the screen\r\n   */\r\n  private spawnLifeItemFromRight(): void {\r\n    const camera = this.cameras.main;\r\n    const screenRight = camera.scrollX + camera.width + 100; // Spawn off-screen to the right\r\n    const groundY = this.WORLD_HEIGHT - 100;\r\n\r\n    // Get spawn height that requires jumping to collect\r\n    const spawnY = LifeItemFactory.getSpawnHeight(groundY);\r\n\r\n    console.log(`Spawning life item from right at (${screenRight}, ${spawnY})`);\r\n\r\n    // Create random life item\r\n    const lifeItem = LifeItemFactory.createRandomLifeItem(this, screenRight, spawnY);\r\n\r\n    // Add to life items group\r\n    this.lifeItems.add(lifeItem);\r\n  }\r\n\r\n  /**\r\n   * Clean up enemies and items that have moved too far off screen\r\n   */\r\n  private cleanupOffscreenEnemies(): void {\r\n    const camera = this.cameras.main;\r\n    const screenLeft = camera.scrollX - 200; // Clean up when well off-screen\r\n\r\n    // Clean up enemies\r\n    this.enemies.children.entries.forEach((enemy) => {\r\n      const enemySprite = enemy as Phaser.Physics.Arcade.Sprite;\r\n      if (enemySprite.x < screenLeft) {\r\n        enemySprite.destroy();\r\n      }\r\n    });\r\n\r\n    // Clean up life items\r\n    this.lifeItems.children.entries.forEach((item) => {\r\n      const itemSprite = item as Phaser.Physics.Arcade.Sprite;\r\n      if (itemSprite.x < screenLeft) {\r\n        itemSprite.destroy();\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Apply battery optimization settings to game performance\r\n   * Requirements: 10.4 - Battery usage optimization settings\r\n   */\r\n  private applyBatteryOptimizations(): void {\r\n    // Only check every 60 frames (about once per second) to avoid performance impact\r\n    if (this.updateCallCount % 60 !== 0) return;\r\n\r\n    const optimizationSettings = batteryOptimizer.getOptimizationSettings();\r\n    const optimizationLevel = batteryOptimizer.getOptimizationLevel();\r\n\r\n    // Apply frame rate optimization\r\n    if (this.game.loop) {\r\n      const targetFPS = optimizationSettings.frameRate;\r\n      if (this.game.loop.targetFps !== targetFPS) {\r\n        this.game.loop.targetFps = targetFPS;\r\n        console.log(`Battery optimization: Set target FPS to ${targetFPS}`);\r\n      }\r\n    }\r\n\r\n    // Apply particle count optimization\r\n    if (optimizationLevel === 'high' || optimizationLevel === 'medium') {\r\n      // Reduce enemy spawn rate for better performance\r\n      const baseSpawnInterval = this.enemySpawnInterval;\r\n      const optimizedInterval = baseSpawnInterval * (optimizationLevel === 'high' ? 1.5 : 1.2);\r\n\r\n      if (this.enemySpawnInterval !== optimizedInterval) {\r\n        this.enemySpawnInterval = optimizedInterval;\r\n        console.log(`Battery optimization: Adjusted enemy spawn interval to ${optimizedInterval}ms`);\r\n      }\r\n    }\r\n\r\n    // Disable audio for high battery optimization\r\n    if (optimizationLevel === 'high' && !optimizationSettings.audioEnabled) {\r\n      if (!audioManager.isMutedState()) {\r\n        audioManager.mute();\r\n        console.log('Battery optimization: Audio disabled to save battery');\r\n      }\r\n    } else if (optimizationLevel !== 'high' && optimizationSettings.audioEnabled) {\r\n      if (audioManager.isMutedState()) {\r\n        audioManager.unmute();\r\n        console.log('Battery optimization: Audio re-enabled');\r\n      }\r\n    }\r\n\r\n    // Background processing optimization is handled in the main update loop\r\n  }\r\n\r\n  /**\r\n   * Apply performance optimizations based on current settings\r\n   * Requirements: 19.2 - Optimize for low-end devices\r\n   */\r\n  private applyPerformanceOptimizations(): void {\r\n    // Only check every 120 frames (about every 2 seconds) to avoid performance impact\r\n    if (this.updateCallCount % 120 !== 0) return;\r\n\r\n    const performanceSettings = usePerformanceStore.getState().settings;\r\n    const optimizationSettings = performanceOptimizer.getOptimizationSettings();\r\n\r\n    // Apply frame rate limit from performance settings\r\n    if (this.game.loop && performanceSettings.frameRateLimit > 0) {\r\n      const targetFPS = performanceSettings.frameRateLimit;\r\n      if (this.game.loop.targetFps !== targetFPS) {\r\n        this.game.loop.targetFps = targetFPS;\r\n        console.log(`Performance optimization: Set target FPS to ${targetFPS}`);\r\n      }\r\n    }\r\n\r\n    // Adjust enemy spawn rate based on performance settings\r\n    if (optimizationSettings.reduceUpdateFrequency) {\r\n      const baseSpawnInterval = 2000; // Base interval\r\n      const optimizedInterval = baseSpawnInterval * 1.5; // Reduce spawn frequency\r\n\r\n      if (this.enemySpawnInterval !== optimizedInterval) {\r\n        this.enemySpawnInterval = optimizedInterval;\r\n        console.log(`Performance optimization: Reduced enemy spawn frequency`);\r\n      }\r\n    }\r\n\r\n    // Disable audio if performance is critically low\r\n    if (performanceSettings.lightweightMode && !audioManager.isMutedState()) {\r\n      audioManager.mute();\r\n      console.log('Performance optimization: Audio disabled in lightweight mode');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Determine if parallax backgrounds should be updated this frame\r\n   */\r\n  private shouldUpdateParallax(): boolean {\r\n    const optimizationSettings = performanceOptimizer.getOptimizationSettings();\r\n    const batteryOptimizationLevel = batteryOptimizer.getOptimizationLevel();\r\n\r\n    // Always update on high quality\r\n    if (!optimizationSettings.reduceUpdateFrequency && batteryOptimizationLevel === 'none') {\r\n      return true;\r\n    }\r\n\r\n    // Update every 2nd frame on medium optimization\r\n    if (batteryOptimizationLevel === 'medium' || optimizationSettings.reduceUpdateFrequency) {\r\n      return this.updateCallCount % 2 === 0;\r\n    }\r\n\r\n    // Update every 4th frame on high optimization\r\n    if (batteryOptimizationLevel === 'high') {\r\n      return this.updateCallCount % 4 === 0;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * Determine if spawning system should be updated this frame\r\n   */\r\n  private shouldUpdateSpawning(): boolean {\r\n    const optimizationSettings = performanceOptimizer.getOptimizationSettings();\r\n\r\n    // Always update spawning unless we're in aggressive optimization mode\r\n    if (!optimizationSettings.reduceUpdateFrequency) {\r\n      return true;\r\n    }\r\n\r\n    // Update every 2nd frame when optimizing\r\n    return this.updateCallCount % 2 === 0;\r\n  }\r\n\r\n  /**\r\n   * Cull objects that are far off-screen to improve performance\r\n   */\r\n  private cullOffscreenObjects(): void {\r\n    const camera = this.cameras.main;\r\n    const cullDistance = 400; // Distance beyond screen to start culling\r\n    const screenLeft = camera.scrollX - cullDistance;\r\n    const screenRight = camera.scrollX + camera.width + cullDistance;\r\n\r\n    // Cull enemies that are too far off-screen\r\n    this.enemies.children.entries.forEach((enemy) => {\r\n      const enemySprite = enemy as Phaser.Physics.Arcade.Sprite;\r\n      if (enemySprite.x < screenLeft || enemySprite.x > screenRight) {\r\n        // Instead of destroying, disable the enemy to save on object creation/destruction\r\n        enemySprite.setActive(false);\r\n        enemySprite.setVisible(false);\r\n        if (enemySprite.body) {\r\n          enemySprite.body.enable = false;\r\n        }\r\n      }\r\n    });\r\n\r\n    // Cull life items that are too far off-screen\r\n\r\n    achievementStore.triggerAchievementCheck('enemy_killed', 1, {\r\n      enemyType,\r\n      weapon,\r\n      multiKill\r\n    });\r\n\r\n    // Also trigger weapon usage tracking\r\n    achievementStore.triggerAchievementCheck('weapon_used', 1, {\r\n      weapon\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Trigger achievement for life item collection\r\n   */\r\n  private triggerLifeCollectedAchievement(): void {\r\n    const achievementStore = useAchievementStore.getState();\r\n\r\n    achievementStore.triggerAchievementCheck('life_collected', 1);\r\n  }\r\n\r\n  /**\r\n   * Trigger achievement for taking damage\r\n   */\r\n  private triggerDamageTakenAchievement(): void {\r\n    const achievementStore = useAchievementStore.getState();\r\n\r\n    achievementStore.triggerAchievementCheck('damage_taken', 1);\r\n  }\r\n\r\n  /**\r\n   * Trigger achievement for score milestones\r\n   */\r\n  private triggerScoreAchievement(score: number): void {\r\n    const achievementStore = useAchievementStore.getState();\r\n\r\n    achievementStore.triggerAchievementCheck('score_reached', score);\r\n  }\r\n\r\n  /**\r\n   * Trigger achievement for game completion\r\n   */\r\n  private triggerGameCompletionAchievement(survived: boolean, finalScore: number, gameTime: number): void {\r\n    const achievementStore = useAchievementStore.getState();\r\n\r\n    if (survived) {\r\n      achievementStore.triggerAchievementCheck('game_completed', 1, {\r\n        character: this.registry.get('character'),\r\n        weapon: this.registry.get('weapon'),\r\n        difficulty: this.difficulty,\r\n        livesRemaining: this.player.lives,\r\n        finalScore,\r\n        gameTime\r\n      });\r\n\r\n      // Check for difficulty-specific achievements\r\n      achievementStore.triggerAchievementCheck('difficulty_completed', 1, {\r\n        difficulty: this.difficulty\r\n      });\r\n\r\n      // Check for perfect run (no damage taken)\r\n      if (this.player.lives === 10) {\r\n        achievementStore.triggerAchievementCheck('perfect_run', 1);\r\n      }\r\n\r\n      // Check for speed run (less than 5 minutes)\r\n      if (gameTime < 300) {\r\n        achievementStore.triggerAchievementCheck('speed_run', gameTime);\r\n      }\r\n    }\r\n  }\r\n\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\scenes\\__tests__\\CollisionDetection.test.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'GameScene' is defined but never used.","line":1,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":19},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":96,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":96,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2190,2193],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2190,2193],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":138,"column":30,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":138,"endColumn":53},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":170,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":170,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4584,4587],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4584,4587],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":193,"column":30,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":193,"endColumn":53},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":202,"column":30,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":202,"endColumn":53},{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":256,"column":30,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":256,"endColumn":53}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { GameScene } from '../GameScene';\r\n\r\n// Mock Phaser classes and methods\r\nclass MockBody {\r\n  public touching = { down: false };\r\n  public velocity = { x: 0, y: 0 };\r\n  \r\n  setCollideWorldBounds = jest.fn();\r\n  setGravityY = jest.fn();\r\n  setSize = jest.fn();\r\n  setVelocityX = jest.fn();\r\n  setVelocityY = jest.fn();\r\n}\r\n\r\nclass MockSprite {\r\n  public x: number;\r\n  public y: number;\r\n  public body: MockBody;\r\n  public active: boolean = true;\r\n  \r\n  constructor(x: number, y: number) {\r\n    this.x = x;\r\n    this.y = y;\r\n    this.body = new MockBody();\r\n  }\r\n  \r\n  destroy = jest.fn();\r\n  setActive = jest.fn((active: boolean) => { this.active = active; });\r\n}\r\n\r\nclass MockGroup {\r\n  public children = {\r\n    entries: [] as MockSprite[]\r\n  };\r\n  \r\n  add = jest.fn((sprite: MockSprite) => {\r\n    this.children.entries.push(sprite);\r\n  });\r\n  \r\n  remove = jest.fn((sprite: MockSprite) => {\r\n    const index = this.children.entries.indexOf(sprite);\r\n    if (index > -1) {\r\n      this.children.entries.splice(index, 1);\r\n    }\r\n  });\r\n  \r\n  clear = jest.fn(() => {\r\n    this.children.entries = [];\r\n  });\r\n}\r\n\r\nclass MockPhysics {\r\n  public add = {\r\n    existing: jest.fn(),\r\n    group: jest.fn(() => new MockGroup()),\r\n    collider: jest.fn(),\r\n    overlap: jest.fn()\r\n  };\r\n}\r\n\r\nclass MockScene {\r\n  public physics = new MockPhysics();\r\n  public time = { now: 0 };\r\n  public registry = {\r\n    get: jest.fn(() => 'boy'),\r\n    set: jest.fn()\r\n  };\r\n  public add = {\r\n    existing: jest.fn()\r\n  };\r\n}\r\n\r\n// Mock the actual GameScene methods we need to test\r\njest.mock('../GameScene', () => {\r\n  return {\r\n    GameScene: jest.fn().mockImplementation(() => ({\r\n      physics: new MockPhysics(),\r\n      time: { now: 0 },\r\n      registry: {\r\n        get: jest.fn(() => 'boy'),\r\n        set: jest.fn()\r\n      },\r\n      add: { existing: jest.fn() },\r\n      \r\n      // Mock collision detection methods\r\n      handlePlayerEnemyCollision: jest.fn(),\r\n      handleWeaponEnemyCollision: jest.fn(),\r\n      handlePlayerLifeItemCollision: jest.fn(),\r\n      updateScore: jest.fn(),\r\n      updateLives: jest.fn()\r\n    }))\r\n  };\r\n});\r\n\r\ndescribe('Collision Detection System', () => {\r\n  let mockScene: any;\r\n  let mockPlayer: MockSprite;\r\n  let mockEnemy: MockSprite;\r\n  let mockLifeItem: MockSprite;\r\n  \r\n  beforeEach(() => {\r\n    mockScene = new MockScene();\r\n    mockPlayer = new MockSprite(100, 100);\r\n    mockEnemy = new MockSprite(150, 100);\r\n    mockLifeItem = new MockSprite(200, 100);\r\n    jest.clearAllMocks();\r\n  });\r\n  \r\n  describe('Player-Enemy Collision', () => {\r\n    it('should detect collision between player and enemy', () => {\r\n      // Simulate collision detection\r\n      const playerBounds = {\r\n        x: mockPlayer.x - 16,\r\n        y: mockPlayer.y - 24,\r\n        width: 32,\r\n        height: 48\r\n      };\r\n      \r\n      const enemyBounds = {\r\n        x: mockEnemy.x - 16,\r\n        y: mockEnemy.y - 16,\r\n        width: 32,\r\n        height: 32\r\n      };\r\n      \r\n      // Check if bounds overlap\r\n      const isColliding = (\r\n        playerBounds.x < enemyBounds.x + enemyBounds.width &&\r\n        playerBounds.x + playerBounds.width > enemyBounds.x &&\r\n        playerBounds.y < enemyBounds.y + enemyBounds.height &&\r\n        playerBounds.y + playerBounds.height > enemyBounds.y\r\n      );\r\n      \r\n      expect(isColliding).toBe(true);\r\n    });\r\n    \r\n    it('should handle player damage when colliding with enemy per requirement 7.3', () => {\r\n      const gameScene = new (require('../GameScene').GameScene)();\r\n      \r\n      // Simulate player-enemy collision\r\n      gameScene.handlePlayerEnemyCollision(mockPlayer, mockEnemy);\r\n      \r\n      expect(gameScene.handlePlayerEnemyCollision).toHaveBeenCalledWith(mockPlayer, mockEnemy);\r\n    });\r\n    \r\n    it('should remove enemy after collision per requirements 4.1-4.4', () => {\r\n      // Simulate enemy destruction after collision\r\n      mockEnemy.destroy();\r\n      \r\n      expect(mockEnemy.destroy).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should not process collision when player is invulnerable', () => {\r\n      const mockPlayerWithInvulnerability = {\r\n        ...mockPlayer,\r\n        isInvulnerable: true,\r\n        takeDamage: jest.fn()\r\n      };\r\n      \r\n      // Collision should be ignored when player is invulnerable\r\n      if (!mockPlayerWithInvulnerability.isInvulnerable) {\r\n        mockPlayerWithInvulnerability.takeDamage();\r\n      }\r\n      \r\n      expect(mockPlayerWithInvulnerability.takeDamage).not.toHaveBeenCalled();\r\n    });\r\n  });\r\n  \r\n  describe('Weapon-Enemy Collision', () => {\r\n    let mockWeapon: any;\r\n    \r\n    beforeEach(() => {\r\n      mockWeapon = {\r\n        x: 120,\r\n        y: 100,\r\n        range: 40,\r\n        type: 'katana',\r\n        isAttacking: true,\r\n        getLastAttackTime: jest.fn(() => mockScene.time.now - 50)\r\n      };\r\n    });\r\n    \r\n    it('should detect weapon hit on enemy within range', () => {\r\n      const weaponRange = mockWeapon.range;\r\n      const distance = Math.abs(mockEnemy.x - mockWeapon.x);\r\n      \r\n      const isInRange = distance <= weaponRange;\r\n      \r\n      expect(isInRange).toBe(true); // Enemy at 150, weapon at 120, range 40\r\n    });\r\n    \r\n    it('should eliminate enemy in one hit per requirement 5.5', () => {\r\n      const gameScene = new (require('../GameScene').GameScene)();\r\n      \r\n      // Simulate weapon-enemy collision\r\n      gameScene.handleWeaponEnemyCollision(mockWeapon, mockEnemy);\r\n      \r\n      expect(gameScene.handleWeaponEnemyCollision).toHaveBeenCalledWith(mockWeapon, mockEnemy);\r\n    });\r\n    \r\n    it('should add score when enemy is eliminated per requirement 7.2', () => {\r\n      const gameScene = new (require('../GameScene').GameScene)();\r\n      const initialScore = 1000;\r\n      const enemyPoints = 100;\r\n      \r\n      gameScene.updateScore(initialScore + enemyPoints);\r\n      \r\n      expect(gameScene.updateScore).toHaveBeenCalledWith(1100);\r\n    });\r\n    \r\n    it('should only damage enemy during active weapon attack window', () => {\r\n      // Test attack timing window (100ms as per Player.ts)\r\n      const attackTime = mockScene.time.now - 50; // 50ms ago\r\n      const isAttackActive = (mockScene.time.now - attackTime) <= 100;\r\n      \r\n      expect(isAttackActive).toBe(true);\r\n      \r\n      // Test outside attack window\r\n      const oldAttackTime = mockScene.time.now - 150; // 150ms ago\r\n      const isOldAttackActive = (mockScene.time.now - oldAttackTime) <= 100;\r\n      \r\n      expect(isOldAttackActive).toBe(false);\r\n    });\r\n  });\r\n  \r\n  describe('Player-Life Item Collision', () => {\r\n    it('should detect collision between player and life item', () => {\r\n      // Move life item closer to player for collision\r\n      mockLifeItem.x = 110;\r\n      \r\n      const playerBounds = {\r\n        x: mockPlayer.x - 16,\r\n        y: mockPlayer.y - 24,\r\n        width: 32,\r\n        height: 48\r\n      };\r\n      \r\n      const lifeItemBounds = {\r\n        x: mockLifeItem.x - 8,\r\n        y: mockLifeItem.y - 8,\r\n        width: 16,\r\n        height: 16\r\n      };\r\n      \r\n      const isColliding = (\r\n        playerBounds.x < lifeItemBounds.x + lifeItemBounds.width &&\r\n        playerBounds.x + playerBounds.width > lifeItemBounds.x &&\r\n        playerBounds.y < lifeItemBounds.y + lifeItemBounds.height &&\r\n        playerBounds.y + playerBounds.height > lifeItemBounds.y\r\n      );\r\n      \r\n      expect(isColliding).toBe(true);\r\n    });\r\n    \r\n    it('should add life when collecting life item per requirement 6.2', () => {\r\n      const gameScene = new (require('../GameScene').GameScene)();\r\n      \r\n      gameScene.handlePlayerLifeItemCollision(mockPlayer, mockLifeItem);\r\n      \r\n      expect(gameScene.handlePlayerLifeItemCollision).toHaveBeenCalledWith(mockPlayer, mockLifeItem);\r\n    });\r\n    \r\n    it('should remove life item after collection', () => {\r\n      mockLifeItem.destroy();\r\n      \r\n      expect(mockLifeItem.destroy).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should not exceed maximum of 10 lives per requirement 6.2', () => {\r\n      const mockPlayerWithMaxLives = {\r\n        lives: 10,\r\n        addLife: jest.fn()\r\n      };\r\n      \r\n      // Simulate life item collection when at max lives\r\n      if (mockPlayerWithMaxLives.lives < 10) {\r\n        mockPlayerWithMaxLives.addLife();\r\n      }\r\n      \r\n      expect(mockPlayerWithMaxLives.addLife).not.toHaveBeenCalled();\r\n    });\r\n  });\r\n  \r\n  describe('Projectile Collision', () => {\r\n    let mockProjectile: MockSprite;\r\n    \r\n    beforeEach(() => {\r\n      mockProjectile = new MockSprite(130, 100);\r\n    });\r\n    \r\n    it('should detect laser projectile collision with enemy', () => {\r\n      const projectileBounds = {\r\n        x: mockProjectile.x - 4,\r\n        y: mockProjectile.y - 2,\r\n        width: 8,\r\n        height: 4\r\n      };\r\n      \r\n      const enemyBounds = {\r\n        x: mockEnemy.x - 16,\r\n        y: mockEnemy.y - 16,\r\n        width: 32,\r\n        height: 32\r\n      };\r\n      \r\n      const isColliding = (\r\n        projectileBounds.x < enemyBounds.x + enemyBounds.width &&\r\n        projectileBounds.x + projectileBounds.width > enemyBounds.x &&\r\n        projectileBounds.y < enemyBounds.y + enemyBounds.height &&\r\n        projectileBounds.y + projectileBounds.height > enemyBounds.y\r\n      );\r\n      \r\n      expect(isColliding).toBe(true);\r\n    });\r\n    \r\n    it('should deactivate projectile after hitting enemy', () => {\r\n      mockProjectile.setActive(false);\r\n      \r\n      expect(mockProjectile.setActive).toHaveBeenCalledWith(false);\r\n      expect(mockProjectile.active).toBe(false);\r\n    });\r\n    \r\n    it('should eliminate enemy when hit by projectile', () => {\r\n      mockEnemy.destroy();\r\n      \r\n      expect(mockEnemy.destroy).toHaveBeenCalled();\r\n    });\r\n  });\r\n  \r\n  describe('Area Damage Collision (Bazooka)', () => {\r\n    let explosionCenter: { x: number; y: number };\r\n    let explosionRadius: number;\r\n    \r\n    beforeEach(() => {\r\n      explosionCenter = { x: 140, y: 100 };\r\n      explosionRadius = 80;\r\n    });\r\n    \r\n    it('should detect enemies within explosion radius', () => {\r\n      const distance = Math.sqrt(\r\n        Math.pow(mockEnemy.x - explosionCenter.x, 2) +\r\n        Math.pow(mockEnemy.y - explosionCenter.y, 2)\r\n      );\r\n      \r\n      const isInExplosionRange = distance <= explosionRadius;\r\n      \r\n      expect(isInExplosionRange).toBe(true); // Enemy at 150,100, explosion at 140,100\r\n    });\r\n    \r\n    it('should not damage enemies outside explosion radius', () => {\r\n      const farEnemy = new MockSprite(300, 100); // Far from explosion\r\n      \r\n      const distance = Math.sqrt(\r\n        Math.pow(farEnemy.x - explosionCenter.x, 2) +\r\n        Math.pow(farEnemy.y - explosionCenter.y, 2)\r\n      );\r\n      \r\n      const isInExplosionRange = distance <= explosionRadius;\r\n      \r\n      expect(isInExplosionRange).toBe(false);\r\n    });\r\n    \r\n    it('should damage multiple enemies in explosion area', () => {\r\n      const enemy1 = new MockSprite(130, 100);\r\n      const enemy2 = new MockSprite(160, 100);\r\n      const enemies = [enemy1, enemy2];\r\n      \r\n      enemies.forEach(enemy => {\r\n        const distance = Math.sqrt(\r\n          Math.pow(enemy.x - explosionCenter.x, 2) +\r\n          Math.pow(enemy.y - explosionCenter.y, 2)\r\n        );\r\n        \r\n        if (distance <= explosionRadius) {\r\n          enemy.destroy();\r\n        }\r\n      });\r\n      \r\n      expect(enemy1.destroy).toHaveBeenCalled();\r\n      expect(enemy2.destroy).toHaveBeenCalled();\r\n    });\r\n  });\r\n  \r\n  describe('Collision System Performance', () => {\r\n    it('should handle multiple simultaneous collisions', () => {\r\n      const enemies = [\r\n        new MockSprite(105, 100),\r\n        new MockSprite(110, 100),\r\n        new MockSprite(115, 100)\r\n      ];\r\n      \r\n      // Simulate multiple collisions in one frame\r\n      enemies.forEach(enemy => {\r\n        const distance = Math.abs(enemy.x - mockPlayer.x);\r\n        if (distance < 20) { // Close enough for collision\r\n          enemy.destroy();\r\n        }\r\n      });\r\n      \r\n      enemies.forEach(enemy => {\r\n        expect(enemy.destroy).toHaveBeenCalled();\r\n      });\r\n    });\r\n    \r\n    it('should efficiently check collisions using spatial partitioning concept', () => {\r\n      // Test that we only check nearby objects for collision\r\n      const nearbyEnemies = [\r\n        new MockSprite(110, 100), // Close\r\n        new MockSprite(120, 100)  // Close\r\n      ];\r\n      \r\n      const farEnemies = [\r\n        new MockSprite(500, 100), // Far\r\n        new MockSprite(600, 100)  // Far\r\n      ];\r\n      \r\n      // Only check collisions for nearby enemies\r\n      nearbyEnemies.forEach(enemy => {\r\n        const distance = Math.abs(enemy.x - mockPlayer.x);\r\n        expect(distance).toBeLessThan(50); // Within reasonable check distance\r\n      });\r\n      \r\n      farEnemies.forEach(enemy => {\r\n        const distance = Math.abs(enemy.x - mockPlayer.x);\r\n        expect(distance).toBeGreaterThan(200); // Too far to need checking\r\n      });\r\n    });\r\n  });\r\n});","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\scenes\\__tests__\\GameScene.collision.test.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Ghost' is defined but never used.","line":3,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'LifeItem' is defined but never used.","line":4,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":18},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":59,"column":6,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":59,"endColumn":9,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1200,1203],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1200,1203],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":68,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":68,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1426,1429],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1426,1429],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":69,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":69,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1469,1472],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1469,1472],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":70,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1514,1517],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1514,1517],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":71,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":71,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1567,1570],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1567,1570],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":72,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":72,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1614,1617],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1614,1617],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":73,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":73,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1665,1668],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1665,1668],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":74,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":74,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1718,1721],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1718,1721],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":75,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":75,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1767,1770],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1767,1770],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":76,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":76,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1822,1825],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1822,1825],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":92,"column":10,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":92,"endColumn":13,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2184,2187],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2184,2187],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":94,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":94,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2210,2213],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2210,2213],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":100,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":100,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2448,2451],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2448,2451],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":102,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":102,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2491,2494],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2491,2494],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":109,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":109,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2745,2748],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2745,2748],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":111,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":111,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2788,2791],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2788,2791],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":118,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":118,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3052,3055],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3052,3055],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":120,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":120,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3095,3098],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3095,3098],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":127,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":127,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3354,3357],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3354,3357],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":129,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":129,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3397,3400],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3397,3400],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":138,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":138,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3701,3704],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3701,3704],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":140,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":140,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3729,3732],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3729,3732],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":148,"column":66,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":148,"endColumn":69,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4095,4098],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4095,4098],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":149,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":149,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4121,4124],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4121,4124],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":150,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":150,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4204,4207],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4204,4207],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":151,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":151,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4259,4262],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4259,4262],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":153,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":153,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4315,4318],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4315,4318],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":165,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":165,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4750,4753],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4750,4753],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":166,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":166,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4776,4779],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4776,4779],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":168,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":168,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4833,4836],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4833,4836],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":179,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":179,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5254,5257],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5254,5257],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":180,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":180,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5309,5312],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5309,5312],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":182,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":182,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5364,5367],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5364,5367],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":185,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":185,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5496,5499],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5496,5499],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":190,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":190,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5662,5665],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5662,5665],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":191,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":191,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5717,5720],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5717,5720],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":193,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":193,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5772,5775],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5772,5775],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":196,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":196,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5901,5904],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5901,5904],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":202,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":202,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6115,6118],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6115,6118],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":203,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":203,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6169,6172],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6169,6172],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":204,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":204,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6195,6198],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6195,6198],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":205,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":205,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6250,6253],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6250,6253],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":207,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":207,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6306,6309],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6306,6309],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":219,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":219,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6663,6666],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6663,6666],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":220,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":220,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6719,6722],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6719,6722],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":222,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":222,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6778,6781],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6778,6781],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":224,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":224,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6835,6838],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6835,6838],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":47,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { GameScene } from '../GameScene';\r\nimport { Player } from '../../entities/Player';\r\nimport { Ghost } from '../../entities/Ghost';\r\nimport { LifeItem } from '../../entities/LifeItem';\r\n\r\n// Mock Phaser\r\nconst mockScene = {\r\n  add: {\r\n    existing: jest.fn(),\r\n    rectangle: jest.fn(),\r\n    graphics: jest.fn(() => ({\r\n      fillStyle: jest.fn().mockReturnThis(),\r\n      fillRect: jest.fn().mockReturnThis(),\r\n      generateTexture: jest.fn()\r\n    })),\r\n    tileSprite: jest.fn()\r\n  },\r\n  physics: {\r\n    add: {\r\n      existing: jest.fn(),\r\n      group: jest.fn(),\r\n      overlap: jest.fn()\r\n    },\r\n    world: {\r\n      setBounds: jest.fn(),\r\n      gravity: { y: 0 }\r\n    }\r\n  },\r\n  time: {\r\n    now: 1000\r\n  },\r\n  events: {\r\n    emit: jest.fn()\r\n  },\r\n  cameras: {\r\n    main: {\r\n      startFollow: jest.fn(),\r\n      setBounds: jest.fn(),\r\n      setFollowOffset: jest.fn(),\r\n      setLerp: jest.fn(),\r\n      setDeadzone: jest.fn()\r\n    }\r\n  },\r\n  input: {\r\n    keyboard: {\r\n      createCursorKeys: jest.fn(),\r\n      addKeys: jest.fn(),\r\n      addKey: jest.fn()\r\n    }\r\n  },\r\n  registry: {\r\n    get: jest.fn(),\r\n    set: jest.fn()\r\n  },\r\n  scale: {\r\n    width: 800,\r\n    height: 600\r\n  }\r\n} as any;\r\n\r\ndescribe('GameScene Collision Detection', () => {\r\n  let gameScene: GameScene;\r\n  let mockPlayer: Player;\r\n\r\n  beforeEach(() => {\r\n    gameScene = new GameScene();\r\n    // Set up the scene with mock\r\n    (gameScene as any).scene = mockScene;\r\n    (gameScene as any).add = mockScene.add;\r\n    (gameScene as any).physics = mockScene.physics;\r\n    (gameScene as any).time = mockScene.time;\r\n    (gameScene as any).events = mockScene.events;\r\n    (gameScene as any).cameras = mockScene.cameras;\r\n    (gameScene as any).input = mockScene.input;\r\n    (gameScene as any).registry = mockScene.registry;\r\n    (gameScene as any).scale = mockScene.scale;\r\n\r\n    // Create mock player\r\n    mockPlayer = {\r\n      x: 100,\r\n      y: 100,\r\n      lives: 10,\r\n      score: 0,\r\n      isInvulnerable: false,\r\n      isCrouching: false,\r\n      isJumping: false,\r\n      flipX: false,\r\n      weapon: null,\r\n      takeDamage: jest.fn(),\r\n      addLife: jest.fn(),\r\n      addScore: jest.fn()\r\n    } as any;\r\n\r\n    (gameScene as any).player = mockPlayer;\r\n  });\r\n\r\n  describe('canPlayerAvoidDamage', () => {\r\n    it('should allow crouching player to avoid floating enemies', () => {\r\n      mockPlayer.isCrouching = true;\r\n      const mockGhost = { type: 'ghost' } as any;\r\n\r\n      const result = (gameScene as any).canPlayerAvoidDamage(mockPlayer, mockGhost);\r\n\r\n      expect(result).toBe(true);\r\n    });\r\n\r\n    it('should allow jumping player to avoid ground enemies', () => {\r\n      mockPlayer.isJumping = true;\r\n      const mockVampire = { type: 'vampire' } as any;\r\n\r\n      const result = (gameScene as any).canPlayerAvoidDamage(mockPlayer, mockVampire);\r\n\r\n      expect(result).toBe(true);\r\n    });\r\n\r\n    it('should not allow crouching player to avoid ground enemies', () => {\r\n      mockPlayer.isCrouching = true;\r\n      const mockVampire = { type: 'vampire' } as any;\r\n\r\n      const result = (gameScene as any).canPlayerAvoidDamage(mockPlayer, mockVampire);\r\n\r\n      expect(result).toBe(false);\r\n    });\r\n\r\n    it('should not allow jumping player to avoid floating enemies', () => {\r\n      mockPlayer.isJumping = true;\r\n      const mockGhost = { type: 'ghost' } as any;\r\n\r\n      const result = (gameScene as any).canPlayerAvoidDamage(mockPlayer, mockGhost);\r\n\r\n      expect(result).toBe(false);\r\n    });\r\n  });\r\n\r\n  describe('handlePlayerEnemyCollision', () => {\r\n    it('should not damage invulnerable player', () => {\r\n      mockPlayer.isInvulnerable = true;\r\n      const mockEnemy = { destroy: jest.fn() } as any;\r\n\r\n      (gameScene as any).handlePlayerEnemyCollision(mockPlayer, mockEnemy);\r\n\r\n      expect(mockPlayer.takeDamage).not.toHaveBeenCalled();\r\n      expect(mockEnemy.destroy).not.toHaveBeenCalled();\r\n    });\r\n\r\n    it('should damage player and destroy enemy on collision', () => {\r\n      mockPlayer.isInvulnerable = false;\r\n      const mockEnemy = { destroy: jest.fn(), type: 'ghost' } as any;\r\n      (gameScene as any).canPlayerAvoidDamage = jest.fn().mockReturnValue(false);\r\n      (gameScene as any).updateGameState = jest.fn();\r\n      (gameScene as any).handleGameOver = jest.fn();\r\n\r\n      (gameScene as any).handlePlayerEnemyCollision(mockPlayer, mockEnemy);\r\n\r\n      expect(mockPlayer.takeDamage).toHaveBeenCalled();\r\n      expect(mockEnemy.destroy).toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe('handlePlayerLifeItemCollision', () => {\r\n    it('should add life and score when collecting life item', () => {\r\n      const mockLifeItem = {\r\n        getPointValue: jest.fn().mockReturnValue(50),\r\n        collect: jest.fn()\r\n      } as any;\r\n      (gameScene as any).updateGameState = jest.fn();\r\n\r\n      (gameScene as any).handlePlayerLifeItemCollision(mockPlayer, mockLifeItem);\r\n\r\n      expect(mockPlayer.addLife).toHaveBeenCalled();\r\n      expect(mockPlayer.addScore).toHaveBeenCalledWith(50);\r\n      expect(mockLifeItem.collect).toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe('handlePlayerSchoolGateCollision', () => {\r\n    it('should add bonus score and trigger game win', () => {\r\n      mockPlayer.lives = 5;\r\n      (gameScene as any).updateGameState = jest.fn();\r\n      (gameScene as any).handleGameWin = jest.fn();\r\n\r\n      (gameScene as any).handlePlayerSchoolGateCollision();\r\n\r\n      expect(mockPlayer.addScore).toHaveBeenCalledWith(500);\r\n      expect((gameScene as any).handleGameWin).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should not trigger win if player has no lives', () => {\r\n      mockPlayer.lives = 0;\r\n      (gameScene as any).updateGameState = jest.fn();\r\n      (gameScene as any).handleGameWin = jest.fn();\r\n\r\n      (gameScene as any).handlePlayerSchoolGateCollision();\r\n\r\n      expect(mockPlayer.addScore).not.toHaveBeenCalled();\r\n      expect((gameScene as any).handleGameWin).not.toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe('handleWeaponHitEnemy', () => {\r\n    it('should award points and destroy enemy', () => {\r\n      const mockEnemy = { destroy: jest.fn() } as any;\r\n      mockPlayer.weapon = { type: 'katana' } as any;\r\n      (gameScene as any).updateGameState = jest.fn();\r\n      (gameScene as any).applyKnockback = jest.fn();\r\n\r\n      (gameScene as any).handleWeaponHitEnemy(mockEnemy);\r\n\r\n      expect(mockPlayer.addScore).toHaveBeenCalledWith(100);\r\n      expect(mockEnemy.destroy).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should apply knockback for baseball bat', () => {\r\n      const mockEnemy = { \r\n        destroy: jest.fn(),\r\n        body: {\r\n          setVelocityX: jest.fn()\r\n        }\r\n      } as any;\r\n      mockPlayer.weapon = { type: 'baseball' } as any;\r\n      mockPlayer.flipX = false;\r\n      (gameScene as any).updateGameState = jest.fn();\r\n\r\n      (gameScene as any).handleWeaponHitEnemy(mockEnemy);\r\n\r\n      expect(mockPlayer.addScore).toHaveBeenCalledWith(100);\r\n      expect(mockEnemy.destroy).toHaveBeenCalled();\r\n    });\r\n  });\r\n});","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\scenes\\__tests__\\GameScene.input-integration.test.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":163,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":163,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3780,3783],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3780,3783],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":163,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":163,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3791,3794],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3791,3794],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":163,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":163,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3806,3809],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3806,3809],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Integration test for keyboard and touch input working together\r\n * Requirements: 3.1, 3.2, 3.3, 3.4, 3.5, 3.6\r\n */\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { describe } from \"node:test\";\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { it } from \"node:test\";\r\n\r\nimport { describe } from \"node:test\";\r\n\r\nimport { beforeEach } from \"node:test\";\r\n\r\nimport { describe } from \"node:test\";\r\n\r\ndescribe('GameScene Input Integration', () => {\r\n  // Mock the GameScene class with minimal implementation\r\n  class MockGameScene {\r\n    private touchControls = {\r\n      moveLeft: false,\r\n      moveRight: false,\r\n      jump: false,\r\n      crouch: false,\r\n      attack: false\r\n    };\r\n    \r\n    private registry = new Map();\r\n    private mockPlayer = {\r\n      move: jest.fn(),\r\n      stopMovement: jest.fn(),\r\n      jump: jest.fn(),\r\n      crouch: jest.fn(),\r\n      stopCrouching: jest.fn(),\r\n      attack: jest.fn()\r\n    };\r\n    \r\n    private scene = {\r\n      isPaused: jest.fn(() => false),\r\n      pause: jest.fn(),\r\n      resume: jest.fn()\r\n    };\r\n    \r\n    // Simulate the handleInput method logic\r\n    handleInput(): void {\r\n      if (this.scene.isPaused()) {\r\n        return;\r\n      }\r\n      \r\n      const cursors = this.registry.get('cursors');\r\n      const wasd = this.registry.get('wasd');\r\n      const spaceKey = this.registry.get('spaceKey');\r\n      \r\n      // Movement logic (keyboard + touch)\r\n      const moveLeft = (\r\n        (cursors?.left?.isDown) || \r\n        (wasd?.A?.isDown) || \r\n        this.touchControls.moveLeft\r\n      );\r\n      const moveRight = (\r\n        (cursors?.right?.isDown) || \r\n        (wasd?.D?.isDown) || \r\n        this.touchControls.moveRight\r\n      );\r\n      \r\n      if (moveLeft && !moveRight) {\r\n        this.mockPlayer.move('left');\r\n      } else if (moveRight && !moveLeft) {\r\n        this.mockPlayer.move('right');\r\n      } else {\r\n        this.mockPlayer.stopMovement();\r\n      }\r\n      \r\n      // Jump logic (keyboard + touch)\r\n      const shouldJump = (\r\n        (cursors?.up?.isDown) || \r\n        (wasd?.W?.isDown) || \r\n        this.touchControls.jump\r\n      );\r\n      \r\n      if (shouldJump) {\r\n        this.mockPlayer.jump();\r\n      }\r\n      \r\n      // Crouch logic (keyboard + touch)\r\n      const shouldCrouch = (\r\n        (cursors?.down?.isDown) || \r\n        (wasd?.S?.isDown) || \r\n        this.touchControls.crouch\r\n      );\r\n      \r\n      if (shouldCrouch) {\r\n        this.mockPlayer.crouch();\r\n      } else {\r\n        this.mockPlayer.stopCrouching();\r\n      }\r\n      \r\n      // Attack logic (keyboard + touch)\r\n      const shouldAttack = (\r\n        (spaceKey?.isDown) || \r\n        this.touchControls.attack\r\n      );\r\n      \r\n      if (shouldAttack) {\r\n        this.mockPlayer.attack();\r\n      }\r\n    }\r\n    \r\n    // Helper methods for testing\r\n    setTouchControl(control: keyof typeof this.touchControls, pressed: boolean): void {\r\n      this.touchControls[control] = pressed;\r\n    }\r\n    \r\n    setKeyboardState(cursors: any, wasd: any, spaceKey: any): void {\r\n      this.registry.set('cursors', cursors);\r\n      this.registry.set('wasd', wasd);\r\n      this.registry.set('spaceKey', spaceKey);\r\n    }\r\n    \r\n    getPlayer() {\r\n      return this.mockPlayer;\r\n    }\r\n  }\r\n  \r\n  let gameScene: MockGameScene;\r\n  \r\n  beforeEach(() => {\r\n    gameScene = new MockGameScene();\r\n    jest.clearAllMocks();\r\n  });\r\n  \r\n  describe('Keyboard and Touch Integration', () => {\r\n    it('should handle keyboard left movement (A key)', () => {\r\n      // Set up keyboard state - A key pressed\r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: false }, right: { isDown: false }, up: { isDown: false }, down: { isDown: false } },\r\n        { A: { isDown: true }, D: { isDown: false }, W: { isDown: false }, S: { isDown: false } },\r\n        { isDown: false }\r\n      );\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      expect(gameScene.getPlayer().move).toHaveBeenCalledWith('left');\r\n    });\r\n    \r\n    it('should handle keyboard right movement (D key)', () => {\r\n      // Set up keyboard state - D key pressed\r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: false }, right: { isDown: false }, up: { isDown: false }, down: { isDown: false } },\r\n        { A: { isDown: false }, D: { isDown: true }, W: { isDown: false }, S: { isDown: false } },\r\n        { isDown: false }\r\n      );\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      expect(gameScene.getPlayer().move).toHaveBeenCalledWith('right');\r\n    });\r\n    \r\n    it('should handle keyboard left movement (arrow key)', () => {\r\n      // Set up keyboard state - left arrow pressed\r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: true }, right: { isDown: false }, up: { isDown: false }, down: { isDown: false } },\r\n        { A: { isDown: false }, D: { isDown: false }, W: { isDown: false }, S: { isDown: false } },\r\n        { isDown: false }\r\n      );\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      expect(gameScene.getPlayer().move).toHaveBeenCalledWith('left');\r\n    });\r\n    \r\n    it('should handle keyboard right movement (arrow key)', () => {\r\n      // Set up keyboard state - right arrow pressed\r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: false }, right: { isDown: true }, up: { isDown: false }, down: { isDown: false } },\r\n        { A: { isDown: false }, D: { isDown: false }, W: { isDown: false }, S: { isDown: false } },\r\n        { isDown: false }\r\n      );\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      expect(gameScene.getPlayer().move).toHaveBeenCalledWith('right');\r\n    });\r\n    \r\n    it('should handle keyboard jump (W key)', () => {\r\n      // Set up keyboard state - W key pressed\r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: false }, right: { isDown: false }, up: { isDown: false }, down: { isDown: false } },\r\n        { A: { isDown: false }, D: { isDown: false }, W: { isDown: true }, S: { isDown: false } },\r\n        { isDown: false }\r\n      );\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      expect(gameScene.getPlayer().jump).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should handle keyboard jump (up arrow)', () => {\r\n      // Set up keyboard state - up arrow pressed\r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: false }, right: { isDown: false }, up: { isDown: true }, down: { isDown: false } },\r\n        { A: { isDown: false }, D: { isDown: false }, W: { isDown: false }, S: { isDown: false } },\r\n        { isDown: false }\r\n      );\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      expect(gameScene.getPlayer().jump).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should handle keyboard crouch (S key)', () => {\r\n      // Set up keyboard state - S key pressed\r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: false }, right: { isDown: false }, up: { isDown: false }, down: { isDown: false } },\r\n        { A: { isDown: false }, D: { isDown: false }, W: { isDown: false }, S: { isDown: true } },\r\n        { isDown: false }\r\n      );\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      expect(gameScene.getPlayer().crouch).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should handle keyboard crouch (down arrow)', () => {\r\n      // Set up keyboard state - down arrow pressed\r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: false }, right: { isDown: false }, up: { isDown: false }, down: { isDown: true } },\r\n        { A: { isDown: false }, D: { isDown: false }, W: { isDown: false }, S: { isDown: false } },\r\n        { isDown: false }\r\n      );\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      expect(gameScene.getPlayer().crouch).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should handle keyboard attack (space key)', () => {\r\n      // Set up keyboard state - space key pressed\r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: false }, right: { isDown: false }, up: { isDown: false }, down: { isDown: false } },\r\n        { A: { isDown: false }, D: { isDown: false }, W: { isDown: false }, S: { isDown: false } },\r\n        { isDown: true }\r\n      );\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      expect(gameScene.getPlayer().attack).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should combine keyboard and touch controls - keyboard left + touch jump', () => {\r\n      // Set up keyboard left movement\r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: false }, right: { isDown: false }, up: { isDown: false }, down: { isDown: false } },\r\n        { A: { isDown: true }, D: { isDown: false }, W: { isDown: false }, S: { isDown: false } },\r\n        { isDown: false }\r\n      );\r\n      \r\n      // Set up touch jump\r\n      gameScene.setTouchControl('jump', true);\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      expect(gameScene.getPlayer().move).toHaveBeenCalledWith('left');\r\n      expect(gameScene.getPlayer().jump).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should combine keyboard and touch controls - touch left + keyboard attack', () => {\r\n      // Set up touch left movement\r\n      gameScene.setTouchControl('moveLeft', true);\r\n      \r\n      // Set up keyboard attack\r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: false }, right: { isDown: false }, up: { isDown: false }, down: { isDown: false } },\r\n        { A: { isDown: false }, D: { isDown: false }, W: { isDown: false }, S: { isDown: false } },\r\n        { isDown: true }\r\n      );\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      expect(gameScene.getPlayer().move).toHaveBeenCalledWith('left');\r\n      expect(gameScene.getPlayer().attack).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should handle conflicting inputs correctly', () => {\r\n      // Set up conflicting inputs - keyboard right, touch left\r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: false }, right: { isDown: false }, up: { isDown: false }, down: { isDown: false } },\r\n        { A: { isDown: false }, D: { isDown: true }, W: { isDown: false }, S: { isDown: false } },\r\n        { isDown: false }\r\n      );\r\n      gameScene.setTouchControl('moveLeft', true);\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      // When both moveLeft and moveRight are true, neither should be called (stopMovement should be called)\r\n      expect(gameScene.getPlayer().move).not.toHaveBeenCalled();\r\n      expect(gameScene.getPlayer().stopMovement).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should handle multiple simultaneous keyboard inputs', () => {\r\n      // Set up multiple keyboard inputs - move right, jump, attack\r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: false }, right: { isDown: true }, up: { isDown: true }, down: { isDown: false } },\r\n        { A: { isDown: false }, D: { isDown: false }, W: { isDown: false }, S: { isDown: false } },\r\n        { isDown: true }\r\n      );\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      expect(gameScene.getPlayer().move).toHaveBeenCalledWith('right');\r\n      expect(gameScene.getPlayer().jump).toHaveBeenCalled();\r\n      expect(gameScene.getPlayer().attack).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should handle multiple simultaneous touch inputs', () => {\r\n      // Set up multiple touch inputs - move left, crouch, attack\r\n      gameScene.setTouchControl('moveLeft', true);\r\n      gameScene.setTouchControl('crouch', true);\r\n      gameScene.setTouchControl('attack', true);\r\n      \r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: false }, right: { isDown: false }, up: { isDown: false }, down: { isDown: false } },\r\n        { A: { isDown: false }, D: { isDown: false }, W: { isDown: false }, S: { isDown: false } },\r\n        { isDown: false }\r\n      );\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      expect(gameScene.getPlayer().move).toHaveBeenCalledWith('left');\r\n      expect(gameScene.getPlayer().crouch).toHaveBeenCalled();\r\n      expect(gameScene.getPlayer().attack).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should stop movement when no movement keys are pressed', () => {\r\n      // No movement keys pressed\r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: false }, right: { isDown: false }, up: { isDown: false }, down: { isDown: false } },\r\n        { A: { isDown: false }, D: { isDown: false }, W: { isDown: false }, S: { isDown: false } },\r\n        { isDown: false }\r\n      );\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      expect(gameScene.getPlayer().stopMovement).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should stop crouching when no crouch keys are pressed', () => {\r\n      // No crouch keys pressed\r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: false }, right: { isDown: false }, up: { isDown: false }, down: { isDown: false } },\r\n        { A: { isDown: false }, D: { isDown: false }, W: { isDown: false }, S: { isDown: false } },\r\n        { isDown: false }\r\n      );\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      expect(gameScene.getPlayer().stopCrouching).toHaveBeenCalled();\r\n    });\r\n  });\r\n  \r\n  describe('Requirements Verification', () => {\r\n    it('should meet requirement 3.1 - A key moves left', () => {\r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: false }, right: { isDown: false }, up: { isDown: false }, down: { isDown: false } },\r\n        { A: { isDown: true }, D: { isDown: false }, W: { isDown: false }, S: { isDown: false } },\r\n        { isDown: false }\r\n      );\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      expect(gameScene.getPlayer().move).toHaveBeenCalledWith('left');\r\n    });\r\n    \r\n    it('should meet requirement 3.1 - left arrow moves left', () => {\r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: true }, right: { isDown: false }, up: { isDown: false }, down: { isDown: false } },\r\n        { A: { isDown: false }, D: { isDown: false }, W: { isDown: false }, S: { isDown: false } },\r\n        { isDown: false }\r\n      );\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      expect(gameScene.getPlayer().move).toHaveBeenCalledWith('left');\r\n    });\r\n    \r\n    it('should meet requirement 3.2 - D key moves right', () => {\r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: false }, right: { isDown: false }, up: { isDown: false }, down: { isDown: false } },\r\n        { A: { isDown: false }, D: { isDown: true }, W: { isDown: false }, S: { isDown: false } },\r\n        { isDown: false }\r\n      );\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      expect(gameScene.getPlayer().move).toHaveBeenCalledWith('right');\r\n    });\r\n    \r\n    it('should meet requirement 3.2 - right arrow moves right', () => {\r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: false }, right: { isDown: true }, up: { isDown: false }, down: { isDown: false } },\r\n        { A: { isDown: false }, D: { isDown: false }, W: { isDown: false }, S: { isDown: false } },\r\n        { isDown: false }\r\n      );\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      expect(gameScene.getPlayer().move).toHaveBeenCalledWith('right');\r\n    });\r\n    \r\n    it('should meet requirement 3.3 - W key makes player jump', () => {\r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: false }, right: { isDown: false }, up: { isDown: false }, down: { isDown: false } },\r\n        { A: { isDown: false }, D: { isDown: false }, W: { isDown: true }, S: { isDown: false } },\r\n        { isDown: false }\r\n      );\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      expect(gameScene.getPlayer().jump).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should meet requirement 3.3 - up arrow makes player jump', () => {\r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: false }, right: { isDown: false }, up: { isDown: true }, down: { isDown: false } },\r\n        { A: { isDown: false }, D: { isDown: false }, W: { isDown: false }, S: { isDown: false } },\r\n        { isDown: false }\r\n      );\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      expect(gameScene.getPlayer().jump).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should meet requirement 3.4 - S key makes player crouch', () => {\r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: false }, right: { isDown: false }, up: { isDown: false }, down: { isDown: false } },\r\n        { A: { isDown: false }, D: { isDown: false }, W: { isDown: false }, S: { isDown: true } },\r\n        { isDown: false }\r\n      );\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      expect(gameScene.getPlayer().crouch).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should meet requirement 3.4 - down arrow makes player crouch', () => {\r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: false }, right: { isDown: false }, up: { isDown: false }, down: { isDown: true } },\r\n        { A: { isDown: false }, D: { isDown: false }, W: { isDown: false }, S: { isDown: false } },\r\n        { isDown: false }\r\n      );\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      expect(gameScene.getPlayer().crouch).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should meet requirement 3.5 - Space key makes player attack', () => {\r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: false }, right: { isDown: false }, up: { isDown: false }, down: { isDown: false } },\r\n        { A: { isDown: false }, D: { isDown: false }, W: { isDown: false }, S: { isDown: false } },\r\n        { isDown: true }\r\n      );\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      expect(gameScene.getPlayer().attack).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should meet requirement 3.6 - keyboard controls work alongside touch controls', () => {\r\n      // Combine keyboard movement with touch attack\r\n      gameScene.setKeyboardState(\r\n        { left: { isDown: false }, right: { isDown: false }, up: { isDown: false }, down: { isDown: false } },\r\n        { A: { isDown: true }, D: { isDown: false }, W: { isDown: false }, S: { isDown: false } },\r\n        { isDown: false }\r\n      );\r\n      gameScene.setTouchControl('attack', true);\r\n      \r\n      gameScene.handleInput();\r\n      \r\n      expect(gameScene.getPlayer().move).toHaveBeenCalledWith('left');\r\n      expect(gameScene.getPlayer().attack).toHaveBeenCalled();\r\n    });\r\n  });\r\n});","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\scenes\\__tests__\\GameScene.keyboard.test.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":104,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":104,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2483,2486],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2483,2486],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'texture' is defined but never used. Allowed unused args must match /^_/u.","line":104,"column":55,"nodeType":null,"messageId":"unusedVar","endLine":104,"endColumn":62},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":115,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":115,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2709,2712],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2709,2712],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":138,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":138,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3216,3219],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3216,3219],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":139,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":139,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3261,3264],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3261,3264],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":140,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":140,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3326,3329],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3326,3329],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":141,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":141,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3393,3396],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3393,3396],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":153,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":153,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3697,3700],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3697,3700],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":166,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":166,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4206,4209],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4206,4209],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":169,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":169,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4309,4312],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4309,4312],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":176,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":176,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4509,4512],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4509,4512],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":188,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":188,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4838,4841],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4838,4841],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":202,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":202,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5260,5263],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5260,5263],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":216,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":216,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5653,5656],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5653,5656],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":230,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":230,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6061,6064],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6061,6064],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":244,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":244,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6445,6448],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6445,6448],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":258,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":258,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6861,6864],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6861,6864],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":267,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":267,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7147,7150],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7147,7150],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":274,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":274,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7368,7371],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7368,7371],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":285,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":285,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7680,7683],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7680,7683],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":309,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":309,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8442,8445],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8442,8445],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":331,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":331,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9140,9143],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9140,9143],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":339,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":339,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9334,9337],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9334,9337],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":349,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":349,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9668,9671],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9668,9671],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":366,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":366,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10165,10168],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10165,10168],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":24,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { GameScene } from '../GameScene';\r\nimport * as Phaser from 'phaser';\r\n\r\n// Mock Phaser components\r\njest.mock('phaser', () => ({\r\n  Scene: class MockScene {\r\n    registry = new Map();\r\n    input = {\r\n      keyboard: {\r\n        createCursorKeys: jest.fn(() => ({\r\n          left: { isDown: false },\r\n          right: { isDown: false },\r\n          up: { isDown: false },\r\n          down: { isDown: false }\r\n        })),\r\n        addKeys: jest.fn(() => ({\r\n          W: { isDown: false },\r\n          A: { isDown: false },\r\n          S: { isDown: false },\r\n          D: { isDown: false }\r\n        })),\r\n        addKey: jest.fn(() => ({ isDown: false })),\r\n        addCapture: jest.fn()\r\n      }\r\n    };\r\n    events = {\r\n      emit: jest.fn()\r\n    };\r\n    scene = {\r\n      isPaused: jest.fn(() => false),\r\n      pause: jest.fn(),\r\n      resume: jest.fn()\r\n    };\r\n    physics = {\r\n      world: {\r\n        setBounds: jest.fn(),\r\n        gravity: { y: 0 }\r\n      },\r\n      add: {\r\n        group: jest.fn(() => ({\r\n          children: { entries: [] }\r\n        })),\r\n        existing: jest.fn(),\r\n        overlap: jest.fn()\r\n      }\r\n    };\r\n    add = {\r\n      graphics: jest.fn(() => ({\r\n        fillStyle: jest.fn().mockReturnThis(),\r\n        fillRect: jest.fn().mockReturnThis(),\r\n        generateTexture: jest.fn().mockReturnThis()\r\n      })),\r\n      tileSprite: jest.fn(() => ({\r\n        setOrigin: jest.fn().mockReturnThis(),\r\n        setScrollFactor: jest.fn().mockReturnThis()\r\n      })),\r\n      rectangle: jest.fn(() => ({})),\r\n      existing: jest.fn()\r\n    };\r\n    cameras = {\r\n      main: {\r\n        startFollow: jest.fn(),\r\n        setBounds: jest.fn(),\r\n        setFollowOffset: jest.fn(),\r\n        setLerp: jest.fn(),\r\n        setDeadzone: jest.fn(),\r\n        scrollX: 0\r\n      }\r\n    };\r\n    time = {\r\n      now: 0\r\n    };\r\n  },\r\n  Input: {\r\n    Keyboard: {\r\n      KeyCodes: {\r\n        W: 87,\r\n        A: 65,\r\n        S: 83,\r\n        D: 68,\r\n        SPACE: 32,\r\n        ESC: 27,\r\n        UP: 38,\r\n        DOWN: 40,\r\n        LEFT: 37,\r\n        RIGHT: 39\r\n      },\r\n      JustDown: jest.fn(() => false)\r\n    }\r\n  },\r\n  Physics: {\r\n    Arcade: {\r\n      Sprite: class MockSprite {\r\n        x = 0;\r\n        y = 0;\r\n        flipX = false;\r\n        body = {\r\n          setCollideWorldBounds: jest.fn(),\r\n          setGravityY: jest.fn(),\r\n          setSize: jest.fn(),\r\n          touching: { down: true }\r\n        };\r\n        setFlipX = jest.fn();\r\n        constructor(scene: any, x: number, y: number, texture: string) {\r\n          this.x = x;\r\n          this.y = y;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}));\r\n\r\ndescribe('GameScene Keyboard Input', () => {\r\n  let gameScene: GameScene;\r\n  let mockPlayer: any;\r\n\r\n  beforeEach(() => {\r\n    gameScene = new GameScene();\r\n    \r\n    // Mock player\r\n    mockPlayer = {\r\n      x: 100,\r\n      y: 100,\r\n      lives: 10,\r\n      score: 0,\r\n      move: jest.fn(),\r\n      stopMovement: jest.fn(),\r\n      jump: jest.fn(),\r\n      crouch: jest.fn(),\r\n      stopCrouching: jest.fn(),\r\n      attack: jest.fn(),\r\n      update: jest.fn(),\r\n      setCollideWorldBounds: jest.fn(),\r\n      weapon: null\r\n    };\r\n    \r\n    // Set up the scene with mocked components\r\n    (gameScene as any).player = mockPlayer;\r\n    (gameScene as any).enemies = { children: { entries: [] } };\r\n    (gameScene as any).lifeItems = { children: { entries: [] } };\r\n    (gameScene as any).touchControls = {\r\n      moveLeft: false,\r\n      moveRight: false,\r\n      jump: false,\r\n      crouch: false,\r\n      attack: false\r\n    };\r\n  });\r\n\r\n  describe('setupControls', () => {\r\n    it('should initialize keyboard controls correctly', () => {\r\n      // Call setupControls\r\n      (gameScene as any).setupControls();\r\n      \r\n      // Verify keyboard controls are set up\r\n      expect(gameScene.areKeyboardControlsReady()).toBe(true);\r\n      \r\n      // Verify input capture is set up\r\n      expect(gameScene.input.keyboard?.addCapture).toHaveBeenCalledWith([\r\n        87, 65, 83, 68, 32, 38, 40, 37, 39, 27 // W, A, S, D, SPACE, UP, DOWN, LEFT, RIGHT, ESC\r\n      ]);\r\n    });\r\n\r\n    it('should handle missing keyboard input gracefully', () => {\r\n      // Mock missing keyboard input\r\n      (gameScene as any).input.keyboard = null;\r\n      \r\n      // Should not throw error\r\n      expect(() => (gameScene as any).setupControls()).not.toThrow();\r\n      expect(gameScene.areKeyboardControlsReady()).toBe(false);\r\n    });\r\n  });\r\n\r\n  describe('handleInput', () => {\r\n    beforeEach(() => {\r\n      (gameScene as any).setupControls();\r\n    });\r\n\r\n    it('should handle WASD movement keys', () => {\r\n      const wasd = {\r\n        W: { isDown: false },\r\n        A: { isDown: true },  // Press A key\r\n        S: { isDown: false },\r\n        D: { isDown: false }\r\n      };\r\n      gameScene.registry.set('wasd', wasd);\r\n      \r\n      (gameScene as any).handleInput();\r\n      \r\n      expect(mockPlayer.move).toHaveBeenCalledWith('left');\r\n    });\r\n\r\n    it('should handle arrow keys movement', () => {\r\n      const cursors = {\r\n        left: { isDown: false },\r\n        right: { isDown: true }, // Press right arrow\r\n        up: { isDown: false },\r\n        down: { isDown: false }\r\n      };\r\n      gameScene.registry.set('cursors', cursors);\r\n      \r\n      (gameScene as any).handleInput();\r\n      \r\n      expect(mockPlayer.move).toHaveBeenCalledWith('right');\r\n    });\r\n\r\n    it('should handle jump with W key', () => {\r\n      const wasd = {\r\n        W: { isDown: true }, // Press W key\r\n        A: { isDown: false },\r\n        S: { isDown: false },\r\n        D: { isDown: false }\r\n      };\r\n      gameScene.registry.set('wasd', wasd);\r\n      \r\n      (gameScene as any).handleInput();\r\n      \r\n      expect(mockPlayer.jump).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should handle jump with up arrow', () => {\r\n      const cursors = {\r\n        left: { isDown: false },\r\n        right: { isDown: false },\r\n        up: { isDown: true }, // Press up arrow\r\n        down: { isDown: false }\r\n      };\r\n      gameScene.registry.set('cursors', cursors);\r\n      \r\n      (gameScene as any).handleInput();\r\n      \r\n      expect(mockPlayer.jump).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should handle crouch with S key', () => {\r\n      const wasd = {\r\n        W: { isDown: false },\r\n        A: { isDown: false },\r\n        S: { isDown: true }, // Press S key\r\n        D: { isDown: false }\r\n      };\r\n      gameScene.registry.set('wasd', wasd);\r\n      \r\n      (gameScene as any).handleInput();\r\n      \r\n      expect(mockPlayer.crouch).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should handle crouch with down arrow', () => {\r\n      const cursors = {\r\n        left: { isDown: false },\r\n        right: { isDown: false },\r\n        up: { isDown: false },\r\n        down: { isDown: true } // Press down arrow\r\n      };\r\n      gameScene.registry.set('cursors', cursors);\r\n      \r\n      (gameScene as any).handleInput();\r\n      \r\n      expect(mockPlayer.crouch).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should handle attack with space key', () => {\r\n      const spaceKey = { isDown: true }; // Press space\r\n      gameScene.registry.set('spaceKey', spaceKey);\r\n      \r\n      (gameScene as any).handleInput();\r\n      \r\n      expect(mockPlayer.attack).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should combine keyboard and touch controls', () => {\r\n      // Set touch control for left movement\r\n      (gameScene as any).touchControls.moveLeft = true;\r\n      \r\n      // Set keyboard control for jump\r\n      const wasd = {\r\n        W: { isDown: true },\r\n        A: { isDown: false },\r\n        S: { isDown: false },\r\n        D: { isDown: false }\r\n      };\r\n      gameScene.registry.set('wasd', wasd);\r\n      \r\n      (gameScene as any).handleInput();\r\n      \r\n      // Both touch and keyboard inputs should work\r\n      expect(mockPlayer.move).toHaveBeenCalledWith('left');\r\n      expect(mockPlayer.jump).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should stop movement when no movement keys are pressed', () => {\r\n      // No movement keys pressed\r\n      const wasd = {\r\n        W: { isDown: false },\r\n        A: { isDown: false },\r\n        S: { isDown: false },\r\n        D: { isDown: false }\r\n      };\r\n      const cursors = {\r\n        left: { isDown: false },\r\n        right: { isDown: false },\r\n        up: { isDown: false },\r\n        down: { isDown: false }\r\n      };\r\n      gameScene.registry.set('wasd', wasd);\r\n      gameScene.registry.set('cursors', cursors);\r\n      \r\n      (gameScene as any).handleInput();\r\n      \r\n      expect(mockPlayer.stopMovement).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should stop crouching when crouch keys are released', () => {\r\n      // No crouch keys pressed\r\n      const wasd = {\r\n        W: { isDown: false },\r\n        A: { isDown: false },\r\n        S: { isDown: false }, // S key not pressed\r\n        D: { isDown: false }\r\n      };\r\n      const cursors = {\r\n        left: { isDown: false },\r\n        right: { isDown: false },\r\n        up: { isDown: false },\r\n        down: { isDown: false } // Down arrow not pressed\r\n      };\r\n      gameScene.registry.set('wasd', wasd);\r\n      gameScene.registry.set('cursors', cursors);\r\n      \r\n      (gameScene as any).handleInput();\r\n      \r\n      expect(mockPlayer.stopCrouching).toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe('pause functionality', () => {\r\n    beforeEach(() => {\r\n      (gameScene as any).setupControls();\r\n    });\r\n\r\n    it('should handle pause with ESC key', () => {\r\n      const escKey = { isDown: true };\r\n      gameScene.registry.set('escKey', escKey);\r\n      \r\n      // Mock JustDown to return true for ESC\r\n      (Phaser.Input.Keyboard.JustDown as jest.Mock).mockReturnValue(true);\r\n      \r\n      (gameScene as any).handleInput();\r\n      \r\n      expect(gameScene.scene.pause).toHaveBeenCalled();\r\n    });\r\n\r\n    it('should skip input processing when game is paused', () => {\r\n      // Mock game as paused\r\n      (gameScene.scene.isPaused as jest.Mock).mockReturnValue(true);\r\n      \r\n      const wasd = {\r\n        W: { isDown: true },\r\n        A: { isDown: true },\r\n        S: { isDown: true },\r\n        D: { isDown: true }\r\n      };\r\n      gameScene.registry.set('wasd', wasd);\r\n      \r\n      (gameScene as any).handleInput();\r\n      \r\n      // No player actions should be called when paused\r\n      expect(mockPlayer.move).not.toHaveBeenCalled();\r\n      expect(mockPlayer.jump).not.toHaveBeenCalled();\r\n      expect(mockPlayer.crouch).not.toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe('getKeyboardState', () => {\r\n    it('should return current keyboard state', () => {\r\n      const wasd = {\r\n        W: { isDown: true },\r\n        A: { isDown: false },\r\n        S: { isDown: true },\r\n        D: { isDown: false }\r\n      };\r\n      const cursors = {\r\n        left: { isDown: true },\r\n        right: { isDown: false },\r\n        up: { isDown: false },\r\n        down: { isDown: true }\r\n      };\r\n      const spaceKey = { isDown: true };\r\n      const escKey = { isDown: false };\r\n      \r\n      gameScene.registry.set('wasd', wasd);\r\n      gameScene.registry.set('cursors', cursors);\r\n      gameScene.registry.set('spaceKey', spaceKey);\r\n      gameScene.registry.set('escKey', escKey);\r\n      \r\n      const state = gameScene.getKeyboardState();\r\n      \r\n      expect(state).toEqual({\r\n        cursors: {\r\n          left: true,\r\n          right: false,\r\n          up: false,\r\n          down: true\r\n        },\r\n        wasd: {\r\n          W: true,\r\n          A: false,\r\n          S: true,\r\n          D: false\r\n        },\r\n        spaceKey: true,\r\n        escKey: false\r\n      });\r\n    });\r\n  });\r\n});","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\scenes\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\sprites\\SpriteManager.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\utils\\AssetLoader.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\utils\\AudioManager.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":151,"column":67,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":151,"endColumn":70,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5375,5378],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5375,5378],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Howl, Howler } from 'howler';\r\n\r\n/**\r\n * AudioManager handles all game audio using Howler.js\r\n * Requirements: 11.1, 11.2, 11.3, 11.4, 11.5\r\n */\r\nexport class AudioManager {\r\n  private static instance: AudioManager;\r\n  private sounds: Map<string, Howl> = new Map();\r\n  private backgroundMusic: Howl | null = null;\r\n  private isInitialized: boolean = false;\r\n  private isMuted: boolean = false;\r\n  \r\n  // Volume settings (will be overridden by audio store)\r\n  private musicVolume = 0.3;\r\n  private sfxVolume = 0.7;\r\n  \r\n  private constructor() {\r\n    // Private constructor for singleton pattern\r\n  }\r\n  \r\n  /**\r\n   * Get singleton instance of AudioManager\r\n   */\r\n  public static getInstance(): AudioManager {\r\n    if (!AudioManager.instance) {\r\n      AudioManager.instance = new AudioManager();\r\n    }\r\n    return AudioManager.instance;\r\n  }\r\n  \r\n  /**\r\n   * Initialize audio system and load all sounds\r\n   * Requirements: 11.1, 11.2, 11.3, 11.4, 11.5\r\n   */\r\n  public initialize(): void {\r\n    if (this.isInitialized) return;\r\n    \r\n    try {\r\n      // Set global volume\r\n      Howler.volume(1.0);\r\n      \r\n      // Load background music\r\n      this.loadBackgroundMusic();\r\n      \r\n      // Load sound effects\r\n      this.loadSoundEffects();\r\n      \r\n      this.isInitialized = true;\r\n      console.log('AudioManager initialized successfully');\r\n    } catch (error) {\r\n      console.warn('Failed to initialize AudioManager:', error);\r\n      // Graceful degradation - game continues without sound\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Load background music (wind and crickets ambient sound)\r\n   * Requirements: 11.1\r\n   */\r\n  private loadBackgroundMusic(): void {\r\n    try {\r\n      console.log('Loading real background ambient music...');\r\n      this.backgroundMusic = new Howl({\r\n        src: ['/assets/audio/background-ambient.mp3'],\r\n        loop: true,\r\n        volume: this.musicVolume,\r\n        autoplay: false,\r\n        onload: () => {\r\n          console.log('Background ambient music loaded successfully');\r\n        },\r\n        onloaderror: (_, error) => {\r\n          console.warn('Failed to load background music, creating silent fallback:', error);\r\n          // Create silent fallback if real audio fails\r\n          this.backgroundMusic = new Howl({\r\n            src: ['data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAAAQESsAEAEAAABAAgAZGF0YQAAAAA='],\r\n            loop: true,\r\n            volume: 0\r\n          });\r\n        }\r\n      });\r\n    } catch (error) {\r\n      console.warn('Error loading background music:', error);\r\n      // Create silent fallback\r\n      this.backgroundMusic = new Howl({\r\n        src: ['data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAAAQESsAEAEAAABAAgAZGF0YQAAAAA='],\r\n        loop: true,\r\n        volume: 0\r\n      });\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Load all sound effects\r\n   * Requirements: 11.2, 11.3, 11.4, 11.5\r\n   */\r\n  private loadSoundEffects(): void {\r\n    const soundEffects = [\r\n      // Player action sounds\r\n      { key: 'jump', src: '/assets/audio/jump.mp3', fallbackFreq: 800, fallbackDuration: 150 },\r\n      { key: 'damage', src: '/assets/audio/damage.mp3', fallbackFreq: 200, fallbackDuration: 300 },\r\n      { key: 'item_collect', src: '/assets/audio/item-collect.mp3', fallbackFreq: 1000, fallbackDuration: 200 },\r\n      \r\n      // Weapon sounds\r\n      { key: 'slash', src: '/assets/audio/slash.mp3', fallbackFreq: 600, fallbackDuration: 100 },\r\n      { key: 'laser', src: '/assets/audio/laser.mp3', fallbackFreq: 1200, fallbackDuration: 250 },\r\n      { key: 'explosion', src: '/assets/audio/explosion.mp3', fallbackFreq: 100, fallbackDuration: 400 },\r\n    ];\r\n    \r\n    soundEffects.forEach(({ key, src, fallbackFreq, fallbackDuration }) => {\r\n      try {\r\n        console.log(`Loading real audio file for: ${key}`);\r\n        const sound = new Howl({\r\n          src: [src],\r\n          volume: this.sfxVolume,\r\n          onload: () => {\r\n            console.log(`Successfully loaded real audio file: ${key}`);\r\n          },\r\n          onloaderror: (_, error) => {\r\n            console.warn(`Failed to load real audio file '${key}', creating fallback:`, error);\r\n            // Replace with fallback sound if real audio fails\r\n            const fallbackSound = this.createFallbackSound(fallbackFreq, fallbackDuration);\r\n            this.sounds.set(key, fallbackSound);\r\n          }\r\n        });\r\n        this.sounds.set(key, sound);\r\n      } catch (error) {\r\n        console.warn(`Error loading sound '${key}':`, error);\r\n        // Create fallback sound as backup\r\n        try {\r\n          const fallbackSound = this.createFallbackSound(fallbackFreq, fallbackDuration);\r\n          this.sounds.set(key, fallbackSound);\r\n        } catch (fallbackError) {\r\n          console.warn(`Failed to create fallback for '${key}':`, fallbackError);\r\n          // Create silent fallback as last resort\r\n          this.sounds.set(key, new Howl({\r\n            src: ['data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAAAQESsAEAEAAABAAgAZGF0YQAAAAA='],\r\n            volume: 0\r\n          }));\r\n        }\r\n      }\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * Create a simple beep sound as fallback when audio files fail to load\r\n   */\r\n  private createFallbackSound(frequency: number = 440, duration: number = 200): Howl {\r\n    // Create a simple beep sound using Web Audio API\r\n    try {\r\n      const audioContext = new (window.AudioContext || (window as any).webkitAudioContext)();\r\n      const sampleRate = audioContext.sampleRate;\r\n      const numSamples = Math.floor(sampleRate * (duration / 1000));\r\n      const buffer = audioContext.createBuffer(1, numSamples, sampleRate);\r\n      const channelData = buffer.getChannelData(0);\r\n      \r\n      // Generate a simple sine wave\r\n      for (let i = 0; i < numSamples; i++) {\r\n        channelData[i] = Math.sin(2 * Math.PI * frequency * i / sampleRate) * 0.1; // Low volume\r\n      }\r\n      \r\n      // Convert buffer to WAV blob and create object URL\r\n      const wavBlob = this.bufferToWav(buffer);\r\n      const audioUrl = URL.createObjectURL(wavBlob);\r\n      \r\n      return new Howl({\r\n        src: [audioUrl],\r\n        volume: 0.1\r\n      });\r\n    } catch (error) {\r\n      console.warn('Failed to create fallback sound:', error);\r\n      // Return a completely silent sound as last resort\r\n      return new Howl({\r\n        src: ['data:audio/wav;base64,UklGRigAAABXQVZFZm10IBAAAAAAQESsAEAEAAABAAgAZGF0YQAAAAA='],\r\n        volume: 0\r\n      });\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Convert AudioBuffer to WAV blob\r\n   */\r\n  private bufferToWav(buffer: AudioBuffer): Blob {\r\n    const length = buffer.length;\r\n    const arrayBuffer = new ArrayBuffer(44 + length * 2);\r\n    const view = new DataView(arrayBuffer);\r\n    \r\n    // WAV header\r\n    const writeString = (offset: number, string: string) => {\r\n      for (let i = 0; i < string.length; i++) {\r\n        view.setUint8(offset + i, string.charCodeAt(i));\r\n      }\r\n    };\r\n    \r\n    writeString(0, 'RIFF');\r\n    view.setUint32(4, 36 + length * 2, true);\r\n    writeString(8, 'WAVE');\r\n    writeString(12, 'fmt ');\r\n    view.setUint32(16, 16, true);\r\n    view.setUint16(20, 1, true);\r\n    view.setUint16(22, 1, true);\r\n    view.setUint32(24, buffer.sampleRate, true);\r\n    view.setUint32(28, buffer.sampleRate * 2, true);\r\n    view.setUint16(32, 2, true);\r\n    view.setUint16(34, 16, true);\r\n    writeString(36, 'data');\r\n    view.setUint32(40, length * 2, true);\r\n    \r\n    // Convert float samples to 16-bit PCM\r\n    const channelData = buffer.getChannelData(0);\r\n    let offset = 44;\r\n    for (let i = 0; i < length; i++) {\r\n      const sample = Math.max(-1, Math.min(1, channelData[i]));\r\n      view.setInt16(offset, sample * 0x7FFF, true);\r\n      offset += 2;\r\n    }\r\n    \r\n    return new Blob([arrayBuffer], { type: 'audio/wav' });\r\n  }\r\n  \r\n  /**\r\n   * Start playing background music\r\n   * Requirements: 11.1\r\n   */\r\n  public playBackgroundMusic(): void {\r\n    if (!this.isInitialized || this.isMuted || !this.backgroundMusic) return;\r\n    \r\n    try {\r\n      if (!this.backgroundMusic.playing()) {\r\n        this.backgroundMusic.play();\r\n        console.log('Background music started');\r\n        // Trigger accessibility events\r\n        this.triggerAccessibilityEvents('background_music');\r\n      }\r\n    } catch (error) {\r\n      console.warn('Failed to play background music:', error);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Stop background music\r\n   */\r\n  public stopBackgroundMusic(): void {\r\n    if (this.backgroundMusic) {\r\n      this.backgroundMusic.stop();\r\n      console.log('Background music stopped');\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Play jump sound effect\r\n   * Requirements: 11.2\r\n   */\r\n  public playJumpSound(): void {\r\n    this.playSound('jump');\r\n    // Trigger accessibility events\r\n    this.triggerAccessibilityEvents('jump');\r\n  }\r\n  \r\n  /**\r\n   * Play damage sound effect\r\n   * Requirements: 11.3\r\n   */\r\n  public playDamageSound(): void {\r\n    this.playSound('damage');\r\n    // Trigger accessibility events\r\n    this.triggerAccessibilityEvents('damage');\r\n  }\r\n  \r\n  /**\r\n   * Play item collection sound effect\r\n   * Requirements: 11.4\r\n   */\r\n  public playItemCollectSound(): void {\r\n    this.playSound('item_collect');\r\n    // Trigger accessibility events\r\n    this.triggerAccessibilityEvents('item_collect');\r\n  }\r\n  \r\n  /**\r\n   * Play weapon-specific attack sound\r\n   * Requirements: 11.5\r\n   */\r\n  public playWeaponSound(weaponType: 'katana' | 'laser' | 'baseball' | 'bazooka'): void {\r\n    switch (weaponType) {\r\n      case 'katana':\r\n      case 'baseball':\r\n        this.playSound('slash');\r\n        break;\r\n      case 'laser':\r\n        this.playSound('laser');\r\n        break;\r\n      case 'bazooka':\r\n        this.playSound('explosion');\r\n        break;\r\n      default:\r\n        console.warn(`Unknown weapon type: ${weaponType}`);\r\n    }\r\n    // Trigger accessibility events\r\n    this.triggerAccessibilityEvents('weapon_attack', weaponType);\r\n  }\r\n  \r\n  /**\r\n   * Play a specific sound effect by key\r\n   */\r\n  private playSound(key: string): void {\r\n    if (!this.isInitialized || this.isMuted) return;\r\n    \r\n    const sound = this.sounds.get(key);\r\n    if (sound) {\r\n      try {\r\n        sound.play();\r\n      } catch (error) {\r\n        console.warn(`Failed to play sound '${key}':`, error);\r\n      }\r\n    } else {\r\n      console.warn(`Sound '${key}' not found`);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Mute all audio\r\n   */\r\n  public mute(): void {\r\n    this.isMuted = true;\r\n    Howler.mute(true);\r\n    console.log('Audio muted');\r\n  }\r\n  \r\n  /**\r\n   * Unmute all audio\r\n   */\r\n  public unmute(): void {\r\n    this.isMuted = false;\r\n    Howler.mute(false);\r\n    console.log('Audio unmuted');\r\n  }\r\n  \r\n  /**\r\n   * Toggle mute state\r\n   */\r\n  public toggleMute(): void {\r\n    if (this.isMuted) {\r\n      this.unmute();\r\n    } else {\r\n      this.mute();\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Set master volume (0.0 to 1.0)\r\n   */\r\n  public setVolume(volume: number): void {\r\n    const clampedVolume = Math.max(0, Math.min(1, volume));\r\n    Howler.volume(clampedVolume);\r\n    console.log(`Master volume set to: ${clampedVolume}`);\r\n  }\r\n  \r\n  /**\r\n   * Set background music volume (0.0 to 1.0)\r\n   */\r\n  public setMusicVolume(volume: number): void {\r\n    const clampedVolume = Math.max(0, Math.min(1, volume));\r\n    this.musicVolume = clampedVolume;\r\n    if (this.backgroundMusic) {\r\n      this.backgroundMusic.volume(clampedVolume);\r\n      console.log(`Music volume set to: ${clampedVolume}`);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Set sound effects volume (0.0 to 1.0)\r\n   */\r\n  public setSFXVolume(volume: number): void {\r\n    const clampedVolume = Math.max(0, Math.min(1, volume));\r\n    this.sfxVolume = clampedVolume;\r\n    this.sounds.forEach((sound) => {\r\n      sound.volume(clampedVolume);\r\n    });\r\n    console.log(`SFX volume set to: ${clampedVolume}`);\r\n  }\r\n  \r\n  /**\r\n   * Get current mute state\r\n   */\r\n  public isMutedState(): boolean {\r\n    return this.isMuted;\r\n  }\r\n  \r\n  /**\r\n   * Get initialization state\r\n   */\r\n  public isReady(): boolean {\r\n    return this.isInitialized;\r\n  }\r\n  \r\n  /**\r\n   * Cleanup audio resources\r\n   */\r\n  public destroy(): void {\r\n    // Stop and unload background music\r\n    if (this.backgroundMusic) {\r\n      this.backgroundMusic.stop();\r\n      this.backgroundMusic.unload();\r\n      this.backgroundMusic = null;\r\n    }\r\n    \r\n    // Stop and unload all sound effects\r\n    this.sounds.forEach((sound) => {\r\n      sound.stop();\r\n      sound.unload();\r\n    });\r\n    this.sounds.clear();\r\n    \r\n    this.isInitialized = false;\r\n    console.log('AudioManager destroyed');\r\n  }\r\n  \r\n\r\n  \r\n  /**\r\n   * Trigger accessibility events for audio cues\r\n   * Requirements: 18.2 - Visual indicators for audio events\r\n   */\r\n  private triggerAccessibilityEvents(\r\n    type: 'jump' | 'damage' | 'item_collect' | 'weapon_attack' | 'background_music',\r\n    weaponType?: string\r\n  ): void {\r\n    try {\r\n      // Trigger audio subtitle event\r\n      window.dispatchEvent(new CustomEvent('audioEvent', {\r\n        detail: { type, weaponType }\r\n      }));\r\n\r\n      // Trigger visual indicator event\r\n      window.dispatchEvent(new CustomEvent('visualIndicator', {\r\n        detail: { \r\n          type, \r\n          weaponType,\r\n          intensity: type === 'damage' ? 'high' : type === 'weapon_attack' ? 'medium' : 'low'\r\n        }\r\n      }));\r\n    } catch (error) {\r\n      console.warn('Failed to trigger accessibility events:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get debug information about loaded sounds\r\n   */\r\n  public getDebugInfo(): {\r\n    isInitialized: boolean;\r\n    isMuted: boolean;\r\n    backgroundMusicLoaded: boolean;\r\n    soundEffectsLoaded: string[];\r\n    masterVolume: number;\r\n  } {\r\n    return {\r\n      isInitialized: this.isInitialized,\r\n      isMuted: this.isMuted,\r\n      backgroundMusicLoaded: !!this.backgroundMusic,\r\n      soundEffectsLoaded: Array.from(this.sounds.keys()),\r\n      masterVolume: typeof Howler.volume === 'function' ? Howler.volume() : 1.0\r\n    };\r\n  }\r\n}\r\n\r\n// Export singleton instance for easy access\r\nexport const audioManager = AudioManager.getInstance();","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\utils\\SpritePool.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'key' is defined but never used. Allowed unused args must match /^_/u.","line":118,"column":43,"nodeType":null,"messageId":"unusedVar","endLine":118,"endColumn":46}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Optimized sprite pooling system for Phaser game objects\r\n * Reduces garbage collection by reusing sprites\r\n */\r\n\r\nexport class SpritePool {\r\n  private scene: Phaser.Scene;\r\n  private pools: Map<string, Phaser.GameObjects.Sprite[]> = new Map();\r\n  private activePools: Map<string, Set<Phaser.GameObjects.Sprite>> = new Map();\r\n  private maxPoolSize: number;\r\n\r\n  constructor(scene: Phaser.Scene, maxPoolSize: number = 50) {\r\n    this.scene = scene;\r\n    this.maxPoolSize = maxPoolSize;\r\n  }\r\n\r\n  /**\r\n   * Get a sprite from the pool or create a new one\r\n   */\r\n  getSprite(key: string, texture: string, frame?: string | number): Phaser.GameObjects.Sprite {\r\n    let pool = this.pools.get(key);\r\n    let activePool = this.activePools.get(key);\r\n\r\n    if (!pool) {\r\n      pool = [];\r\n      this.pools.set(key, pool);\r\n    }\r\n\r\n    if (!activePool) {\r\n      activePool = new Set();\r\n      this.activePools.set(key, activePool);\r\n    }\r\n\r\n    let sprite: Phaser.GameObjects.Sprite;\r\n\r\n    // Try to get from pool\r\n    if (pool.length > 0) {\r\n      sprite = pool.pop()!;\r\n      sprite.setActive(true);\r\n      sprite.setVisible(true);\r\n    } else {\r\n      // Create new sprite\r\n      sprite = this.scene.add.sprite(0, 0, texture, frame);\r\n    }\r\n\r\n    // Add to active pool\r\n    activePool.add(sprite);\r\n\r\n    return sprite;\r\n  }\r\n\r\n  /**\r\n   * Return a sprite to the pool\r\n   */\r\n  releaseSprite(key: string, sprite: Phaser.GameObjects.Sprite): void {\r\n    const pool = this.pools.get(key);\r\n    const activePool = this.activePools.get(key);\r\n\r\n    if (!pool || !activePool) {\r\n      return;\r\n    }\r\n\r\n    // Remove from active pool\r\n    activePool.delete(sprite);\r\n\r\n    // Reset sprite state\r\n    sprite.setActive(false);\r\n    sprite.setVisible(false);\r\n    sprite.setPosition(0, 0);\r\n    sprite.setRotation(0);\r\n    sprite.setScale(1);\r\n    sprite.setAlpha(1);\r\n    sprite.clearTint();\r\n\r\n    // Stop any animations\r\n    if (sprite.anims) {\r\n      sprite.anims.stop();\r\n    }\r\n\r\n    // Return to pool if not at max capacity\r\n    if (pool.length < this.maxPoolSize) {\r\n      pool.push(sprite);\r\n    } else {\r\n      // Destroy excess sprites\r\n      sprite.destroy();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get all active sprites of a type\r\n   */\r\n  getActiveSprites(key: string): Phaser.GameObjects.Sprite[] {\r\n    const activePool = this.activePools.get(key);\r\n    return activePool ? Array.from(activePool) : [];\r\n  }\r\n\r\n  /**\r\n   * Release all active sprites of a type\r\n   */\r\n  releaseAllSprites(key: string): void {\r\n    const activePool = this.activePools.get(key);\r\n    if (!activePool) return;\r\n\r\n    const sprites = Array.from(activePool);\r\n    sprites.forEach(sprite => this.releaseSprite(key, sprite));\r\n  }\r\n\r\n  /**\r\n   * Clear all pools and destroy sprites\r\n   */\r\n  clearAll(): void {\r\n    // Destroy all pooled sprites\r\n    this.pools.forEach(pool => {\r\n      pool.forEach(sprite => sprite.destroy());\r\n    });\r\n\r\n    // Destroy all active sprites\r\n    this.activePools.forEach((activePool, key) => {\r\n      activePool.forEach(sprite => sprite.destroy());\r\n    });\r\n\r\n    this.pools.clear();\r\n    this.activePools.clear();\r\n  }\r\n\r\n  /**\r\n   * Get pool statistics for debugging\r\n   */\r\n  getStats(): Record<string, { pooled: number; active: number }> {\r\n    const stats: Record<string, { pooled: number; active: number }> = {};\r\n\r\n    this.pools.forEach((pool, key) => {\r\n      const activePool = this.activePools.get(key);\r\n      stats[key] = {\r\n        pooled: pool.length,\r\n        active: activePool ? activePool.size : 0,\r\n      };\r\n    });\r\n\r\n    return stats;\r\n  }\r\n}\r\n\r\n/**\r\n * Particle pool for efficient particle effects\r\n */\r\nexport class ParticlePool {\r\n  private scene: Phaser.Scene;\r\n  private particles: Phaser.GameObjects.Particles.ParticleEmitter[] = [];\r\n  private activeParticles: Set<Phaser.GameObjects.Particles.ParticleEmitter> = new Set();\r\n  private maxPoolSize: number;\r\n\r\n  constructor(scene: Phaser.Scene, maxPoolSize: number = 20) {\r\n    this.scene = scene;\r\n    this.maxPoolSize = maxPoolSize;\r\n  }\r\n\r\n  /**\r\n   * Get a particle emitter from the pool\r\n   */\r\n  getEmitter(texture: string, config?: Phaser.Types.GameObjects.Particles.ParticleEmitterConfig): Phaser.GameObjects.Particles.ParticleEmitter {\r\n    let emitter: Phaser.GameObjects.Particles.ParticleEmitter;\r\n\r\n    if (this.particles.length > 0) {\r\n      emitter = this.particles.pop()!;\r\n      if (config) {\r\n        emitter.setConfig(config);\r\n      }\r\n    } else {\r\n      emitter = this.scene.add.particles(0, 0, texture, config);\r\n    }\r\n\r\n    this.activeParticles.add(emitter);\r\n    return emitter;\r\n  }\r\n\r\n  /**\r\n   * Return a particle emitter to the pool\r\n   */\r\n  releaseEmitter(emitter: Phaser.GameObjects.Particles.ParticleEmitter): void {\r\n    this.activeParticles.delete(emitter);\r\n\r\n    // Stop and reset emitter\r\n    emitter.stop();\r\n    emitter.killAll();\r\n    emitter.setPosition(0, 0);\r\n\r\n    if (this.particles.length < this.maxPoolSize) {\r\n      this.particles.push(emitter);\r\n    } else {\r\n      emitter.destroy();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear all particle emitters\r\n   */\r\n  clearAll(): void {\r\n    this.particles.forEach(emitter => {\r\n      emitter.destroy();\r\n    });\r\n\r\n    this.activeParticles.forEach(emitter => {\r\n      emitter.destroy();\r\n    });\r\n\r\n    this.particles.length = 0;\r\n    this.activeParticles.clear();\r\n  }\r\n}\r\n\r\n/**\r\n * Tween pool for efficient animations\r\n */\r\nexport class TweenPool {\r\n  private scene: Phaser.Scene;\r\n  private tweens: Phaser.Tweens.Tween[] = [];\r\n  private activeTweens: Set<Phaser.Tweens.Tween> = new Set();\r\n  private maxPoolSize: number;\r\n\r\n  constructor(scene: Phaser.Scene, maxPoolSize: number = 30) {\r\n    this.scene = scene;\r\n    this.maxPoolSize = maxPoolSize;\r\n  }\r\n\r\n  /**\r\n   * Get a tween from the pool\r\n   */\r\n  getTween(config: Phaser.Types.Tweens.TweenBuilderConfig): Phaser.Tweens.Tween {\r\n    let tween: Phaser.Tweens.Tween;\r\n\r\n    if (this.tweens.length > 0) {\r\n      tween = this.tweens.pop()!;\r\n      // Reset the tween with new config\r\n      tween.stop();\r\n      tween.reset();\r\n      // For simplicity, just create a new tween instead of trying to reconfigure\r\n      tween = this.scene.tweens.add(config);\r\n    } else {\r\n      tween = this.scene.tweens.add(config);\r\n    }\r\n\r\n    this.activeTweens.add(tween);\r\n    return tween;\r\n  }\r\n\r\n  /**\r\n   * Return a tween to the pool\r\n   */\r\n  releaseTween(tween: Phaser.Tweens.Tween): void {\r\n    this.activeTweens.delete(tween);\r\n\r\n    // Stop and reset tween\r\n    tween.stop();\r\n    tween.remove();\r\n\r\n    if (this.tweens.length < this.maxPoolSize) {\r\n      this.tweens.push(tween);\r\n    } else {\r\n      tween.destroy();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear all tweens\r\n   */\r\n  clearAll(): void {\r\n    this.tweens.forEach(tween => tween.destroy());\r\n    this.activeTweens.forEach(tween => tween.destroy());\r\n\r\n    this.tweens.length = 0;\r\n    this.activeTweens.clear();\r\n  }\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\utils\\__tests__\\AudioManager.test.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":21,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[507,510],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[507,510],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":117,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":117,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3841,3844],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3841,3844],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { AudioManager, audioManager } from '../AudioManager';\r\n\r\n// Mock Howler.js\r\njest.mock('howler', () => ({\r\n  Howl: jest.fn().mockImplementation(() => ({\r\n    play: jest.fn(),\r\n    stop: jest.fn(),\r\n    unload: jest.fn(),\r\n    volume: jest.fn(),\r\n    playing: jest.fn().mockReturnValue(false)\r\n  })),\r\n  Howler: {\r\n    volume: jest.fn(),\r\n    mute: jest.fn()\r\n  }\r\n}));\r\n\r\ndescribe('AudioManager', () => {\r\n  beforeEach(() => {\r\n    // Reset the singleton instance for each test\r\n    (AudioManager as any).instance = undefined;\r\n    jest.clearAllMocks();\r\n  });\r\n\r\n  describe('Singleton Pattern', () => {\r\n    it('should return the same instance', () => {\r\n      const instance1 = AudioManager.getInstance();\r\n      const instance2 = AudioManager.getInstance();\r\n      expect(instance1).toBe(instance2);\r\n    });\r\n\r\n    it('should export a singleton instance', () => {\r\n      expect(audioManager).toBeInstanceOf(AudioManager);\r\n    });\r\n  });\r\n\r\n  describe('Initialization', () => {\r\n    it('should initialize successfully', () => {\r\n      const manager = AudioManager.getInstance();\r\n      expect(manager.isReady()).toBe(false);\r\n      \r\n      manager.initialize();\r\n      expect(manager.isReady()).toBe(true);\r\n    });\r\n\r\n    it('should not initialize twice', () => {\r\n      const manager = AudioManager.getInstance();\r\n      const consoleSpy = jest.spyOn(console, 'log').mockImplementation();\r\n      \r\n      manager.initialize();\r\n      const firstCallCount = consoleSpy.mock.calls.length;\r\n      \r\n      manager.initialize(); // Second call should be ignored\r\n      const secondCallCount = consoleSpy.mock.calls.length;\r\n      \r\n      // Should have the same number of calls (no additional calls from second initialization)\r\n      expect(secondCallCount).toBe(firstCallCount);\r\n      expect(consoleSpy).toHaveBeenCalledWith('AudioManager initialized successfully');\r\n      \r\n      consoleSpy.mockRestore();\r\n    });\r\n  });\r\n\r\n  describe('Background Music', () => {\r\n    it('should play background music when initialized', () => {\r\n      const manager = AudioManager.getInstance();\r\n      manager.initialize();\r\n      \r\n      const consoleSpy = jest.spyOn(console, 'log').mockImplementation();\r\n      manager.playBackgroundMusic();\r\n      \r\n      expect(consoleSpy).toHaveBeenCalledWith('Background music started');\r\n      consoleSpy.mockRestore();\r\n    });\r\n\r\n    it('should stop background music', () => {\r\n      const manager = AudioManager.getInstance();\r\n      manager.initialize();\r\n      \r\n      const consoleSpy = jest.spyOn(console, 'log').mockImplementation();\r\n      manager.stopBackgroundMusic();\r\n      \r\n      expect(consoleSpy).toHaveBeenCalledWith('Background music stopped');\r\n      consoleSpy.mockRestore();\r\n    });\r\n  });\r\n\r\n  describe('Sound Effects', () => {\r\n    let manager: AudioManager;\r\n\r\n    beforeEach(() => {\r\n      manager = AudioManager.getInstance();\r\n      manager.initialize();\r\n    });\r\n\r\n    it('should play jump sound', () => {\r\n      expect(() => manager.playJumpSound()).not.toThrow();\r\n    });\r\n\r\n    it('should play damage sound', () => {\r\n      expect(() => manager.playDamageSound()).not.toThrow();\r\n    });\r\n\r\n    it('should play item collect sound', () => {\r\n      expect(() => manager.playItemCollectSound()).not.toThrow();\r\n    });\r\n\r\n    it('should play weapon sounds for different weapon types', () => {\r\n      expect(() => manager.playWeaponSound('katana')).not.toThrow();\r\n      expect(() => manager.playWeaponSound('laser')).not.toThrow();\r\n      expect(() => manager.playWeaponSound('baseball')).not.toThrow();\r\n      expect(() => manager.playWeaponSound('bazooka')).not.toThrow();\r\n    });\r\n\r\n    it('should handle unknown weapon types gracefully', () => {\r\n      const consoleSpy = jest.spyOn(console, 'warn').mockImplementation();\r\n      manager.playWeaponSound('unknown' as any);\r\n      \r\n      expect(consoleSpy).toHaveBeenCalledWith('Unknown weapon type: unknown');\r\n      consoleSpy.mockRestore();\r\n    });\r\n  });\r\n\r\n  describe('Volume Control', () => {\r\n    let manager: AudioManager;\r\n\r\n    beforeEach(() => {\r\n      manager = AudioManager.getInstance();\r\n      manager.initialize();\r\n    });\r\n\r\n    it('should set master volume', () => {\r\n      const consoleSpy = jest.spyOn(console, 'log').mockImplementation();\r\n      manager.setVolume(0.5);\r\n      \r\n      expect(consoleSpy).toHaveBeenCalledWith('Master volume set to: 0.5');\r\n      consoleSpy.mockRestore();\r\n    });\r\n\r\n    it('should clamp volume values', () => {\r\n      const consoleSpy = jest.spyOn(console, 'log').mockImplementation();\r\n      \r\n      manager.setVolume(-0.5); // Should clamp to 0\r\n      expect(consoleSpy).toHaveBeenCalledWith('Master volume set to: 0');\r\n      \r\n      manager.setVolume(1.5); // Should clamp to 1\r\n      expect(consoleSpy).toHaveBeenCalledWith('Master volume set to: 1');\r\n      \r\n      consoleSpy.mockRestore();\r\n    });\r\n  });\r\n\r\n  describe('Mute Control', () => {\r\n    let manager: AudioManager;\r\n\r\n    beforeEach(() => {\r\n      manager = AudioManager.getInstance();\r\n      manager.initialize();\r\n    });\r\n\r\n    it('should mute and unmute audio', () => {\r\n      const consoleSpy = jest.spyOn(console, 'log').mockImplementation();\r\n      \r\n      expect(manager.isMutedState()).toBe(false);\r\n      \r\n      manager.mute();\r\n      expect(manager.isMutedState()).toBe(true);\r\n      expect(consoleSpy).toHaveBeenCalledWith('Audio muted');\r\n      \r\n      manager.unmute();\r\n      expect(manager.isMutedState()).toBe(false);\r\n      expect(consoleSpy).toHaveBeenCalledWith('Audio unmuted');\r\n      \r\n      consoleSpy.mockRestore();\r\n    });\r\n\r\n    it('should toggle mute state', () => {\r\n      expect(manager.isMutedState()).toBe(false);\r\n      \r\n      manager.toggleMute();\r\n      expect(manager.isMutedState()).toBe(true);\r\n      \r\n      manager.toggleMute();\r\n      expect(manager.isMutedState()).toBe(false);\r\n    });\r\n  });\r\n\r\n  describe('Debug Information', () => {\r\n    it('should provide debug information', () => {\r\n      const manager = AudioManager.getInstance();\r\n      manager.initialize();\r\n      \r\n      const debugInfo = manager.getDebugInfo();\r\n      \r\n      expect(debugInfo).toHaveProperty('isInitialized', true);\r\n      expect(debugInfo).toHaveProperty('isMuted', false);\r\n      expect(debugInfo).toHaveProperty('backgroundMusicLoaded', true);\r\n      expect(debugInfo).toHaveProperty('soundEffectsLoaded');\r\n      expect(debugInfo).toHaveProperty('masterVolume');\r\n      expect(Array.isArray(debugInfo.soundEffectsLoaded)).toBe(true);\r\n    });\r\n  });\r\n\r\n  describe('Cleanup', () => {\r\n    it('should destroy and cleanup resources', () => {\r\n      const manager = AudioManager.getInstance();\r\n      manager.initialize();\r\n      \r\n      const consoleSpy = jest.spyOn(console, 'log').mockImplementation();\r\n      manager.destroy();\r\n      \r\n      expect(manager.isReady()).toBe(false);\r\n      expect(consoleSpy).toHaveBeenCalledWith('AudioManager destroyed');\r\n      \r\n      consoleSpy.mockRestore();\r\n    });\r\n  });\r\n});","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\utils\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\weapons\\BaseWeapon.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\weapons\\BaseballBat.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":52,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":52,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1840,1843],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1840,1843],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as Phaser from 'phaser';\r\nimport { BaseWeapon } from './BaseWeapon';\r\nimport { audioManager } from '../utils/AudioManager';\r\n\r\nexport class BaseballBat extends BaseWeapon {\r\n  private readonly KNOCKBACK_FORCE = 200; // Knockback force in pixels\r\n  \r\n  constructor(scene: Phaser.Scene) {\r\n    // BaseballBat: 55px range, 450ms cooldown, knockback effect\r\n    super(scene, 'baseball', 55, 450);\r\n  }\r\n  \r\n  /**\r\n   * Perform melee attack with baseball bat\r\n   * Requirements: 5.3 - 55px range, 450ms cooldown, knockback\r\n   */\r\n  attack(x: number, y: number): void {\r\n    if (!this.canAttack()) return;\r\n    \r\n    // Update attack timing\r\n    this.onAttack();\r\n    \r\n    // Create melee attack area (slightly larger than katana)\r\n    const attackWidth = this.range;\r\n    const attackHeight = 70; // Slightly taller attack area\r\n    \r\n    // Check for enemy collisions in melee range with knockback\r\n    this.checkEnemyCollisionsWithKnockback(x, y, attackWidth, attackHeight);\r\n    \r\n    // Play slash sound effect for baseball bat\r\n    audioManager.playWeaponSound('baseball');\r\n    \r\n    // Visual effect for baseball bat swing\r\n    this.createSwingEffect(x, y);\r\n  }\r\n  \r\n  /**\r\n   * Check for enemy collisions and apply knockback\r\n   */\r\n  private checkEnemyCollisionsWithKnockback(x: number, y: number, width: number, height: number): void {\r\n    // This will be extended when enemy system is available\r\n    // For now, log the attack with knockback indication\r\n    console.log(`Baseball bat attacking at (${x}, ${y}) with area ${width}x${height} and knockback ${this.KNOCKBACK_FORCE}`);\r\n    \r\n    // The knockback effect will be applied to enemies when they are hit\r\n    // This involves pushing enemies away from the attack point\r\n  }\r\n  \r\n  /**\r\n   * Apply knockback effect to an enemy\r\n   */\r\n  public applyKnockback(enemy: any, attackX: number): void {\r\n    // Calculate knockback direction based on enemy position relative to attack\r\n    const knockbackDirection = enemy.x > attackX ? 1 : -1;\r\n    \r\n    // Apply knockback force (this will be implemented when enemy physics are available)\r\n    if (enemy.body) {\r\n      enemy.body.setVelocityX(knockbackDirection * this.KNOCKBACK_FORCE);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Create visual effect for baseball bat swing\r\n   */\r\n  private createSwingEffect(x: number, y: number): void {\r\n    // Create a swing arc effect\r\n    const swingEffect = this.scene.add.arc(x, y, this.range, 0, 180, false, 0xffffff, 0.4);\r\n    \r\n    // Animate the swing\r\n    this.scene.tweens.add({\r\n      targets: swingEffect,\r\n      angle: 45, // Swing arc\r\n      alpha: 0,\r\n      duration: 150,\r\n      onComplete: () => {\r\n        swingEffect.destroy();\r\n      }\r\n    });\r\n  }\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\weapons\\Bazooka.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\weapons\\Katana.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\weapons\\LaserGun.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\weapons\\WeaponDemo.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\weapons\\__tests__\\BaseWeapon.test.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":27,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[557,560],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[557,560],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":58,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":58,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1251,1254],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1251,1254],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":70,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1706,1709],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1706,1709],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":98,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":98,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2711,2714],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2711,2714],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":103,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":103,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2925,2928],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2925,2928],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":140,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":140,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4150,4153],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4150,4153],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":152,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":152,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4585,4588],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4585,4588],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'attackedBefore' is assigned a value but never used.","line":160,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":160,"endColumn":27}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { BaseWeapon } from '../BaseWeapon';\r\n\r\n// Mock Phaser Scene\r\nclass MockScene {\r\n  public time = {\r\n    now: 0\r\n  };\r\n  \r\n  public add = {\r\n    rectangle: jest.fn(() => ({\r\n      destroy: jest.fn()\r\n    })),\r\n    circle: jest.fn(() => ({\r\n      destroy: jest.fn()\r\n    })),\r\n    graphics: jest.fn(() => ({\r\n      lineStyle: jest.fn(),\r\n      lineBetween: jest.fn(),\r\n      fillStyle: jest.fn(),\r\n      fillCircle: jest.fn(),\r\n      strokeCircle: jest.fn(),\r\n      destroy: jest.fn()\r\n    }))\r\n  };\r\n  \r\n  public tweens = {\r\n    add: jest.fn((config: any) => {\r\n      // Simulate immediate completion for testing\r\n      if (config.onComplete) {\r\n        config.onComplete();\r\n      }\r\n    })\r\n  };\r\n}\r\n\r\n// Concrete implementation for testing\r\nclass TestWeapon extends BaseWeapon {\r\n  public attackCalled = false;\r\n  public attackX = 0;\r\n  public attackY = 0;\r\n  \r\n  attack(x: number, y: number): void {\r\n    if (!this.canAttack()) return;\r\n    \r\n    this.onAttack();\r\n    this.attackCalled = true;\r\n    this.attackX = x;\r\n    this.attackY = y;\r\n  }\r\n}\r\n\r\ndescribe('BaseWeapon', () => {\r\n  let mockScene: MockScene;\r\n  let weapon: TestWeapon;\r\n  \r\n  beforeEach(() => {\r\n    mockScene = new MockScene();\r\n    weapon = new TestWeapon(mockScene as any, 'katana', 40, 300);\r\n  });\r\n  \r\n  describe('constructor', () => {\r\n    it('should initialize weapon properties correctly', () => {\r\n      expect(weapon.type).toBe('katana');\r\n      expect(weapon.range).toBe(40);\r\n      expect(weapon.cooldown).toBe(300);\r\n      expect(weapon.ammunition).toBeUndefined();\r\n    });\r\n    \r\n    it('should initialize weapon with ammunition when provided', () => {\r\n      const bazookaWeapon = new TestWeapon(mockScene as any, 'bazooka', 400, 900, 6);\r\n      expect(bazookaWeapon.ammunition).toBe(6);\r\n    });\r\n  });\r\n  \r\n  describe('canAttack', () => {\r\n    it('should return true when cooldown is ready and has ammo', () => {\r\n      mockScene.time.now = 1000;\r\n      expect(weapon.canAttack()).toBe(true);\r\n    });\r\n    \r\n    it('should return false when cooldown is not ready', () => {\r\n      mockScene.time.now = 1000;\r\n      weapon.attack(100, 100); // First attack\r\n      \r\n      mockScene.time.now = 1200; // Only 200ms later, cooldown is 300ms\r\n      expect(weapon.canAttack()).toBe(false);\r\n    });\r\n    \r\n    it('should return true when cooldown is ready after waiting', () => {\r\n      mockScene.time.now = 1000;\r\n      weapon.attack(100, 100); // First attack\r\n      \r\n      mockScene.time.now = 1400; // 400ms later, cooldown is 300ms\r\n      expect(weapon.canAttack()).toBe(true);\r\n    });\r\n    \r\n    it('should return false when out of ammunition', () => {\r\n      const bazookaWeapon = new TestWeapon(mockScene as any, 'bazooka', 400, 900, 0);\r\n      expect(bazookaWeapon.canAttack()).toBe(false);\r\n    });\r\n    \r\n    it('should return true when has ammunition', () => {\r\n      const bazookaWeapon = new TestWeapon(mockScene as any, 'bazooka', 400, 900, 3);\r\n      mockScene.time.now = 1000; // Set time to ensure cooldown is ready\r\n      expect(bazookaWeapon.canAttack()).toBe(true);\r\n    });\r\n  });\r\n  \r\n  describe('attack', () => {\r\n    it('should call onAttack when attack is successful', () => {\r\n      mockScene.time.now = 1000;\r\n      weapon.attack(100, 100);\r\n      \r\n      expect(weapon.attackCalled).toBe(true);\r\n      expect(weapon.attackX).toBe(100);\r\n      expect(weapon.attackY).toBe(100);\r\n    });\r\n    \r\n    it('should not attack when cooldown is not ready', () => {\r\n      mockScene.time.now = 1000;\r\n      weapon.attack(100, 100); // First attack\r\n      weapon.attackCalled = false; // Reset flag\r\n      \r\n      mockScene.time.now = 1200; // Only 200ms later\r\n      weapon.attack(150, 150); // Second attack attempt\r\n      \r\n      expect(weapon.attackCalled).toBe(false);\r\n    });\r\n  });\r\n  \r\n  describe('onAttack', () => {\r\n    it('should update last attack time', () => {\r\n      mockScene.time.now = 1500;\r\n      weapon.attack(100, 100);\r\n      \r\n      expect(weapon.getLastAttackTime()).toBe(1500);\r\n    });\r\n    \r\n    it('should consume ammunition when applicable', () => {\r\n      const bazookaWeapon = new TestWeapon(mockScene as any, 'bazooka', 400, 900, 6);\r\n      mockScene.time.now = 1000;\r\n      \r\n      bazookaWeapon.attack(100, 100);\r\n      expect(bazookaWeapon.ammunition).toBe(5);\r\n      \r\n      mockScene.time.now = 2000; // Wait for cooldown\r\n      bazookaWeapon.attack(100, 100);\r\n      expect(bazookaWeapon.ammunition).toBe(4);\r\n    });\r\n    \r\n    it('should not go below 0 ammunition', () => {\r\n      const bazookaWeapon = new TestWeapon(mockScene as any, 'bazooka', 400, 900, 1);\r\n      mockScene.time.now = 1000;\r\n      \r\n      bazookaWeapon.attack(100, 100);\r\n      expect(bazookaWeapon.ammunition).toBe(0);\r\n      \r\n      mockScene.time.now = 2000; // Wait for cooldown\r\n      // Should not attack when out of ammo, so ammunition stays at 0\r\n      const attackedBefore = bazookaWeapon.attackCalled;\r\n      bazookaWeapon.attackCalled = false;\r\n      bazookaWeapon.attack(100, 100);\r\n      expect(bazookaWeapon.attackCalled).toBe(false); // Attack should not happen\r\n      expect(bazookaWeapon.ammunition).toBe(0); // Should not go negative\r\n    });\r\n  });\r\n  \r\n  describe('getLastAttackTime', () => {\r\n    it('should return 0 initially', () => {\r\n      expect(weapon.getLastAttackTime()).toBe(0);\r\n    });\r\n    \r\n    it('should return correct time after attack', () => {\r\n      mockScene.time.now = 2500;\r\n      weapon.attack(100, 100);\r\n      \r\n      expect(weapon.getLastAttackTime()).toBe(2500);\r\n    });\r\n  });\r\n});","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\weapons\\__tests__\\WeaponMechanics.test.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":49,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1153,1156],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1153,1156],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":96,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":96,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2018,2021],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2018,2021],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":147,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":147,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3700,3703],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3700,3703],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":175,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":175,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4672,4675],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4672,4675],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":203,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":203,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5538,5541],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5538,5541],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":274,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":274,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7875,7878],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7875,7878],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":302,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":302,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8827,8830],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8827,8830],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":370,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":370,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11081,11084],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11081,11084],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":371,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":371,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11137,11140],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11137,11140],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":372,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":372,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11199,11202],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11199,11202],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":373,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":373,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11253,11256],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11253,11256],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":11,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Mock Phaser before importing weapons\r\njest.mock('phaser', () => ({}));\r\n\r\nimport { Katana } from '../Katana';\r\nimport { LaserGun } from '../LaserGun';\r\nimport { BaseballBat } from '../BaseballBat';\r\nimport { Bazooka } from '../Bazooka';\r\n\r\n// Mock AudioManager\r\njest.mock('../../utils/AudioManager', () => ({\r\n  audioManager: {\r\n    playWeaponSound: jest.fn()\r\n  }\r\n}));\r\n\r\n// Mock Phaser Scene with more complete implementation\r\nclass MockScene {\r\n  public time = {\r\n    now: 0,\r\n    delayedCall: jest.fn()\r\n  };\r\n  \r\n  public add = {\r\n    rectangle: jest.fn(() => ({\r\n      destroy: jest.fn(),\r\n      setAlpha: jest.fn()\r\n    })),\r\n    circle: jest.fn(() => ({\r\n      destroy: jest.fn(),\r\n      setScale: jest.fn(),\r\n      setAlpha: jest.fn()\r\n    })),\r\n    arc: jest.fn(() => ({\r\n      destroy: jest.fn(),\r\n      setAngle: jest.fn(),\r\n      setAlpha: jest.fn()\r\n    })),\r\n    graphics: jest.fn(() => ({\r\n      lineStyle: jest.fn(),\r\n      lineBetween: jest.fn(),\r\n      fillStyle: jest.fn(),\r\n      fillCircle: jest.fn(),\r\n      strokeCircle: jest.fn(),\r\n      destroy: jest.fn()\r\n    }))\r\n  };\r\n  \r\n  public tweens = {\r\n    add: jest.fn((config: any) => {\r\n      // Simulate immediate completion for testing\r\n      if (config.onComplete) {\r\n        config.onComplete();\r\n      }\r\n    })\r\n  };\r\n  \r\n  public physics = {\r\n    add: {\r\n      group: jest.fn(() => ({\r\n        get: jest.fn(() => ({\r\n          fire: jest.fn(),\r\n          setActive: jest.fn(),\r\n          setVisible: jest.fn()\r\n        })),\r\n        clear: jest.fn()\r\n      }))\r\n    }\r\n  };\r\n  \r\n  public cameras = {\r\n    main: {\r\n      worldView: {\r\n        right: 800,\r\n        left: 0\r\n      }\r\n    }\r\n  };\r\n  \r\n  public scale = {\r\n    width: 800\r\n  };\r\n}\r\n\r\ndescribe('Weapon Mechanics', () => {\r\n  let mockScene: MockScene;\r\n  \r\n  beforeEach(() => {\r\n    mockScene = new MockScene();\r\n    jest.clearAllMocks();\r\n  });\r\n  \r\n  describe('Katana', () => {\r\n    let katana: Katana;\r\n    \r\n    beforeEach(() => {\r\n      katana = new Katana(mockScene as any);\r\n    });\r\n    \r\n    it('should have correct specifications per requirement 5.1', () => {\r\n      expect(katana.type).toBe('katana');\r\n      expect(katana.range).toBe(40); // 40px range\r\n      expect(katana.cooldown).toBe(300); // 300ms cooldown\r\n      expect(katana.ammunition).toBeUndefined(); // No ammunition limit\r\n    });\r\n    \r\n    it('should perform melee attack when cooldown is ready', () => {\r\n      mockScene.time.now = 1000;\r\n      \r\n      katana.attack(100, 100);\r\n      \r\n      expect(mockScene.add.rectangle).toHaveBeenCalledWith(\r\n        100, 100, 40, 60, 0xffffff, 0.3\r\n      );\r\n      expect(mockScene.tweens.add).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should not attack when cooldown is not ready', () => {\r\n      mockScene.time.now = 1000;\r\n      katana.attack(100, 100); // First attack\r\n      \r\n      mockScene.time.now = 1200; // Only 200ms later, need 300ms\r\n      katana.attack(150, 150); // Second attack\r\n      \r\n      // Should only have been called once (first attack)\r\n      expect(mockScene.add.rectangle).toHaveBeenCalledTimes(1);\r\n    });\r\n    \r\n    it('should respect 300ms cooldown timing', () => {\r\n      mockScene.time.now = 1000;\r\n      expect(katana.canAttack()).toBe(true);\r\n      \r\n      katana.attack(100, 100);\r\n      expect(katana.canAttack()).toBe(false);\r\n      \r\n      mockScene.time.now = 1299; // 299ms later\r\n      expect(katana.canAttack()).toBe(false);\r\n      \r\n      mockScene.time.now = 1300; // Exactly 300ms later\r\n      expect(katana.canAttack()).toBe(true);\r\n    });\r\n  });\r\n  \r\n  describe('LaserGun', () => {\r\n    let laserGun: LaserGun;\r\n    \r\n    beforeEach(() => {\r\n      laserGun = new LaserGun(mockScene as any);\r\n    });\r\n    \r\n    it('should have correct specifications per requirement 5.2', () => {\r\n      expect(laserGun.type).toBe('laser');\r\n      expect(laserGun.range).toBe(800); // Screen width for projectiles\r\n      expect(laserGun.cooldown).toBe(200); // 200ms cooldown\r\n      expect(laserGun.ammunition).toBeUndefined(); // No ammunition limit\r\n    });\r\n    \r\n    it('should create projectile group on construction', () => {\r\n      expect(mockScene.physics.add.group).toHaveBeenCalledWith({\r\n        classType: expect.any(Function),\r\n        maxSize: 10,\r\n        runChildUpdate: true\r\n      });\r\n    });\r\n    \r\n    it('should fire projectile when attacking', () => {\r\n      const mockProjectile = {\r\n        fire: jest.fn()\r\n      };\r\n      const mockGroup = {\r\n        get: jest.fn(() => mockProjectile),\r\n        clear: jest.fn()\r\n      };\r\n      mockScene.physics.add.group = jest.fn(() => mockGroup);\r\n      \r\n      const newLaserGun = new LaserGun(mockScene as any);\r\n      mockScene.time.now = 1000;\r\n      \r\n      newLaserGun.attack(100, 100);\r\n      \r\n      expect(mockGroup.get).toHaveBeenCalledWith(100, 100);\r\n      expect(mockProjectile.fire).toHaveBeenCalledWith(500); // 500px/s speed\r\n    });\r\n    \r\n    it('should respect 200ms cooldown timing', () => {\r\n      mockScene.time.now = 1000;\r\n      expect(laserGun.canAttack()).toBe(true);\r\n      \r\n      laserGun.attack(100, 100);\r\n      expect(laserGun.canAttack()).toBe(false);\r\n      \r\n      mockScene.time.now = 1199; // 199ms later\r\n      expect(laserGun.canAttack()).toBe(false);\r\n      \r\n      mockScene.time.now = 1200; // Exactly 200ms later\r\n      expect(laserGun.canAttack()).toBe(true);\r\n    });\r\n  });\r\n  \r\n  describe('BaseballBat', () => {\r\n    let baseballBat: BaseballBat;\r\n    \r\n    beforeEach(() => {\r\n      baseballBat = new BaseballBat(mockScene as any);\r\n    });\r\n    \r\n    it('should have correct specifications per requirement 5.3', () => {\r\n      expect(baseballBat.type).toBe('baseball');\r\n      expect(baseballBat.range).toBe(55); // 55px range\r\n      expect(baseballBat.cooldown).toBe(450); // 450ms cooldown\r\n      expect(baseballBat.ammunition).toBeUndefined(); // No ammunition limit\r\n    });\r\n    \r\n    it('should perform melee attack with swing effect', () => {\r\n      mockScene.time.now = 1000;\r\n      \r\n      baseballBat.attack(100, 100);\r\n      \r\n      expect(mockScene.add.arc).toHaveBeenCalledWith(\r\n        100, 100, 55, 0, 180, false, 0xffffff, 0.4\r\n      );\r\n      expect(mockScene.tweens.add).toHaveBeenCalled();\r\n    });\r\n    \r\n    it('should respect 450ms cooldown timing', () => {\r\n      mockScene.time.now = 1000;\r\n      expect(baseballBat.canAttack()).toBe(true);\r\n      \r\n      baseballBat.attack(100, 100);\r\n      expect(baseballBat.canAttack()).toBe(false);\r\n      \r\n      mockScene.time.now = 1449; // 449ms later\r\n      expect(baseballBat.canAttack()).toBe(false);\r\n      \r\n      mockScene.time.now = 1450; // Exactly 450ms later\r\n      expect(baseballBat.canAttack()).toBe(true);\r\n    });\r\n    \r\n    it('should apply knockback effect to enemies', () => {\r\n      const mockEnemy = {\r\n        x: 150,\r\n        body: {\r\n          setVelocityX: jest.fn()\r\n        }\r\n      };\r\n      \r\n      baseballBat.applyKnockback(mockEnemy, 100);\r\n      \r\n      // Enemy at x=150, attack at x=100, so knockback should be positive (right)\r\n      expect(mockEnemy.body.setVelocityX).toHaveBeenCalledWith(200);\r\n    });\r\n    \r\n    it('should apply knockback in correct direction', () => {\r\n      const mockEnemyLeft = {\r\n        x: 50,\r\n        body: { setVelocityX: jest.fn() }\r\n      };\r\n      const mockEnemyRight = {\r\n        x: 150,\r\n        body: { setVelocityX: jest.fn() }\r\n      };\r\n      \r\n      baseballBat.applyKnockback(mockEnemyLeft, 100); // Enemy to left of attack\r\n      expect(mockEnemyLeft.body.setVelocityX).toHaveBeenCalledWith(-200);\r\n      \r\n      baseballBat.applyKnockback(mockEnemyRight, 100); // Enemy to right of attack\r\n      expect(mockEnemyRight.body.setVelocityX).toHaveBeenCalledWith(200);\r\n    });\r\n  });\r\n  \r\n  describe('Bazooka', () => {\r\n    let bazooka: Bazooka;\r\n    \r\n    beforeEach(() => {\r\n      bazooka = new Bazooka(mockScene as any);\r\n    });\r\n    \r\n    it('should have correct specifications per requirement 5.4', () => {\r\n      expect(bazooka.type).toBe('bazooka');\r\n      expect(bazooka.range).toBe(400);\r\n      expect(bazooka.cooldown).toBe(900); // 900ms cooldown\r\n      expect(bazooka.ammunition).toBe(6); // 6 ammunition limit\r\n    });\r\n    \r\n    it('should create rocket group on construction', () => {\r\n      expect(mockScene.physics.add.group).toHaveBeenCalledWith({\r\n        classType: expect.any(Function),\r\n        maxSize: 6, // Match ammunition limit\r\n        runChildUpdate: true\r\n      });\r\n    });\r\n    \r\n    it('should fire rocket when attacking with ammunition', () => {\r\n      const mockRocket = {\r\n        fire: jest.fn()\r\n      };\r\n      const mockGroup = {\r\n        get: jest.fn(() => mockRocket),\r\n        clear: jest.fn()\r\n      };\r\n      mockScene.physics.add.group = jest.fn(() => mockGroup);\r\n      \r\n      const newBazooka = new Bazooka(mockScene as any);\r\n      mockScene.time.now = 1000;\r\n      \r\n      newBazooka.attack(100, 100);\r\n      \r\n      expect(mockGroup.get).toHaveBeenCalledWith(100, 100);\r\n      expect(mockRocket.fire).toHaveBeenCalledWith(300, 80); // Speed and explosion radius\r\n    });\r\n    \r\n    it('should consume ammunition when attacking', () => {\r\n      mockScene.time.now = 1000;\r\n      \r\n      expect(bazooka.getAmmunition()).toBe(6);\r\n      \r\n      bazooka.attack(100, 100);\r\n      expect(bazooka.getAmmunition()).toBe(5);\r\n      \r\n      mockScene.time.now = 2000; // Wait for cooldown\r\n      bazooka.attack(100, 100);\r\n      expect(bazooka.getAmmunition()).toBe(4);\r\n    });\r\n    \r\n    it('should not attack when out of ammunition', () => {\r\n      // Consume all ammunition\r\n      for (let i = 0; i < 6; i++) {\r\n        mockScene.time.now = i * 1000;\r\n        bazooka.attack(100, 100);\r\n      }\r\n      \r\n      expect(bazooka.getAmmunition()).toBe(0);\r\n      \r\n      mockScene.time.now = 10000; // Wait for cooldown\r\n      expect(bazooka.canAttack()).toBe(false); // No ammunition\r\n    });\r\n    \r\n    it('should respect 900ms cooldown timing', () => {\r\n      mockScene.time.now = 1000;\r\n      expect(bazooka.canAttack()).toBe(true);\r\n      \r\n      bazooka.attack(100, 100);\r\n      expect(bazooka.canAttack()).toBe(false);\r\n      \r\n      mockScene.time.now = 1899; // 899ms later\r\n      expect(bazooka.canAttack()).toBe(false);\r\n      \r\n      mockScene.time.now = 1900; // Exactly 900ms later\r\n      expect(bazooka.canAttack()).toBe(true);\r\n    });\r\n    \r\n    it('should reload ammunition correctly', () => {\r\n      // Consume some ammunition\r\n      mockScene.time.now = 1000;\r\n      bazooka.attack(100, 100);\r\n      mockScene.time.now = 2000;\r\n      bazooka.attack(100, 100);\r\n      \r\n      expect(bazooka.getAmmunition()).toBe(4);\r\n      \r\n      bazooka.reload();\r\n      expect(bazooka.getAmmunition()).toBe(6);\r\n    });\r\n  });\r\n  \r\n  describe('Weapon Damage Calculations', () => {\r\n    it('should eliminate enemies in one hit per requirement 5.5', () => {\r\n      // This test verifies that all weapons are designed to eliminate enemies in one hit\r\n      // The actual damage calculation is handled by the collision system\r\n      \r\n      const katana = new Katana(mockScene as any);\r\n      const laserGun = new LaserGun(mockScene as any);\r\n      const baseballBat = new BaseballBat(mockScene as any);\r\n      const bazooka = new Bazooka(mockScene as any);\r\n      \r\n      // All weapons should be able to attack (indicating they can deal damage)\r\n      expect(katana.canAttack()).toBe(true);\r\n      expect(laserGun.canAttack()).toBe(true);\r\n      expect(baseballBat.canAttack()).toBe(true);\r\n      expect(bazooka.canAttack()).toBe(true);\r\n      \r\n      // All weapons should have attack methods that can be called\r\n      expect(typeof katana.attack).toBe('function');\r\n      expect(typeof laserGun.attack).toBe('function');\r\n      expect(typeof baseballBat.attack).toBe('function');\r\n      expect(typeof bazooka.attack).toBe('function');\r\n    });\r\n  });\r\n});","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\weapons\\__tests__\\WeaponSounds.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\game\\weapons\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\hooks\\useAccessibility.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'html' is assigned a value but never used.","line":13,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":15}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useEffect } from 'react';\r\nimport { useSettingsStore } from '../store/settingsStore';\r\n\r\nexport const useAccessibility = () => {\r\n  const { display, game } = useSettingsStore();\r\n\r\n  useEffect(() => {\r\n    // Only run on client side\r\n    if (typeof window === 'undefined' || typeof document === 'undefined') return;\r\n    const body = document.body;\r\n    const html = document.documentElement;\r\n\r\n    // Apply reduced motion\r\n    if (display.reducedMotion) {\r\n      body.classList.add('reduced-motion');\r\n    } else {\r\n      body.classList.remove('reduced-motion');\r\n    }\r\n\r\n    // Apply high contrast\r\n    if (display.highContrast) {\r\n      body.classList.add('high-contrast');\r\n    } else {\r\n      body.classList.remove('high-contrast');\r\n    }\r\n\r\n    // Apply colorblind filters\r\n    body.classList.remove('colorblind-protanopia', 'colorblind-deuteranopia', 'colorblind-tritanopia', 'colorblind-friendly-ui');\r\n    if (display.colorBlindMode !== 'none') {\r\n      body.classList.add(`colorblind-${display.colorBlindMode}`);\r\n    }\r\n\r\n    // Apply colorblind-friendly UI\r\n    if (display.colorBlindFriendlyUI) {\r\n      body.classList.add('colorblind-friendly-ui');\r\n    }\r\n\r\n    // Apply particle effects setting\r\n    if (!display.particleEffects) {\r\n      body.classList.add('no-particles');\r\n    } else {\r\n      body.classList.remove('no-particles');\r\n    }\r\n\r\n    // Apply screen shake setting\r\n    if (!display.screenShake) {\r\n      body.classList.add('no-screen-shake');\r\n    } else {\r\n      body.classList.remove('no-screen-shake');\r\n    }\r\n\r\n    // Set up audio subtitle events\r\n    const handleAudioSubtitleToggle = () => {\r\n      window.dispatchEvent(new CustomEvent('toggleSubtitles', {\r\n        detail: { enabled: display.audioSubtitles }\r\n      }));\r\n    };\r\n\r\n    // Set up visual indicator events\r\n    const handleVisualIndicatorToggle = () => {\r\n      window.dispatchEvent(new CustomEvent('toggleVisualIndicators', {\r\n        detail: { enabled: display.visualAudioIndicators }\r\n      }));\r\n    };\r\n\r\n    // Trigger initial events\r\n    handleAudioSubtitleToggle();\r\n    handleVisualIndicatorToggle();\r\n\r\n    // Handle focus loss pause setting\r\n    if (game.pauseOnFocusLoss) {\r\n      const handleVisibilityChange = () => {\r\n        if (document.hidden) {\r\n          // Dispatch custom event for game to handle pause\r\n          window.dispatchEvent(new CustomEvent('gamePauseOnFocusLoss'));\r\n        }\r\n      };\r\n\r\n      document.addEventListener('visibilitychange', handleVisibilityChange);\r\n      return () => {\r\n        document.removeEventListener('visibilitychange', handleVisibilityChange);\r\n      };\r\n    }\r\n  }, [display, game]);\r\n\r\n  // FPS Counter\r\n  useEffect(() => {\r\n    if (typeof window === 'undefined') return;\r\n    \r\n    if (display.showFPS) {\r\n      let fpsCounter = document.getElementById('fps-counter');\r\n      if (!fpsCounter) {\r\n        fpsCounter = document.createElement('div');\r\n        fpsCounter.id = 'fps-counter';\r\n        fpsCounter.className = 'fps-counter';\r\n        document.body.appendChild(fpsCounter);\r\n      }\r\n\r\n      let lastTime = performance.now();\r\n      let frameCount = 0;\r\n      let fps = 0;\r\n\r\n      const updateFPS = (currentTime: number) => {\r\n        frameCount++;\r\n        if (currentTime - lastTime >= 1000) {\r\n          fps = Math.round((frameCount * 1000) / (currentTime - lastTime));\r\n          if (fpsCounter) {\r\n            fpsCounter.textContent = `FPS: ${fps}`;\r\n          }\r\n          frameCount = 0;\r\n          lastTime = currentTime;\r\n        }\r\n        requestAnimationFrame(updateFPS);\r\n      };\r\n\r\n      const animationId = requestAnimationFrame(updateFPS);\r\n\r\n      return () => {\r\n        cancelAnimationFrame(animationId);\r\n        const counter = document.getElementById('fps-counter');\r\n        if (counter) {\r\n          counter.remove();\r\n        }\r\n      };\r\n    } else {\r\n      const counter = document.getElementById('fps-counter');\r\n      if (counter) {\r\n        counter.remove();\r\n      }\r\n    }\r\n  }, [display.showFPS]);\r\n\r\n  // Control Hints\r\n  useEffect(() => {\r\n    if (typeof window === 'undefined') return;\r\n    \r\n    if (game.showControlHints) {\r\n      let hintsElement = document.getElementById('control-hints');\r\n      if (!hintsElement) {\r\n        hintsElement = document.createElement('div');\r\n        hintsElement.id = 'control-hints';\r\n        hintsElement.className = 'control-hints';\r\n        hintsElement.innerHTML = `\r\n          <div style=\"margin-bottom: 8px; font-weight: bold;\">Controlos:</div>\r\n          <div>A/D ou /: Mover</div>\r\n          <div>W/: Saltar</div>\r\n          <div>S/: Agachar</div>\r\n          <div>Espao: Atacar</div>\r\n          <div>Esc: Pausar</div>\r\n        `;\r\n        document.body.appendChild(hintsElement);\r\n      }\r\n\r\n      // Auto-hide after 10 seconds\r\n      const hideTimer = setTimeout(() => {\r\n        if (hintsElement) {\r\n          hintsElement.classList.add('hidden');\r\n        }\r\n      }, 10000);\r\n\r\n      // Show on mouse movement or key press\r\n      const showHints = () => {\r\n        if (hintsElement) {\r\n          hintsElement.classList.remove('hidden');\r\n        }\r\n      };\r\n\r\n      document.addEventListener('mousemove', showHints);\r\n      document.addEventListener('keydown', showHints);\r\n\r\n      return () => {\r\n        clearTimeout(hideTimer);\r\n        document.removeEventListener('mousemove', showHints);\r\n        document.removeEventListener('keydown', showHints);\r\n        const hints = document.getElementById('control-hints');\r\n        if (hints) {\r\n          hints.remove();\r\n        }\r\n      };\r\n    } else {\r\n      const hints = document.getElementById('control-hints');\r\n      if (hints) {\r\n        hints.remove();\r\n      }\r\n    }\r\n  }, [game.showControlHints]);\r\n\r\n  return {\r\n    isReducedMotion: display.reducedMotion,\r\n    isHighContrast: display.highContrast,\r\n    colorBlindMode: display.colorBlindMode,\r\n    showFPS: display.showFPS,\r\n    particleEffects: display.particleEffects,\r\n    screenShake: display.screenShake,\r\n    showControlHints: game.showControlHints,\r\n    pauseOnFocusLoss: game.pauseOnFocusLoss,\r\n    // New accessibility features\r\n    audioSubtitles: display.audioSubtitles,\r\n    visualAudioIndicators: display.visualAudioIndicators,\r\n    colorBlindFriendlyUI: display.colorBlindFriendlyUI\r\n  };\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\hooks\\useAccessibilityFeatures.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\hooks\\useHapticFeedback.ts","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\hooks\\useHapticFeedback.ts:45:9\n  43 |       if (stored) {\n  44 |         const parsedSettings = JSON.parse(stored);\n> 45 |         setSettings({ ...DEFAULT_SETTINGS, ...parsedSettings });\n     |         ^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  46 |       }\n  47 |     } catch (error) {\n  48 |       console.warn('Failed to load haptic settings:', error);","line":45,"column":9,"nodeType":null,"endLine":45,"endColumn":20}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect, useCallback } from 'react';\r\n\r\ninterface HapticSettings {\r\n  enabled: boolean;\r\n  intensity: 'light' | 'medium' | 'heavy';\r\n}\r\n\r\nconst DEFAULT_SETTINGS: HapticSettings = {\r\n  enabled: true,\r\n  intensity: 'medium'\r\n};\r\n\r\nconst STORAGE_KEY = 'haptic-settings';\r\n\r\nexport function useHapticFeedback() {\r\n  const [settings, setSettings] = useState<HapticSettings>(DEFAULT_SETTINGS);\r\n  const [isSupported, setIsSupported] = useState(false);\r\n\r\n  // Check if haptic feedback is supported\r\n  useEffect(() => {\r\n    const checkSupport = () => {\r\n      // Check for vibration API support\r\n      const hasVibration = 'vibrate' in navigator;\r\n      \r\n      // Check for device type (mobile/tablet)\r\n      const isMobile = /Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\r\n      const hasTouch = 'ontouchstart' in window || navigator.maxTouchPoints > 0;\r\n      \r\n      setIsSupported(hasVibration && (isMobile || hasTouch));\r\n    };\r\n\r\n    checkSupport();\r\n  }, []);\r\n\r\n  // Load settings from localStorage\r\n  useEffect(() => {\r\n    if (typeof window === 'undefined') return;\r\n\r\n    try {\r\n      const stored = localStorage.getItem(STORAGE_KEY);\r\n      if (stored) {\r\n        const parsedSettings = JSON.parse(stored);\r\n        setSettings({ ...DEFAULT_SETTINGS, ...parsedSettings });\r\n      }\r\n    } catch (error) {\r\n      console.warn('Failed to load haptic settings:', error);\r\n    }\r\n  }, []);\r\n\r\n  // Save settings to localStorage\r\n  const updateSettings = useCallback((newSettings: Partial<HapticSettings>) => {\r\n    const updatedSettings = { ...settings, ...newSettings };\r\n    setSettings(updatedSettings);\r\n    \r\n    try {\r\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(updatedSettings));\r\n    } catch (error) {\r\n      console.warn('Failed to save haptic settings:', error);\r\n    }\r\n  }, [settings]);\r\n\r\n  // Trigger haptic feedback\r\n  const triggerHaptic = useCallback((intensity?: 'light' | 'medium' | 'heavy') => {\r\n    if (!isSupported || !settings.enabled) return;\r\n\r\n    const hapticIntensity = intensity || settings.intensity;\r\n    \r\n    if ('vibrate' in navigator) {\r\n      const patterns = {\r\n        light: [10],\r\n        medium: [20],\r\n        heavy: [30]\r\n      };\r\n      \r\n      try {\r\n        navigator.vibrate(patterns[hapticIntensity]);\r\n      } catch (error) {\r\n        console.warn('Haptic feedback failed:', error);\r\n      }\r\n    }\r\n  }, [isSupported, settings]);\r\n\r\n  // Trigger specific haptic patterns for different actions\r\n  const triggerActionHaptic = useCallback((action: 'button-press' | 'gesture' | 'success' | 'error') => {\r\n    if (!isSupported || !settings.enabled) return;\r\n\r\n    const patterns = {\r\n      'button-press': [15],\r\n      'gesture': [10, 50, 10],\r\n      'success': [20, 100, 20],\r\n      'error': [50, 50, 50]\r\n    };\r\n\r\n    try {\r\n      navigator.vibrate(patterns[action]);\r\n    } catch (error) {\r\n      console.warn('Action haptic feedback failed:', error);\r\n    }\r\n  }, [isSupported, settings]);\r\n\r\n  return {\r\n    settings,\r\n    updateSettings,\r\n    isSupported,\r\n    triggerHaptic,\r\n    triggerActionHaptic\r\n  };\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\hooks\\useMobileOptimization.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\hooks\\usePerformanceMonitor.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'updateInterval' is assigned a value but never used.","line":15,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":15,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'setMetrics' is assigned a value but never used.","line":22,"column":19,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":29},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":22,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":22,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[722,725],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[722,725],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":104,"column":85,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":104,"endColumn":88,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2940,2943],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2940,2943],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/refs","severity":2,"message":"Error: Cannot access refs during render\n\nReact refs are values that are not needed for rendering. Refs should only be accessed outside of render, such as in event handlers or effects. Accessing a ref value (the `current` property) during render can cause your component not to update as expected (https://react.dev/reference/react/useRef).\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\hooks\\usePerformanceMonitor.ts:113:10\n  111 |   };\n  112 |\n> 113 |   return {\n      |          ^\n> 114 |     // Visibility\n      | ^^^^^^^^^^^^^^^^^\n> 115 |     isVisible,\n      \n      | ^^^^^^^^^^^^^^^^^\n> 138 |     perfDebugger: perfDebuggerRef.current,\n      | ^^^^^^^^^^^^^^^^^\n> 139 |   };\n      | ^^^^ Cannot access ref value during render\n  140 | }\n  141 |\n  142 | // Higher-order component for automatic performance monitoring","line":113,"column":10,"nodeType":null,"endLine":139,"endColumn":4},{"ruleId":"react-hooks/refs","severity":2,"message":"Error: Cannot access refs during render\n\nReact refs are values that are not needed for rendering. Refs should only be accessed outside of render, such as in event handlers or effects. Accessing a ref value (the `current` property) during render can cause your component not to update as expected (https://react.dev/reference/react/useRef).\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\hooks\\usePerformanceMonitor.ts:137:14\n  135 |     \n  136 |     // Monitor instances (for advanced usage)\n> 137 |     monitor: monitorRef.current,\n      |              ^^^^^^^^^^^^^^^^^^ Cannot access ref value during render\n  138 |     perfDebugger: perfDebuggerRef.current,\n  139 |   };\n  140 | }","line":137,"column":14,"nodeType":null,"endLine":137,"endColumn":32},{"ruleId":"react-hooks/refs","severity":2,"message":"Error: Cannot access refs during render\n\nReact refs are values that are not needed for rendering. Refs should only be accessed outside of render, such as in event handlers or effects. Accessing a ref value (the `current` property) during render can cause your component not to update as expected (https://react.dev/reference/react/useRef).\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\hooks\\usePerformanceMonitor.ts:138:19\n  136 |     // Monitor instances (for advanced usage)\n  137 |     monitor: monitorRef.current,\n> 138 |     perfDebugger: perfDebuggerRef.current,\n      |                   ^^^^^^^^^^^^^^^^^^^^^^^ Cannot access ref value during render\n  139 |   };\n  140 | }\n  141 |","line":138,"column":19,"nodeType":null,"endLine":138,"endColumn":42},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":168,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":168,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4569,4572],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4569,4572],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":168,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":168,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4579,4582],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4579,4582],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":4,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport React, { useEffect, useRef, useState } from 'react';\r\nimport { AdvancedPerformanceMonitor, PerformanceDebugger } from '../utils/performance';\r\n\r\nexport interface UsePerformanceMonitorOptions {\r\n  enabled?: boolean;\r\n  updateInterval?: number;\r\n  autoProfile?: boolean;\r\n}\r\n\r\nexport function usePerformanceMonitor(options: UsePerformanceMonitorOptions = {}) {\r\n  const {\r\n    enabled = true,\r\n    updateInterval = 100,\r\n    autoProfile = false,\r\n  } = options;\r\n\r\n  const monitorRef = useRef<AdvancedPerformanceMonitor | null>(null);\r\n  const perfDebuggerRef = useRef<PerformanceDebugger | null>(null);\r\n  const [isVisible, setIsVisible] = useState(false);\r\n  const [metrics, setMetrics] = useState<any>(null);\r\n  const [isClient, setIsClient] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setIsClient(true);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!enabled || !isClient) return;\r\n\r\n    // Initialize monitors\r\n    if (!monitorRef.current) {\r\n      monitorRef.current = new AdvancedPerformanceMonitor();\r\n    }\r\n    if (!perfDebuggerRef.current) {\r\n      perfDebuggerRef.current = PerformanceDebugger.getInstance();\r\n    }\r\n\r\n    // Set up keyboard shortcut to toggle performance monitor\r\n    const handleKeyPress = (event: KeyboardEvent) => {\r\n      // Ctrl/Cmd + Shift + P to toggle performance monitor\r\n      if ((event.ctrlKey || event.metaKey) && event.shiftKey && event.key === 'P') {\r\n        event.preventDefault();\r\n        setIsVisible(prev => !prev);\r\n      }\r\n    };\r\n\r\n    document.addEventListener('keydown', handleKeyPress);\r\n\r\n    return () => {\r\n      document.removeEventListener('keydown', handleKeyPress);\r\n    };\r\n  }, [enabled, isClient]);\r\n\r\n  // Performance monitoring functions\r\n  const startRenderMeasurement = () => {\r\n    monitorRef.current?.startRenderMeasurement();\r\n  };\r\n\r\n  const endRenderMeasurement = () => {\r\n    monitorRef.current?.endRenderMeasurement();\r\n  };\r\n\r\n  const startUpdateMeasurement = () => {\r\n    monitorRef.current?.startUpdateMeasurement();\r\n  };\r\n\r\n  const endUpdateMeasurement = () => {\r\n    monitorRef.current?.endUpdateMeasurement();\r\n  };\r\n\r\n  const recordDrawCall = () => {\r\n    monitorRef.current?.recordDrawCall();\r\n  };\r\n\r\n  const recordObjectCount = (count: number) => {\r\n    monitorRef.current?.recordObjectCount(count);\r\n  };\r\n\r\n  const updateMetrics = () => {\r\n    if (!monitorRef.current) return null;\r\n    return monitorRef.current.update();\r\n  };\r\n\r\n  // Profiling functions\r\n  const startProfile = (name: string) => {\r\n    if (autoProfile) {\r\n      perfDebuggerRef.current?.startProfile(name);\r\n    }\r\n  };\r\n\r\n  const endProfile = (name: string) => {\r\n    if (autoProfile) {\r\n      return perfDebuggerRef.current?.endProfile(name);\r\n    }\r\n    return 0;\r\n  };\r\n\r\n  const setMarker = (name: string) => {\r\n    perfDebuggerRef.current?.setMarker(name);\r\n  };\r\n\r\n  const logPerformance = (level: 'info' | 'warn' | 'error', message: string, data?: any) => {\r\n    perfDebuggerRef.current?.log(level, message, data);\r\n  };\r\n\r\n  // Toggle visibility\r\n  const toggleVisibility = () => {\r\n    setIsVisible(prev => !prev);\r\n  };\r\n\r\n  return {\r\n    // Visibility\r\n    isVisible,\r\n    toggleVisibility,\r\n    \r\n    // Measurement functions\r\n    startRenderMeasurement,\r\n    endRenderMeasurement,\r\n    startUpdateMeasurement,\r\n    endUpdateMeasurement,\r\n    recordDrawCall,\r\n    recordObjectCount,\r\n    updateMetrics,\r\n    \r\n    // Profiling functions\r\n    startProfile,\r\n    endProfile,\r\n    setMarker,\r\n    logPerformance,\r\n    \r\n    // Current metrics\r\n    metrics,\r\n    \r\n    // Monitor instances (for advanced usage)\r\n    monitor: monitorRef.current,\r\n    perfDebugger: perfDebuggerRef.current,\r\n  };\r\n}\r\n\r\n// Higher-order component for automatic performance monitoring\r\nexport function withPerformanceMonitoring<T extends object>(\r\n  Component: React.ComponentType<T>,\r\n  componentName?: string\r\n) {\r\n  function PerformanceMonitoredComponent(props: T) {\r\n    const { startProfile, endProfile } = usePerformanceMonitor({ autoProfile: true });\r\n    const name = componentName || Component.displayName || Component.name || 'Component';\r\n\r\n    useEffect(() => {\r\n      startProfile(`${name}-render`);\r\n      return () => {\r\n        endProfile(`${name}-render`);\r\n      };\r\n    });\r\n\r\n    return React.createElement(Component, props);\r\n  }\r\n  \r\n  return PerformanceMonitoredComponent;\r\n}\r\n\r\n// Hook for measuring function performance\r\nexport function usePerformanceMeasure() {\r\n  const perfDebugger = useRef(PerformanceDebugger.getInstance());\r\n\r\n  const measure = <T extends (...args: any[]) => any>(\r\n    fn: T,\r\n    name?: string\r\n  ): T => {\r\n    const functionName = name || fn.name || 'anonymous';\r\n    \r\n    return ((...args: Parameters<T>) => {\r\n      perfDebugger.current.startProfile(functionName);\r\n      try {\r\n        const result = fn(...args);\r\n        \r\n        // Handle async functions\r\n        if (result instanceof Promise) {\r\n          return result.finally(() => {\r\n            perfDebugger.current.endProfile(functionName);\r\n          });\r\n        }\r\n        \r\n        perfDebugger.current.endProfile(functionName);\r\n        return result;\r\n      } catch (error) {\r\n        perfDebugger.current.endProfile(functionName);\r\n        perfDebugger.current.log('error', `Error in ${functionName}`, error);\r\n        throw error;\r\n      }\r\n    }) as T;\r\n  };\r\n\r\n  return { measure };\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\hooks\\usePerformanceMonitoring.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\hooks\\useResponsive.ts","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\hooks\\useResponsive.ts:106:5\n  104 |   useEffect(() => {\n  105 |     const mediaQuery = window.matchMedia(query);\n> 106 |     setMatches(mediaQuery.matches);\n      |     ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  107 |\n  108 |     const handler = (event: MediaQueryListEvent) => {\n  109 |       setMatches(event.matches);","line":106,"column":5,"nodeType":null,"endLine":106,"endColumn":15}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\n\r\ninterface BreakpointConfig {\r\n  sm: number;\r\n  md: number;\r\n  lg: number;\r\n  xl: number;\r\n  '2xl': number;\r\n}\r\n\r\ninterface ResponsiveState {\r\n  width: number;\r\n  height: number;\r\n  isMobile: boolean;\r\n  isTablet: boolean;\r\n  isDesktop: boolean;\r\n  isLandscape: boolean;\r\n  isPortrait: boolean;\r\n  breakpoint: keyof BreakpointConfig | 'xs';\r\n}\r\n\r\nconst breakpoints: BreakpointConfig = {\r\n  sm: 640,\r\n  md: 768,\r\n  lg: 1024,\r\n  xl: 1280,\r\n  '2xl': 1536,\r\n};\r\n\r\nexport function useResponsive(): ResponsiveState {\r\n  const [state, setState] = useState<ResponsiveState>({\r\n    width: 0,\r\n    height: 0,\r\n    isMobile: false,\r\n    isTablet: false,\r\n    isDesktop: true,\r\n    isLandscape: true,\r\n    isPortrait: false,\r\n    breakpoint: 'xl',\r\n  });\r\n\r\n  useEffect(() => {\r\n    const updateState = () => {\r\n      const width = window.innerWidth;\r\n      const height = window.innerHeight;\r\n      \r\n      // Determine breakpoint\r\n      let breakpoint: keyof BreakpointConfig | 'xs' = 'xs';\r\n      if (width >= breakpoints['2xl']) breakpoint = '2xl';\r\n      else if (width >= breakpoints.xl) breakpoint = 'xl';\r\n      else if (width >= breakpoints.lg) breakpoint = 'lg';\r\n      else if (width >= breakpoints.md) breakpoint = 'md';\r\n      else if (width >= breakpoints.sm) breakpoint = 'sm';\r\n\r\n      // Determine device type\r\n      const isMobile = width < breakpoints.md;\r\n      const isTablet = width >= breakpoints.md && width < breakpoints.lg;\r\n      const isDesktop = width >= breakpoints.lg;\r\n\r\n      // Determine orientation\r\n      const isLandscape = width > height;\r\n      const isPortrait = height > width;\r\n\r\n      setState({\r\n        width,\r\n        height,\r\n        isMobile,\r\n        isTablet,\r\n        isDesktop,\r\n        isLandscape,\r\n        isPortrait,\r\n        breakpoint,\r\n      });\r\n    };\r\n\r\n    // Initial state\r\n    updateState();\r\n\r\n    // Listen for changes\r\n    window.addEventListener('resize', updateState);\r\n    window.addEventListener('orientationchange', updateState);\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', updateState);\r\n      window.removeEventListener('orientationchange', updateState);\r\n    };\r\n  }, []);\r\n\r\n  return state;\r\n}\r\n\r\n// Utility hook for specific breakpoint checks\r\nexport function useBreakpoint(breakpoint: keyof BreakpointConfig): boolean {\r\n  const { width } = useResponsive();\r\n  return width >= breakpoints[breakpoint];\r\n}\r\n\r\n// Utility hook for media queries\r\nexport function useMediaQuery(query: string): boolean {\r\n  const [matches, setMatches] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const mediaQuery = window.matchMedia(query);\r\n    setMatches(mediaQuery.matches);\r\n\r\n    const handler = (event: MediaQueryListEvent) => {\r\n      setMatches(event.matches);\r\n    };\r\n\r\n    mediaQuery.addEventListener('change', handler);\r\n    return () => mediaQuery.removeEventListener('change', handler);\r\n  }, [query]);\r\n\r\n  return matches;\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\lib\\analytics.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":180,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":180,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4791,4794],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4791,4794],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Character, Weapon, Difficulty } from '@/store/gameStore';\r\n\r\n// Analytics event types\r\nexport interface PlayerProgressionEvent {\r\n  type: 'progression';\r\n  difficulty: Difficulty;\r\n  score: number;\r\n  lives: number;\r\n  timestamp: number;\r\n  sessionId: string;\r\n}\r\n\r\nexport interface WeaponUsageEvent {\r\n  type: 'weapon_usage';\r\n  weapon: Weapon;\r\n  usageCount: number;\r\n  timestamp: number;\r\n  sessionId: string;\r\n}\r\n\r\nexport interface GameCompletionEvent {\r\n  type: 'completion';\r\n  difficulty: Difficulty;\r\n  finalScore: number;\r\n  completionTime: number;\r\n  survived: boolean;\r\n  timestamp: number;\r\n  sessionId: string;\r\n}\r\n\r\nexport interface PerformanceMetrics {\r\n  type: 'performance';\r\n  fps: number;\r\n  loadTime: number;\r\n  memoryUsage?: number;\r\n  timestamp: number;\r\n  sessionId: string;\r\n}\r\n\r\nexport type AnalyticsEvent = PlayerProgressionEvent | WeaponUsageEvent | GameCompletionEvent | PerformanceMetrics;\r\n\r\n// Analytics data storage interface\r\nexport interface AnalyticsData {\r\n  progression: PlayerProgressionEvent[];\r\n  weaponUsage: Map<Weapon, number>;\r\n  completions: GameCompletionEvent[];\r\n  performance: PerformanceMetrics[];\r\n  sessionStats: {\r\n    sessionId: string;\r\n    startTime: number;\r\n    character: Character | null;\r\n    weapon: Weapon | null;\r\n    difficulty: Difficulty | null;\r\n  };\r\n}\r\n\r\nclass AnalyticsService {\r\n  private data: AnalyticsData;\r\n  private sessionId: string;\r\n  private gameStartTime: number = 0;\r\n  private lastFPSCheck: number = 0;\r\n  private fpsCounter: number = 0;\r\n  private frameCount: number = 0;\r\n\r\n  constructor() {\r\n    this.sessionId = this.generateSessionId();\r\n    this.data = {\r\n      progression: [],\r\n      weaponUsage: new Map(),\r\n      completions: [],\r\n      performance: [],\r\n      sessionStats: {\r\n        sessionId: this.sessionId,\r\n        startTime: Date.now(),\r\n        character: null,\r\n        weapon: null,\r\n        difficulty: null\r\n      }\r\n    };\r\n\r\n    // Initialize performance monitoring\r\n    this.initializePerformanceMonitoring();\r\n  }\r\n\r\n  private generateSessionId(): string {\r\n    return `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\r\n  }\r\n\r\n  private initializePerformanceMonitoring(): void {\r\n    // Only initialize on client side\r\n    if (typeof window === 'undefined') return;\r\n\r\n    // Monitor FPS\r\n    this.lastFPSCheck = performance.now();\r\n    this.startFPSMonitoring();\r\n\r\n    // Monitor memory usage if available\r\n    if ('memory' in performance) {\r\n      setInterval(() => {\r\n        this.trackPerformanceMetrics();\r\n      }, 5000); // Every 5 seconds\r\n    }\r\n  }\r\n\r\n  private startFPSMonitoring(): void {\r\n    // Only run on client side\r\n    if (typeof window === 'undefined') return;\r\n\r\n    const measureFPS = () => {\r\n      this.frameCount++;\r\n      const now = performance.now();\r\n      \r\n      if (now - this.lastFPSCheck >= 1000) {\r\n        this.fpsCounter = Math.round((this.frameCount * 1000) / (now - this.lastFPSCheck));\r\n        this.frameCount = 0;\r\n        this.lastFPSCheck = now;\r\n      }\r\n      \r\n      requestAnimationFrame(measureFPS);\r\n    };\r\n    \r\n    requestAnimationFrame(measureFPS);\r\n  }\r\n\r\n  // Track player progression through difficulty levels\r\n  trackProgression(difficulty: Difficulty, score: number, lives: number): void {\r\n    const event: PlayerProgressionEvent = {\r\n      type: 'progression',\r\n      difficulty,\r\n      score,\r\n      lives,\r\n      timestamp: Date.now(),\r\n      sessionId: this.sessionId\r\n    };\r\n\r\n    this.data.progression.push(event);\r\n    this.saveToLocalStorage();\r\n    this.sendToAPI(event);\r\n  }\r\n\r\n  // Monitor weapon usage statistics\r\n  trackWeaponUsage(weapon: Weapon): void {\r\n    const currentCount = this.data.weaponUsage.get(weapon) || 0;\r\n    this.data.weaponUsage.set(weapon, currentCount + 1);\r\n\r\n    const event: WeaponUsageEvent = {\r\n      type: 'weapon_usage',\r\n      weapon,\r\n      usageCount: currentCount + 1,\r\n      timestamp: Date.now(),\r\n      sessionId: this.sessionId\r\n    };\r\n\r\n    // Store weapon usage events for detailed analysis\r\n    this.saveToLocalStorage();\r\n    this.sendToAPI(event);\r\n  }\r\n\r\n  // Record completion rates and average scores\r\n  trackGameCompletion(difficulty: Difficulty, finalScore: number, survived: boolean): void {\r\n    const completionTime = Date.now() - this.gameStartTime;\r\n    \r\n    const event: GameCompletionEvent = {\r\n      type: 'completion',\r\n      difficulty,\r\n      finalScore,\r\n      completionTime,\r\n      survived,\r\n      timestamp: Date.now(),\r\n      sessionId: this.sessionId\r\n    };\r\n\r\n    this.data.completions.push(event);\r\n    this.saveToLocalStorage();\r\n    this.sendToAPI(event);\r\n  }\r\n\r\n  // Add performance metrics (FPS, load times)\r\n  trackPerformanceMetrics(loadTime?: number): void {\r\n    const memoryInfo = (performance as any).memory;\r\n    \r\n    const metrics: PerformanceMetrics = {\r\n      type: 'performance',\r\n      fps: this.fpsCounter,\r\n      loadTime: loadTime || 0,\r\n      memoryUsage: memoryInfo ? memoryInfo.usedJSHeapSize : undefined,\r\n      timestamp: Date.now(),\r\n      sessionId: this.sessionId\r\n    };\r\n\r\n    this.data.performance.push(metrics);\r\n    this.saveToLocalStorage();\r\n    this.sendToAPI(metrics);\r\n  }\r\n\r\n  // Set session information\r\n  setSessionInfo(character: Character, weapon: Weapon, difficulty: Difficulty): void {\r\n    this.data.sessionStats.character = character;\r\n    this.data.sessionStats.weapon = weapon;\r\n    this.data.sessionStats.difficulty = difficulty;\r\n    this.gameStartTime = Date.now();\r\n    this.saveToLocalStorage();\r\n  }\r\n\r\n  // Get analytics summary\r\n  getAnalyticsSummary() {\r\n    const completions = this.data.completions;\r\n    const progressions = this.data.progression;\r\n    const performance = this.data.performance;\r\n\r\n    // Calculate completion rates by difficulty\r\n    const completionRates = {\r\n      easy: this.calculateCompletionRate('easy'),\r\n      medium: this.calculateCompletionRate('medium'),\r\n      impossible: this.calculateCompletionRate('impossible')\r\n    };\r\n\r\n    // Calculate average scores by difficulty\r\n    const averageScores = {\r\n      easy: this.calculateAverageScore('easy'),\r\n      medium: this.calculateAverageScore('medium'),\r\n      impossible: this.calculateAverageScore('impossible')\r\n    };\r\n\r\n    // Get weapon usage statistics\r\n    const weaponStats = Array.from(this.data.weaponUsage.entries()).map(([weapon, count]) => ({\r\n      weapon,\r\n      count,\r\n      percentage: (count / Array.from(this.data.weaponUsage.values()).reduce((a, b) => a + b, 0)) * 100\r\n    }));\r\n\r\n    // Calculate average performance metrics\r\n    const avgFPS = performance.length > 0 \r\n      ? performance.reduce((sum, p) => sum + p.fps, 0) / performance.length \r\n      : 0;\r\n\r\n    const avgLoadTime = performance.filter(p => p.loadTime > 0).length > 0\r\n      ? performance.filter(p => p.loadTime > 0).reduce((sum, p) => sum + p.loadTime, 0) / performance.filter(p => p.loadTime > 0).length\r\n      : 0;\r\n\r\n    return {\r\n      session: this.data.sessionStats,\r\n      completionRates,\r\n      averageScores,\r\n      weaponUsage: weaponStats,\r\n      performance: {\r\n        averageFPS: Math.round(avgFPS),\r\n        averageLoadTime: Math.round(avgLoadTime),\r\n        currentFPS: this.fpsCounter\r\n      },\r\n      totalGames: completions.length,\r\n      totalProgressionEvents: progressions.length\r\n    };\r\n  }\r\n\r\n  private calculateCompletionRate(difficulty: Difficulty): number {\r\n    const completions = this.data.completions.filter(c => c.difficulty === difficulty);\r\n    const survived = completions.filter(c => c.survived).length;\r\n    return completions.length > 0 ? (survived / completions.length) * 100 : 0;\r\n  }\r\n\r\n  private calculateAverageScore(difficulty: Difficulty): number {\r\n    const completions = this.data.completions.filter(c => c.difficulty === difficulty);\r\n    return completions.length > 0 \r\n      ? completions.reduce((sum, c) => sum + c.finalScore, 0) / completions.length \r\n      : 0;\r\n  }\r\n\r\n  // Export analytics data\r\n  exportData(): AnalyticsData {\r\n    return { ...this.data };\r\n  }\r\n\r\n  // Import analytics data (for loading saved data)\r\n  importData(data: Partial<AnalyticsData>): void {\r\n    if (data.progression) this.data.progression = data.progression;\r\n    if (data.weaponUsage) this.data.weaponUsage = new Map(data.weaponUsage);\r\n    if (data.completions) this.data.completions = data.completions;\r\n    if (data.performance) this.data.performance = data.performance;\r\n    if (data.sessionStats) this.data.sessionStats = { ...this.data.sessionStats, ...data.sessionStats };\r\n  }\r\n\r\n  // Clear analytics data\r\n  clearData(): void {\r\n    this.data = {\r\n      progression: [],\r\n      weaponUsage: new Map(),\r\n      completions: [],\r\n      performance: [],\r\n      sessionStats: {\r\n        sessionId: this.generateSessionId(),\r\n        startTime: Date.now(),\r\n        character: null,\r\n        weapon: null,\r\n        difficulty: null\r\n      }\r\n    };\r\n    this.sessionId = this.data.sessionStats.sessionId;\r\n    if (typeof window !== 'undefined') {\r\n      localStorage.removeItem('gameAnalytics');\r\n    }\r\n  }\r\n\r\n  private saveToLocalStorage(): void {\r\n    // Only run on client side\r\n    if (typeof window === 'undefined') return;\r\n\r\n    try {\r\n      const dataToSave = {\r\n        ...this.data,\r\n        weaponUsage: Array.from(this.data.weaponUsage.entries())\r\n      };\r\n      localStorage.setItem('gameAnalytics', JSON.stringify(dataToSave));\r\n    } catch (error) {\r\n      console.warn('Failed to save analytics to localStorage:', error);\r\n    }\r\n  }\r\n\r\n  // Send analytics event to API (optional)\r\n  private async sendToAPI(event: AnalyticsEvent): Promise<void> {\r\n    try {\r\n      await fetch('/api/analytics', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(event),\r\n      });\r\n    } catch (error) {\r\n      // Silently fail - analytics shouldn't break the game\r\n      console.warn('Failed to send analytics to API:', error);\r\n    }\r\n  }\r\n\r\n  loadFromLocalStorage(): void {\r\n    // Only run on client side\r\n    if (typeof window === 'undefined') return;\r\n\r\n    try {\r\n      const saved = localStorage.getItem('gameAnalytics');\r\n      if (saved) {\r\n        const data = JSON.parse(saved);\r\n        this.importData({\r\n          ...data,\r\n          weaponUsage: new Map(data.weaponUsage || [])\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.warn('Failed to load analytics from localStorage:', error);\r\n    }\r\n  }\r\n}\r\n\r\n// Create singleton instance with lazy initialization\r\nlet analyticsServiceInstance: AnalyticsService | null = null;\r\n\r\nexport const analyticsService = {\r\n  getInstance(): AnalyticsService {\r\n    if (!analyticsServiceInstance) {\r\n      analyticsServiceInstance = new AnalyticsService();\r\n      // Load saved data on first initialization\r\n      if (typeof window !== 'undefined') {\r\n        analyticsServiceInstance.loadFromLocalStorage();\r\n      }\r\n    }\r\n    return analyticsServiceInstance;\r\n  },\r\n\r\n  // Proxy methods to the singleton instance\r\n  trackProgression: (difficulty: Difficulty, score: number, lives: number) => {\r\n    if (typeof window !== 'undefined') {\r\n      analyticsService.getInstance().trackProgression(difficulty, score, lives);\r\n    }\r\n  },\r\n\r\n  trackWeaponUsage: (weapon: Weapon) => {\r\n    if (typeof window !== 'undefined') {\r\n      analyticsService.getInstance().trackWeaponUsage(weapon);\r\n    }\r\n  },\r\n\r\n  trackGameCompletion: (difficulty: Difficulty, finalScore: number, survived: boolean) => {\r\n    if (typeof window !== 'undefined') {\r\n      analyticsService.getInstance().trackGameCompletion(difficulty, finalScore, survived);\r\n    }\r\n  },\r\n\r\n  trackPerformanceMetrics: (loadTime?: number) => {\r\n    if (typeof window !== 'undefined') {\r\n      analyticsService.getInstance().trackPerformanceMetrics(loadTime);\r\n    }\r\n  },\r\n\r\n  setSessionInfo: (character: Character, weapon: Weapon, difficulty: Difficulty) => {\r\n    if (typeof window !== 'undefined') {\r\n      analyticsService.getInstance().setSessionInfo(character, weapon, difficulty);\r\n    }\r\n  },\r\n\r\n  getAnalyticsSummary: () => {\r\n    if (typeof window !== 'undefined') {\r\n      return analyticsService.getInstance().getAnalyticsSummary();\r\n    }\r\n    return null;\r\n  },\r\n\r\n  exportData: () => {\r\n    if (typeof window !== 'undefined') {\r\n      return analyticsService.getInstance().exportData();\r\n    }\r\n    return null;\r\n  },\r\n\r\n  importData: (data: Partial<AnalyticsData>) => {\r\n    if (typeof window !== 'undefined') {\r\n      analyticsService.getInstance().importData(data);\r\n    }\r\n  },\r\n\r\n  clearData: () => {\r\n    if (typeof window !== 'undefined') {\r\n      analyticsService.getInstance().clearData();\r\n    }\r\n  }\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\lib\\api.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\lib\\aws-api.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":36,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1005,1008],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1005,1008],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":65,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":65,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1787,1790],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1787,1790],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":141,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":141,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3938,3941],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3938,3941],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * AWS API client utilities for communicating with Lambda functions\r\n * Provides retry logic, error handling, and request/response validation\r\n */\r\n\r\nexport interface RetryOptions {\r\n  maxRetries: number;\r\n  baseDelay: number; // milliseconds\r\n  maxDelay: number; // milliseconds\r\n}\r\n\r\nconst DEFAULT_RETRY_OPTIONS: RetryOptions = {\r\n  maxRetries: 3,\r\n  baseDelay: 1000, // 1 second\r\n  maxDelay: 10000, // 10 seconds\r\n};\r\n\r\n/**\r\n * Sleep utility for retry delays\r\n */\r\nconst sleep = (ms: number): Promise<void> => \r\n  new Promise(resolve => setTimeout(resolve, ms));\r\n\r\n/**\r\n * Calculate exponential backoff delay with jitter\r\n */\r\nconst calculateDelay = (attempt: number, options: RetryOptions): number => {\r\n  const exponentialDelay = options.baseDelay * Math.pow(2, attempt);\r\n  const jitter = Math.random() * 0.1 * exponentialDelay; // 10% jitter\r\n  return Math.min(exponentialDelay + jitter, options.maxDelay);\r\n};\r\n\r\n/**\r\n * Check if an error is retryable\r\n */\r\nconst isRetryableError = (error: any): boolean => {\r\n  // Network errors\r\n  if (error instanceof TypeError && error.message.includes('fetch')) {\r\n    return true;\r\n  }\r\n  \r\n  // Timeout errors\r\n  if (error instanceof Error && error.name === 'AbortError') {\r\n    return true;\r\n  }\r\n  \r\n  // HTTP status codes that should be retried\r\n  if (error.status) {\r\n    const retryableStatuses = [408, 429, 500, 502, 503, 504];\r\n    return retryableStatuses.includes(error.status);\r\n  }\r\n  \r\n  return false;\r\n};\r\n\r\n/**\r\n * Enhanced fetch with retry logic and error handling\r\n */\r\nexport async function fetchWithRetry(\r\n  url: string,\r\n  options: RequestInit = {},\r\n  retryOptions: Partial<RetryOptions> = {}\r\n): Promise<Response> {\r\n  const finalRetryOptions = { ...DEFAULT_RETRY_OPTIONS, ...retryOptions };\r\n  let lastError: any;\r\n\r\n  for (let attempt = 0; attempt <= finalRetryOptions.maxRetries; attempt++) {\r\n    try {\r\n      const response = await fetch(url, {\r\n        ...options,\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Accept': 'application/json',\r\n          ...options.headers,\r\n        },\r\n      });\r\n\r\n      // If successful or non-retryable error, return response\r\n      if (response.ok || !isRetryableError({ status: response.status })) {\r\n        return response;\r\n      }\r\n\r\n      // Store error for potential retry\r\n      lastError = { status: response.status, statusText: response.statusText };\r\n      \r\n      // Don't retry on last attempt\r\n      if (attempt === finalRetryOptions.maxRetries) {\r\n        return response;\r\n      }\r\n\r\n    } catch (error) {\r\n      lastError = error;\r\n      \r\n      // Don't retry on last attempt or non-retryable errors\r\n      if (attempt === finalRetryOptions.maxRetries || !isRetryableError(error)) {\r\n        throw error;\r\n      }\r\n    }\r\n\r\n    // Calculate delay and wait before retry\r\n    if (attempt < finalRetryOptions.maxRetries) {\r\n      const delay = calculateDelay(attempt, finalRetryOptions);\r\n      console.warn(`Request failed, retrying in ${delay}ms (attempt ${attempt + 1}/${finalRetryOptions.maxRetries + 1})`);\r\n      await sleep(delay);\r\n    }\r\n  }\r\n\r\n  // This should never be reached, but throw last error as fallback\r\n  throw lastError;\r\n}\r\n\r\n/**\r\n * Validate AWS API base URL configuration\r\n */\r\nexport function validateAwsConfig(): string {\r\n  const baseUrl = process.env.AWS_API_BASE_URL;\r\n  \r\n  if (!baseUrl) {\r\n    throw new Error('AWS_API_BASE_URL environment variable is not configured');\r\n  }\r\n  \r\n  try {\r\n    new URL(baseUrl);\r\n  } catch {\r\n    throw new Error('AWS_API_BASE_URL is not a valid URL');\r\n  }\r\n  \r\n  return baseUrl;\r\n}\r\n\r\n/**\r\n * Create standardized error responses for API routes\r\n */\r\nexport function createErrorResponse(message: string, status: number) {\r\n  return Response.json({ error: message }, { status });\r\n}\r\n\r\n/**\r\n * Handle common AWS API errors and convert to appropriate HTTP responses\r\n */\r\nexport function handleAwsError(error: any): Response {\r\n  console.error('AWS API Error:', error);\r\n  \r\n  // Network connectivity issues\r\n  if (error instanceof TypeError && error.message.includes('fetch')) {\r\n    return createErrorResponse('Network error connecting to AWS', 503);\r\n  }\r\n  \r\n  // Timeout errors\r\n  if (error instanceof Error && error.name === 'AbortError') {\r\n    return createErrorResponse('Request timeout', 504);\r\n  }\r\n  \r\n  // Configuration errors\r\n  if (error.message?.includes('AWS_API_BASE_URL')) {\r\n    return createErrorResponse('API configuration error', 500);\r\n  }\r\n  \r\n  // HTTP errors with status codes\r\n  if (error.status) {\r\n    switch (error.status) {\r\n      case 400:\r\n        return createErrorResponse('Invalid request data', 400);\r\n      case 401:\r\n        return createErrorResponse('Unauthorized', 401);\r\n      case 403:\r\n        return createErrorResponse('Forbidden', 403);\r\n      case 404:\r\n        return createErrorResponse('Resource not found', 404);\r\n      case 429:\r\n        return createErrorResponse('Too many requests. Please try again later.', 429);\r\n      case 500:\r\n        return createErrorResponse('Internal server error', 500);\r\n      case 502:\r\n        return createErrorResponse('Bad gateway', 502);\r\n      case 503:\r\n        return createErrorResponse('Service unavailable', 503);\r\n      case 504:\r\n        return createErrorResponse('Gateway timeout', 504);\r\n      default:\r\n        return createErrorResponse(`AWS API error: ${error.statusText || 'Unknown error'}`, error.status);\r\n    }\r\n  }\r\n  \r\n  // Generic fallback\r\n  return createErrorResponse('Internal server error', 500);\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\lib\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\store\\__tests__\\achievementStore.test.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'progress' is assigned a value but never used.","line":48,"column":39,"nodeType":null,"messageId":"unusedVar","endLine":48,"endColumn":47}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useAchievementStore } from '../achievementStore';\r\nimport { ACHIEVEMENT_DEFINITIONS } from '../../types/achievements';\r\n\r\n// Mock localStorage\r\nconst localStorageMock = {\r\n  getItem: jest.fn(),\r\n  setItem: jest.fn(),\r\n  removeItem: jest.fn(),\r\n  clear: jest.fn(),\r\n};\r\nObject.defineProperty(window, 'localStorage', {\r\n  value: localStorageMock\r\n});\r\n\r\ndescribe('Achievement Store', () => {\r\n  beforeEach(() => {\r\n    // Reset the store state before each test\r\n    useAchievementStore.setState({\r\n      progress: {},\r\n      notifications: [],\r\n      stats: {\r\n        totalUnlocked: 0,\r\n        totalPoints: 0,\r\n        completionPercentage: 0,\r\n        rareAchievements: 0,\r\n        epicAchievements: 0,\r\n        legendaryAchievements: 0\r\n      },\r\n      sessionStats: {\r\n        enemiesKilled: 0,\r\n        enemiesKilledByType: {},\r\n        enemiesKilledByWeapon: {},\r\n        livesCollected: 0,\r\n        weaponsUsed: new Set<string>(),\r\n        gameStartTime: undefined,\r\n        perfectRun: true,\r\n        bazookaMultiKills: 0\r\n      }\r\n    });\r\n    \r\n    // Clear localStorage mocks\r\n    localStorageMock.getItem.mockClear();\r\n    localStorageMock.setItem.mockClear();\r\n  });\r\n\r\n  describe('Initialization', () => {\r\n    it('should initialize achievements correctly', () => {\r\n      const { initializeAchievements, progress } = useAchievementStore.getState();\r\n      \r\n      initializeAchievements();\r\n      \r\n      const updatedProgress = useAchievementStore.getState().progress;\r\n      \r\n      // Should have progress entries for all achievements\r\n      expect(Object.keys(updatedProgress)).toHaveLength(ACHIEVEMENT_DEFINITIONS.length);\r\n      \r\n      // Each achievement should have correct initial progress\r\n      ACHIEVEMENT_DEFINITIONS.forEach(achievement => {\r\n        expect(updatedProgress[achievement.id]).toEqual({\r\n          achievementId: achievement.id,\r\n          progress: 0,\r\n          maxProgress: achievement.maxProgress || 1,\r\n          unlocked: false\r\n        });\r\n      });\r\n    });\r\n  });\r\n\r\n  describe('Achievement Triggers', () => {\r\n    beforeEach(() => {\r\n      const { initializeAchievements } = useAchievementStore.getState();\r\n      initializeAchievements();\r\n    });\r\n\r\n    it('should unlock first kill achievement', () => {\r\n      const { triggerAchievementCheck } = useAchievementStore.getState();\r\n      \r\n      triggerAchievementCheck('enemy_killed', 1, { enemyType: 'ghost', weapon: 'katana' });\r\n      \r\n      const { progress, notifications } = useAchievementStore.getState();\r\n      \r\n      // First kill achievement should be unlocked\r\n      expect(progress['first_kill'].unlocked).toBe(true);\r\n      expect(progress['first_kill'].progress).toBe(1);\r\n      \r\n      // Should have a notification\r\n      expect(notifications).toHaveLength(1);\r\n      expect(notifications[0].achievement.id).toBe('first_kill');\r\n    });\r\n\r\n    it('should track enemy kills by type', () => {\r\n      const { triggerAchievementCheck } = useAchievementStore.getState();\r\n      \r\n      // Kill 5 ghosts\r\n      for (let i = 0; i < 5; i++) {\r\n        triggerAchievementCheck('enemy_killed', 1, { enemyType: 'ghost', weapon: 'katana' });\r\n      }\r\n      \r\n      const { sessionStats } = useAchievementStore.getState();\r\n      \r\n      expect(sessionStats.enemiesKilled).toBe(5);\r\n      expect(sessionStats.enemiesKilledByType['ghost']).toBe(5);\r\n      expect(sessionStats.enemiesKilledByWeapon['katana']).toBe(5);\r\n    });\r\n\r\n    it('should track weapon usage', () => {\r\n      const { triggerAchievementCheck } = useAchievementStore.getState();\r\n      \r\n      triggerAchievementCheck('weapon_used', 1, { weapon: 'katana' });\r\n      triggerAchievementCheck('weapon_used', 1, { weapon: 'laser' });\r\n      triggerAchievementCheck('weapon_used', 1, { weapon: 'baseball' });\r\n      \r\n      const { sessionStats } = useAchievementStore.getState();\r\n      \r\n      expect(sessionStats.weaponsUsed.size).toBe(3);\r\n      expect(sessionStats.weaponsUsed.has('katana')).toBe(true);\r\n      expect(sessionStats.weaponsUsed.has('laser')).toBe(true);\r\n      expect(sessionStats.weaponsUsed.has('baseball')).toBe(true);\r\n    });\r\n\r\n    it('should unlock score achievements', () => {\r\n      const { triggerAchievementCheck } = useAchievementStore.getState();\r\n      \r\n      triggerAchievementCheck('score_reached', 5000);\r\n      \r\n      const { progress } = useAchievementStore.getState();\r\n      \r\n      expect(progress['high_scorer'].unlocked).toBe(true);\r\n      expect(progress['high_scorer'].progress).toBe(5000);\r\n    });\r\n\r\n    it('should track life collection', () => {\r\n      const { triggerAchievementCheck } = useAchievementStore.getState();\r\n      \r\n      // Collect 10 life items\r\n      for (let i = 0; i < 10; i++) {\r\n        triggerAchievementCheck('life_collected', 1);\r\n      }\r\n      \r\n      const { sessionStats, progress } = useAchievementStore.getState();\r\n      \r\n      expect(sessionStats.livesCollected).toBe(10);\r\n      expect(progress['life_collector'].progress).toBe(10);\r\n    });\r\n  });\r\n\r\n  describe('Session Stats', () => {\r\n    it('should reset session stats', () => {\r\n      const { triggerAchievementCheck, resetSessionStats } = useAchievementStore.getState();\r\n      \r\n      // Add some session data\r\n      triggerAchievementCheck('enemy_killed', 5, { enemyType: 'ghost', weapon: 'katana' });\r\n      triggerAchievementCheck('life_collected', 3);\r\n      \r\n      let { sessionStats } = useAchievementStore.getState();\r\n      expect(sessionStats.enemiesKilled).toBe(5);\r\n      expect(sessionStats.livesCollected).toBe(3);\r\n      \r\n      // Reset\r\n      resetSessionStats();\r\n      \r\n      sessionStats = useAchievementStore.getState().sessionStats;\r\n      expect(sessionStats.enemiesKilled).toBe(0);\r\n      expect(sessionStats.livesCollected).toBe(0);\r\n      expect(sessionStats.weaponsUsed.size).toBe(0);\r\n    });\r\n  });\r\n\r\n  describe('Achievement Stats', () => {\r\n    beforeEach(() => {\r\n      const { initializeAchievements } = useAchievementStore.getState();\r\n      initializeAchievements();\r\n    });\r\n\r\n    it('should calculate stats correctly', () => {\r\n      const { triggerAchievementCheck } = useAchievementStore.getState();\r\n      \r\n      // Unlock a few achievements\r\n      triggerAchievementCheck('enemy_killed', 1, { enemyType: 'ghost', weapon: 'katana' }); // first_kill (common, 10 points)\r\n      triggerAchievementCheck('score_reached', 5000); // high_scorer (rare, 40 points)\r\n      \r\n      const { stats } = useAchievementStore.getState();\r\n      \r\n      expect(stats.totalUnlocked).toBe(2);\r\n      expect(stats.totalPoints).toBe(50); // 10 + 40\r\n      expect(stats.completionPercentage).toBeGreaterThan(0);\r\n    });\r\n  });\r\n\r\n  describe('Notifications', () => {\r\n    beforeEach(() => {\r\n      const { initializeAchievements } = useAchievementStore.getState();\r\n      initializeAchievements();\r\n    });\r\n\r\n    it('should mark notifications as shown', () => {\r\n      const { triggerAchievementCheck, markNotificationShown } = useAchievementStore.getState();\r\n      \r\n      triggerAchievementCheck('enemy_killed', 1, { enemyType: 'ghost', weapon: 'katana' });\r\n      \r\n      let { notifications } = useAchievementStore.getState();\r\n      expect(notifications[0].shown).toBe(false);\r\n      \r\n      markNotificationShown('first_kill');\r\n      \r\n      notifications = useAchievementStore.getState().notifications;\r\n      expect(notifications[0].shown).toBe(true);\r\n    });\r\n\r\n    it('should clear all notifications', () => {\r\n      const { triggerAchievementCheck, clearNotifications } = useAchievementStore.getState();\r\n      \r\n      triggerAchievementCheck('enemy_killed', 1, { enemyType: 'ghost', weapon: 'katana' });\r\n      triggerAchievementCheck('score_reached', 5000);\r\n      \r\n      let { notifications } = useAchievementStore.getState();\r\n      expect(notifications).toHaveLength(2);\r\n      \r\n      clearNotifications();\r\n      \r\n      notifications = useAchievementStore.getState().notifications;\r\n      expect(notifications).toHaveLength(0);\r\n    });\r\n  });\r\n});","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\store\\__tests__\\gameStore.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\store\\__tests__\\performanceStore.test.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'GraphicsQuality' is defined but never used.","line":1,"column":36,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":51}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { usePerformanceStore, type GraphicsQuality } from '../performanceStore';\r\n\r\ndescribe('Performance Store', () => {\r\n  beforeEach(() => {\r\n    // Reset store state before each test\r\n    usePerformanceStore.getState().resetToDefaults();\r\n  });\r\n\r\n  describe('Graphics Quality Settings', () => {\r\n    it('should set graphics quality and apply preset', () => {\r\n      const store = usePerformanceStore.getState();\r\n      \r\n      store.setGraphicsQuality('low');\r\n      \r\n      const updatedSettings = usePerformanceStore.getState().settings;\r\n      expect(updatedSettings.graphicsQuality).toBe('low');\r\n      expect(updatedSettings.particleEffects).toBe(false);\r\n      expect(updatedSettings.animations).toBe(false);\r\n      expect(updatedSettings.shadows).toBe(false);\r\n      expect(updatedSettings.antialiasing).toBe(false);\r\n      expect(updatedSettings.frameRateLimit).toBe(30);\r\n    });\r\n\r\n    it('should apply medium quality preset correctly', () => {\r\n      const store = usePerformanceStore.getState();\r\n      \r\n      store.setGraphicsQuality('medium');\r\n      \r\n      const updatedSettings = usePerformanceStore.getState().settings;\r\n      expect(updatedSettings.graphicsQuality).toBe('medium');\r\n      expect(updatedSettings.particleEffects).toBe(true);\r\n      expect(updatedSettings.animations).toBe(true);\r\n      expect(updatedSettings.shadows).toBe(false);\r\n      expect(updatedSettings.antialiasing).toBe(false);\r\n      expect(updatedSettings.frameRateLimit).toBe(45);\r\n    });\r\n\r\n    it('should apply high quality preset correctly', () => {\r\n      const store = usePerformanceStore.getState();\r\n      \r\n      store.setGraphicsQuality('high');\r\n      \r\n      const updatedSettings = usePerformanceStore.getState().settings;\r\n      expect(updatedSettings.graphicsQuality).toBe('high');\r\n      expect(updatedSettings.particleEffects).toBe(true);\r\n      expect(updatedSettings.animations).toBe(true);\r\n      expect(updatedSettings.shadows).toBe(true);\r\n      expect(updatedSettings.antialiasing).toBe(true);\r\n      expect(updatedSettings.frameRateLimit).toBe(60);\r\n    });\r\n  });\r\n\r\n  describe('Lightweight Mode', () => {\r\n    it('should enable lightweight mode and apply optimizations', () => {\r\n      const { setLightweightMode, settings } = usePerformanceStore.getState();\r\n      \r\n      setLightweightMode(true);\r\n      \r\n      expect(settings.lightweightMode).toBe(true);\r\n      expect(settings.particleEffects).toBe(false);\r\n      expect(settings.shadows).toBe(false);\r\n      expect(settings.antialiasing).toBe(false);\r\n      expect(settings.frameRateLimit).toBe(30);\r\n      expect(settings.graphicsQuality).toBe('low');\r\n    });\r\n\r\n    it('should disable lightweight mode', () => {\r\n      const { setLightweightMode, settings } = usePerformanceStore.getState();\r\n      \r\n      // First enable it\r\n      setLightweightMode(true);\r\n      expect(settings.lightweightMode).toBe(true);\r\n      \r\n      // Then disable it\r\n      setLightweightMode(false);\r\n      expect(settings.lightweightMode).toBe(false);\r\n    });\r\n  });\r\n\r\n  describe('Individual Settings', () => {\r\n    it('should toggle particle effects', () => {\r\n      const { setParticleEffects, settings } = usePerformanceStore.getState();\r\n      \r\n      setParticleEffects(false);\r\n      expect(settings.particleEffects).toBe(false);\r\n      \r\n      setParticleEffects(true);\r\n      expect(settings.particleEffects).toBe(true);\r\n    });\r\n\r\n    it('should toggle animations', () => {\r\n      const { setAnimations, settings } = usePerformanceStore.getState();\r\n      \r\n      setAnimations(false);\r\n      expect(settings.animations).toBe(false);\r\n      \r\n      setAnimations(true);\r\n      expect(settings.animations).toBe(true);\r\n    });\r\n\r\n    it('should set frame rate limit', () => {\r\n      const { setFrameRateLimit, settings } = usePerformanceStore.getState();\r\n      \r\n      setFrameRateLimit(30);\r\n      expect(settings.frameRateLimit).toBe(30);\r\n      \r\n      setFrameRateLimit(0);\r\n      expect(settings.frameRateLimit).toBe(0);\r\n    });\r\n  });\r\n\r\n  describe('Auto Quality Adjustment', () => {\r\n    it('should enable auto quality adjustment', () => {\r\n      const { setAutoAdjustQuality, settings } = usePerformanceStore.getState();\r\n      \r\n      setAutoAdjustQuality(true);\r\n      expect(settings.autoAdjustQuality).toBe(true);\r\n      \r\n      setAutoAdjustQuality(false);\r\n      expect(settings.autoAdjustQuality).toBe(false);\r\n    });\r\n\r\n    it('should adjust quality based on performance when enabled', () => {\r\n      const { \r\n        setAutoAdjustQuality, \r\n        updateMetrics, \r\n        adjustQualityBasedOnPerformance,\r\n        settings \r\n      } = usePerformanceStore.getState();\r\n      \r\n      // Enable auto adjustment and set to high quality\r\n      setAutoAdjustQuality(true);\r\n      usePerformanceStore.getState().setGraphicsQuality('high');\r\n      \r\n      // Simulate low performance\r\n      updateMetrics({\r\n        currentFPS: 20,\r\n        averageFPS: 20,\r\n        frameTime: 50,\r\n        isLowPerformance: true,\r\n        lastAdjustment: 0,\r\n      });\r\n      \r\n      // Trigger adjustment\r\n      adjustQualityBasedOnPerformance();\r\n      \r\n      // Should reduce quality\r\n      expect(settings.graphicsQuality).toBe('medium');\r\n    });\r\n\r\n    it('should not adjust quality when auto adjustment is disabled', () => {\r\n      const { \r\n        setAutoAdjustQuality, \r\n        updateMetrics, \r\n        adjustQualityBasedOnPerformance,\r\n        settings \r\n      } = usePerformanceStore.getState();\r\n      \r\n      // Disable auto adjustment and set to high quality\r\n      setAutoAdjustQuality(false);\r\n      usePerformanceStore.getState().setGraphicsQuality('high');\r\n      \r\n      // Simulate low performance\r\n      updateMetrics({\r\n        currentFPS: 20,\r\n        averageFPS: 20,\r\n        frameTime: 50,\r\n        isLowPerformance: true,\r\n        lastAdjustment: 0,\r\n      });\r\n      \r\n      // Trigger adjustment\r\n      adjustQualityBasedOnPerformance();\r\n      \r\n      // Should not change quality\r\n      expect(settings.graphicsQuality).toBe('high');\r\n    });\r\n  });\r\n\r\n  describe('Metrics Update', () => {\r\n    it('should update performance metrics', () => {\r\n      const { updateMetrics, metrics } = usePerformanceStore.getState();\r\n      \r\n      const newMetrics = {\r\n        currentFPS: 45,\r\n        averageFPS: 50,\r\n        frameTime: 22,\r\n        isLowPerformance: false,\r\n        memoryUsage: 85,\r\n      };\r\n      \r\n      updateMetrics(newMetrics);\r\n      \r\n      expect(metrics.currentFPS).toBe(45);\r\n      expect(metrics.averageFPS).toBe(50);\r\n      expect(metrics.frameTime).toBe(22);\r\n      expect(metrics.isLowPerformance).toBe(false);\r\n      expect(metrics.memoryUsage).toBe(85);\r\n    });\r\n  });\r\n\r\n  describe('Reset to Defaults', () => {\r\n    it('should reset all settings to defaults', () => {\r\n      const { \r\n        setGraphicsQuality, \r\n        setLightweightMode, \r\n        setFrameRateLimit,\r\n        resetToDefaults,\r\n        settings \r\n      } = usePerformanceStore.getState();\r\n      \r\n      // Change some settings\r\n      setGraphicsQuality('low');\r\n      setLightweightMode(true);\r\n      setFrameRateLimit(15);\r\n      \r\n      // Reset to defaults\r\n      resetToDefaults();\r\n      \r\n      // Should be back to defaults\r\n      expect(settings.graphicsQuality).toBe('high');\r\n      expect(settings.lightweightMode).toBe(false);\r\n      expect(settings.frameRateLimit).toBe(0);\r\n      expect(settings.autoAdjustQuality).toBe(true);\r\n      expect(settings.particleEffects).toBe(true);\r\n      expect(settings.animations).toBe(true);\r\n      expect(settings.shadows).toBe(true);\r\n      expect(settings.antialiasing).toBe(true);\r\n    });\r\n  });\r\n});","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\store\\achievementStore.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":33,"column":100,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":33,"endColumn":103,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[988,991],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[988,991],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":200,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":200,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6488,6491],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6488,6491],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":203,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":203,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6571,6574],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6571,6574],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":248,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":248,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7859,7862],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7859,7862],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":251,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":251,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7942,7945],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7942,7945],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":252,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":252,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7965,7968],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7965,7968],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":297,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":297,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9207,9210],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9207,9210],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":300,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":300,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9290,9293],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9290,9293],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":301,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":301,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9313,9316],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9313,9316],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { create } from 'zustand';\r\nimport { persist } from 'zustand/middleware';\r\nimport { \r\n  Achievement, \r\n  AchievementProgress, \r\n  AchievementNotification, \r\n  AchievementStats,\r\n  AchievementTrigger,\r\n  ACHIEVEMENT_DEFINITIONS,\r\n  ACHIEVEMENT_CONDITIONS\r\n} from '../types/achievements';\r\n\r\ninterface AchievementState {\r\n  // Achievement progress tracking\r\n  progress: Record<string, AchievementProgress>;\r\n  notifications: AchievementNotification[];\r\n  stats: AchievementStats;\r\n  \r\n  // Session tracking for achievements\r\n  sessionStats: {\r\n    enemiesKilled: number;\r\n    enemiesKilledByType: Record<string, number>;\r\n    enemiesKilledByWeapon: Record<string, number>;\r\n    livesCollected: number;\r\n    weaponsUsed: Set<string>;\r\n    gameStartTime?: number;\r\n    perfectRun: boolean;\r\n    bazookaMultiKills: number;\r\n  };\r\n  \r\n  // Actions\r\n  initializeAchievements: () => void;\r\n  triggerAchievementCheck: (trigger: AchievementTrigger, value?: number, metadata?: Record<string, any>) => void;\r\n  markNotificationShown: (achievementId: string) => void;\r\n  clearNotifications: () => void;\r\n  resetSessionStats: () => void;\r\n  getUnlockedAchievements: () => Achievement[];\r\n  getAchievementStats: () => AchievementStats;\r\n}\r\n\r\nconst initialSessionStats = {\r\n  enemiesKilled: 0,\r\n  enemiesKilledByType: {},\r\n  enemiesKilledByWeapon: {},\r\n  livesCollected: 0,\r\n  weaponsUsed: new Set<string>(),\r\n  gameStartTime: undefined,\r\n  perfectRun: true,\r\n  bazookaMultiKills: 0\r\n};\r\n\r\nexport const useAchievementStore = create<AchievementState>()(\r\n  persist(\r\n    (set, get) => ({\r\n      progress: {},\r\n      notifications: [],\r\n      stats: {\r\n        totalUnlocked: 0,\r\n        totalPoints: 0,\r\n        completionPercentage: 0,\r\n        rareAchievements: 0,\r\n        epicAchievements: 0,\r\n        legendaryAchievements: 0\r\n      },\r\n      sessionStats: { ...initialSessionStats },\r\n\r\n      initializeAchievements: () => {\r\n        set((state) => {\r\n          const newProgress = { ...state.progress };\r\n          \r\n          // Initialize progress for all achievements if not already present\r\n          ACHIEVEMENT_DEFINITIONS.forEach((achievement) => {\r\n            if (!newProgress[achievement.id]) {\r\n              newProgress[achievement.id] = {\r\n                achievementId: achievement.id,\r\n                progress: 0,\r\n                maxProgress: achievement.maxProgress || 1,\r\n                unlocked: false\r\n              };\r\n            }\r\n          });\r\n          \r\n          return {\r\n            progress: newProgress,\r\n            stats: calculateStats(newProgress)\r\n          };\r\n        });\r\n      },\r\n\r\n      triggerAchievementCheck: (trigger: AchievementTrigger, value = 1, metadata = {}) => {\r\n        set((state) => {\r\n          const newState = { ...state };\r\n          const newNotifications: AchievementNotification[] = [];\r\n          \r\n          // Update session stats based on trigger\r\n          updateSessionStats(newState.sessionStats, trigger, value, metadata);\r\n          \r\n          // Check each achievement for completion\r\n          ACHIEVEMENT_DEFINITIONS.forEach((achievement) => {\r\n            const conditions = ACHIEVEMENT_CONDITIONS[achievement.id];\r\n            if (!conditions) return;\r\n            \r\n            const progress = newState.progress[achievement.id];\r\n            if (!progress || progress.unlocked) return;\r\n            \r\n            // Check if this trigger matches any condition for this achievement\r\n            const matchingCondition = conditions.find(condition => condition.trigger === trigger);\r\n            if (!matchingCondition) return;\r\n            \r\n            // Calculate progress based on the trigger and conditions\r\n            const newProgress = calculateAchievementProgress(\r\n              achievement,\r\n              matchingCondition,\r\n              trigger,\r\n              value,\r\n              metadata,\r\n              newState.sessionStats\r\n            );\r\n            \r\n            // Update progress\r\n            newState.progress[achievement.id] = {\r\n              ...progress,\r\n              progress: newProgress\r\n            };\r\n            \r\n            // Check if achievement is now unlocked\r\n            if (newProgress >= (achievement.maxProgress || 1) && !progress.unlocked) {\r\n              newState.progress[achievement.id].unlocked = true;\r\n              newState.progress[achievement.id].unlockedAt = new Date().toISOString();\r\n              \r\n              // Add notification\r\n              newNotifications.push({\r\n                achievement,\r\n                timestamp: Date.now(),\r\n                shown: false\r\n              });\r\n              \r\n              // Announce achievement for screen readers\r\n              if (typeof window !== 'undefined') {\r\n                window.dispatchEvent(new CustomEvent('screenReaderAnnounce', {\r\n                  detail: { \r\n                    message: `Conquista desbloqueada: ${achievement.name} - ${achievement.description}`,\r\n                    priority: 'assertive'\r\n                  }\r\n                }));\r\n              }\r\n            }\r\n          });\r\n          \r\n          return {\r\n            ...newState,\r\n            notifications: [...newState.notifications, ...newNotifications],\r\n            stats: calculateStats(newState.progress)\r\n          };\r\n        });\r\n      },\r\n\r\n      markNotificationShown: (achievementId: string) => {\r\n        set((state) => ({\r\n          notifications: state.notifications.map(notification =>\r\n            notification.achievement.id === achievementId\r\n              ? { ...notification, shown: true }\r\n              : notification\r\n          )\r\n        }));\r\n      },\r\n\r\n      clearNotifications: () => {\r\n        set({ notifications: [] });\r\n      },\r\n\r\n      resetSessionStats: () => {\r\n        set({ sessionStats: { ...initialSessionStats } });\r\n      },\r\n\r\n      getUnlockedAchievements: () => {\r\n        const state = get();\r\n        return ACHIEVEMENT_DEFINITIONS.filter(achievement => \r\n          state.progress[achievement.id]?.unlocked\r\n        );\r\n      },\r\n\r\n      getAchievementStats: () => {\r\n        return get().stats;\r\n      }\r\n    }),\r\n    {\r\n      name: 'achievement-storage',\r\n      // Only persist progress and stats, not session data or notifications\r\n      partialize: (state) => ({\r\n        progress: state.progress,\r\n        stats: state.stats\r\n      })\r\n    }\r\n  )\r\n);\r\n\r\n// Helper function to update session stats\r\nfunction updateSessionStats(\r\n  sessionStats: any,\r\n  trigger: AchievementTrigger,\r\n  value: number,\r\n  metadata: Record<string, any>\r\n): void {\r\n  switch (trigger) {\r\n    case 'enemy_killed':\r\n      sessionStats.enemiesKilled += value;\r\n      \r\n      if (metadata.enemyType) {\r\n        sessionStats.enemiesKilledByType[metadata.enemyType] = \r\n          (sessionStats.enemiesKilledByType[metadata.enemyType] || 0) + value;\r\n      }\r\n      \r\n      if (metadata.weapon) {\r\n        sessionStats.enemiesKilledByWeapon[metadata.weapon] = \r\n          (sessionStats.enemiesKilledByWeapon[metadata.weapon] || 0) + value;\r\n      }\r\n      \r\n      if (metadata.weapon === 'bazooka' && metadata.multiKill) {\r\n        sessionStats.bazookaMultiKills = Math.max(sessionStats.bazookaMultiKills, value);\r\n      }\r\n      break;\r\n      \r\n    case 'life_collected':\r\n      sessionStats.livesCollected += value;\r\n      break;\r\n      \r\n    case 'weapon_used':\r\n      if (metadata.weapon) {\r\n        sessionStats.weaponsUsed.add(metadata.weapon);\r\n      }\r\n      break;\r\n      \r\n    case 'game_started':\r\n      sessionStats.gameStartTime = Date.now();\r\n      sessionStats.perfectRun = true;\r\n      break;\r\n      \r\n    case 'damage_taken':\r\n      sessionStats.perfectRun = false;\r\n      break;\r\n  }\r\n}\r\n\r\n// Helper function to calculate achievement progress\r\nfunction calculateAchievementProgress(\r\n  achievement: Achievement,\r\n  condition: any,\r\n  trigger: AchievementTrigger,\r\n  value: number,\r\n  metadata: Record<string, any>,\r\n  sessionStats: any\r\n): number {\r\n  switch (achievement.id) {\r\n    case 'first_kill':\r\n    case 'survivor':\r\n    case 'iron_will':\r\n    case 'speed_runner':\r\n    case 'perfectionist':\r\n    case 'bazooka_expert':\r\n    case 'brave_boy':\r\n    case 'brave_girl':\r\n      // Binary achievements - either 0 or max progress\r\n      return checkCondition(condition, trigger, value, metadata, sessionStats) ? \r\n        (achievement.maxProgress || 1) : 0;\r\n      \r\n    case 'enemy_slayer':\r\n      return sessionStats.enemiesKilled;\r\n      \r\n    case 'ghost_hunter':\r\n      return sessionStats.enemiesKilledByType['ghost'] || 0;\r\n      \r\n    case 'vampire_slayer':\r\n      return sessionStats.enemiesKilledByType['vampire'] || 0;\r\n      \r\n    case 'weapon_master':\r\n      return sessionStats.weaponsUsed.size;\r\n      \r\n    case 'life_collector':\r\n      return sessionStats.livesCollected;\r\n      \r\n    case 'high_scorer':\r\n    case 'score_master':\r\n    case 'legendary_score':\r\n      return trigger === 'score_reached' ? value : 0;\r\n      \r\n    case 'katana_master':\r\n      return sessionStats.enemiesKilledByWeapon['katana'] || 0;\r\n      \r\n    default:\r\n      return 0;\r\n  }\r\n}\r\n\r\n// Helper function to check if a condition is met\r\nfunction checkCondition(\r\n  condition: any,\r\n  trigger: AchievementTrigger,\r\n  value: number,\r\n  metadata: Record<string, any>,\r\n  sessionStats: any\r\n): boolean {\r\n  if (condition.trigger !== trigger) return false;\r\n  \r\n  // Check metadata conditions\r\n  if (condition.metadata) {\r\n    for (const [key, expectedValue] of Object.entries(condition.metadata)) {\r\n      if (key === 'enemyType' && metadata.enemyType !== expectedValue) return false;\r\n      if (key === 'weapon' && metadata.weapon !== expectedValue) return false;\r\n      if (key === 'character' && metadata.character !== expectedValue) return false;\r\n      if (key === 'difficulty' && metadata.difficulty !== expectedValue) return false;\r\n      if (key === 'minDifficulty') {\r\n        const difficultyOrder = ['easy', 'medium', 'impossible'];\r\n        const currentIndex = difficultyOrder.indexOf(metadata.difficulty);\r\n        const minIndex = difficultyOrder.indexOf(expectedValue as string);\r\n        if (currentIndex < minIndex) return false;\r\n      }\r\n      if (key === 'livesRemaining' && metadata.livesRemaining !== expectedValue) return false;\r\n      if (key === 'timeInSeconds' && sessionStats.gameStartTime) {\r\n        const gameTime = (Date.now() - sessionStats.gameStartTime) / 1000;\r\n        if (gameTime >= (condition.value || 0)) return false;\r\n      }\r\n      if (key === 'singleShot' && sessionStats.bazookaMultiKills < (condition.value || 0)) return false;\r\n    }\r\n  }\r\n  \r\n  // Check value condition\r\n  if (condition.value !== undefined) {\r\n    switch (condition.comparison) {\r\n      case 'equals': return value === condition.value;\r\n      case 'greater': return value > condition.value;\r\n      case 'less': return value < condition.value;\r\n      case 'greater_equal': return value >= condition.value;\r\n      case 'less_equal': return value <= condition.value;\r\n      default: return value >= condition.value;\r\n    }\r\n  }\r\n  \r\n  return true;\r\n}\r\n\r\n// Helper function to calculate achievement stats\r\nfunction calculateStats(progress: Record<string, AchievementProgress>): AchievementStats {\r\n  const unlockedAchievements = Object.values(progress).filter(p => p.unlocked);\r\n  const totalAchievements = ACHIEVEMENT_DEFINITIONS.length;\r\n  \r\n  let totalPoints = 0;\r\n  let rareAchievements = 0;\r\n  let epicAchievements = 0;\r\n  let legendaryAchievements = 0;\r\n  \r\n  unlockedAchievements.forEach(progress => {\r\n    const achievement = ACHIEVEMENT_DEFINITIONS.find(a => a.id === progress.achievementId);\r\n    if (achievement) {\r\n      totalPoints += achievement.points;\r\n      \r\n      switch (achievement.rarity) {\r\n        case 'rare': rareAchievements++; break;\r\n        case 'epic': epicAchievements++; break;\r\n        case 'legendary': legendaryAchievements++; break;\r\n      }\r\n    }\r\n  });\r\n  \r\n  return {\r\n    totalUnlocked: unlockedAchievements.length,\r\n    totalPoints,\r\n    completionPercentage: Math.round((unlockedAchievements.length / totalAchievements) * 100),\r\n    rareAchievements,\r\n    epicAchievements,\r\n    legendaryAchievements\r\n  };\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\store\\audioStore.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\store\\example-usage.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'firstName' is assigned a value but never used.","line":9,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":9,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'lastName' is assigned a value but never used.","line":10,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":10,"endColumn":13},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'character' is assigned a value but never used.","line":11,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":11,"endColumn":14},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'weapon' is assigned a value but never used.","line":12,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'difficulty' is assigned a value but never used.","line":13,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'gameStatus' is assigned a value but never used.","line":16,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":16,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleNameSubmit' is assigned a value but never used.","line":30,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":30,"endColumn":25},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleCharacterSelect' is assigned a value but never used.","line":35,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":35,"endColumn":30},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleWeaponSelect' is assigned a value but never used.","line":40,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":40,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleDifficultySelect' is assigned a value but never used.","line":45,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":45,"endColumn":31},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handlePlayerDamage' is assigned a value but never used.","line":50,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":50,"endColumn":27},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'handleScoreIncrease' is assigned a value but never used.","line":56,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":56,"endColumn":28},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'startGame' is assigned a value but never used.","line":61,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":61,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'pauseGame' is assigned a value but never used.","line":65,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":65,"endColumn":18},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'endGame' is assigned a value but never used.","line":69,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":69,"endColumn":16},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'startNewGame' is assigned a value but never used.","line":74,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":74,"endColumn":21},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":87,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":87,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2111,2114],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2111,2114],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":16,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Example usage of the GameStore\r\n// This file demonstrates how to use the store in components\r\n\r\nimport { useGameStore } from './gameStore';\r\n\r\n// Example React component usage\r\nexport function ExampleComponent() {\r\n  const {\r\n    firstName,\r\n    lastName,\r\n    character,\r\n    weapon,\r\n    difficulty,\r\n    lives,\r\n    score,\r\n    gameStatus,\r\n    setPlayerName,\r\n    setCharacter,\r\n    setWeapon,\r\n    setDifficulty,\r\n    updateLives,\r\n    updateScore,\r\n    setGameStatus,\r\n    resetGame\r\n  } = useGameStore();\r\n\r\n  // Example usage patterns:\r\n  \r\n  // Setting player name (Requirement 1.3)\r\n  const handleNameSubmit = (first: string, last: string) => {\r\n    setPlayerName(first, last);\r\n  };\r\n\r\n  // Setting character selection (Requirement 2.4)\r\n  const handleCharacterSelect = (selectedCharacter: 'boy' | 'girl') => {\r\n    setCharacter(selectedCharacter);\r\n  };\r\n\r\n  // Setting weapon selection (Requirement 2.4)\r\n  const handleWeaponSelect = (selectedWeapon: 'katana' | 'laser' | 'baseball' | 'bazooka') => {\r\n    setWeapon(selectedWeapon);\r\n  };\r\n\r\n  // Setting difficulty (Requirement 2.6)\r\n  const handleDifficultySelect = (selectedDifficulty: 'easy' | 'medium' | 'impossible') => {\r\n    setDifficulty(selectedDifficulty);\r\n  };\r\n\r\n  // Game progress updates (Requirement 7.1)\r\n  const handlePlayerDamage = () => {\r\n    if (lives > 0) {\r\n      updateLives(lives - 1);\r\n    }\r\n  };\r\n\r\n  const handleScoreIncrease = (points: number) => {\r\n    updateScore(score + points);\r\n  };\r\n\r\n  // Game state management\r\n  const startGame = () => {\r\n    setGameStatus('playing');\r\n  };\r\n\r\n  const pauseGame = () => {\r\n    setGameStatus('paused');\r\n  };\r\n\r\n  const endGame = () => {\r\n    setGameStatus('finished');\r\n  };\r\n\r\n  // Reset everything when starting a new game\r\n  const startNewGame = () => {\r\n    resetGame();\r\n  };\r\n\r\n  return null; // This is just an example file\r\n}\r\n\r\n// Example of accessing store outside of React components\r\nexport function getGameState() {\r\n  return useGameStore.getState();\r\n}\r\n\r\n// Example of subscribing to store changes\r\nexport function subscribeToGameState(callback: (state: any) => void) {\r\n  return useGameStore.subscribe(callback);\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\store\\gameStore.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'state' is defined but never used. Allowed unused args must match /^_/u.","line":78,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":78,"endColumn":15},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":79,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":79,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2380,2383],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2380,2383],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { create } from 'zustand';\r\nimport { analyticsService } from '@/lib/analytics';\r\n\r\nexport type Character = 'boy' | 'girl';\r\nexport type Weapon = 'katana' | 'laser' | 'baseball' | 'bazooka';\r\nexport type Difficulty = 'easy' | 'medium' | 'impossible';\r\nexport type GameStatus = 'menu' | 'playing' | 'paused' | 'finished';\r\nexport type GameMode = 'story' | 'endless' | 'timeAttack' | 'survival' | 'practice';\r\n\r\ninterface GameState {\r\n  // Player data\r\n  firstName: string;\r\n  lastName: string;\r\n  character: Character | null;\r\n  weapon: Weapon | null;\r\n  difficulty: Difficulty | null;\r\n  gameMode: GameMode | null;\r\n  \r\n  // Game progress\r\n  lives: number;\r\n  score: number;\r\n  gameStatus: GameStatus;\r\n  \r\n  // Game mode specific data\r\n  timeRemaining?: number; // For time attack mode\r\n  survivalLives?: number; // For survival mode (limited lives)\r\n  \r\n  // Actions\r\n  setPlayerName: (firstName: string, lastName: string) => void;\r\n  setCharacter: (character: Character) => void;\r\n  setWeapon: (weapon: Weapon) => void;\r\n  setDifficulty: (difficulty: Difficulty) => void;\r\n  setGameMode: (gameMode: GameMode) => void;\r\n  updateLives: (lives: number) => void;\r\n  updateScore: (score: number) => void;\r\n  setGameStatus: (status: GameStatus) => void;\r\n  updateTimeRemaining: (time: number) => void;\r\n  updateSurvivalLives: (lives: number) => void;\r\n  resetGame: () => void;\r\n}\r\n\r\nconst initialState = {\r\n  firstName: '',\r\n  lastName: '',\r\n  character: null as Character | null,\r\n  weapon: null as Weapon | null,\r\n  difficulty: null as Difficulty | null,\r\n  gameMode: null as GameMode | null,\r\n  lives: 10, // Starting with 10 lives as per requirement 7.1\r\n  score: 0,\r\n  gameStatus: 'menu' as GameStatus,\r\n  timeRemaining: undefined,\r\n  survivalLives: undefined,\r\n};\r\n\r\nexport const useGameStore = create<GameState>((set) => ({\r\n  ...initialState,\r\n  \r\n  // Player data actions\r\n  setPlayerName: (firstName: string, lastName: string) =>\r\n    set({ firstName, lastName }),\r\n  \r\n  setCharacter: (character: Character) => {\r\n    set({ character });\r\n  },\r\n  \r\n  setWeapon: (weapon: Weapon) => {\r\n    set({ weapon });\r\n    // Track weapon selection\r\n    analyticsService.trackWeaponUsage(weapon);\r\n  },\r\n  \r\n  setDifficulty: (difficulty: Difficulty) => {\r\n    set({ difficulty });\r\n  },\r\n  \r\n  setGameMode: (gameMode: GameMode) => {\r\n    set((state) => {\r\n      const newState: any = { gameMode };\r\n      \r\n      // Initialize mode-specific data\r\n      if (gameMode === 'timeAttack') {\r\n        newState.timeRemaining = 300; // 5 minutes in seconds\r\n      } else if (gameMode === 'survival') {\r\n        newState.survivalLives = 3; // Limited lives for survival mode\r\n        newState.lives = 3;\r\n      } else if (gameMode === 'practice') {\r\n        newState.lives = 999; // Unlimited lives for practice\r\n      } else {\r\n        // Reset mode-specific data for other modes\r\n        newState.timeRemaining = undefined;\r\n        newState.survivalLives = undefined;\r\n        newState.lives = 10; // Default lives\r\n      }\r\n      \r\n      return newState;\r\n    });\r\n  },\r\n  \r\n  // Game progress actions\r\n  updateLives: (lives: number) => {\r\n    set((state) => {\r\n      const newState = { lives };\r\n      \r\n      // Track progression when lives or score change\r\n      if (state.difficulty) {\r\n        analyticsService.trackProgression(state.difficulty, state.score, lives);\r\n      }\r\n      \r\n      // Announce life changes for screen readers (client-side only)\r\n      if (typeof window !== 'undefined') {\r\n        if (lives < state.lives) {\r\n          const livesLost = state.lives - lives;\r\n          window.dispatchEvent(new CustomEvent('screenReaderAnnounce', {\r\n            detail: { \r\n              message: `Perdeu ${livesLost} vida${livesLost > 1 ? 's' : ''}. Vidas restantes: ${lives}`,\r\n              priority: 'assertive'\r\n            }\r\n          }));\r\n        } else if (lives > state.lives) {\r\n          const livesGained = lives - state.lives;\r\n          window.dispatchEvent(new CustomEvent('screenReaderAnnounce', {\r\n            detail: { \r\n              message: `Ganhou ${livesGained} vida${livesGained > 1 ? 's' : ''}. Total de vidas: ${lives}`,\r\n              priority: 'polite'\r\n            }\r\n          }));\r\n        }\r\n      }\r\n      \r\n      return newState;\r\n    });\r\n  },\r\n  \r\n  updateScore: (score: number) => {\r\n    set((state) => {\r\n      const newState = { score };\r\n      \r\n      // Track progression when score changes\r\n      if (state.difficulty) {\r\n        analyticsService.trackProgression(state.difficulty, score, state.lives);\r\n      }\r\n      \r\n      // Announce significant score increases for screen readers (client-side only)\r\n      if (typeof window !== 'undefined' && score > state.score) {\r\n        const scoreIncrease = score - state.score;\r\n        if (scoreIncrease >= 100) { // Only announce significant score changes\r\n          window.dispatchEvent(new CustomEvent('screenReaderAnnounce', {\r\n            detail: { \r\n              message: `Pontuao aumentou para ${score.toLocaleString()} pontos`,\r\n              priority: 'polite'\r\n            }\r\n          }));\r\n        }\r\n      }\r\n      \r\n      return newState;\r\n    });\r\n  },\r\n  \r\n  setGameStatus: (gameStatus: GameStatus) => {\r\n    set((state) => {\r\n      // Track game completion when status changes to finished\r\n      if (gameStatus === 'finished' && state.difficulty) {\r\n        const survived = state.lives > 0;\r\n        analyticsService.trackGameCompletion(state.difficulty, state.score, survived);\r\n      }\r\n      \r\n      // Set session info when game starts\r\n      if (gameStatus === 'playing' && state.character && state.weapon && state.difficulty) {\r\n        analyticsService.setSessionInfo(state.character, state.weapon, state.difficulty);\r\n      }\r\n      \r\n      return { gameStatus };\r\n    });\r\n  },\r\n  \r\n  updateTimeRemaining: (timeRemaining: number) => {\r\n    set({ timeRemaining });\r\n  },\r\n  \r\n  updateSurvivalLives: (survivalLives: number) => {\r\n    set({ survivalLives });\r\n  },\r\n  \r\n  // Reset game action - clears all state back to initial values\r\n  resetGame: () =>\r\n    set(initialState),\r\n}));","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\store\\gameValidation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\store\\performanceStore.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\store\\settingsStore.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\types\\achievements.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":58,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":58,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1515,1518],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1515,1518],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Achievement system types and definitions\r\n\r\nexport interface Achievement {\r\n  id: string;\r\n  name: string;\r\n  description: string;\r\n  icon: string;\r\n  category: 'combat' | 'survival' | 'exploration' | 'mastery' | 'special';\r\n  rarity: 'common' | 'rare' | 'epic' | 'legendary';\r\n  points: number; // Achievement points for rewards\r\n  unlockedAt?: string; // ISO timestamp when unlocked\r\n  progress?: number; // Current progress (0-100)\r\n  maxProgress?: number; // Maximum progress needed\r\n}\r\n\r\nexport interface AchievementProgress {\r\n  achievementId: string;\r\n  progress: number;\r\n  maxProgress: number;\r\n  unlocked: boolean;\r\n  unlockedAt?: string;\r\n}\r\n\r\nexport interface AchievementNotification {\r\n  achievement: Achievement;\r\n  timestamp: number;\r\n  shown: boolean;\r\n}\r\n\r\nexport interface AchievementStats {\r\n  totalUnlocked: number;\r\n  totalPoints: number;\r\n  completionPercentage: number;\r\n  rareAchievements: number;\r\n  epicAchievements: number;\r\n  legendaryAchievements: number;\r\n}\r\n\r\n// Achievement trigger events\r\nexport type AchievementTrigger = \r\n  | 'enemy_killed'\r\n  | 'life_collected'\r\n  | 'game_completed'\r\n  | 'game_started'\r\n  | 'weapon_used'\r\n  | 'damage_taken'\r\n  | 'score_reached'\r\n  | 'lives_remaining'\r\n  | 'difficulty_completed'\r\n  | 'perfect_run'\r\n  | 'speed_run'\r\n  | 'survival_time';\r\n\r\nexport interface AchievementCondition {\r\n  trigger: AchievementTrigger;\r\n  value?: number;\r\n  comparison?: 'equals' | 'greater' | 'less' | 'greater_equal' | 'less_equal';\r\n  metadata?: Record<string, any>;\r\n}\r\n\r\n// Achievement definitions - based on requirements 7.1, 7.2, 9.1\r\nexport const ACHIEVEMENT_DEFINITIONS: Achievement[] = [\r\n  // Combat achievements\r\n  {\r\n    id: 'first_kill',\r\n    name: 'Primeiro Sangue',\r\n    description: 'Elimine o seu primeiro inimigo',\r\n    icon: '',\r\n    category: 'combat',\r\n    rarity: 'common',\r\n    points: 10,\r\n    maxProgress: 1\r\n  },\r\n  {\r\n    id: 'enemy_slayer',\r\n    name: 'Caador de Monstros',\r\n    description: 'Elimine 50 inimigos',\r\n    icon: '',\r\n    category: 'combat',\r\n    rarity: 'rare',\r\n    points: 50,\r\n    maxProgress: 50\r\n  },\r\n  {\r\n    id: 'ghost_hunter',\r\n    name: 'Caa-Fantasmas',\r\n    description: 'Elimine 25 fantasmas',\r\n    icon: '',\r\n    category: 'combat',\r\n    rarity: 'rare',\r\n    points: 30,\r\n    maxProgress: 25\r\n  },\r\n  {\r\n    id: 'vampire_slayer',\r\n    name: 'Matador de Vampiros',\r\n    description: 'Elimine 20 vampiros',\r\n    icon: '',\r\n    category: 'combat',\r\n    rarity: 'rare',\r\n    points: 35,\r\n    maxProgress: 20\r\n  },\r\n  {\r\n    id: 'weapon_master',\r\n    name: 'Mestre das Armas',\r\n    description: 'Use todas as 4 armas pelo menos uma vez',\r\n    icon: '',\r\n    category: 'mastery',\r\n    rarity: 'epic',\r\n    points: 75,\r\n    maxProgress: 4\r\n  },\r\n\r\n  // Survival achievements\r\n  {\r\n    id: 'survivor',\r\n    name: 'Sobrevivente',\r\n    description: 'Complete o jogo sem perder uma vida',\r\n    icon: '',\r\n    category: 'survival',\r\n    rarity: 'epic',\r\n    points: 100,\r\n    maxProgress: 1\r\n  },\r\n  {\r\n    id: 'life_collector',\r\n    name: 'Colecionador de Vidas',\r\n    description: 'Colete 20 itens de vida',\r\n    icon: '',\r\n    category: 'exploration',\r\n    rarity: 'common',\r\n    points: 25,\r\n    maxProgress: 20\r\n  },\r\n  {\r\n    id: 'iron_will',\r\n    name: 'Vontade de Ferro',\r\n    description: 'Complete o jogo no nvel Impossvel',\r\n    icon: '',\r\n    category: 'mastery',\r\n    rarity: 'legendary',\r\n    points: 200,\r\n    maxProgress: 1\r\n  },\r\n\r\n  // Score achievements\r\n  {\r\n    id: 'high_scorer',\r\n    name: 'Pontuador',\r\n    description: 'Alcance 5000 pontos',\r\n    icon: '',\r\n    category: 'mastery',\r\n    rarity: 'rare',\r\n    points: 40,\r\n    maxProgress: 5000\r\n  },\r\n  {\r\n    id: 'score_master',\r\n    name: 'Mestre da Pontuao',\r\n    description: 'Alcance 10000 pontos',\r\n    icon: '',\r\n    category: 'mastery',\r\n    rarity: 'epic',\r\n    points: 80,\r\n    maxProgress: 10000\r\n  },\r\n  {\r\n    id: 'legendary_score',\r\n    name: 'Pontuao Lendria',\r\n    description: 'Alcance 20000 pontos',\r\n    icon: '',\r\n    category: 'mastery',\r\n    rarity: 'legendary',\r\n    points: 150,\r\n    maxProgress: 20000\r\n  },\r\n\r\n  // Special achievements\r\n  {\r\n    id: 'speed_runner',\r\n    name: 'Corredor Veloz',\r\n    description: 'Complete o jogo em menos de 5 minutos',\r\n    icon: '',\r\n    category: 'special',\r\n    rarity: 'epic',\r\n    points: 90,\r\n    maxProgress: 1\r\n  },\r\n  {\r\n    id: 'perfectionist',\r\n    name: 'Perfeccionista',\r\n    description: 'Complete o jogo coletando todos os itens de vida disponveis',\r\n    icon: '',\r\n    category: 'special',\r\n    rarity: 'legendary',\r\n    points: 120,\r\n    maxProgress: 1\r\n  },\r\n  {\r\n    id: 'katana_master',\r\n    name: 'Mestre da Katana',\r\n    description: 'Elimine 30 inimigos usando apenas a Katana',\r\n    icon: '',\r\n    category: 'mastery',\r\n    rarity: 'rare',\r\n    points: 45,\r\n    maxProgress: 30\r\n  },\r\n  {\r\n    id: 'bazooka_expert',\r\n    name: 'Especialista em Bazuca',\r\n    description: 'Elimine 5 inimigos com uma nica munio de bazuca',\r\n    icon: '',\r\n    category: 'mastery',\r\n    rarity: 'epic',\r\n    points: 85,\r\n    maxProgress: 1\r\n  },\r\n\r\n  // Character-specific achievements\r\n  {\r\n    id: 'brave_boy',\r\n    name: 'Menino Corajoso',\r\n    description: 'Complete o jogo como menino no nvel Mdio ou superior',\r\n    icon: '',\r\n    category: 'special',\r\n    rarity: 'rare',\r\n    points: 50,\r\n    maxProgress: 1\r\n  },\r\n  {\r\n    id: 'brave_girl',\r\n    name: 'Menina Corajosa',\r\n    description: 'Complete o jogo como menina no nvel Mdio ou superior',\r\n    icon: '',\r\n    category: 'special',\r\n    rarity: 'rare',\r\n    points: 50,\r\n    maxProgress: 1\r\n  }\r\n];\r\n\r\n// Achievement conditions mapping\r\nexport const ACHIEVEMENT_CONDITIONS: Record<string, AchievementCondition[]> = {\r\n  first_kill: [{ trigger: 'enemy_killed', value: 1, comparison: 'greater_equal' }],\r\n  enemy_slayer: [{ trigger: 'enemy_killed', value: 50, comparison: 'greater_equal' }],\r\n  ghost_hunter: [{ trigger: 'enemy_killed', value: 25, comparison: 'greater_equal', metadata: { enemyType: 'ghost' } }],\r\n  vampire_slayer: [{ trigger: 'enemy_killed', value: 20, comparison: 'greater_equal', metadata: { enemyType: 'vampire' } }],\r\n  weapon_master: [{ trigger: 'weapon_used', value: 4, comparison: 'greater_equal', metadata: { uniqueWeapons: true } }],\r\n  survivor: [{ trigger: 'game_completed', value: 10, comparison: 'equals', metadata: { livesRemaining: 10 } }],\r\n  life_collector: [{ trigger: 'life_collected', value: 20, comparison: 'greater_equal' }],\r\n  iron_will: [{ trigger: 'difficulty_completed', value: 1, comparison: 'greater_equal', metadata: { difficulty: 'impossible' } }],\r\n  high_scorer: [{ trigger: 'score_reached', value: 5000, comparison: 'greater_equal' }],\r\n  score_master: [{ trigger: 'score_reached', value: 10000, comparison: 'greater_equal' }],\r\n  legendary_score: [{ trigger: 'score_reached', value: 20000, comparison: 'greater_equal' }],\r\n  speed_runner: [{ trigger: 'game_completed', value: 300, comparison: 'less', metadata: { timeInSeconds: true } }],\r\n  perfectionist: [{ trigger: 'perfect_run', value: 1, comparison: 'greater_equal' }],\r\n  katana_master: [{ trigger: 'enemy_killed', value: 30, comparison: 'greater_equal', metadata: { weapon: 'katana' } }],\r\n  bazooka_expert: [{ trigger: 'enemy_killed', value: 5, comparison: 'greater_equal', metadata: { singleShot: true, weapon: 'bazooka' } }],\r\n  brave_boy: [{ trigger: 'game_completed', value: 1, comparison: 'greater_equal', metadata: { character: 'boy', minDifficulty: 'medium' } }],\r\n  brave_girl: [{ trigger: 'game_completed', value: 1, comparison: 'greater_equal', metadata: { character: 'girl', minDifficulty: 'medium' } }]\r\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\types\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\utils\\__tests__\\performance.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\utils\\gameResponsive.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\utils\\mobileOptimization.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":42,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":42,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1069,1072],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1069,1072],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":43,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":43,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1120,1123],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1120,1123],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":128,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":128,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3477,3480],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3477,3480],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":129,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":129,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3542,3545],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3542,3545],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":130,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":130,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3610,3613],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3610,3613],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":131,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":131,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3671,3674],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3671,3674],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":132,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":132,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3735,3738],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3735,3738],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":133,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":133,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3797,3800],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3797,3800],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":152,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":152,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4265,4268],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4265,4268],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":153,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":153,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4322,4325],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4322,4325],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":154,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":154,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4382,4385],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4382,4385],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":155,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":155,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4435,4438],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4435,4438],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":156,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":156,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4491,4494],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4491,4494],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":157,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":157,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4547,4550],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4547,4550],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":185,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":185,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5203,5206],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5203,5206],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":186,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":186,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5255,5258],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5255,5258],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":187,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":187,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5303,5306],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5303,5306],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":317,"column":7,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":317,"endColumn":50,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[9015,9058],"text":"// @ts-expect-error - Battery API is experimental"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":319,"column":9,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":319,"endColumn":22,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[9108,9121],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":343,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":343,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9909,9912],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9909,9912],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":18,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\n/**\r\n * Mobile-specific optimization utilities\r\n * Handles device orientation lock, fullscreen mode, UI scaling, and battery optimization\r\n */\r\n\r\nexport interface MobileSettings {\r\n  orientationLock: boolean;\r\n  fullscreenMode: boolean;\r\n  batteryOptimization: boolean;\r\n  uiScale: number;\r\n}\r\n\r\nexport interface BatteryInfo {\r\n  level: number;\r\n  charging: boolean;\r\n  chargingTime: number;\r\n  dischargingTime: number;\r\n}\r\n\r\n/**\r\n * Device orientation management\r\n */\r\nexport class OrientationManager {\r\n  private static instance: OrientationManager;\r\n  private isLocked = false;\r\n  private preferredOrientation: string = 'landscape-primary';\r\n\r\n  static getInstance(): OrientationManager {\r\n    if (!OrientationManager.instance) {\r\n      OrientationManager.instance = new OrientationManager();\r\n    }\r\n    return OrientationManager.instance;\r\n  }\r\n\r\n  /**\r\n   * Lock device to landscape orientation for optimal gaming experience\r\n   */\r\n  async lockToLandscape(): Promise<boolean> {\r\n    try {\r\n      if (screen.orientation && (screen.orientation as any).lock) {\r\n        await (screen.orientation as any).lock('landscape-primary');\r\n        this.isLocked = true;\r\n        this.preferredOrientation = 'landscape-primary';\r\n        console.log('Orientation locked to landscape');\r\n        return true;\r\n      }\r\n    } catch (error) {\r\n      console.warn('Orientation lock not supported or failed:', error);\r\n    }\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Unlock orientation to allow natural device rotation\r\n   */\r\n  async unlock(): Promise<void> {\r\n    try {\r\n      if (screen.orientation && screen.orientation.unlock) {\r\n        screen.orientation.unlock();\r\n        this.isLocked = false;\r\n        console.log('Orientation unlocked');\r\n      }\r\n    } catch (error) {\r\n      console.warn('Orientation unlock failed:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if orientation is currently locked\r\n   */\r\n  isOrientationLocked(): boolean {\r\n    return this.isLocked;\r\n  }\r\n\r\n  /**\r\n   * Get current orientation\r\n   */\r\n  getCurrentOrientation(): string {\r\n    if (screen.orientation) {\r\n      return screen.orientation.type;\r\n    }\r\n    return window.innerWidth > window.innerHeight ? 'landscape' : 'portrait';\r\n  }\r\n\r\n  /**\r\n   * Add orientation change listener\r\n   */\r\n  onOrientationChange(callback: (orientation: string) => void): () => void {\r\n    const handler = () => {\r\n      callback(this.getCurrentOrientation());\r\n    };\r\n\r\n    if (screen.orientation) {\r\n      screen.orientation.addEventListener('change', handler);\r\n      return () => screen.orientation.removeEventListener('change', handler);\r\n    } else {\r\n      window.addEventListener('orientationchange', handler);\r\n      return () => window.removeEventListener('orientationchange', handler);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Fullscreen mode management\r\n */\r\nexport class FullscreenManager {\r\n  private static instance: FullscreenManager;\r\n  private isFullscreen = false;\r\n\r\n  static getInstance(): FullscreenManager {\r\n    if (!FullscreenManager.instance) {\r\n      FullscreenManager.instance = new FullscreenManager();\r\n    }\r\n    return FullscreenManager.instance;\r\n  }\r\n\r\n  /**\r\n   * Enter fullscreen mode\r\n   */\r\n  async enterFullscreen(element?: HTMLElement): Promise<boolean> {\r\n    try {\r\n      const targetElement = element || document.documentElement;\r\n      \r\n      if (targetElement.requestFullscreen) {\r\n        await targetElement.requestFullscreen();\r\n      } else if ((targetElement as any).webkitRequestFullscreen) {\r\n        await (targetElement as any).webkitRequestFullscreen();\r\n      } else if ((targetElement as any).msRequestFullscreen) {\r\n        await (targetElement as any).msRequestFullscreen();\r\n      } else if ((targetElement as any).mozRequestFullScreen) {\r\n        await (targetElement as any).mozRequestFullScreen();\r\n      }\r\n      \r\n      this.isFullscreen = true;\r\n      console.log('Entered fullscreen mode');\r\n      return true;\r\n    } catch (error) {\r\n      console.warn('Fullscreen request failed:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Exit fullscreen mode\r\n   */\r\n  async exitFullscreen(): Promise<void> {\r\n    try {\r\n      if (document.exitFullscreen) {\r\n        await document.exitFullscreen();\r\n      } else if ((document as any).webkitExitFullscreen) {\r\n        await (document as any).webkitExitFullscreen();\r\n      } else if ((document as any).msExitFullscreen) {\r\n        await (document as any).msExitFullscreen();\r\n      } else if ((document as any).mozCancelFullScreen) {\r\n        await (document as any).mozCancelFullScreen();\r\n      }\r\n      \r\n      this.isFullscreen = false;\r\n      console.log('Exited fullscreen mode');\r\n    } catch (error) {\r\n      console.warn('Exit fullscreen failed:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Toggle fullscreen mode\r\n   */\r\n  async toggleFullscreen(element?: HTMLElement): Promise<boolean> {\r\n    if (this.isInFullscreen()) {\r\n      await this.exitFullscreen();\r\n      return false;\r\n    } else {\r\n      return await this.enterFullscreen(element);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check if currently in fullscreen\r\n   */\r\n  isInFullscreen(): boolean {\r\n    return !!(\r\n      document.fullscreenElement ||\r\n      (document as any).webkitFullscreenElement ||\r\n      (document as any).msFullscreenElement ||\r\n      (document as any).mozFullScreenElement\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Add fullscreen change listener\r\n   */\r\n  onFullscreenChange(callback: (isFullscreen: boolean) => void): () => void {\r\n    const handler = () => {\r\n      const isFullscreen = this.isInFullscreen();\r\n      this.isFullscreen = isFullscreen;\r\n      callback(isFullscreen);\r\n    };\r\n\r\n    document.addEventListener('fullscreenchange', handler);\r\n    document.addEventListener('webkitfullscreenchange', handler);\r\n    document.addEventListener('msfullscreenchange', handler);\r\n    document.addEventListener('mozfullscreenchange', handler);\r\n\r\n    return () => {\r\n      document.removeEventListener('fullscreenchange', handler);\r\n      document.removeEventListener('webkitfullscreenchange', handler);\r\n      document.removeEventListener('msfullscreenchange', handler);\r\n      document.removeEventListener('mozfullscreenchange', handler);\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Mobile UI scaling optimization\r\n */\r\nexport class MobileUIScaler {\r\n  private static instance: MobileUIScaler;\r\n  private currentScale = 1;\r\n  private baseViewportWidth = 375; // iPhone base width\r\n  private maxScale = 1.5;\r\n  private minScale = 0.7;\r\n\r\n  static getInstance(): MobileUIScaler {\r\n    if (!MobileUIScaler.instance) {\r\n      MobileUIScaler.instance = new MobileUIScaler();\r\n    }\r\n    return MobileUIScaler.instance;\r\n  }\r\n\r\n  /**\r\n   * Calculate optimal UI scale based on device characteristics\r\n   */\r\n  calculateOptimalScale(): number {\r\n    const viewport = {\r\n      width: window.innerWidth,\r\n      height: window.innerHeight,\r\n      pixelRatio: window.devicePixelRatio || 1\r\n    };\r\n\r\n    // Base scale calculation\r\n    let scale = viewport.width / this.baseViewportWidth;\r\n\r\n    // Adjust for pixel density\r\n    if (viewport.pixelRatio > 2) {\r\n      scale *= 0.9; // Slightly smaller on high-DPI displays\r\n    }\r\n\r\n    // Adjust for very small or large screens\r\n    if (viewport.width < 320) {\r\n      scale *= 0.8; // Smaller UI on very small screens\r\n    } else if (viewport.width > 768) {\r\n      scale *= 1.1; // Slightly larger UI on tablets\r\n    }\r\n\r\n    // Clamp to reasonable bounds\r\n    return Math.max(this.minScale, Math.min(this.maxScale, scale));\r\n  }\r\n\r\n  /**\r\n   * Apply UI scaling to the document\r\n   */\r\n  applyScale(scale?: number): void {\r\n    const targetScale = scale || this.calculateOptimalScale();\r\n    this.currentScale = targetScale;\r\n\r\n    // Apply CSS custom property for UI scaling\r\n    document.documentElement.style.setProperty('--mobile-ui-scale', targetScale.toString());\r\n    \r\n    // Apply to specific UI elements\r\n    const gameContainer = document.getElementById('game-container');\r\n    if (gameContainer) {\r\n      gameContainer.style.transform = `scale(${targetScale})`;\r\n      gameContainer.style.transformOrigin = 'center center';\r\n    }\r\n\r\n    console.log(`Applied mobile UI scale: ${targetScale.toFixed(2)}`);\r\n  }\r\n\r\n  /**\r\n   * Get current UI scale\r\n   */\r\n  getCurrentScale(): number {\r\n    return this.currentScale;\r\n  }\r\n\r\n  /**\r\n   * Reset UI scale to default\r\n   */\r\n  resetScale(): void {\r\n    this.applyScale(1);\r\n  }\r\n}\r\n\r\n/**\r\n * Battery usage optimization\r\n */\r\nexport class BatteryOptimizer {\r\n  private static instance: BatteryOptimizer;\r\n  private batteryInfo: BatteryInfo | null = null;\r\n  private optimizationLevel: 'none' | 'low' | 'medium' | 'high' = 'none';\r\n  private updateInterval: NodeJS.Timeout | null = null;\r\n\r\n  static getInstance(): BatteryOptimizer {\r\n    if (!BatteryOptimizer.instance) {\r\n      BatteryOptimizer.instance = new BatteryOptimizer();\r\n    }\r\n    return BatteryOptimizer.instance;\r\n  }\r\n\r\n  /**\r\n   * Initialize battery monitoring\r\n   */\r\n  async initialize(): Promise<void> {\r\n    try {\r\n      // @ts-ignore - Battery API is experimental\r\n      if ('getBattery' in navigator) {\r\n        // @ts-ignore\r\n        const battery = await navigator.getBattery();\r\n        this.batteryInfo = {\r\n          level: battery.level,\r\n          charging: battery.charging,\r\n          chargingTime: battery.chargingTime,\r\n          dischargingTime: battery.dischargingTime\r\n        };\r\n\r\n        // Set up battery event listeners\r\n        battery.addEventListener('levelchange', () => this.updateBatteryInfo(battery));\r\n        battery.addEventListener('chargingchange', () => this.updateBatteryInfo(battery));\r\n\r\n        this.determineOptimizationLevel();\r\n        console.log('Battery optimization initialized');\r\n      }\r\n    } catch (error) {\r\n      console.warn('Battery API not available:', error);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update battery information\r\n   */\r\n  private updateBatteryInfo(battery: any): void {\r\n    this.batteryInfo = {\r\n      level: battery.level,\r\n      charging: battery.charging,\r\n      chargingTime: battery.chargingTime,\r\n      dischargingTime: battery.dischargingTime\r\n    };\r\n    this.determineOptimizationLevel();\r\n  }\r\n\r\n  /**\r\n   * Determine optimization level based on battery status\r\n   */\r\n  private determineOptimizationLevel(): void {\r\n    if (!this.batteryInfo) return;\r\n\r\n    const { level, charging } = this.batteryInfo;\r\n\r\n    if (charging) {\r\n      this.optimizationLevel = 'none';\r\n    } else if (level < 0.15) {\r\n      this.optimizationLevel = 'high';\r\n    } else if (level < 0.30) {\r\n      this.optimizationLevel = 'medium';\r\n    } else if (level < 0.50) {\r\n      this.optimizationLevel = 'low';\r\n    } else {\r\n      this.optimizationLevel = 'none';\r\n    }\r\n\r\n    console.log(`Battery optimization level: ${this.optimizationLevel} (${Math.round(level * 100)}%)`);\r\n  }\r\n\r\n  /**\r\n   * Get current battery information\r\n   */\r\n  getBatteryInfo(): BatteryInfo | null {\r\n    return this.batteryInfo;\r\n  }\r\n\r\n  /**\r\n   * Get current optimization level\r\n   */\r\n  getOptimizationLevel(): 'none' | 'low' | 'medium' | 'high' {\r\n    return this.optimizationLevel;\r\n  }\r\n\r\n  /**\r\n   * Get optimization settings based on current level\r\n   */\r\n  getOptimizationSettings(): {\r\n    frameRate: number;\r\n    particleCount: number;\r\n    shadowQuality: 'none' | 'low' | 'medium' | 'high';\r\n    audioEnabled: boolean;\r\n    hapticEnabled: boolean;\r\n    backgroundProcessing: boolean;\r\n  } {\r\n    switch (this.optimizationLevel) {\r\n      case 'high':\r\n        return {\r\n          frameRate: 30,\r\n          particleCount: 5,\r\n          shadowQuality: 'none',\r\n          audioEnabled: false,\r\n          hapticEnabled: false,\r\n          backgroundProcessing: false\r\n        };\r\n      case 'medium':\r\n        return {\r\n          frameRate: 45,\r\n          particleCount: 15,\r\n          shadowQuality: 'low',\r\n          audioEnabled: true,\r\n          hapticEnabled: false,\r\n          backgroundProcessing: false\r\n        };\r\n      case 'low':\r\n        return {\r\n          frameRate: 50,\r\n          particleCount: 25,\r\n          shadowQuality: 'medium',\r\n          audioEnabled: true,\r\n          hapticEnabled: true,\r\n          backgroundProcessing: true\r\n        };\r\n      default:\r\n        return {\r\n          frameRate: 60,\r\n          particleCount: 50,\r\n          shadowQuality: 'high',\r\n          audioEnabled: true,\r\n          hapticEnabled: true,\r\n          backgroundProcessing: true\r\n        };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Start battery monitoring\r\n   */\r\n  startMonitoring(interval: number = 30000): void {\r\n    if (this.updateInterval) {\r\n      clearInterval(this.updateInterval);\r\n    }\r\n\r\n    this.updateInterval = setInterval(() => {\r\n      this.initialize(); // Refresh battery info\r\n    }, interval);\r\n  }\r\n\r\n  /**\r\n   * Stop battery monitoring\r\n   */\r\n  stopMonitoring(): void {\r\n    if (this.updateInterval) {\r\n      clearInterval(this.updateInterval);\r\n      this.updateInterval = null;\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Comprehensive mobile optimization manager\r\n */\r\nexport class MobileOptimizationManager {\r\n  private orientationManager: OrientationManager;\r\n  private fullscreenManager: FullscreenManager;\r\n  private uiScaler: MobileUIScaler;\r\n  private batteryOptimizer: BatteryOptimizer;\r\n  private settings: MobileSettings;\r\n\r\n  constructor() {\r\n    this.orientationManager = OrientationManager.getInstance();\r\n    this.fullscreenManager = FullscreenManager.getInstance();\r\n    this.uiScaler = MobileUIScaler.getInstance();\r\n    this.batteryOptimizer = BatteryOptimizer.getInstance();\r\n    \r\n    this.settings = {\r\n      orientationLock: false,\r\n      fullscreenMode: false,\r\n      batteryOptimization: true,\r\n      uiScale: 1\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Initialize all mobile optimizations\r\n   */\r\n  async initialize(settings?: Partial<MobileSettings>): Promise<void> {\r\n    if (settings) {\r\n      this.settings = { ...this.settings, ...settings };\r\n    }\r\n\r\n    // Initialize battery optimization\r\n    if (this.settings.batteryOptimization) {\r\n      await this.batteryOptimizer.initialize();\r\n      this.batteryOptimizer.startMonitoring();\r\n    }\r\n\r\n    // Apply UI scaling\r\n    this.uiScaler.applyScale(this.settings.uiScale);\r\n\r\n    // Lock orientation if requested\r\n    if (this.settings.orientationLock) {\r\n      await this.orientationManager.lockToLandscape();\r\n    }\r\n\r\n    // Enter fullscreen if requested\r\n    if (this.settings.fullscreenMode) {\r\n      await this.fullscreenManager.enterFullscreen();\r\n    }\r\n\r\n    console.log('Mobile optimization manager initialized');\r\n  }\r\n\r\n  /**\r\n   * Update settings\r\n   */\r\n  async updateSettings(newSettings: Partial<MobileSettings>): Promise<void> {\r\n    const oldSettings = { ...this.settings };\r\n    this.settings = { ...this.settings, ...newSettings };\r\n\r\n    // Handle orientation lock changes\r\n    if (oldSettings.orientationLock !== this.settings.orientationLock) {\r\n      if (this.settings.orientationLock) {\r\n        await this.orientationManager.lockToLandscape();\r\n      } else {\r\n        await this.orientationManager.unlock();\r\n      }\r\n    }\r\n\r\n    // Handle fullscreen changes\r\n    if (oldSettings.fullscreenMode !== this.settings.fullscreenMode) {\r\n      if (this.settings.fullscreenMode) {\r\n        await this.fullscreenManager.enterFullscreen();\r\n      } else {\r\n        await this.fullscreenManager.exitFullscreen();\r\n      }\r\n    }\r\n\r\n    // Handle UI scale changes\r\n    if (oldSettings.uiScale !== this.settings.uiScale) {\r\n      this.uiScaler.applyScale(this.settings.uiScale);\r\n    }\r\n\r\n    // Handle battery optimization changes\r\n    if (oldSettings.batteryOptimization !== this.settings.batteryOptimization) {\r\n      if (this.settings.batteryOptimization) {\r\n        await this.batteryOptimizer.initialize();\r\n        this.batteryOptimizer.startMonitoring();\r\n      } else {\r\n        this.batteryOptimizer.stopMonitoring();\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get current settings\r\n   */\r\n  getSettings(): MobileSettings {\r\n    return { ...this.settings };\r\n  }\r\n\r\n  /**\r\n   * Get comprehensive mobile status\r\n   */\r\n  getStatus(): {\r\n    orientation: string;\r\n    isOrientationLocked: boolean;\r\n    isFullscreen: boolean;\r\n    uiScale: number;\r\n    batteryInfo: BatteryInfo | null;\r\n    optimizationLevel: string;\r\n  } {\r\n    return {\r\n      orientation: this.orientationManager.getCurrentOrientation(),\r\n      isOrientationLocked: this.orientationManager.isOrientationLocked(),\r\n      isFullscreen: this.fullscreenManager.isInFullscreen(),\r\n      uiScale: this.uiScaler.getCurrentScale(),\r\n      batteryInfo: this.batteryOptimizer.getBatteryInfo(),\r\n      optimizationLevel: this.batteryOptimizer.getOptimizationLevel()\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Cleanup and reset all optimizations\r\n   */\r\n  async cleanup(): Promise<void> {\r\n    await this.orientationManager.unlock();\r\n    await this.fullscreenManager.exitFullscreen();\r\n    this.uiScaler.resetScale();\r\n    this.batteryOptimizer.stopMonitoring();\r\n    \r\n    console.log('Mobile optimizations cleaned up');\r\n  }\r\n}\r\n\r\n// Export singleton instances for easy access\r\nexport const mobileOptimization = new MobileOptimizationManager();\r\nexport const orientationManager = OrientationManager.getInstance();\r\nexport const fullscreenManager = FullscreenManager.getInstance();\r\nexport const mobileUIScaler = MobileUIScaler.getInstance();\r\nexport const batteryOptimizer = BatteryOptimizer.getInstance();","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\utils\\performance.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":152,"column":5,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":152,"endColumn":62,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[4170,4227],"text":"// @ts-expect-error - performance.memory is not in all browsers"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":154,"column":7,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":154,"endColumn":20,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[4266,4279],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":323,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":323,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9153,9156],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9153,9156],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":324,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":324,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9212,9215],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9212,9215],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":360,"column":14,"nodeType":null,"messageId":"unusedVar","endLine":360,"endColumn":19},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'url' is defined but never used. Allowed unused args must match /^_/u.","line":366,"column":17,"nodeType":null,"messageId":"unusedVar","endLine":366,"endColumn":20},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":403,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":403,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11537,11540],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11537,11540],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'metrics' is assigned a value but never used.","line":442,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":442,"endColumn":18},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":511,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":511,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14762,14765],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14762,14765],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":512,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":512,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14852,14855],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14852,14855],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":513,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":513,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14935,14938],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14935,14938],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":530,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":530,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15452,15455],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15452,15455],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":546,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":546,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15959,15962],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15959,15962],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":555,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":555,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16170,16173],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16170,16173],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":571,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":571,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16657,16660],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16657,16660],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":580,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":580,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16868,16871],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16868,16871],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":588,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":588,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17040,17043],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17040,17043],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":596,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":596,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[17309,17312],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[17309,17312],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":659,"column":5,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":659,"endColumn":18,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[19433,19446],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":661,"column":7,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":661,"endColumn":20,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[19485,19498],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":730,"column":7,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":730,"endColumn":20,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[21580,21593],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":763,"column":5,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":763,"endColumn":18,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[22446,22459],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":766,"column":5,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":766,"endColumn":18,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[22674,22687],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":774,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":774,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[22904,22907],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[22904,22907],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":774,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":774,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[22914,22917],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[22914,22917],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":791,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":791,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[23284,23287],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[23284,23287],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":791,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":791,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[23294,23297],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[23294,23297],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":809,"column":83,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":809,"endColumn":86,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[23895,23898],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[23895,23898],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":879,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":879,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[25773,25776],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[25773,25776],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":906,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":906,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[26587,26590],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[26587,26590],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":958,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":958,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[27899,27902],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[27899,27902],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":959,"column":11,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":959,"endColumn":24,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[27926,27939],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":961,"column":11,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":961,"endColumn":24,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[28013,28026],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":963,"column":11,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":963,"endColumn":24,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[28102,28115],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":966,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":966,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[28234,28237],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[28234,28237],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":967,"column":11,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":967,"endColumn":24,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[28265,28278],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]},{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":969,"column":11,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":969,"endColumn":24,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[28352,28365],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]}],"suppressedMessages":[],"errorCount":15,"fatalErrorCount":0,"warningCount":22,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Advanced performance monitoring and optimization utilities\r\n */\r\n\r\nexport interface PerformanceMetrics {\r\n  fps: number;\r\n  frameTime: number;\r\n  memoryUsage?: number;\r\n  isLowPerformance: boolean;\r\n  // Advanced metrics\r\n  cpuUsage?: number;\r\n  networkLatency?: number;\r\n  renderTime: number;\r\n  updateTime: number;\r\n  drawCalls: number;\r\n  activeObjects: number;\r\n}\r\n\r\nexport interface NetworkMetrics {\r\n  latency: number;\r\n  downloadSpeed: number;\r\n  uploadSpeed: number;\r\n  connectionType: string;\r\n  isOnline: boolean;\r\n  requestCount: number;\r\n  failedRequests: number;\r\n  averageResponseTime: number;\r\n}\r\n\r\nexport interface MemoryMetrics {\r\n  usedJSHeapSize: number;\r\n  totalJSHeapSize: number;\r\n  jsHeapSizeLimit: number;\r\n  textureMemory: number;\r\n  audioMemory: number;\r\n  objectCount: number;\r\n}\r\n\r\nexport class AdvancedPerformanceMonitor {\r\n  private frameCount = 0;\r\n  private lastTime = 0;\r\n  private fps = 60;\r\n  private frameTime = 16.67;\r\n  private fpsHistory: number[] = [];\r\n  private readonly maxHistorySize = 300; // 5 seconds at 60fps\r\n  \r\n  // Advanced metrics\r\n  private renderTimeHistory: number[] = [];\r\n  private updateTimeHistory: number[] = [];\r\n  private drawCallHistory: number[] = [];\r\n  private objectCountHistory: number[] = [];\r\n  private cpuUsageHistory: number[] = [];\r\n  \r\n  // Performance tracking\r\n  private lastRenderTime = 0;\r\n  private lastUpdateTime = 0;\r\n  private currentDrawCalls = 0;\r\n  private currentObjectCount = 0;\r\n  \r\n  // Network monitoring\r\n  private networkMonitor: NetworkPerformanceMonitor;\r\n  \r\n  constructor() {\r\n    this.lastTime = performance.now();\r\n    this.networkMonitor = new NetworkPerformanceMonitor();\r\n  }\r\n\r\n  startRenderMeasurement(): void {\r\n    this.lastRenderTime = performance.now();\r\n  }\r\n\r\n  endRenderMeasurement(): void {\r\n    const renderTime = performance.now() - this.lastRenderTime;\r\n    this.renderTimeHistory.push(renderTime);\r\n    if (this.renderTimeHistory.length > this.maxHistorySize) {\r\n      this.renderTimeHistory.shift();\r\n    }\r\n  }\r\n\r\n  startUpdateMeasurement(): void {\r\n    this.lastUpdateTime = performance.now();\r\n  }\r\n\r\n  endUpdateMeasurement(): void {\r\n    const updateTime = performance.now() - this.lastUpdateTime;\r\n    this.updateTimeHistory.push(updateTime);\r\n    if (this.updateTimeHistory.length > this.maxHistorySize) {\r\n      this.updateTimeHistory.shift();\r\n    }\r\n  }\r\n\r\n  recordDrawCall(): void {\r\n    this.currentDrawCalls++;\r\n  }\r\n\r\n  recordObjectCount(count: number): void {\r\n    this.currentObjectCount = count;\r\n  }\r\n\r\n  update(): PerformanceMetrics {\r\n    const currentTime = performance.now();\r\n    const deltaTime = currentTime - this.lastTime;\r\n    \r\n    this.frameTime = deltaTime;\r\n    this.frameCount++;\r\n    \r\n    // Calculate FPS every frame for more accurate readings\r\n    if (deltaTime > 0) {\r\n      const instantFps = 1000 / deltaTime;\r\n      this.fpsHistory.push(instantFps);\r\n      \r\n      // Keep history size manageable\r\n      if (this.fpsHistory.length > this.maxHistorySize) {\r\n        this.fpsHistory.shift();\r\n      }\r\n      \r\n      // Update FPS as rolling average\r\n      this.fps = this.getAverageFPS();\r\n    }\r\n    \r\n    // Record draw calls and object count\r\n    this.drawCallHistory.push(this.currentDrawCalls);\r\n    this.objectCountHistory.push(this.currentObjectCount);\r\n    \r\n    if (this.drawCallHistory.length > this.maxHistorySize) {\r\n      this.drawCallHistory.shift();\r\n    }\r\n    if (this.objectCountHistory.length > this.maxHistorySize) {\r\n      this.objectCountHistory.shift();\r\n    }\r\n    \r\n    // Reset counters\r\n    this.currentDrawCalls = 0;\r\n    \r\n    this.lastTime = currentTime;\r\n    \r\n    return {\r\n      fps: this.fps,\r\n      frameTime: this.frameTime,\r\n      memoryUsage: this.getMemoryUsage(),\r\n      isLowPerformance: this.isLowPerformance(),\r\n      cpuUsage: this.getCPUUsage(),\r\n      networkLatency: this.networkMonitor.getLatency(),\r\n      renderTime: this.getAverageRenderTime(),\r\n      updateTime: this.getAverageUpdateTime(),\r\n      drawCalls: this.getAverageDrawCalls(),\r\n      activeObjects: this.currentObjectCount,\r\n    };\r\n  }\r\n\r\n  private getMemoryUsage(): number | undefined {\r\n    // @ts-ignore - performance.memory is not in all browsers\r\n    if (performance.memory) {\r\n      // @ts-ignore\r\n      return performance.memory.usedJSHeapSize / 1024 / 1024; // MB\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  private getCPUUsage(): number | undefined {\r\n    // Estimate CPU usage based on frame time vs ideal frame time\r\n    const idealFrameTime = 16.67; // 60 FPS\r\n    if (this.frameTime > 0) {\r\n      const cpuUsage = Math.min(100, (this.frameTime / idealFrameTime) * 100);\r\n      this.cpuUsageHistory.push(cpuUsage);\r\n      \r\n      if (this.cpuUsageHistory.length > this.maxHistorySize) {\r\n        this.cpuUsageHistory.shift();\r\n      }\r\n      \r\n      return this.cpuUsageHistory.reduce((sum, usage) => sum + usage, 0) / this.cpuUsageHistory.length;\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  private isLowPerformance(): boolean {\r\n    if (this.fpsHistory.length < 30) return false; // Need at least 30 samples\r\n    \r\n    const recentFps = this.fpsHistory.slice(-30);\r\n    const averageFps = recentFps.reduce((sum, fps) => sum + fps, 0) / recentFps.length;\r\n    \r\n    return averageFps < 30; // Consider low performance if below 30 FPS\r\n  }\r\n\r\n  getAverageFPS(): number {\r\n    if (this.fpsHistory.length === 0) return 60;\r\n    return this.fpsHistory.reduce((sum, fps) => sum + fps, 0) / this.fpsHistory.length;\r\n  }\r\n\r\n  private getAverageRenderTime(): number {\r\n    if (this.renderTimeHistory.length === 0) return 0;\r\n    return this.renderTimeHistory.reduce((sum, time) => sum + time, 0) / this.renderTimeHistory.length;\r\n  }\r\n\r\n  private getAverageUpdateTime(): number {\r\n    if (this.updateTimeHistory.length === 0) return 0;\r\n    return this.updateTimeHistory.reduce((sum, time) => sum + time, 0) / this.updateTimeHistory.length;\r\n  }\r\n\r\n  private getAverageDrawCalls(): number {\r\n    if (this.drawCallHistory.length === 0) return 0;\r\n    return this.drawCallHistory.reduce((sum, calls) => sum + calls, 0) / this.drawCallHistory.length;\r\n  }\r\n\r\n  getDetailedMetrics() {\r\n    return {\r\n      fps: {\r\n        current: this.fps,\r\n        average: this.getAverageFPS(),\r\n        min: Math.min(...this.fpsHistory.slice(-60)),\r\n        max: Math.max(...this.fpsHistory.slice(-60)),\r\n        history: this.fpsHistory.slice(-60),\r\n      },\r\n      frameTime: {\r\n        current: this.frameTime,\r\n        average: this.fpsHistory.length > 0 ? 1000 / this.getAverageFPS() : 16.67,\r\n        history: this.fpsHistory.slice(-60).map(fps => 1000 / fps),\r\n      },\r\n      render: {\r\n        averageTime: this.getAverageRenderTime(),\r\n        history: this.renderTimeHistory.slice(-60),\r\n      },\r\n      update: {\r\n        averageTime: this.getAverageUpdateTime(),\r\n        history: this.updateTimeHistory.slice(-60),\r\n      },\r\n      drawCalls: {\r\n        average: this.getAverageDrawCalls(),\r\n        history: this.drawCallHistory.slice(-60),\r\n      },\r\n      objects: {\r\n        current: this.currentObjectCount,\r\n        history: this.objectCountHistory.slice(-60),\r\n      },\r\n    };\r\n  }\r\n\r\n  getNetworkMetrics(): NetworkMetrics {\r\n    return this.networkMonitor.getMetrics();\r\n  }\r\n\r\n  getMemoryMetrics(): MemoryMetrics {\r\n    return MemoryManager.getInstance().getMetrics();\r\n  }\r\n\r\n  reset(): void {\r\n    this.fpsHistory = [];\r\n    this.renderTimeHistory = [];\r\n    this.updateTimeHistory = [];\r\n    this.drawCallHistory = [];\r\n    this.objectCountHistory = [];\r\n    this.cpuUsageHistory = [];\r\n    this.frameCount = 0;\r\n    this.lastTime = performance.now();\r\n  }\r\n}\r\n\r\n/**\r\n * Object pool for reusing game objects to reduce garbage collection\r\n */\r\nexport class ObjectPool<T> {\r\n  private pool: T[] = [];\r\n  private createFn: () => T;\r\n  private resetFn: (obj: T) => void;\r\n  private maxSize: number;\r\n\r\n  constructor(\r\n    createFn: () => T,\r\n    resetFn: (obj: T) => void,\r\n    initialSize: number = 10,\r\n    maxSize: number = 100\r\n  ) {\r\n    this.createFn = createFn;\r\n    this.resetFn = resetFn;\r\n    this.maxSize = maxSize;\r\n    \r\n    // Pre-populate pool\r\n    for (let i = 0; i < initialSize; i++) {\r\n      this.pool.push(this.createFn());\r\n    }\r\n  }\r\n\r\n  get(): T {\r\n    if (this.pool.length > 0) {\r\n      return this.pool.pop()!;\r\n    }\r\n    return this.createFn();\r\n  }\r\n\r\n  release(obj: T): void {\r\n    if (this.pool.length < this.maxSize) {\r\n      this.resetFn(obj);\r\n      this.pool.push(obj);\r\n    }\r\n  }\r\n\r\n  clear(): void {\r\n    this.pool.length = 0;\r\n  }\r\n\r\n  getPoolSize(): number {\r\n    return this.pool.length;\r\n  }\r\n}\r\n\r\n/**\r\n * Network performance monitoring\r\n */\r\nexport class NetworkPerformanceMonitor {\r\n  private latencyHistory: number[] = [];\r\n  private requestTimes = new Map<string, number>();\r\n  private requestCount = 0;\r\n  private failedRequests = 0;\r\n  private responseTimeHistory: number[] = [];\r\n  private readonly maxHistorySize = 100;\r\n\r\n  constructor() {\r\n    this.setupNetworkMonitoring();\r\n  }\r\n\r\n  private setupNetworkMonitoring(): void {\r\n    // Monitor network connection changes\r\n    if ('connection' in navigator && (navigator as any).connection) {\r\n      const connection = (navigator as any).connection;\r\n      if (typeof connection.addEventListener === 'function') {\r\n        connection.addEventListener('change', () => {\r\n          this.measureLatency();\r\n        });\r\n      }\r\n    }\r\n\r\n    // Monitor online/offline status\r\n    if (typeof window !== 'undefined') {\r\n      window.addEventListener('online', () => this.measureLatency());\r\n      window.addEventListener('offline', () => this.recordOffline());\r\n    }\r\n  }\r\n\r\n  async measureLatency(): Promise<number> {\r\n    try {\r\n      const start = performance.now();\r\n      \r\n      // Use a small image or API endpoint for latency measurement\r\n      const response = await fetch('/api/health', {\r\n        method: 'HEAD',\r\n        cache: 'no-cache'\r\n      });\r\n      \r\n      const latency = performance.now() - start;\r\n      \r\n      if (response.ok) {\r\n        this.latencyHistory.push(latency);\r\n        if (this.latencyHistory.length > this.maxHistorySize) {\r\n          this.latencyHistory.shift();\r\n        }\r\n        return latency;\r\n      }\r\n      \r\n      return -1;\r\n    } catch (error) {\r\n      this.failedRequests++;\r\n      return -1;\r\n    }\r\n  }\r\n\r\n  recordRequest(url: string): string {\r\n    const requestId = `${Date.now()}-${Math.random()}`;\r\n    this.requestTimes.set(requestId, performance.now());\r\n    this.requestCount++;\r\n    return requestId;\r\n  }\r\n\r\n  recordResponse(requestId: string, success: boolean): void {\r\n    const startTime = this.requestTimes.get(requestId);\r\n    if (startTime !== undefined) {\r\n      const responseTime = performance.now() - startTime;\r\n      this.responseTimeHistory.push(responseTime);\r\n      \r\n      if (this.responseTimeHistory.length > this.maxHistorySize) {\r\n        this.responseTimeHistory.shift();\r\n      }\r\n      \r\n      if (!success) {\r\n        this.failedRequests++;\r\n      }\r\n      \r\n      this.requestTimes.delete(requestId);\r\n    }\r\n  }\r\n\r\n  private recordOffline(): void {\r\n    this.latencyHistory.push(-1); // -1 indicates offline\r\n  }\r\n\r\n  getLatency(): number {\r\n    if (this.latencyHistory.length === 0) return 0;\r\n    const validLatencies = this.latencyHistory.filter(l => l > 0);\r\n    if (validLatencies.length === 0) return -1;\r\n    return validLatencies.reduce((sum, l) => sum + l, 0) / validLatencies.length;\r\n  }\r\n\r\n  getMetrics(): NetworkMetrics {\r\n    const connection = (navigator as any).connection;\r\n    \r\n    return {\r\n      latency: this.getLatency(),\r\n      downloadSpeed: connection?.downlink || 0,\r\n      uploadSpeed: connection?.uplink || 0,\r\n      connectionType: connection?.effectiveType || 'unknown',\r\n      isOnline: navigator.onLine,\r\n      requestCount: this.requestCount,\r\n      failedRequests: this.failedRequests,\r\n      averageResponseTime: this.responseTimeHistory.length > 0 \r\n        ? this.responseTimeHistory.reduce((sum, time) => sum + time, 0) / this.responseTimeHistory.length \r\n        : 0,\r\n    };\r\n  }\r\n\r\n  reset(): void {\r\n    this.latencyHistory = [];\r\n    this.requestTimes.clear();\r\n    this.requestCount = 0;\r\n    this.failedRequests = 0;\r\n    this.responseTimeHistory = [];\r\n  }\r\n}\r\n\r\n/**\r\n * Adaptive quality settings based on performance\r\n */\r\nexport class AdaptiveQuality {\r\n  private performanceMonitor: AdvancedPerformanceMonitor;\r\n  private currentQuality: 'low' | 'medium' | 'high' = 'high';\r\n  private lastAdjustment = 0;\r\n  private readonly adjustmentCooldown = 5000; // 5 seconds\r\n\r\n  constructor() {\r\n    this.performanceMonitor = new AdvancedPerformanceMonitor();\r\n  }\r\n\r\n  update(): void {\r\n    const metrics = this.performanceMonitor.update();\r\n    const now = performance.now();\r\n    \r\n    // Only adjust quality every few seconds to avoid flickering\r\n    if (now - this.lastAdjustment < this.adjustmentCooldown) {\r\n      return;\r\n    }\r\n    \r\n    const avgFps = this.performanceMonitor.getAverageFPS();\r\n    \r\n    // Adjust quality based on performance\r\n    if (avgFps < 25 && this.currentQuality !== 'low') {\r\n      this.currentQuality = 'low';\r\n      this.lastAdjustment = now;\r\n      console.log('Performance: Switching to low quality');\r\n    } else if (avgFps < 45 && this.currentQuality === 'high') {\r\n      this.currentQuality = 'medium';\r\n      this.lastAdjustment = now;\r\n      console.log('Performance: Switching to medium quality');\r\n    } else if (avgFps > 55 && this.currentQuality !== 'high') {\r\n      this.currentQuality = 'high';\r\n      this.lastAdjustment = now;\r\n      console.log('Performance: Switching to high quality');\r\n    }\r\n  }\r\n\r\n  getQuality(): 'low' | 'medium' | 'high' {\r\n    return this.currentQuality;\r\n  }\r\n\r\n  getMetrics(): PerformanceMetrics {\r\n    return this.performanceMonitor.update();\r\n  }\r\n\r\n  getQualitySettings() {\r\n    switch (this.currentQuality) {\r\n      case 'low':\r\n        return {\r\n          particleCount: 10,\r\n          shadowQuality: 'none',\r\n          textureQuality: 'low',\r\n          animationFPS: 30,\r\n          enablePostProcessing: false,\r\n        };\r\n      case 'medium':\r\n        return {\r\n          particleCount: 25,\r\n          shadowQuality: 'low',\r\n          textureQuality: 'medium',\r\n          animationFPS: 45,\r\n          enablePostProcessing: false,\r\n        };\r\n      case 'high':\r\n        return {\r\n          particleCount: 50,\r\n          shadowQuality: 'high',\r\n          textureQuality: 'high',\r\n          animationFPS: 60,\r\n          enablePostProcessing: true,\r\n        };\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Enhanced memory management utilities with detailed tracking\r\n */\r\nexport class MemoryManager {\r\n  private static instance: MemoryManager;\r\n  private textures = new Map<string, { data: any; size: number; lastAccessed: number }>();\r\n  private sounds = new Map<string, { data: any; size: number; lastAccessed: number }>();\r\n  private objects = new Map<string, any>();\r\n  private maxTextureMemory = 50 * 1024 * 1024; // 50MB\r\n  private maxAudioMemory = 20 * 1024 * 1024; // 20MB\r\n  \r\n  // Memory tracking\r\n  private textureMemoryUsage = 0;\r\n  private audioMemoryUsage = 0;\r\n  private memoryHistory: number[] = [];\r\n  private readonly maxHistorySize = 300;\r\n  \r\n  static getInstance(): MemoryManager {\r\n    if (!MemoryManager.instance) {\r\n      MemoryManager.instance = new MemoryManager();\r\n    }\r\n    return MemoryManager.instance;\r\n  }\r\n\r\n  cacheTexture(key: string, texture: any, estimatedSize?: number): void {\r\n    const size = estimatedSize || this.estimateTextureSize(texture);\r\n    const now = performance.now();\r\n    \r\n    // Remove old texture if it exists\r\n    if (this.textures.has(key)) {\r\n      const old = this.textures.get(key)!;\r\n      this.textureMemoryUsage -= old.size;\r\n    }\r\n    \r\n    this.textures.set(key, { data: texture, size, lastAccessed: now });\r\n    this.textureMemoryUsage += size;\r\n    \r\n    this.checkMemoryUsage();\r\n  }\r\n\r\n  getTexture(key: string): any {\r\n    const entry = this.textures.get(key);\r\n    if (entry) {\r\n      entry.lastAccessed = performance.now();\r\n      return entry.data;\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  cacheSound(key: string, sound: any, estimatedSize?: number): void {\r\n    const size = estimatedSize || this.estimateAudioSize(sound);\r\n    const now = performance.now();\r\n    \r\n    // Remove old sound if it exists\r\n    if (this.sounds.has(key)) {\r\n      const old = this.sounds.get(key)!;\r\n      this.audioMemoryUsage -= old.size;\r\n    }\r\n    \r\n    this.sounds.set(key, { data: sound, size, lastAccessed: now });\r\n    this.audioMemoryUsage += size;\r\n    \r\n    this.checkMemoryUsage();\r\n  }\r\n\r\n  getSound(key: string): any {\r\n    const entry = this.sounds.get(key);\r\n    if (entry) {\r\n      entry.lastAccessed = performance.now();\r\n      return entry.data;\r\n    }\r\n    return undefined;\r\n  }\r\n\r\n  trackObject(key: string, object: any): void {\r\n    this.objects.set(key, object);\r\n  }\r\n\r\n  untrackObject(key: string): void {\r\n    this.objects.delete(key);\r\n  }\r\n\r\n  private estimateTextureSize(texture: any): number {\r\n    // Rough estimation based on texture properties\r\n    if (texture && texture.width && texture.height) {\r\n      return texture.width * texture.height * 4; // RGBA\r\n    }\r\n    return 1024; // Default estimate\r\n  }\r\n\r\n  private estimateAudioSize(sound: any): number {\r\n    // Rough estimation for audio files\r\n    if (sound && sound.duration) {\r\n      return sound.duration * 44100 * 2 * 2; // 44.1kHz, stereo, 16-bit\r\n    }\r\n    return 1024 * 100; // Default estimate ~100KB\r\n  }\r\n\r\n  private checkMemoryUsage(): void {\r\n    const memoryInfo = this.getMemoryInfo();\r\n    \r\n    // Record memory usage history\r\n    this.memoryHistory.push(memoryInfo.usedJSHeapSize);\r\n    if (this.memoryHistory.length > this.maxHistorySize) {\r\n      this.memoryHistory.shift();\r\n    }\r\n    \r\n    // Clear textures if over limit\r\n    if (this.textureMemoryUsage > this.maxTextureMemory) {\r\n      this.clearOldestTextures();\r\n    }\r\n    \r\n    // Clear audio if over limit\r\n    if (this.audioMemoryUsage > this.maxAudioMemory) {\r\n      this.clearOldestAudio();\r\n    }\r\n  }\r\n\r\n  private clearOldestTextures(): void {\r\n    const entries = Array.from(this.textures.entries())\r\n      .sort((a, b) => a[1].lastAccessed - b[1].lastAccessed);\r\n    \r\n    const toRemove = entries.slice(0, Math.ceil(entries.length * 0.3)); // Remove 30%\r\n    \r\n    toRemove.forEach(([key, entry]) => {\r\n      if (entry.data && entry.data.destroy) {\r\n        entry.data.destroy();\r\n      }\r\n      this.textures.delete(key);\r\n      this.textureMemoryUsage -= entry.size;\r\n    });\r\n    \r\n    console.log(`Memory: Cleared ${toRemove.length} textures (${(toRemove.reduce((sum, [, entry]) => sum + entry.size, 0) / 1024 / 1024).toFixed(2)}MB)`);\r\n  }\r\n\r\n  private clearOldestAudio(): void {\r\n    const entries = Array.from(this.sounds.entries())\r\n      .sort((a, b) => a[1].lastAccessed - b[1].lastAccessed);\r\n    \r\n    const toRemove = entries.slice(0, Math.ceil(entries.length * 0.3)); // Remove 30%\r\n    \r\n    toRemove.forEach(([key, entry]) => {\r\n      if (entry.data && entry.data.destroy) {\r\n        entry.data.destroy();\r\n      }\r\n      this.sounds.delete(key);\r\n      this.audioMemoryUsage -= entry.size;\r\n    });\r\n    \r\n    console.log(`Memory: Cleared ${toRemove.length} audio files (${(toRemove.reduce((sum, [, entry]) => sum + entry.size, 0) / 1024 / 1024).toFixed(2)}MB)`);\r\n  }\r\n\r\n  private getMemoryInfo() {\r\n    // @ts-ignore\r\n    if (performance.memory) {\r\n      // @ts-ignore\r\n      return performance.memory;\r\n    }\r\n    return {\r\n      usedJSHeapSize: 0,\r\n      totalJSHeapSize: 0,\r\n      jsHeapSizeLimit: 0,\r\n    };\r\n  }\r\n\r\n  getMetrics(): MemoryMetrics {\r\n    const memoryInfo = this.getMemoryInfo();\r\n    \r\n    return {\r\n      usedJSHeapSize: memoryInfo.usedJSHeapSize / 1024 / 1024, // MB\r\n      totalJSHeapSize: memoryInfo.totalJSHeapSize / 1024 / 1024, // MB\r\n      jsHeapSizeLimit: memoryInfo.jsHeapSizeLimit / 1024 / 1024, // MB\r\n      textureMemory: this.textureMemoryUsage / 1024 / 1024, // MB\r\n      audioMemory: this.audioMemoryUsage / 1024 / 1024, // MB\r\n      objectCount: this.objects.size,\r\n    };\r\n  }\r\n\r\n  getDetailedMetrics() {\r\n    const metrics = this.getMetrics();\r\n    \r\n    return {\r\n      ...metrics,\r\n      textureCount: this.textures.size,\r\n      audioCount: this.sounds.size,\r\n      memoryHistory: this.memoryHistory.slice(-60).map(bytes => bytes / 1024 / 1024), // Last 60 samples in MB\r\n      largestTextures: Array.from(this.textures.entries())\r\n        .sort((a, b) => b[1].size - a[1].size)\r\n        .slice(0, 10)\r\n        .map(([key, entry]) => ({ key, size: entry.size / 1024 / 1024 })), // Top 10 in MB\r\n      largestAudio: Array.from(this.sounds.entries())\r\n        .sort((a, b) => b[1].size - a[1].size)\r\n        .slice(0, 10)\r\n        .map(([key, entry]) => ({ key, size: entry.size / 1024 / 1024 })), // Top 10 in MB\r\n    };\r\n  }\r\n\r\n  clearAll(): void {\r\n    this.textures.forEach(entry => {\r\n      if (entry.data && entry.data.destroy) {\r\n        entry.data.destroy();\r\n      }\r\n    });\r\n    this.textures.clear();\r\n    this.textureMemoryUsage = 0;\r\n    \r\n    this.sounds.forEach(entry => {\r\n      if (entry.data && entry.data.destroy) {\r\n        entry.data.destroy();\r\n      }\r\n    });\r\n    this.sounds.clear();\r\n    this.audioMemoryUsage = 0;\r\n    \r\n    this.objects.clear();\r\n  }\r\n\r\n  forceGarbageCollection(): void {\r\n    // Clear least recently used items\r\n    this.clearOldestTextures();\r\n    this.clearOldestAudio();\r\n    \r\n    // Suggest garbage collection (if available)\r\n    if ('gc' in window) {\r\n      // @ts-ignore\r\n      window.gc();\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Device capability detection\r\n */\r\nexport function getDeviceCapabilities() {\r\n  let webGL = false;\r\n  let webGL2 = false;\r\n  let maxTextureSize = 2048;\r\n  \r\n  // Only try to create canvas in browser environment\r\n  if (typeof document !== 'undefined') {\r\n    try {\r\n      const canvas = document.createElement('canvas');\r\n      const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl') as WebGLRenderingContext | null;\r\n      \r\n      webGL = !!gl;\r\n      webGL2 = !!canvas.getContext('webgl2');\r\n      maxTextureSize = gl ? gl.getParameter(gl.MAX_TEXTURE_SIZE) : 2048;\r\n    } catch (error) {\r\n      // Canvas not supported or other error\r\n      console.warn('Could not detect WebGL capabilities:', error);\r\n    }\r\n  }\r\n  \r\n  return {\r\n    webGL,\r\n    webGL2,\r\n    maxTextureSize,\r\n    // @ts-ignore\r\n    deviceMemory: (typeof navigator !== 'undefined' && navigator.deviceMemory) || 4, // GB, fallback to 4GB\r\n    hardwareConcurrency: (typeof navigator !== 'undefined' && navigator.hardwareConcurrency) || 4,\r\n    // @ts-ignore\r\n    connection: (typeof navigator !== 'undefined' && navigator.connection?.effectiveType) || 'unknown',\r\n  };\r\n}\r\n\r\n/**\r\n * Throttle function calls for performance\r\n */\r\nexport function throttle<T extends (...args: any[]) => any>(\r\n  func: T,\r\n  delay: number\r\n): (...args: Parameters<T>) => void {\r\n  let lastCall = 0;\r\n  return (...args: Parameters<T>) => {\r\n    const now = performance.now();\r\n    if (now - lastCall >= delay) {\r\n      lastCall = now;\r\n      func(...args);\r\n    }\r\n  };\r\n}\r\n\r\n/**\r\n * Debounce function calls for performance\r\n */\r\nexport function debounce<T extends (...args: any[]) => any>(\r\n  func: T,\r\n  delay: number\r\n): (...args: Parameters<T>) => void {\r\n  let timeoutId: NodeJS.Timeout;\r\n  return (...args: Parameters<T>) => {\r\n    clearTimeout(timeoutId);\r\n    timeoutId = setTimeout(() => func(...args), delay);\r\n  };\r\n}\r\n\r\n/**\r\n * Performance debugging and profiling utilities\r\n */\r\nexport class PerformanceDebugger {\r\n  private static instance: PerformanceDebugger;\r\n  private profiles = new Map<string, { start: number; samples: number[] }>();\r\n  private markers = new Map<string, number>();\r\n  private logs: Array<{ timestamp: number; level: string; message: string; data?: any }> = [];\r\n  private readonly maxLogs = 1000;\r\n\r\n  static getInstance(): PerformanceDebugger {\r\n    if (!PerformanceDebugger.instance) {\r\n      PerformanceDebugger.instance = new PerformanceDebugger();\r\n    }\r\n    return PerformanceDebugger.instance;\r\n  }\r\n\r\n  startProfile(name: string): void {\r\n    this.profiles.set(name, { start: performance.now(), samples: [] });\r\n    if (typeof performance !== 'undefined' && performance.mark) {\r\n      performance.mark(`${name}-start`);\r\n    }\r\n  }\r\n\r\n  endProfile(name: string): number {\r\n    const profile = this.profiles.get(name);\r\n    if (!profile) {\r\n      console.warn(`Profile '${name}' not found`);\r\n      return 0;\r\n    }\r\n\r\n    const duration = performance.now() - profile.start;\r\n    profile.samples.push(duration);\r\n    \r\n    // Keep only last 100 samples\r\n    if (profile.samples.length > 100) {\r\n      profile.samples.shift();\r\n    }\r\n\r\n    if (typeof performance !== 'undefined') {\r\n      if (performance.mark) {\r\n        performance.mark(`${name}-end`);\r\n      }\r\n      if (performance.measure) {\r\n        performance.measure(name, `${name}-start`, `${name}-end`);\r\n      }\r\n    }\r\n\r\n    return duration;\r\n  }\r\n\r\n  getProfileStats(name: string) {\r\n    const profile = this.profiles.get(name);\r\n    if (!profile || profile.samples.length === 0) {\r\n      return null;\r\n    }\r\n\r\n    const samples = profile.samples;\r\n    const sum = samples.reduce((a, b) => a + b, 0);\r\n    const avg = sum / samples.length;\r\n    const min = Math.min(...samples);\r\n    const max = Math.max(...samples);\r\n    const median = samples.sort((a, b) => a - b)[Math.floor(samples.length / 2)];\r\n\r\n    return {\r\n      name,\r\n      samples: samples.length,\r\n      average: avg,\r\n      min,\r\n      max,\r\n      median,\r\n      total: sum,\r\n      recent: samples.slice(-10), // Last 10 samples\r\n    };\r\n  }\r\n\r\n  getAllProfiles() {\r\n    const results: any[] = [];\r\n    this.profiles.forEach((_, name) => {\r\n      const stats = this.getProfileStats(name);\r\n      if (stats) {\r\n        results.push(stats);\r\n      }\r\n    });\r\n    return results.sort((a, b) => b.average - a.average); // Sort by average time desc\r\n  }\r\n\r\n  setMarker(name: string): void {\r\n    this.markers.set(name, performance.now());\r\n    if (typeof performance !== 'undefined' && performance.mark) {\r\n      performance.mark(name);\r\n    }\r\n  }\r\n\r\n  getMarkerDuration(startMarker: string, endMarker?: string): number {\r\n    const start = this.markers.get(startMarker);\r\n    if (!start) return 0;\r\n\r\n    const end = endMarker ? this.markers.get(endMarker) : performance.now();\r\n    if (!end) return 0;\r\n\r\n    return end - start;\r\n  }\r\n\r\n  log(level: 'info' | 'warn' | 'error', message: string, data?: any): void {\r\n    const logEntry = {\r\n      timestamp: performance.now(),\r\n      level,\r\n      message,\r\n      data,\r\n    };\r\n\r\n    this.logs.push(logEntry);\r\n\r\n    // Keep logs manageable\r\n    if (this.logs.length > this.maxLogs) {\r\n      this.logs.shift();\r\n    }\r\n\r\n    // Also log to console with performance timestamp\r\n    const timeStr = `[${logEntry.timestamp.toFixed(2)}ms]`;\r\n    switch (level) {\r\n      case 'info':\r\n        console.log(`${timeStr} ${message}`, data || '');\r\n        break;\r\n      case 'warn':\r\n        console.warn(`${timeStr} ${message}`, data || '');\r\n        break;\r\n      case 'error':\r\n        console.error(`${timeStr} ${message}`, data || '');\r\n        break;\r\n    }\r\n  }\r\n\r\n  getLogs(level?: string, limit?: number) {\r\n    let filteredLogs = this.logs;\r\n    \r\n    if (level) {\r\n      filteredLogs = this.logs.filter(log => log.level === level);\r\n    }\r\n\r\n    if (limit) {\r\n      filteredLogs = filteredLogs.slice(-limit);\r\n    }\r\n\r\n    return filteredLogs;\r\n  }\r\n\r\n  exportPerformanceData() {\r\n    return {\r\n      timestamp: Date.now(),\r\n      profiles: this.getAllProfiles(),\r\n      markers: Object.fromEntries(this.markers),\r\n      logs: this.logs.slice(-100), // Last 100 logs\r\n      browserInfo: {\r\n        userAgent: navigator.userAgent,\r\n        memory: (performance as any).memory ? {\r\n          // @ts-ignore\r\n          usedJSHeapSize: performance.memory.usedJSHeapSize,\r\n          // @ts-ignore\r\n          totalJSHeapSize: performance.memory.totalJSHeapSize,\r\n          // @ts-ignore\r\n          jsHeapSizeLimit: performance.memory.jsHeapSizeLimit,\r\n        } : null,\r\n        connection: (navigator as any).connection ? {\r\n          // @ts-ignore\r\n          effectiveType: navigator.connection.effectiveType,\r\n          // @ts-ignore\r\n          downlink: navigator.connection.downlink,\r\n        } : null,\r\n      },\r\n    };\r\n  }\r\n\r\n  clear(): void {\r\n    this.profiles.clear();\r\n    this.markers.clear();\r\n    this.logs = [];\r\n    \r\n    // Only clear performance marks/measures if available\r\n    if (typeof performance !== 'undefined') {\r\n      if (performance.clearMarks) {\r\n        performance.clearMarks();\r\n      }\r\n      if (performance.clearMeasures) {\r\n        performance.clearMeasures();\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// Backward compatibility - keep the old PerformanceMonitor as an alias\r\nexport const PerformanceMonitor = AdvancedPerformanceMonitor;","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\utils\\performanceOptimizer.ts","messages":[{"ruleId":"@typescript-eslint/ban-ts-comment","severity":2,"message":"Use \"@ts-expect-error\" instead of \"@ts-ignore\", as \"@ts-ignore\" will do nothing if the following line is error-free.","line":184,"column":9,"nodeType":"Line","messageId":"tsIgnoreInsteadOfExpectError","endLine":184,"endColumn":22,"suggestions":[{"messageId":"replaceTsIgnoreWithTsExpectError","fix":{"range":[6073,6086],"text":"// @ts-expect-error"},"desc":"Replace \"@ts-ignore\" with \"@ts-expect-error\"."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\r\n * Performance optimization utilities for low-end devices\r\n */\r\n\r\nimport { usePerformanceStore, type GraphicsQuality } from '@/store/performanceStore';\r\nimport { AdvancedPerformanceMonitor } from './performance';\r\n\r\nexport interface OptimizationSettings {\r\n  // Graphics optimizations\r\n  reduceParticleCount: boolean;\r\n  disableAnimations: boolean;\r\n  simplifyShaders: boolean;\r\n  reduceShadowQuality: boolean;\r\n  \r\n  // Rendering optimizations\r\n  skipFrames: boolean;\r\n  reduceDrawCalls: boolean;\r\n  cullOffscreenObjects: boolean;\r\n  \r\n  // Memory optimizations\r\n  aggressiveGarbageCollection: boolean;\r\n  textureCompression: boolean;\r\n  audioCompression: boolean;\r\n  \r\n  // CPU optimizations\r\n  reduceUpdateFrequency: boolean;\r\n  simplifyPhysics: boolean;\r\n  batchOperations: boolean;\r\n}\r\n\r\nexport class PerformanceOptimizer {\r\n  private static instance: PerformanceOptimizer;\r\n  private performanceMonitor: AdvancedPerformanceMonitor;\r\n  private optimizationSettings: OptimizationSettings;\r\n  private lastOptimizationCheck = 0;\r\n  private readonly CHECK_INTERVAL = 2000; // Check every 2 seconds\r\n  \r\n  private constructor() {\r\n    this.performanceMonitor = new AdvancedPerformanceMonitor();\r\n    this.optimizationSettings = this.getDefaultOptimizationSettings();\r\n  }\r\n\r\n  static getInstance(): PerformanceOptimizer {\r\n    if (!PerformanceOptimizer.instance) {\r\n      PerformanceOptimizer.instance = new PerformanceOptimizer();\r\n    }\r\n    return PerformanceOptimizer.instance;\r\n  }\r\n\r\n  private getDefaultOptimizationSettings(): OptimizationSettings {\r\n    return {\r\n      reduceParticleCount: false,\r\n      disableAnimations: false,\r\n      simplifyShaders: false,\r\n      reduceShadowQuality: false,\r\n      skipFrames: false,\r\n      reduceDrawCalls: false,\r\n      cullOffscreenObjects: true,\r\n      aggressiveGarbageCollection: false,\r\n      textureCompression: false,\r\n      audioCompression: false,\r\n      reduceUpdateFrequency: false,\r\n      simplifyPhysics: false,\r\n      batchOperations: true,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Update performance metrics and apply optimizations if needed\r\n   */\r\n  update(): void {\r\n    const metrics = this.performanceMonitor.update();\r\n    const now = performance.now();\r\n    \r\n    // Update performance store with current metrics\r\n    usePerformanceStore.getState().updateMetrics({\r\n      currentFPS: metrics.fps,\r\n      averageFPS: this.performanceMonitor.getAverageFPS(),\r\n      frameTime: metrics.frameTime,\r\n      isLowPerformance: metrics.isLowPerformance,\r\n      memoryUsage: metrics.memoryUsage,\r\n    });\r\n\r\n    // Check if we should adjust quality automatically\r\n    if (now - this.lastOptimizationCheck > this.CHECK_INTERVAL) {\r\n      this.checkAndOptimize();\r\n      this.lastOptimizationCheck = now;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Check performance and apply optimizations if needed\r\n   */\r\n  private checkAndOptimize(): void {\r\n    const { settings, adjustQualityBasedOnPerformance } = usePerformanceStore.getState();\r\n    \r\n    if (settings.autoAdjustQuality) {\r\n      adjustQualityBasedOnPerformance();\r\n    }\r\n    \r\n    // Apply additional optimizations based on current performance\r\n    const metrics = this.performanceMonitor.update();\r\n    this.updateOptimizationSettings(metrics.isLowPerformance, settings.graphicsQuality);\r\n  }\r\n\r\n  /**\r\n   * Update optimization settings based on performance and quality level\r\n   */\r\n  private updateOptimizationSettings(isLowPerformance: boolean, quality: GraphicsQuality): void {\r\n    const newSettings = { ...this.optimizationSettings };\r\n    \r\n    if (quality === 'low' || isLowPerformance) {\r\n      // Aggressive optimizations for low-end devices\r\n      newSettings.reduceParticleCount = true;\r\n      newSettings.disableAnimations = true;\r\n      newSettings.simplifyShaders = true;\r\n      newSettings.reduceShadowQuality = true;\r\n      newSettings.skipFrames = isLowPerformance;\r\n      newSettings.reduceDrawCalls = true;\r\n      newSettings.aggressiveGarbageCollection = true;\r\n      newSettings.textureCompression = true;\r\n      newSettings.audioCompression = true;\r\n      newSettings.reduceUpdateFrequency = isLowPerformance;\r\n      newSettings.simplifyPhysics = true;\r\n    } else if (quality === 'medium') {\r\n      // Moderate optimizations\r\n      newSettings.reduceParticleCount = false;\r\n      newSettings.disableAnimations = false;\r\n      newSettings.simplifyShaders = false;\r\n      newSettings.reduceShadowQuality = true;\r\n      newSettings.skipFrames = false;\r\n      newSettings.reduceDrawCalls = true;\r\n      newSettings.aggressiveGarbageCollection = false;\r\n      newSettings.textureCompression = false;\r\n      newSettings.audioCompression = false;\r\n      newSettings.reduceUpdateFrequency = false;\r\n      newSettings.simplifyPhysics = false;\r\n    } else {\r\n      // High quality - minimal optimizations\r\n      newSettings.reduceParticleCount = false;\r\n      newSettings.disableAnimations = false;\r\n      newSettings.simplifyShaders = false;\r\n      newSettings.reduceShadowQuality = false;\r\n      newSettings.skipFrames = false;\r\n      newSettings.reduceDrawCalls = false;\r\n      newSettings.aggressiveGarbageCollection = false;\r\n      newSettings.textureCompression = false;\r\n      newSettings.audioCompression = false;\r\n      newSettings.reduceUpdateFrequency = false;\r\n      newSettings.simplifyPhysics = false;\r\n    }\r\n    \r\n    this.optimizationSettings = newSettings;\r\n  }\r\n\r\n  /**\r\n   * Get current optimization settings\r\n   */\r\n  getOptimizationSettings(): OptimizationSettings {\r\n    return { ...this.optimizationSettings };\r\n  }\r\n\r\n  /**\r\n   * Get performance metrics\r\n   */\r\n  getMetrics() {\r\n    return this.performanceMonitor.update();\r\n  }\r\n\r\n  /**\r\n   * Get detailed performance metrics for debugging\r\n   */\r\n  getDetailedMetrics() {\r\n    return this.performanceMonitor.getDetailedMetrics();\r\n  }\r\n\r\n  /**\r\n   * Force garbage collection if available\r\n   */\r\n  forceGarbageCollection(): void {\r\n    if (this.optimizationSettings.aggressiveGarbageCollection) {\r\n      // Trigger garbage collection if available\r\n      if ('gc' in window) {\r\n        // @ts-ignore\r\n        window.gc();\r\n      }\r\n      \r\n      // Clear unused textures and audio\r\n      this.clearUnusedAssets();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear unused assets to free memory\r\n   */\r\n  private clearUnusedAssets(): void {\r\n    // This would be implemented to work with Phaser's asset management\r\n    // For now, we'll just log that we're clearing assets\r\n    console.log('Performance: Clearing unused assets');\r\n  }\r\n\r\n  /**\r\n   * Get recommended settings for the current device\r\n   */\r\n  getRecommendedSettings(): {\r\n    quality: GraphicsQuality;\r\n    frameRateLimit: number;\r\n    lightweightMode: boolean;\r\n  } {\r\n    const metrics = this.performanceMonitor.update();\r\n    const avgFPS = this.performanceMonitor.getAverageFPS();\r\n    \r\n    // Determine recommended quality based on performance\r\n    let quality: GraphicsQuality = 'high';\r\n    let frameRateLimit = 0;\r\n    let lightweightMode = false;\r\n    \r\n    if (avgFPS < 20) {\r\n      quality = 'low';\r\n      frameRateLimit = 30;\r\n      lightweightMode = true;\r\n    } else if (avgFPS < 40) {\r\n      quality = 'low';\r\n      frameRateLimit = 30;\r\n    } else if (avgFPS < 50) {\r\n      quality = 'medium';\r\n      frameRateLimit = 45;\r\n    }\r\n    \r\n    // Consider memory usage\r\n    if (metrics.memoryUsage && metrics.memoryUsage > 100) { // > 100MB\r\n      if (quality === 'high') quality = 'medium';\r\n      if (frameRateLimit === 0) frameRateLimit = 45;\r\n    }\r\n    \r\n    return { quality, frameRateLimit, lightweightMode };\r\n  }\r\n\r\n  /**\r\n   * Apply emergency optimizations when performance is critically low\r\n   */\r\n  applyEmergencyOptimizations(): void {\r\n    console.warn('Performance: Applying emergency optimizations');\r\n    \r\n    const { setGraphicsQuality, setFrameRateLimit, setLightweightMode } = usePerformanceStore.getState();\r\n    \r\n    // Force lowest settings\r\n    setGraphicsQuality('low');\r\n    setFrameRateLimit(15);\r\n    setLightweightMode(true);\r\n    \r\n    // Force aggressive optimizations\r\n    this.optimizationSettings = {\r\n      ...this.optimizationSettings,\r\n      reduceParticleCount: true,\r\n      disableAnimations: true,\r\n      simplifyShaders: true,\r\n      reduceShadowQuality: true,\r\n      skipFrames: true,\r\n      reduceDrawCalls: true,\r\n      aggressiveGarbageCollection: true,\r\n      textureCompression: true,\r\n      audioCompression: true,\r\n      reduceUpdateFrequency: true,\r\n      simplifyPhysics: true,\r\n    };\r\n    \r\n    // Force garbage collection\r\n    this.forceGarbageCollection();\r\n  }\r\n\r\n  /**\r\n   * Reset optimizations to default state\r\n   */\r\n  resetOptimizations(): void {\r\n    this.optimizationSettings = this.getDefaultOptimizationSettings();\r\n    this.performanceMonitor.reset();\r\n  }\r\n\r\n  /**\r\n   * Get optimization recommendations as text\r\n   */\r\n  getOptimizationRecommendations(): string[] {\r\n    const recommendations: string[] = [];\r\n    const metrics = this.performanceMonitor.update();\r\n    const avgFPS = this.performanceMonitor.getAverageFPS();\r\n    \r\n    if (avgFPS < 30) {\r\n      recommendations.push('Consider enabling Lightweight Mode for better performance');\r\n      recommendations.push('Reduce graphics quality to Low');\r\n      recommendations.push('Limit frame rate to 30 FPS to save battery');\r\n    } else if (avgFPS < 45) {\r\n      recommendations.push('Try Medium graphics quality for balanced performance');\r\n      recommendations.push('Consider limiting frame rate to 45 FPS');\r\n    }\r\n    \r\n    if (metrics.memoryUsage && metrics.memoryUsage > 80) {\r\n      recommendations.push('High memory usage detected - consider restarting the game');\r\n      recommendations.push('Disable particle effects to reduce memory usage');\r\n    }\r\n    \r\n    if (recommendations.length === 0) {\r\n      recommendations.push('Performance is good! You can try higher quality settings.');\r\n    }\r\n    \r\n    return recommendations;\r\n  }\r\n}\r\n\r\n// Export singleton instance\r\nexport const performanceOptimizer = PerformanceOptimizer.getInstance();\r\n\r\n/**\r\n * Hook to use performance optimization in React components\r\n */\r\nexport function usePerformanceOptimization() {\r\n  const { settings } = usePerformanceStore();\r\n  const optimizationSettings = performanceOptimizer.getOptimizationSettings();\r\n  \r\n  return {\r\n    settings,\r\n    optimizationSettings,\r\n    shouldReduceParticles: optimizationSettings.reduceParticleCount || !settings.particleEffects,\r\n    shouldDisableAnimations: optimizationSettings.disableAnimations || !settings.animations,\r\n    shouldSkipFrames: optimizationSettings.skipFrames,\r\n    shouldReduceDrawCalls: optimizationSettings.reduceDrawCalls,\r\n    shouldCullOffscreen: optimizationSettings.cullOffscreenObjects,\r\n    shouldSimplifyPhysics: optimizationSettings.simplifyPhysics,\r\n    effectiveFrameRate: settings.frameRateLimit || 60,\r\n    isLightweightMode: settings.lightweightMode,\r\n  };\r\n}","usedDeprecatedRules":[]},{"filePath":"C:\\Code\\Personal\\jogos\\OCaminhoAssombradoDaEscola\\src\\utils\\touchControlOptimization.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'isPortrait' is assigned a value but never used.","line":204,"column":26,"nodeType":null,"messageId":"unusedVar","endLine":204,"endColumn":36}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"'use client';\r\n\r\ninterface DeviceInfo {\r\n  width: number;\r\n  height: number;\r\n  pixelRatio: number;\r\n  isPortrait: boolean;\r\n  isMobile: boolean;\r\n  isTablet: boolean;\r\n  hasNotch: boolean;\r\n  safeAreaInsets: {\r\n    top: number;\r\n    bottom: number;\r\n    left: number;\r\n    right: number;\r\n  };\r\n}\r\n\r\ninterface TouchControlLayout {\r\n  buttonSize: string;\r\n  spacing: string;\r\n  positioning: {\r\n    left: string;\r\n    right: string;\r\n    bottom: string;\r\n  };\r\n  fontSize: {\r\n    arrows: string;\r\n    labels: string;\r\n  };\r\n  opacity: number;\r\n  borderRadius: string;\r\n}\r\n\r\nexport function getDeviceInfo(): DeviceInfo {\r\n  if (typeof window === 'undefined') {\r\n    return {\r\n      width: 375,\r\n      height: 667,\r\n      pixelRatio: 2,\r\n      isPortrait: true,\r\n      isMobile: true,\r\n      isTablet: false,\r\n      hasNotch: false,\r\n      safeAreaInsets: { top: 0, bottom: 0, left: 0, right: 0 }\r\n    };\r\n  }\r\n\r\n  const width = window.innerWidth;\r\n  const height = window.innerHeight;\r\n  const pixelRatio = window.devicePixelRatio || 1;\r\n  const isPortrait = height > width;\r\n  \r\n  // Device type detection\r\n  const userAgent = navigator.userAgent;\r\n  const isMobile = /Android|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent);\r\n  const isTablet = /iPad|Android.*Tablet|Windows.*Touch/i.test(userAgent) || \r\n                   (width >= 768 && width <= 1024);\r\n\r\n  // Notch detection (approximate)\r\n  const hasNotch = (\r\n    // iPhone X and newer\r\n    (width === 375 && height === 812) || // iPhone X/XS\r\n    (width === 414 && height === 896) || // iPhone XR/XS Max\r\n    (width === 390 && height === 844) || // iPhone 12/13 mini\r\n    (width === 393 && height === 852) || // iPhone 14/15\r\n    // Or check for safe area insets\r\n    parseInt(getComputedStyle(document.documentElement).getPropertyValue('--safe-area-inset-top') || '0') > 20\r\n  );\r\n\r\n  // Safe area insets\r\n  const safeAreaInsets = {\r\n    top: parseInt(getComputedStyle(document.documentElement).getPropertyValue('--safe-area-inset-top') || '0'),\r\n    bottom: parseInt(getComputedStyle(document.documentElement).getPropertyValue('--safe-area-inset-bottom') || '0'),\r\n    left: parseInt(getComputedStyle(document.documentElement).getPropertyValue('--safe-area-inset-left') || '0'),\r\n    right: parseInt(getComputedStyle(document.documentElement).getPropertyValue('--safe-area-inset-right') || '0')\r\n  };\r\n\r\n  return {\r\n    width,\r\n    height,\r\n    pixelRatio,\r\n    isPortrait,\r\n    isMobile,\r\n    isTablet,\r\n    hasNotch,\r\n    safeAreaInsets\r\n  };\r\n}\r\n\r\nexport function getOptimalTouchControlLayout(deviceInfo: DeviceInfo): TouchControlLayout {\r\n  const { width, height, isPortrait, isMobile, isTablet, hasNotch, safeAreaInsets } = deviceInfo;\r\n  const screenArea = width * height;\r\n  const aspectRatio = width / height;\r\n\r\n  // Base measurements\r\n  let buttonSize: string;\r\n  let spacing: string;\r\n  let fontSize: { arrows: string; labels: string };\r\n  let opacity: number;\r\n  let borderRadius: string;\r\n\r\n  // Button size optimization based on screen characteristics\r\n  if (screenArea < 250000) {\r\n    // Very small screens (old phones)\r\n    buttonSize = 'w-10 h-10';\r\n    fontSize = { arrows: 'text-sm', labels: 'text-xs' };\r\n    spacing = 'space-x-1 space-y-1';\r\n    opacity = 0.8;\r\n    borderRadius = 'rounded-md';\r\n  } else if (screenArea < 400000) {\r\n    // Small screens\r\n    buttonSize = 'w-12 h-12';\r\n    fontSize = { arrows: 'text-base', labels: 'text-xs' };\r\n    spacing = 'space-x-1.5 space-y-1.5';\r\n    opacity = 0.85;\r\n    borderRadius = 'rounded-lg';\r\n  } else if (width < 375) {\r\n    // Narrow phones\r\n    buttonSize = 'w-13 h-13';\r\n    fontSize = { arrows: 'text-lg', labels: 'text-xs' };\r\n    spacing = 'space-x-2 space-y-2';\r\n    opacity = 0.85;\r\n    borderRadius = 'rounded-lg';\r\n  } else if (isMobile && aspectRatio > 2.0) {\r\n    // Very tall phones (modern flagships)\r\n    buttonSize = 'w-16 h-16';\r\n    fontSize = { arrows: 'text-xl', labels: 'text-sm' };\r\n    spacing = 'space-x-3 space-y-3';\r\n    opacity = 0.9;\r\n    borderRadius = 'rounded-xl';\r\n  } else if (isMobile && aspectRatio > 1.5) {\r\n    // Wide phones in landscape\r\n    buttonSize = 'w-14 h-14';\r\n    fontSize = { arrows: 'text-lg', labels: 'text-xs' };\r\n    spacing = 'space-x-2 space-y-2';\r\n    opacity = 0.85;\r\n    borderRadius = 'rounded-lg';\r\n  } else if (isMobile) {\r\n    // Regular phones\r\n    buttonSize = 'w-14 h-14';\r\n    fontSize = { arrows: 'text-lg', labels: 'text-sm' };\r\n    spacing = 'space-x-2 space-y-2';\r\n    opacity = 0.9;\r\n    borderRadius = 'rounded-lg';\r\n  } else if (isTablet && aspectRatio > 1.3) {\r\n    // Tablets in landscape\r\n    buttonSize = 'w-18 h-18';\r\n    fontSize = { arrows: 'text-2xl', labels: 'text-base' };\r\n    spacing = 'space-x-4 space-y-4';\r\n    opacity = 0.9;\r\n    borderRadius = 'rounded-xl';\r\n  } else if (isTablet) {\r\n    // Tablets in portrait\r\n    buttonSize = 'w-20 h-20';\r\n    fontSize = { arrows: 'text-2xl', labels: 'text-base' };\r\n    spacing = 'space-x-4 space-y-4';\r\n    opacity = 0.9;\r\n    borderRadius = 'rounded-xl';\r\n  } else {\r\n    // Default/desktop (shouldn't normally show)\r\n    buttonSize = 'w-16 h-16';\r\n    fontSize = { arrows: 'text-xl', labels: 'text-sm' };\r\n    spacing = 'space-x-3 space-y-3';\r\n    opacity = 0.8;\r\n    borderRadius = 'rounded-lg';\r\n  }\r\n\r\n  // Position optimization\r\n  const baseOffset = Math.max(safeAreaInsets.bottom + 8, 16);\r\n  const sideOffset = Math.max(safeAreaInsets.left + 8, 8);\r\n  const rightOffset = Math.max(safeAreaInsets.right + 8, 8);\r\n\r\n  let bottomOffset: string;\r\n  if (hasNotch && isPortrait) {\r\n    bottomOffset = `bottom-[${baseOffset + 8}px]`;\r\n  } else if (isPortrait && height < 600) {\r\n    bottomOffset = `bottom-[${Math.max(baseOffset, 8)}px]`;\r\n  } else if (isPortrait && height < 800) {\r\n    bottomOffset = `bottom-[${Math.max(baseOffset, 16)}px]`;\r\n  } else if (isPortrait) {\r\n    bottomOffset = `bottom-[${Math.max(baseOffset, 24)}px]`;\r\n  } else {\r\n    // Landscape mode - move controls higher to avoid home indicator\r\n    bottomOffset = `bottom-[${Math.max(baseOffset, 32)}px]`;\r\n  }\r\n\r\n  return {\r\n    buttonSize,\r\n    spacing,\r\n    positioning: {\r\n      left: `left-[${sideOffset}px]`,\r\n      right: `right-[${rightOffset}px]`,\r\n      bottom: bottomOffset\r\n    },\r\n    fontSize,\r\n    opacity,\r\n    borderRadius\r\n  };\r\n}\r\n\r\n// Thumb reach zones for optimal button placement\r\nexport function getThumbReachZones(deviceInfo: DeviceInfo) {\r\n  const { width, height, isPortrait } = deviceInfo;\r\n  \r\n  // Average thumb reach from bottom corners\r\n  const thumbReachRadius = Math.min(width, height) * 0.4;\r\n  \r\n  return {\r\n    left: {\r\n      x: thumbReachRadius * 0.7,\r\n      y: height - thumbReachRadius * 0.8,\r\n      radius: thumbReachRadius\r\n    },\r\n    right: {\r\n      x: width - thumbReachRadius * 0.7,\r\n      y: height - thumbReachRadius * 0.8,\r\n      radius: thumbReachRadius\r\n    }\r\n  };\r\n}\r\n\r\n// Performance optimization for touch events\r\nexport function optimizeTouchPerformance() {\r\n  // Disable default touch behaviors that can interfere\r\n  if (typeof document !== 'undefined') {\r\n    // Prevent zoom on double tap\r\n    document.addEventListener('touchstart', (e) => {\r\n      if (e.touches.length > 1) {\r\n        e.preventDefault();\r\n      }\r\n    }, { passive: false });\r\n\r\n    // Prevent context menu on long press for game controls\r\n    document.addEventListener('contextmenu', (e) => {\r\n      const target = e.target as HTMLElement;\r\n      if (target.closest('[data-touch-control]')) {\r\n        e.preventDefault();\r\n      }\r\n    });\r\n\r\n    // Optimize scroll behavior\r\n    document.body.style.touchAction = 'manipulation';\r\n  }\r\n}","usedDeprecatedRules":[]}]